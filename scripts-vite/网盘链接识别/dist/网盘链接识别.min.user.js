// ==UserScript==
// @name         网盘链接识别
// @namespace    https://greasyfork.org/zh-CN/scripts/445489
// @version      2025.4.17
// @author       WhiteSevs
// @description  识别网页中显示的网盘链接，目前包括百度网盘、蓝奏云、天翼云、中国移动云盘(原:和彩云)、阿里云、文叔叔、奶牛快传、123盘、腾讯微云、迅雷网盘、115网盘、夸克网盘、城通网盘(部分)、坚果云、UC网盘、BT磁力，支持蓝奏云、天翼云(需登录)、123盘、奶牛、UC网盘(需登录)、坚果云(需登录)和阿里云盘(需登录，且限制在网盘页面解析)直链获取下载，页面动态监控加载的链接，可自定义规则来识别小众网盘/网赚网盘或其它自定义的链接。
// @license      GPL-3.0-only
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAACsJJREFUeF7tXW+IHdUVP2c2u8kHIQYL0TRIaK1SgrFFaZsvVkpAo6YR1LJpa9jUd++83SUpSrUNBFRCrVgxNOv+mTOvJBBNmtpamoQG9UNBKLHFDzEtFttKBdOYQENE/Lb75vZd2cVNum/uvXNnZt/MnoGQD+/c8+d3fu+c+2f2PgR+ljQCuKSj5+CBCbDEScAEYAIscQSWePhcAZgASxyBJR4+VwAmQHEIjIyM3DAzM/M1pdSXEfEWALgVANbkaPE0ABwhomdz1GmtSgixHxF3Wg8wC55HxPeVUu8DgP7/jRUrVvxpbGzsY/PQbBK5VwCd9Ha7vVkptRkA9L8yHiKisAxDczaklL8GgAfLsImIryql3gSAqBPnh3nazI0AjUZjbRAEjwLAI3k6aKtLKbUjjuODtvI+cs1m894kSY776Mg49hwAxHkSIRcCSCl10nXy12YMLI9hrxDR/XkoMukQQrQQ8WGTXIGfn0PEZ6IoGvO14U0AKeUJALjH15Ecxr9ARHn2464uCSEOI+K2HHz2VXGUiAZ9lHgRQEp5BgBu9nEgr7FBEGyZmprSZCz8EUIMIuKRwg3ZGfiAiK63E/1/qcwEkFJ+BAArsxrOedzLRPSdnHWmqgvD8EBntj5Ups0UWxeI6NosvmQigBDibUTckMVgAWNKXwHMxSClfBwAtgPA+gLiclX5GhHd6TrImQBhGO5RSu11MHQREY8nSXICEf/R399/bnx8/KLD+CUl2plf3BgEwa1JktyOiN8HgKscAHCuhE4EaDabQ0mSHLBxSCml5weHlFKHWq3WBZsxLHM5AlLKLwLAQwCwCwBWWeLzKBHts5S1fx9ASnkdALxluZPXIiJh6wTLpSMwPDx8U7vd/iEADFtgdTZJko2tVuushawTAZ4EgCdMSpVSW+M4PmaS48/dEZBSWuWgMznfR0R6X8b4WLUA228/Ig5GUXTUaJUFMiMghNiEiK+bFCxbtuxLExMT/zLJ2RLAhnmTRDRiMsif+yMQhuFupdTTaZoQcZfNTqEVAYQQf0TEO1IMXurr69s4OTn5rn94rMEGAYul+Ekiutuky0iAoaGhqwcGBi4ZFD1FRLpK8FMSAkKIHyHiz9PM2bQBIwGklPcBwO9SDH0CAF8hovdKip3NAECj0VgdBMHf05aHSqntcRwfSm0VJjSllD8DgJ90k1NKTcVxbLM8MZnizx0RkFL+BgC6noAi4nNRFD3mSwB96NH1xKnMc3hHfGovbnEoZdweNraAMAxPKaW+0Q1NRFwfRdE7tUe7BwOUUuqTWL3j2u0xHhIZCSCl1K8gdT1pIiKjjh7ErhYujY6OXjM9Pf3ftGBM+TEmT0qpfAzUAukeDsI3P0yAHk6ujWtMABuUaizDBKhxcm1CYwLYoFRjGSZAjZNrExoTwAalGsswAWqcXJvQmAA2KNVYhglQ4+TahMYEsEGpxjK1IYCU8vcAcJvlW8dVTqn+C9+3iGhrHkHUggCmIPIAqhd1mA5qbHw2YWeysehnAWVetGADaMkyzn/Jc6V/dSDAeQBYXTLwvWLOeF5vcrQOBEg9bjYBUPXPTSXaFB8TwIRQj3/OBDC8cNLj+fN2r+oEOE1EX/VBwVTCfHRXYWzBBDDmx7gKMNyF92PfO/pMBPAFKO9Zsyupio7PNz9GAuiAuyzVcrmZo2iA6k4A3/xYEUAb0Xfjtdvt+xBxlVLqeF538jEB8nmrOmt+rAngWvps5ZkA+RDAFu8r5XqBAP9J2f8/R0SfzxrcQuMWgXClxueKVS8QQB8CfbuL48fyOjSZ078IBCg1vsoRYHYSs+BuYN4rgDRbc8CVabMIW5UkwLyZ7O2zAbxR1MWPZVeAeZVH3y5eeHyVJYCr41nlF4sAWf0tetyizwGKDnCx9wHKjs/VHhPgCsR6oS+7JtFHngnABPDhT/XG8hzg8pxxBeAKUL1vsY/HXAG4AvCNJ/M4wC2AW4BPQa3eWG4B3AK4BXAL6F65eCOoelXdyWNuAdwCuAVwC+AWMIcALwN5GejUQisvzHMAngPwHIDnADwH4DlAFw7wPkDlu3x6ADwHyDgHCMPwLqXUJgCYDoLgpampqb9VkSt1JUDW/FgtA6WUvwSAH1yR8Bc7vxSmf9i4Uk8dCeCTHyMBDL8a9j0iOlwlBtSNAL75sSGA/v1Z/TPmCz3/JqIvMAEWDwEppVd+bAhQq3VzDSuAV36YABXfCvYlNBOACbC01s2+35jF6/YLW/aNhysAVwCuAPMRqNpWMFcAx5rsC5ijucLFfePhFsAtgFsAt4AUDviWmMJroKMBjsfxNJABc2RYyeK++VmKc4CevrfPlT9MAEfEZn+cqrR7CR3dcxZnAjhD9unl16XdS5jBPachTAAnuD4Tnr0Bvefu7XMNhwngiljN5JkANUuoazhMAFfEaia/6ATo7+//3Pj4+MWa4VqZcAwEOE9E16UFY7MPkLZu1ro3ENFfK4NYjRwVQtyIiO92CwkR34yiaKMvAY4BwJZuSpRSD8Rx/Nsa4VqZUMIw3KaUSnsr+1dEtM2LAEKIvYi4J4VlB6Mo2lEZ1GrkqBBiEhGbKSE9Q0S7vQggpfwuALyUouRikiTrW63WhRph2/OhSCn1q/qnAeCqlOp8dxzHJ70IMDIycsPMzMw/05QopR6L4/i5nketRg5KKZ8EgCfSQlq+fPnKsbGxj70IoAdLKf8AAJtTmHYmjuNbaoRvT4cyPDx8U7vdPgUAq1Ja86tRFN1lCsS4CtAKwjDcqZTab1DWIiJhMsif+yMgpZwAgGGDpqeISFeJ1MeKADZtQFtRSm2N41ivGvgpCAGb0t8p2ucA4DYi+tDkhhUBZtvA8wDwiFEh4mAURUdNcvy5OwJCiE2I+LrFSKtvv9ZjTYBGo7E2CALdd9ZaODDZ19f3i8nJya6bFBY6WGQeAmEY7lZKPW0BivW334kAs1VAVwBdCWyeSwCg5w2HOvcIvGczgGUuR6DRaKxGRH0Hw0OIuMEGH0TcFUXRmI2sMwFmSXACAO6xNQAAnyilXuysIv4cBMFfoih6x2HskhIdHR29Znp6eo1Saj0iPgAA30qb6S8AzlEiGnQBzboFzFcqpTwDADe7GCpIVm+EHCGiZwvSn6pWCLEfEXcuhu0FbH5ARNe7+pKJALOV4CMAWOlqsCB56sx4w4J0L6h29o2iB8u0mWLrAhFdm8WXzATQxoQQb9v2pizOuYxRSu2I4/igy5isss1m894kSY5nHZ/zuNeI6M6sOr0IoI2GYbhHKbU3qwM5jnulcyx9f476uqoSQrQQ8eEybBlsvOz7G8veBNAONpvNoSRJfgoAaxYRlBeIqJR+3DmHP9w5h089Zi0Yh7N6NUZE+3zt5EKA2TmBfvNE92G9HVw6EYIg2DI1NaVXKIU/QohBRDxSuKGFDexLkuT5VqulSeD95EaAOU+klJ8SQSn1TUS8w9tDOwXepdDOzGdSYRgeUEoNuY7LKH8SEU/29fWdnJiY0LeC5fbkToD5ng0NDV09MDCgSfB1AFiHiOuUUusAINOMtUvUpa8A5pH9cQDYDgDrc8sIgH6vQk+uzyRJcqa/v/9U3kmf72uhBMgRFFZVEAJMgIKArYpaJkBVMlWQn0yAgoCtilomQFUyVZCfTICCgK2KWiZAVTJVkJ9MgIKArYra/wGYigzMiqJYZwAAAABJRU5ErkJggg==
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*/*
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@86be74b83fca4fa47521cded28377b35e1d7d2ac/lib/CoverUMD/index.js
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@11f749fc58f5674c1b4db129731403b77d97f7eb/scripts-vite/%E7%BD%91%E7%9B%98%E9%93%BE%E6%8E%A5%E8%AF%86%E5%88%AB/%E7%BD%91%E7%9B%98%E9%93%BE%E6%8E%A5%E8%AF%86%E5%88%AB-%E5%9B%BE%E6%A0%87.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.6.5/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.5.2/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@2.0.2/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.3.1/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@886625af68455365e426018ecb55419dd4ea6f30/lib/CryptoJS/index.js
// @connect      *
// @connect      lanzoub.com
// @connect      lanzouc.com
// @connect      lanzoue.com
// @connect      lanzouf.com
// @connect      lanzoug.com
// @connect      lanzouh.com
// @connect      lanzoui.com
// @connect      lanzouj.com
// @connect      lanzouk.com
// @connect      lanzoul.com
// @connect      lanzoum.com
// @connect      lanzouo.com
// @connect      lanzoup.com
// @connect      lanzouq.com
// @connect      lanzous.com
// @connect      lanzout.com
// @connect      lanzouu.com
// @connect      lanzouv.com
// @connect      lanzouw.com
// @connect      lanzoux.com
// @connect      lanzouy.com
// @connect      lanosso.com
// @connect      lanzn.com
// @connect      lanzog.com
// @connect      lanpw.com
// @connect      lanpv.com
// @connect      lanzv.com
// @connect      wwentua.com
// @connect      ilanzou.com
// @connect      189.cn
// @connect      123pan.com
// @connect      123pan.cn
// @connect      wenshushu.cn
// @connect      jianguoyun.com
// @connect      cowtransfer.com
// @connect      cowcs.com
// @connect      aliyundrive.com
// @connect      baidu.com
// @connect      139.com
// @connect      weiyun.com
// @connect      xunlei.com
// @connect      115.com
// @connect      quark.cn
// @connect      jianguoyun.com
// @connect      uc.cn
// @connect      ctfile.com
// @connect      sharepoint.com
// @grant        GM_deleteValue
// @grant        GM_download
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_openInTab
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (m, B, xe, Ve, pt) {
	'use strict';

	var ut=Object.defineProperty;var ht=(a,n,t)=>n in a?ut(a,n,{enumerable:true,configurable:true,writable:true,value:t}):a[n]=t;var O=(a,n,t)=>ht(a,typeof n!="symbol"?n+"":n,t);var Be=typeof GM_deleteValue<"u"?GM_deleteValue:undefined,Ge=typeof GM_download<"u"?GM_download:undefined,U=typeof GM_getValue<"u"?GM_getValue:undefined,we=typeof GM_info<"u"?GM_info:undefined,ft=typeof GM_openInTab<"u"?GM_openInTab:undefined,mt=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:undefined,Z=typeof GM_setValue<"u"?GM_setValue:undefined,gt=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:undefined,wt=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:undefined,ee=typeof unsafeWindow<"u"?unsafeWindow:undefined,kt=window;const Ct={$data:{get enable(){return W.getValue("httpx-use-cookie-enable")},get useDocumentCookie(){return W.getValue("httpx-use-document-cookie")},cookieRule:[]},fixCookieSplit(a){return d.isNotNull(a)&&!a.trim().endsWith(";")&&(a+=";"),a},concatCookie(a,n){return d.isNull(a)?n:(a=a.trim(),n=n.trim(),a=this.fixCookieSplit(a),n.startsWith(";")&&(n=n.substring(1)),a.concat(n))},handle(a){if(a.fetch||!this.$data.enable)return;let n="",t=a.url;t.startsWith("//")&&(t=window.location.protocol+t);let e=new URL(t);this.$data.useDocumentCookie&&e.hostname.endsWith(window.location.hostname.split(".").slice(-2).join("."))&&(n=this.concatCookie(n,document.cookie.trim()));for(let i=0;i<this.$data.cookieRule.length;i++){let s=this.$data.cookieRule[i];if(e.hostname.match(s.hostname)){let r=W.getValue(s.key);if(d.isNull(r))break;n=this.concatCookie(n,r);}}d.isNotNull(n)&&(a.headers&&a.headers.Cookie?a.headers.Cookie=this.concatCookie(a.headers.Cookie,n):a.headers.Cookie=n,h.info(["Httpx => 设置cookie:",a])),a.headers&&a.headers.Cookie!=null&&d.isNull(a.headers.Cookie)&&delete a.headers.Cookie;}};class Xe{constructor(n){O(this,"storageKey");if(typeof n=="string"){let t=n.trim();if(t=="")throw new Error("key参数不能为空字符串");this.storageKey=t;}else throw new Error("key参数类型错误，必须是字符串");this.getLocalValue();}getLocalValue(){let n=U(this.storageKey);return n==null&&(n={},this.setLocalValue(n)),n}setLocalValue(n){Z(this.storageKey,n);}set(n,t){let e=this.getLocalValue();Reflect.set(e,n,t),this.setLocalValue(e);}get(n,t){let e=this.getLocalValue();return Reflect.get(e,n)??t}getAll(){return this.getLocalValue()}delete(n){let t=this.getLocalValue();Reflect.deleteProperty(t,n),this.setLocalValue(t);}has(n){let t=this.getLocalValue();return Reflect.has(t,n)}keys(){let n=this.getLocalValue();return Reflect.ownKeys(n)}values(){let n=this.getLocalValue();return Reflect.ownKeys(n).map(t=>Reflect.get(n,t))}clear(){Be(this.storageKey);}}const V={getDefaultLinkClickMode(){return {copy:{default:false,enable:true,text:"复制到剪贴板"},"copy-closePopup":{default:false,enable:true,text:"复制到剪贴板 & 关闭弹窗"},openBlank:{default:false,enable:true,text:"新标签页打开"},"openBlank-closePopup":{default:false,enable:true,text:"新标签页打开 & 关闭弹窗"},parseFile:{default:false,enable:false,text:"文件解析"},"parseFile-closePopup":{default:false,enable:false,text:"文件解析 & 关闭弹窗"},own:{default:false,enable:false,text:"自定义动作"}}},replaceParam(a,n={}){return typeof a!="string"||Object.keys(n).forEach(t=>{let e=n[t];if(d.isNotNull(e)){try{a=a.replaceAll(`{#encodeURI-${t}#}`,encodeURI(e));}catch{h.error("encodeURI-替换的文本失败",[e]);}try{a=a.replaceAll(`{#encodeURIComponent-${t}#}`,encodeURIComponent(e));}catch{h.error("encodeURIComponent-替换的文本失败",[e]);}try{a=a.replaceAll(`{#decodeURI-${t}#}`,decodeURI(e));}catch{h.error("decodeURI-替换的文本失败",[e]);}try{a=a.replaceAll(`{#decodeURIComponent-${t}#}`,decodeURIComponent(e));}catch{h.error("encodeURIComponent-替换的文本失败",[e]);}a=a.replaceAll(`{#${t}#}`,e);}}),a},replaceChinese(a){return a.replace(/[\u4e00-\u9fa5]/g,"")},getDecodeComponentUrl(a=window.location.href){try{a=decodeURIComponent(a);}catch{}return a}},L={matchRange_text:{before:a=>`${a}-text-match-range-before`,after:a=>`${a}-text-match-range-after`},matchRange_html:{before:a=>`${a}-html-match-range-before`,after:a=>`${a}-html-match-range-after`},function:{enable:a=>`${a}-enable`,checkLinkValidity:a=>`${a}-check-link-valid`,checkLinkValidityHoverTip:a=>`${a}-check-link-valid-hover-tip`,linkClickMode:a=>`${a}-click-mode`},linkClickMode_openBlank:{openBlankWithCopyAccessCode:a=>`${a}-open-blank-with-copy-accesscode`},schemeUri:{enable:a=>`${a}-scheme-uri-enable`,isForwardLinearChain:a=>`${a}-scheme-uri-forward-linear-chain`,isForwardBlankLink:a=>`${a}-scheme-uri-forward-blank-link`,uri:a=>`${a}-scheme-uri-uri`}},Oe={features:{customAccessCodeEnable:a=>`${a}-custom-accesscode-enable`,customAccessCode:a=>`${a}-custom-accesscode`}},ke={replaceText(a,n,t){if(Array.isArray(n))for(const e of n)a=a.replace(e,t);else a=a.replace(n,t);return a},async getClipboardText(){function a(e){navigator.clipboard.readText().then(i=>{e(i);}).catch(i=>{h.error("读取剪贴板内容失败👉",i),e("");});}function n(e){navigator.permissions.query({name:"clipboard-read"}).then(i=>{a(e);}).catch(i=>{h.error("申请剪贴板权限失败，尝试直接读取👉",i.message??i.name??i.stack),a(e);});}function t(){var e,i;return !(typeof((e=navigator==null?undefined:navigator.clipboard)==null?undefined:e.readText)!="function"||typeof((i=navigator==null?undefined:navigator.permissions)==null?undefined:i.query)!="function")}return new Promise(e=>{if(!t()){e("");return}document.hasFocus()?n(e):window.addEventListener("focus",()=>{n(e);},{once:true});})}},ge="GM_Panel",Qe="data-init",le="data-key",pe="data-default-value",yt="data-init-more-value",P="data-storage-api",se=function(a,n,t,e,i,s="",r,o){let l={text:a,type:"input",isNumber:!!r,isPassword:!!o,props:{},attributes:{},description:e,getValue(){return this.props[P].get(n,t)},callback(c,u,p){typeof i=="function"&&i(c,u,p)||this.props[P].set(n,u);},placeholder:s};return Reflect.set(l.attributes,le,n),Reflect.set(l.attributes,pe,t),Reflect.set(l.props,P,{get(c,u){return U(c,u)},set(c,u){Z(c,u);}}),l},F=function(a,n,t,e,i,s){let r={text:a,type:"switch",description:i,attributes:{},props:{},getValue(){return !!this.props[P].get(n,t)},callback(o,l){let c=!!l;h.success(`${c?"开启":"关闭"} ${a}`),!(typeof e=="function"&&e(o,c))&&this.props[P].set(n,c);},afterAddToUListCallBack:s};return Reflect.set(r.attributes,le,n),Reflect.set(r.attributes,pe,t),Reflect.set(r.props,P,{get(o,l){return U(o,l)},set(o,l){Z(o,l);}}),r},_e={$key:{STORAGE_KEY:"character-mapping"},getTemplateData(){return {uuid:d.generateUUID(),enable:true,name:"",data:{url:"",isRegExp:true,regExpFlag:"ig",searchValue:"",replaceValue:""}}},show(){let a=j.config.panelHandleContentUtils();function n(e){return {get(i,s){return e[i]??s},set(i,s){e[i]=s;}}}new rt({title:"字符映射规则",data:()=>this.getData(),getAddData:()=>this.getTemplateData(),getDataItemName:e=>e.name,updateData:e=>this.updateData(e),deleteData:e=>this.deleteData(e),getData:e=>this.getData().find(r=>r.uuid===e.uuid)??e,itemControls:{enable:{enable:true,getEnable(e){return e.enable},callback:(e,i)=>{e.enable=i,this.updateData(e);}},edit:{enable:true,getView:(e,i)=>{let s=document.createDocumentFragment();i||(e=this.getTemplateData());let r=F("启用","enable",true);Reflect.set(r.props,P,n(e));let o=a.createSectionContainerItem_switch(r),l=se("规则名称","name","","",undefined,"必填");Reflect.set(l.props,P,n(e));let c=a.createSectionContainerItem_input(l),u=se("匹配网址","url","","",undefined,"必填，可正则");Reflect.set(u.props,P,n(e.data));let p=a.createSectionContainerItem_input(u),f=F("是否启用正则","isRegExp",true);Reflect.set(f.props,P,n(e.data));let w=a.createSectionContainerItem_switch(f),C=se("正则标识符","regExpFlag","ig","",undefined,"i:不区分大小写  g:全局");Reflect.set(C.props,P,n(e.data));let b=a.createSectionContainerItem_input(C),S=se("字符规则","searchValue","","",undefined,"必填，可正则");Reflect.set(S.props,P,n(e.data));let v=a.createSectionContainerItem_input(S),D=se("映射为","replaceValue","","",undefined,"");Reflect.set(D.props,P,n(e.data));let N=a.createSectionContainerItem_input(D);return s.appendChild(o),s.appendChild(c),s.appendChild(p),s.appendChild(w),s.appendChild(b),s.appendChild(v),s.appendChild(N),s},onsubmit:(e,i,s)=>{let r=e.querySelectorAll(".rule-form-ulist > li"),o=this.getTemplateData();return i&&(o.uuid=s.uuid),r.forEach(l=>{let c=Reflect.get(l,"__formConfig__"),u=Reflect.get(c,"attributes"),p=Reflect.get(l,P),f=Reflect.get(u,le),w=Reflect.get(u,pe),C=p.get(f,w);Reflect.has(o,f)?Reflect.set(o,f,C):Reflect.has(o.data,f)?Reflect.set(o.data,f,C):h.error(`${f}不在数据中`);}),o.name.trim()===""?(m.error("规则名称不能为空"),{success:false,data:o}):o.data.url.trim()===""?(m.error("匹配网址不能为空"),{success:false,data:o}):o.data.searchValue.trim()===""?(m.error("字符规则不能为空"),{success:false,data:o}):i?{success:this.updateData(o),data:o}:{success:this.addData(o),data:o}}},delete:{enable:true,deleteCallBack:e=>this.deleteData(e)}},bottomControls:{filter:{enable:true,title:"过滤规则",option:[{name:"过滤【已启用】的规则",filterCallBack(e){return e.enable}},{name:"过滤【未启用】的规则",filterCallBack(e){return !e.enable}},{name:"过滤【在当前网址生效】的规则",filterCallBack(e){return !!window.location.href.match(e.data.url)}}]}}}).showView();},getUrlMatchedRule(a=window.location.href){return this.getData().filter(t=>!!a.match(t.data.url))},getMappingData(a=window.location.href){return this.getUrlMatchedRule().map(t=>{if(t.enable)if(t.data.isRegExp)try{return {searchValue:new RegExp(t.data.searchValue,t.data.regExpFlag),replaceValue:t.data.replaceValue}}catch(e){h.error("字符映射规则转换发生错误：",e);}else return {searchValue:t.data.searchValue,replaceValue:t.data.replaceValue}}).filter(t=>t!=null)},getData(){return U(this.$key.STORAGE_KEY,[])},setData(a){Z(this.$key.STORAGE_KEY,a);},addData(a){let n=this.getData();return n.findIndex(e=>e.uuid==a.uuid)===-1?(n.push(a),Z(this.$key.STORAGE_KEY,n),true):false},updateData(a){let n=this.getData(),t=n.findIndex(i=>i.uuid==a.uuid),e=false;return t!==-1&&(e=true,n[t]=a),this.setData(n),e},deleteData(a){let n=this.getData(),t=n.findIndex(i=>i.uuid==a.uuid),e=false;return t!==-1&&(e=true,n.splice(t,1)),this.setData(n),e},clearData(){Be(this.$key.STORAGE_KEY);}},A={$data:{isMatchedLink:false,clipboardText:""},$match:{matchedInfo:new xe.Dictionary,blackMatchedInfo:new xe.Dictionary,tempMatchedInfo:new xe.Dictionary,matchedInfoRuleKey:new Set},$rule:{matchRule:{},ruleSetting:{},rule:[]},$extraRule:{shareCodeNotMatchRegexpList:[/vipstyle|notexist|ajax|file|download|ptqrshow|xy-privacy/g,/comp|web|undefined|1125|unproved|console|account|favicon|setc/g],accessCodeNotMatchRegexpList:[/^(font)/gi],noAccessCodeRegExp:[/( |提取码:|\n密码：)/gi,/{#accessCode#}/gi,/{#encodeURI-accessCode#}|{#encodeURIComponent-accessCode#}/gi,/{#decodeURI-accessCode#}|{#decodeURIComponent-accessCode#}/gi,/(\?pwd=|&pwd=|\?password=|\?p=)/gi]},init(){this.initLinkDict();},initLinkDict(){Object.keys(this.$rule.matchRule).forEach(t=>{this.$match.matchedInfo.set(t,new d.Dictionary),this.$match.blackMatchedInfo.set(t,new d.Dictionary),this.$match.tempMatchedInfo.set(t,new d.Dictionary);});let a=Q.getUrlMatchedRule().filter(t=>t.enable);a.length&&(h.info("成功命中网站规则 ==> ",a),be.add({key:"matchedUrlRuleList",text:`🌏 命中网站规则 ${a.length} 条`,autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{h.info("当前网址："+self.location.href),W.isTopWindow()&&alert(`以下是命中的规则名：
`+a.map(t=>t.name).join(`
`));}}));let n=_e.getUrlMatchedRule().filter(t=>t.enable);n.length&&(h.info("成功命中字符规则 ==> ",n),be.add({key:"characterMapping",text:`🌏 命中字符规则 ${n.length} 条`,autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{h.info("当前网址："+self.location.href),W.isTopWindow()&&alert(`以下是命中的规则名：
`+n.map(t=>t.name).join(`
`));}}));},handleLink(a,n,t){let e=this.handleShareCode(a,n,t);if(d.isNull(e))return;let i=this.handleAccessCode(a,n,t);return i=this.handleAccessCodeByUserRule(a,i,t),{shareCode:e,accessCode:i}},handleShareCode(a,n,t){var o;let e=A.$rule.matchRule[a][n],i=(o=t.match(e.shareCode))==null?undefined:o.filter(l=>d.isNotNull(l));if(d.isNull(i)){h.error("匹配shareCode为空",{匹配的文本:t,规则:e,正在使用的规则:e.shareCode,网盘名称:a,网盘名称索引下标:n});return}let s=i[0];e.shareCodeNeedRemoveStr&&(s=s.replace(e.shareCodeNeedRemoveStr,""));let r=e.shareCodeNotMatch;if(r!=null&&s.match(r)){h.error(`不可能的shareCode => ${s}`);return}for(const l of A.$extraRule.shareCodeNotMatchRegexpList)if(s.match(l)){h.error(`不可能的shareCode => ${s}`);return}if(s=decodeURI(s),!(g.shareCode.excludeIdenticalSharedCodes.value&&d.isSameChars(s,g.shareCode.excludeIdenticalSharedCodesCoefficient.value))&&!(s.endsWith("http")||s.endsWith("https")))return s},handleAccessCode(a,n,t){var r;let e=this.$rule.matchRule[a][n],i="";if(!e.checkAccessCode)return "";let s=t.match(e.checkAccessCode);if(s){let l=(r=s[s.length-1].match(e.accessCode))==null?undefined:r.filter(c=>d.isNotNull(c));if(d.isNull(l))return "";l.length&&(i=l[0],i.startsWith("http")&&(i=""));}if(d.isNotNull(i)){for(const o of A.$extraRule.accessCodeNotMatchRegexpList)if(i.match(o)){i="";break}e.acceesCodeNotMatch&&i.match(e.acceesCodeNotMatch)&&(i="");}return i},handleAccessCodeByUserRule(a,n,t){let e=Q.getUrlMatchedRule(),i=n;for(let s=0;s<e.length;s++){const r=e[s];let o=Q.getRuleData(r),l=Reflect.get(o,Oe.features.customAccessCode(a));if(Reflect.get(o,Oe.features.customAccessCodeEnable(a))&&typeof l=="string"){i=l,h.success(`使用自定义网站规则中的提取码 ${a} ${i}`);break}}return i},handleLinkShow(a,n,t,e,i){let s=A.$rule.matchRule[a][n];if(s==null)throw m.error("BUG: 获取uiLink规则失败"),h.error("BUG: 分析参数",a,n,t,e),new TypeError("获取uiLink规则失败");let r=V.replaceParam(s.uiLinkShow,{shareCode:t});if(typeof e=="string"&&e.trim()!=""?r=V.replaceParam(r,{accessCode:e}):r=ke.replaceText(r,A.$extraRule.noAccessCodeRegExp,""),s.paramMatch){let o=A.$match.matchedInfo.get(a).get(t);if(i=i??(o==null?undefined:o.matchText),d.isNotNull(i)){let l=i.match(s.paramMatch),c={};if(l)for(let u=0;u<l.length;u++)c[`$${u}`]=l[u];r=V.replaceParam(r,c);}}return r},getLinkDickObj(a,n=0,t=false,e){return {accessCode:a,netDiskIndex:n,isForceAccessCode:t,matchText:e}}},xt={tianYiYunLoginTip:{PC:{width:"30vw",height:"280px"},Mobile:{width:"80vw",height:"250px"}},jianGuoYunLoginTip:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},settingView:{PC:{width:"800px",height:"600px"},Mobile:{width:"92vw",height:"80vh"}},setDefaultValueView:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},mainView:{PC:{width:"500px",height:"100%"},Mobile:{width:"88vw",height:"50vh"}},mainViewSmallWindow:{PC:{get width(){return g.smallWindow["netdisk-ui-small-window-width"].value+"px"},height:"auto"},Mobile:{get width(){return g.smallWindow["netdisk-ui-small-window-width"].value+"px"},height:"auto"}},oneFileStaticView:{PC:{width:"550px",height:"350px"},Mobile:{width:"88vw",height:"300px"}},moreFileStaticView:{PC:{width:"700px",height:"600px"},Mobile:{width:"88vw",height:"500px"}},inputNewAccessCodeView:{PC:{width:"400px",height:"200px"},Mobile:{width:"88vw",height:"160px"}},historyMatchView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRulesView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRuleDebugView:{PC:{width:"55vw",height:"70vh"},Mobile:{width:"88vw",height:"70vh"}},matchPasteTextView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleEditView:{PC:{width:"44vw",height:"50vh"},Mobile:{width:"70vw",height:"45vh"}},websiteRuleView:{PC:{width:"45vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},websiteEditRuleView:{PC:{width:"45vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}}},bt=function(a){window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/share/init"&&window.location.search.startsWith("?surl=")&&(h.success("自动填写链接",a),d.waitNode("div.verify-form #accessCode").then(n=>{var t;if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),(t=document.querySelector("div.verify-form #submitBtn"))==null||t.click();})),window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/wap/init"&&window.location.search.startsWith("?surl=")&&(h.success("自动填写链接",a),d.waitNode("div.extractWrap div.extract-content div.extractInputWrap.extract input[type=text]").then(n=>{var t;if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),(t=document.querySelector("div.extractWrap div.extract-content button.m-button"))==null||t.click();}));},vt=function(a){window.location.hostname.match(/lanzou[a-z]{1}.com/gi)&&(h.success("自动填写链接",a),d.waitNode("#pwd").then(n=>{var t,e;if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),(t=document.querySelector("#passwddiv div.passwddiv-input > div")||n.nextElementSibling)==null||t.click(),(e=document.querySelector("#sub"))==null||e.click();}),d.waitNode("#f_pwd").then(n=>{d.mutationObserver(n,{config:{attributes:true,attributeFilter:["style"]},callback:(t,e)=>{var s;let i=document.querySelector("#f_pwd #pwd");if(!d.isVisible(i)){h.error("输入框不可见，不输入密码");return}e.disconnect(),h.success("自动填入访问码并关闭观察者"),m.success("自动填入访问码"),i.value=a.accessCode,d.dispatchEvent(i,"input"),(s=document.querySelector("#f_pwd #sub"))==null||s.click();}});}));},_t=function(a){function n(t,e){let i=0,s=30,r=setInterval(()=>{if(i++,i>s){h.error("结束循环检查，退出。"),clearInterval(r);return}if(!d.isVisible(t)){h.warn(`第 ${i} 次：输入框不可见，不输入密码`);return}e(),clearInterval(r);},500);}window.location.hostname==="cloud.189.cn"&&(h.success("自动填写链接",a),d.waitNode("input#code_txt").then(t=>{n(t,()=>{m.success("自动填入访问码");let e=document.querySelector(".btn.btn-primary.visit");t.value=a.accessCode,t._value=a.accessCode,d.dispatchEvent(t,"input"),d.dispatchEvent(e,"click");});})),window.location.hostname==="h5.cloud.189.cn"&&(h.success("自动填写链接",a),d.waitNode("input.access-code-input").then(t=>{n(t,()=>{m.success("自动填入访问码"),t.value=a.accessCode,t._value=a.accessCode,d.dispatchEvent(t,"input"),d.dispatchEvent(document.querySelector("div.button"),"click");});}));},At=function(a){window.location.hostname==="caiyun.139.com"&&(h.success("自动填写链接",a),d.waitNode("#token-input").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),document.querySelector("#homepage div.token div.token-form a").click();}),d.waitNode("#app div.token-form input[type=text]").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),document.querySelector("div.token-form a.btn-token").click();}));},ve={async waitReactPropsToSet(a,n,t){if(!Array.isArray(t)){this.waitReactPropsToSet(a,n,[t]);return}function e(){let i=null;return typeof a=="string"?i=document.querySelector(a):typeof a=="function"?i=a():a instanceof HTMLElement&&(i=a),i}typeof a=="string"&&!await d.waitNode(a,1e4)||t.forEach(i=>{typeof i.msg=="string"&&h.info(i.msg);function s(){let r=e();if(r==null)return  false;let o=d.getReactObj(r);if(o==null)return  false;let l=o[n];return l==null?false:!!i.check(l)}d.waitPropertyByInterval(()=>e(),s,250,1e4).then(()=>{let r=e();if(r==null)return;let o=d.getReactObj(r);if(o==null)return;let l=o[n];l!=null&&i.set(l);});});}},St=function(a){(window.location.hostname==="www.aliyundrive.com"||window.location.hostname==="www.alipan.com")&&(h.success("自动填写链接",a),d.waitNode("#root input.ant-input").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,ve.waitReactPropsToSet(n,"reactFiber",{check(t){var e;return typeof((e=t==null?undefined:t.memoizedProps)==null?undefined:e.onChange)=="function"},set(t){t.memoizedProps.onChange({currentTarget:n,target:n});}}),document.querySelector('#root button[type="submit"]').click();}),d.waitNode("#root input[name=pwd]").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,ve.waitReactPropsToSet(n,"reactFiber",{check(t){var e;return typeof((e=t==null?undefined:t.memoizedProps)==null?undefined:e.onChange)=="function"},set(t){t.memoizedProps.onChange({currentTarget:n,target:n});}}),document.querySelector('#root button[type="submit"]').click();}));},Rt=function(a){window.location.hostname==="www.123pan.com"&&(h.success("自动填写链接",a),d.waitNode("#app .ca-fot input.ant-input[type=text]").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),ve.waitReactPropsToSet(n,"reactProps",{check(e){return typeof(e==null?undefined:e.onChange)=="function"},set(e){e.onChange({target:{value:a.accessCode}});}});let t=n.nextSibling;t==null||t.click();}),d.waitNode("#app .appinput input.ant-input[type=text]").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),ve.waitReactPropsToSet(n,"reactProps",{check(e){return typeof(e==null?undefined:e.onChange)=="function"},set(e){e.onChange({target:{value:a.accessCode}});}});let t=n.nextSibling;t==null||t.click();}));},Nt=function(a){window.location.hostname==="share.weiyun.com"&&(h.success("自动填写链接",a),d.waitNode("#app input.input-txt").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),d.dispatchEvent(n,"change"),setTimeout(()=>{document.querySelector(".form-item button.btn-main").click();},500);}),d.waitNode(".input-wrap input.pw-input").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),d.dispatchEvent(n,"change"),setTimeout(()=>{document.querySelector(".pw-btn-wrap button.btn").click();},500);}));},Dt=function(a){window.location.hostname==="pan.xunlei.com"&&(h.success("自动填写链接",a),d.waitNode("#__layout div.pass-input-wrap input.td-input__inner").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}h.error("输入框不可见，不输入密码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),d.dispatchEvent(n,"change"),setTimeout(()=>{document.querySelector("#__layout div.pass-input-wrap button.td-button").click();},500);}),d.waitNode("#__layout div.pass-wrapper input.td-input__inner").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}h.error("输入框不可见，不输入密码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),d.dispatchEvent(n,"change"),setTimeout(()=>{document.querySelector("#__layout div.pass-wrapper button.td-button").click();},500);}));},Mt=function(a){window.location.hostname==="pan.quark.cn"&&(h.success("自动填写链接",a),d.waitNode("#ice-container input.ant-input[class*=ShareReceive]").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),ve.waitReactPropsToSet(n,"reactProps",{check(t){return (t==null?undefined:t.onChange)==="function"},set(t){t.onChange({target:{value:a.accessCode}});}}),ve.waitReactPropsToSet(n,"reactEventHandlers",{check(t){return (t==null?undefined:t.onChange)==="function"},set(t){t.onChange({target:{value:a.accessCode}});}});}));},Tt=function(a){h.success("自动填写链接",a),d.waitNode("#passcode").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),document.querySelector("#main-content .form-group button.btn[type=button]").click();});},It=function(a){window.location.hostname==="115.com"&&(h.success("自动填写链接",a),d.waitNode("input.text").then(n=>{if(!d.isVisible(n)){h.error("输入框不可见，不输入密码");return}m.success("自动填入访问码"),n.value=a.accessCode,d.dispatchEvent(n,"input"),document.querySelector("#js-share_code div.form-decode div.submit a").click();}));},Se={key:"tempNetDiskInfo",$data:{netDiskInfo:null,get enable(){return g.features.autoFillAccessCode.value}},init(){if(!this.$data.enable)return;this.$data.netDiskInfo=this.getValue();let a=false;for(let n=0;n<this.$data.netDiskInfo.length;n++){const t=this.$data.netDiskInfo[n];let e=t.accessCode;if(e==null||typeof e=="string"&&e.trim()==="")continue;let i=t.shareCode;if(t.netDiskName==="baidu"&&i.startsWith("1")&&(i=i.slice(1,i.length)),window.location.href.includes(i)){let r=Se.netDisk[t.netDiskName];typeof r=="function"?(h.success("成功匹配到对应的自动填入访问码的网盘信息：",t),r(t)):h.warn("自动填写访问码失败："+t.netDiskName+"，原因：该网盘未适配"),a=true;break}}a||h.error("未触发自动填入访问码，原因：未找到对应的网盘信息：👇",this.$data.netDiskInfo);},netDisk:{baidu:bt,lanzou:vt,tianyiyun:_t,hecaiyun:At,aliyun:St,wenshushu:()=>{},nainiu:()=>{},_123pan:Rt,weiyun:Nt,xunlei:Dt,_115pan:It,chengtong:Tt,kuake:Mt,jianguoyun:()=>{},onedrive:()=>{}},setValue(a){Z(this.key,a);},addValue(a){let n=a.accessCode;if(n==null||typeof n=="string"&&n.trim()==="")return;let t=this.getValue();t=t.filter(e=>!(e.netDiskName===a.netDiskName&&e.shareCode===a.shareCode)),t.push(a),this.setValue(t);},getValue(){let a=U(this.key,[]);return Array.isArray(a)||(a=[a]),a=a.filter(n=>Date.now()-n.time<24*60*60*1e3),this.setValue(a),a}},Lt=function(){},G={matchRange_text:{before(a,n=20){const t=R(L.matchRange_text.before(a),n);return parseInt(t.value.toString())},after(a,n=10){const t=R(L.matchRange_text.after(a),n);return parseInt(t.value.toString())}},matchRange_html:{before(a,n=100){const t=R(L.matchRange_html.before(a),n);return parseInt(t.value.toString())},after(a,n=15){const t=R(L.matchRange_html.after(a),n);return parseInt(t.value.toString())}},function:{enable(a,n=true){return !!R(L.function.enable(a),n).value},linkClickMode(a,n="copy"){return R(L.function.linkClickMode(a),n).value},checkLinkValidity(a,n=false){return !!R(L.function.checkLinkValidity(a),n).value},checkLinlValidityHoverTip(a,n=true){return !!R(L.function.checkLinkValidityHoverTip(a),n).value}},linkClickMode_openBlank:{openBlankWithCopyAccessCode(a,n=false){return !!R(L.linkClickMode_openBlank.openBlankWithCopyAccessCode(a),n).value}},schemeUri:{enable(a,n=false){return !!R(L.schemeUri.enable(a),n).value},isForwardLinearChain(a,n=false){return !!R(L.schemeUri.isForwardLinearChain(a),n).value},isForwardBlankLink(a,n=false){return !!R(L.schemeUri.isForwardBlankLink(a),n).value},uri(a,n=""){return R(L.schemeUri.uri(a),n).value}}},De="(123pan|123865|123684|123652|123912).(com|cn)",et={rule:[{link_innerText:`${De}/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`${De}/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)`,shareCode:new RegExp(`${De}/s/([a-zA-Z0-9_-]{8,14})`,"gi"),shareCodeNeedRemoveStr:new RegExp(`${De}/s/`,"gi"),checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"123pan.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://123pan.com/s/{#shareCode#}",copyUrl:`https://123pan.com/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"123盘",key:"_123pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},tt={KEY:"_123pan_User_Authorization",set(a){Z(this.KEY,a);},get(){return U(this.KEY)}},Ot=function(){if(window.location.hostname!=="www.123pan.com"||G.function.linkClickMode(et.setting.key)!=="parseFile")return;let a=ee.localStorage.getItem("authorToken");d.isNull(a)||(a=a.replace(/^\"/,"").replace(/\"$/,""),h.success("获取123网盘已登录用户的authorToken值👇"),h.success(a),tt.set(a));},He={init(){Object.keys(He.netDisk).forEach(a=>{this.netDisk[a]();});},netDisk:{_123pan:Ot,lanzouyx:Lt}},I={protocol:"jumpwsv",pathname:"go",parseDataToSchemeUri(a,n){if(!this.isEnableForward(a))return n;let e=G.schemeUri.uri(a);return d.isNull(e)&&(e=this.getSchemeUri(this.get1DMSchemeUriOption(n))),e.startsWith(this.protocol)&&(n=n.replace(/&/g,"{-and-}"),n=n.replace(/#/g,"{-number-}")),e=V.replaceParam(e,{intentData:n}),e},isEnableForward(a){return G.schemeUri.enable(a)},isForwardDownloadLink(a){return this.isEnableForward(a)&&G.schemeUri.isForwardLinearChain(a)},isForwardBlankLink(a){return this.isEnableForward(a)&&G.schemeUri.isForwardBlankLink(a)},getSchemeUri(a){return `${this.protocol}://${this.pathname}?${d.toSearchParamsStr(a)}`},get1DMSchemeUriOption(a=""){return {package:"idm.internet.download.manager.plus",activity:"idm.internet.download.manager.UrlHandlerDownloader",intentAction:"android.intent.action.VIEW",intentData:a,intentExtra:""}}};class ce{constructor(){O(this,"netDiskIndex",0);O(this,"shareCode","");O(this,"accessCode","");}}class $t extends ce{constructor(){super(...arguments);O(this,"panelList",[]);O(this,"Authorization","");O(this,"code",{5113:"您今日下载流量已超出10GB限制，购买VIP会员即可体验无限流量下载",5103:"分享码错误或者分享地址错误",5104:"分享已过期","-1000":"获取出错","-2000":"请求异常","-3000":"请求意外中止","-4000":"请求超时",104:"文件已失效"});O(this,"Headers",{"user-agent":"123pan/v2.4.0(Android_7.1.2;Xiaomi)",platform:"android","app-version":"61","x-app-version":"2.4.0"});}async init(t,e,i){const s=this;if(h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i,s.panelList=[],s.Authorization=tt.get(),!await s.checkLinkValidity())return;let o=await s.getFiles();if(o)if(o.length===1&&o[0].Type==0){let l=o[0];if(l.Status==104){m.error("文件已失效");return}let c=l.DownloadUrl,u="";if(c===""){let w=await s.getFileDownloadInfo(l.Etag,l.FileId,l.S3KeyFlag,s.shareCode,l.Size);w&&w.code===0?(c=w.data.DownloadURL,I.isForwardDownloadLink("_123pan")&&(c=I.parseDataToSchemeUri("_123pan",c)),u=d.formatByteToSize(l.Size)):w&&w.code===401?(c="javascript:;",u="请登录后下载"):(c="javascript:;",u="获取下载链接失败");}else I.isForwardDownloadLink("_123pan")&&(c=I.parseDataToSchemeUri("_123pan",c)),u=d.formatByteToSize(l.Size);let p=new Date(l.CreateAt).getTime(),f=new Date(l.UpdateAt).getTime();p=d.formatTime(p),f=d.formatTime(f),k.staticView.oneFile({title:"123盘单文件直链",fileName:l.FileName,fileSize:u,downloadUrl:c,fileUploadTime:p,fileLatestTime:f});}else {m.info("正在递归文件");let l=m.loading("正在解析多文件中，请稍后..."),c=s.getFolderInfo(o,0);l.close(),h.info("递归完毕"),k.staticView.moreFile("123盘文件解析",c);}}async checkLinkValidity(){const t=this;m.info("正在校验链接有效性");let e=`https://www.123pan.com/s/${t.shareCode}`,i=await _.get({url:e,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://www.123pan.com"}});if(h.info(i),!i.status)return  false;let r=i.data.responseText.match(/window.g_initialProps[\s]*=[\s]*\{(.+?)\};/s);if(r){h.info(r);let o=d.toJSON(`{${r[r.length-1]}}`);if(h.info(o),o.res.code!==0)return m.error(o.res.message),false;if(o.res.data.HasPwd&&(t.accessCode==null||t.accessCode===""))m.error("密码缺失!"),k.newAccessCodeView("密码缺失","_123pan",t.netDiskIndex,t.shareCode,t.accessCode,c=>{t.init(t.netDiskIndex,t.shareCode,c.accessCode);});else return  true}else m.error("校验链接-获取初始化内容失败");}async getFiles(t=0){const e=this,i={limit:100,next:1,orderBy:"share_id",orderDirection:"desc",shareKey:e.shareCode,SharePwd:e.accessCode,ParentFileId:t,Page:1};let s=`https://www.123pan.com/b/api/share/get?${d.toSearchParamsStr(i)}`,r=await _.get({url:s,headers:{Accept:"*/*",Referer:`https://www.123pan.com/s/${e.shareCode}`,...e.Headers}});if(h.info(r),!r.status)return;let o=r.data,l=d.toJSON(o.responseText);if(l.code===0)return l.data.InfoList;l.code===5103?k.newAccessCodeView(undefined,"_123pan",e.netDiskIndex,e.shareCode,e.accessCode,c=>{e.init(e.netDiskIndex,e.shareCode,c.accessCode);}):e.code[l.code]?m.error(e.code[l.code]):"message"in l?m.error(l.message):m.error("123盘：未知的JSON格式");}async getFilesByRec(t){const e=this;let i=await _.get({url:`https://www.123pan.com/b/api/share/get?limit=100&next=1&orderBy=share_id&orderDirection=desc&shareKey=${e.shareCode}&SharePwd=${e.accessCode}&ParentFileId=${t}&Page=1`,headers:{Accept:"*/*",Referer:`https://www.123pan.com/s/${e.shareCode}`,...e.Headers}});if(!i.status)return;let s=i.data;h.info(s);let r=d.toJSON(s.responseText);if(r.code==0)return r.data.InfoList}getFolderInfo(t,e){const i=this;let s=[],r=[],o=[];return t.forEach(l=>{l.Type?r.push({fileName:l.FileName,fileSize:0,fileType:"",createTime:new Date(l.CreateAt).getTime(),latestTime:new Date(l.UpdateAt).getTime(),isFolder:true,index:e,async clickEvent(){let c=await i.getFilesByRec(l.FileId);return c?i.getFolderInfo(c,e+1):[]}}):o.push({fileName:l.FileName,fileSize:l.Size,fileType:"",createTime:new Date(l.CreateAt).getTime(),latestTime:new Date(l.UpdateAt).getTime(),isFolder:false,index:e,async clickEvent(){if(l.Status==104)m.error("文件已失效");else if(l.DownloadUrl){let c=l.DownloadUrl;return I.isForwardDownloadLink("_123pan")&&(c=I.parseDataToSchemeUri("_123pan",c)),{url:c,autoDownload:true,mode:"aBlank"}}else {let c=await i.getFileDownloadInfo(l.Etag,l.FileId,l.S3KeyFlag,i.shareCode,l.Size);if(c&&c.code===0)return {url:c.data.DownloadURL,autoDownload:true,mode:"aBlank"};c&&c.code===401?m.error("请登录后下载"):m.error((c==null?undefined:c.message)||"获取下载链接失败");}}});}),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),s=s.concat(r),s=s.concat(o),s}async getFileDownloadInfo(t,e,i,s,r){const o=this;let l=o.getFileDownloadAuth(),c={"Content-Type":"application/json;charset=UTF-8",Host:"www.123pan.com",Accept:"*/*",Referer:"https://www.123pan.com/s/"+s,Origin:"https://www.123pan.com",...o.Headers};o.Authorization&&Reflect.set(c,"Authorization","Bearer "+o.Authorization),h.success("获取下载链接加密参数："+l);let u=await _.post(`https://www.123pan.com/a/api/share/download/info?${l[0]}=${l[1]}`,{data:JSON.stringify({Etag:t,FileID:e,S3keyFlag:i,ShareKey:s,Size:r}),responseType:"json",headers:c});if(!u.status)return;let p=u.data,f=d.toJSON(p.responseText);return h.info(f),f.code==0?(f.data.DownloadURL=o.decodeDownloadUrl(f.data.DownloadURL),f):{code:f.code,message:f.message}}getFileDownloadAuth(){function t(s){var r,o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:8;if(arguments.length!==0){typeof s=="object"?r=s:((""+s).length===10&&(s=1e3*parseInt(s)),r=new Date(s));var l=s+6e4*new Date(s).getTimezoneOffset(),c=l+36e5*o;return r=new Date(c),{y:r.getFullYear(),m:r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,d:r.getDate()<10?"0"+r.getDate():r.getDate(),h:r.getHours()<10?"0"+r.getHours():r.getHours(),f:r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes()}}}function e(s){for(var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10,o=function(){for(var f,w=[],C=0;C<256;C++){f=C;for(var b=0;b<8;b++)f=1&f?3988292384^f>>>1:f>>>1;w[C]=f;}return w},l=o(),c=s,u=-1,p=0;p<c.length;p++)u=u>>>8^l[255&(u^c.charCodeAt(p))];return u=(-1^u)>>>0,u.toString(r)}function i(s){var r="web",o=3,l=Math.round((new Date().getTime()+60*new Date().getTimezoneOffset()*1e3+288e5)/1e3).toString(),c="a,d,e,f,g,h,l,m,y,i,j,n,o,p,k,q,r,s,t,u,b,c,v,w,s,z",u=Math.round(1e7*Math.random()),p,f,w,C,b,S,v,D,N;for(var $ in p=c.split(","),f=t(l),w=f.y,C=f.m,b=f.d,S=f.h,v=f.f,D=[w,C,b,S,v].join(""),N=[],D)N.push(p[Number(D[$])]);var z,E;return z=e(N.join("")),E=e("".concat(l,"|").concat(u,"|").concat(s,"|").concat(r,"|").concat(o,"|").concat(z)),[z,"".concat(l,"-").concat(u,"-").concat(E)]}return i("/a/api/share/download/info")}decodeDownloadUrl(t){return t===""?"":t}}class Ft extends ce{constructor(){super(...arguments);O(this,"X_Share_Token_Data",{expire_time:"2000-01-01T00:00:00.000Z",expires_in:7200,share_token:""});O(this,"X_Device_Id",null);O(this,"X_Canary","client=web,app=share,version=v2.3.1");}async init(t,e,i){const s=this;if(h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i,s.X_Device_Id=s.get_X_Device_Id(),h.info("生成X_Device_Id："+s.X_Device_Id),globalThis.location.hostname!=="www.aliyundrive.com"&&globalThis.location.hostname!=="www.alipan.com"){let c=q.getBlankUrl("aliyun",s.netDiskIndex,s.shareCode,s.accessCode),u=m.error(`请在阿里云盘页面解析，<a href="${c}">点我前往</a>`,{html:true,timeout:1e4});x.on(u.$Qmsg.querySelector("a[href]"),"click",undefined,p=>{d.preventEvent(p),oe.openBlankUrl(c,"aliyun",s.netDiskIndex,s.shareCode,s.accessCode);});return}let r=await this.list_by_share(e,"root");if(!r)return;m.info("正在解析链接");let o=m.loading("正在解析多文件中，请稍后..."),l=s.getFolderInfo(r,0);o.close(),h.info("解析完毕"),k.staticView.moreFile("阿里云盘文件解析",l);}getFolderInfo(t,e=0){const i=this;let s=[],r=[],o=[];return t.forEach(l=>{l.type!=="folder"?o.push({fileName:l.name,fileSize:l.size,fileType:l.file_extension,createTime:new Date(l.created_at).getTime(),latestTime:new Date(l.updated_at).getTime(),isFolder:false,index:e,async clickEvent(){let c=await i.get_share_link_download_url(l.share_id,l.file_id);if(!c)return;let u=c;return I.isForwardDownloadLink("aliyun")&&(u=I.parseDataToSchemeUri("aliyun",u)),{autoDownload:true,mode:"aBlank",url:u}}}):r.push({fileName:l.name,fileSize:0,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:true,index:e,async clickEvent(){let c=await i.list_by_share(l.share_id,l.file_id);return c?i.getFolderInfo(c,e+1):[]}});}),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),s=s.concat(r),s=s.concat(o),h.info("getFilesInfoByRec",s),s}async list_by_share(t,e,i="name",s="DESC"){const r=this;let o=await _.post("https://api.aliyundrive.com/adrive/v2/file/list_by_share",{data:JSON.stringify({share_id:t,parent_file_id:e,limit:20,image_thumbnail_process:"image/resize,w_256/format,jpeg",image_url_process:"image/resize,w_1920/format,jpeg/interlace,1",video_thumbnail_process:"video/snapshot,t_1000,f_jpg,ar_auto,w_256",order_by:i,order_direction:s}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":r.X_Canary,"X-Device-Id":r.X_Device_Id,"X-Share-Token":await r.get_X_Share_Token(r.shareCode,r.accessCode),"User-Agent":d.getRandomPCUA()},allowInterceptConfig:false,onerror(){}});if(!o.status){r.handle_request_error(o);return}let l=d.toJSON(o.data.responseText);return h.info("列出文件列表：",l),l.items}async get_share_link_download_url(t,e){const i=this;let s=await _.post("https://api.aliyundrive.com/v2/file/get_share_link_download_url",{data:JSON.stringify({expire_sec:600,file_id:e,share_id:t}),headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer "+i.getAuthorization(),"X-Share-Token":await i.get_X_Share_Token(i.shareCode,i.accessCode),"User-Agent":d.getRandomPCUA()},responseType:"arraybuffer",allowInterceptConfig:false,onerror(){}});if(!s.status){i.handle_request_error(s);return}let r=d.toJSON(s.data.responseText);return h.info("获取文件的下载链接：",r),r.download_url}handle_request_error(t){h.error(t);let e=d.toJSON(t.data.responseText);e.message==""?m.error(t.msg):m.error(e.message);}getAuthorization(){let t=ee.localStorage.getItem("token");if(d.isNotNull(t)&&t!=null){let i=d.toJSON(t).access_token;return h.success("获取阿里云盘的access_token：",i),i}else h.error("获取access_token失败，请先登录账号！"),m.error("获取access_token失败，请先登录账号！");}async get_X_Share_Token(t,e){const i=this;if(new Date<new Date(i.X_Share_Token_Data.expire_time))return i.X_Share_Token_Data.share_token;let s=await _.post("https://api.aliyundrive.com/v2/share_link/get_share_token",{data:JSON.stringify({share_id:t,share_pwd:e}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":i.X_Canary,"X-Device-Id":i.X_Device_Id,"User-Agent":d.getRandomPCUA()},allowInterceptConfig:false,onerror(){}});if(!s.status){i.handle_request_error(s);return}let r=d.toJSON(s.data.responseText);return i.X_Share_Token_Data=r,h.info("获取share_token：",i.X_Share_Token_Data),i.X_Share_Token_Data.share_token}get_X_Device_Id(){for(var t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,e=[],i=0;i<256;++i)e.push((i+256).toString(16).substr(1));function s(){return crypto.getRandomValues(new Uint8Array(16))}var r=function(l){var c=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,u=(e[l[c+0]]+e[l[c+1]]+e[l[c+2]]+e[l[c+3]]+"-"+e[l[c+4]]+e[l[c+5]]+"-"+e[l[c+6]]+e[l[c+7]]+"-"+e[l[c+8]]+e[l[c+9]]+"-"+e[l[c+10]]+e[l[c+11]]+e[l[c+12]]+e[l[c+13]]+e[l[c+14]]+e[l[c+15]]).toLowerCase();if(!function(p){return typeof p=="string"&&t.test(p)}(u))throw TypeError("Stringified UUID is invalid");return u},o=function(l,c,u){var p=(l=l||{}).random||(l.rng||s)();return p[6]=15&p[6]|64,p[8]=63&p[8]|128,r(p)};return o()}}class Et extends ce{init(n,t,e){h.info(n,t,e),this.netDiskIndex=n,this.shareCode=t,this.accessCode=e;let i=U("baidu-baiduwp-php-url"),s=U("baidu-baiduwp-php-post-form"),r=U("baidu-baiduwp-php-copy-url");if(!i){m.error("请先在设置中配置百度网盘-网址");return}if(!s){m.error("请先在设置中配置百度网盘-表单参数");return}s=V.replaceParam(s,{shareCode:t,accessCode:e});let o=document.createElement("form"),l={},c=new URLSearchParams(s);o.action=i,o.method="post",o.style.display="none",o.target="_blank";for(let[u,p]of c){let f=document.createElement("textarea");f.name=u,f.value=p,o.appendChild(f),l[u]=p;}h.info("表单数据",l),document.body.appendChild(o),h.info("访问网址",i),r?(oe.copy("baidu",n,t,e,"1.5秒后跳转至解析站"),setTimeout(()=>{o.submit();},1500)):o.submit();}}const qe=`.netdisk-url-box {\r
	border-bottom: 1px solid #e4e6eb;\r
}\r
.netdisk-url-div {\r
	display: flex;\r
	align-items: center;\r
	width: 100%;\r
	padding: 5px 0px 5px 0px;\r
}\r
.netdisk-icon {\r
	display: contents;\r
}\r
.netdisk-icon .netdisk-icon-img {\r
	cursor: pointer;\r
	width: 28px;\r
	height: 28px;\r
	min-width: 28px;\r
	min-height: 28px;\r
	font-size: 0.8em;\r
	margin: 0px 10px;\r
}\r
.netdisk-url-div .netdisk-icon,\r
.netdisk-url-div .netdisk-status {\r
	flex: 0 0 auto;\r
}\r
.netdisk-url-div .netdisk-url {\r
	flex: 1;\r
}\r
.netdisk-icon .netdisk-icon-img {\r
	border-radius: 10px;\r
	box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%),\r
		0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%),\r
		0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);\r
}\r
.netdisk-status[data-check-failed] {\r
	padding: 5px 5px;\r
}\r
.netdisk-url {\r
	padding: 5px 5px;\r
}\r
.netdisk-url a {\r
	color: #ff4848 !important;\r
	min-height: 28px;\r
	overflow-x: hidden;\r
	overflow-y: auto;\r
	font-size: 0.8em;\r
	border: none;\r
	display: flex;\r
	align-items: center;\r
	width: 100%;\r
	height: 100%;\r
	padding: 0px;\r
	word-break: break-word;\r
	text-align: left;\r
}\r
.netdisk-status {\r
	display: none;\r
}\r
.netdisk-status[data-check-valid] {\r
	display: flex;\r
	align-items: center;\r
	width: 15px;\r
	height: 15px;\r
}\r
\r
.netdisk-status[data-check-valid="failed"] {\r
	color: red;\r
}\r
\r
.netdisk-status[data-check-valid="partial-violation"] {\r
	color: orange;\r
}\r
\r
.netdisk-status[data-check-valid="error"] {\r
	cursor: pointer;\r
}\r
\r
.netdisk-status[data-check-valid="success"] {\r
	color: green;\r
}\r
\r
.netdisk-status[data-check-valid="verify"] {\r
	color: #faad14;\r
}\r
\r
.netdisk-status[data-check-valid="loading"] svg {\r
	animation: rotating 2s linear infinite;\r
}\r
\r
.netdisk-url-box:has(.netdisk-status[data-check-valid="failed"]) {\r
	text-decoration: line-through;\r
}\r
\r
.whitesevPop-whitesevPopSetting :focus-visible {\r
	outline-offset: 0;\r
	outline: 0;\r
}\r
.netdisk-url a[isvisited="true"] {\r
	color: #8b8888 !important;\r
}\r
.netdisk-url a:active {\r
	box-shadow: 0 0 0 1px #616161 inset;\r
}\r
.netdisk-url a:focus-visible {\r
	outline: 0;\r
}\r
.whitesevPop-content p[pop] {\r
	text-indent: 0;\r
}\r
.whitesevPop-button[type="primary"] {\r
	border-color: #2d8cf0;\r
	background-color: #2d8cf0;\r
}\r
`,me=function(a,n){return {KEY:a,default:n,get value(){return U(a,n)},set value(t){Z(a,t);}}},ie={show(){k.Alias.uiLinkAlias==null?(this.createView(),this.initViewEvent()):k.Alias.uiLinkAlias.show();},createView(){const a={view:{"netdisl-small-window-shrink-status":me("netdisl-small-window-shrink-status",false),"netdisk-ui-small-window-position":me("netdisk-ui-small-window-position",null)}};let n="";k.isMatchedNetDiskIconMap.forEach(i=>{A.$match.matchedInfo.get(i).forEach((r,o)=>{let l=A.handleLinkShow(i,r.netDiskIndex,o,r.accessCode,r.matchText);n=n+this.createViewBoxElementInfo(k.src.icon[i],i,r.netDiskIndex,o,r.accessCode,l).html;});});let t=`
            <div class="netdisk-url-box-all">
                ${n}
            </div>`;if(g.features["netdisk-behavior-mode"].value.toLowerCase().includes("smallwindow")){k.Alias.uiLinkAlias=H.alert({title:{text:"网盘",position:"center"},content:{text:t,html:true},btn:{ok:{enable:false},close:{callback(r){g.features["netdisk-behavior-mode"].value.toLowerCase().includes("suspension")?(J.mode.current_suspension_smallwindow_mode.value="suspension",r.hide(),k.suspension.show()):(k.Alias.uiLinkAlias=undefined,r.close());}}},mask:{enable:false},animation:"",beforeAppendToPageCallBack(r,o){let l=r.querySelector(".pops-header-control"),c=r.querySelector(".pops-alert-title"),u=r.querySelector(".pops-alert-content"),p=x.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                    <path fill="currentColor" d="M290.816 774.144h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m462.848-524.288h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m188.416 323.584c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
                                    </path>
                                </svg>
                                </i>
                                `},{type:"launch","data-header":true}),f=x.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                    <path fill="currentColor" d="M618.496 425.984h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m-192.512 172.032h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m516.096-24.576c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
                                    </path>
                                </svg>
                                </i>
                                `},{type:"shrink","data-header":true});x.before(l,p),x.before(l,f),x.on(p,"click",undefined,function(){x.addClass(p,"pops-hide-important"),x.removeClass(f,"pops-hide-important"),x.removeClass(c,"pops-no-border-important"),x.removeClass(u,"pops-hide-important"),a.view["netdisl-small-window-shrink-status"].value=false;},{capture:true}),x.on(f,"click",undefined,function(){x.removeClass(p,"pops-hide-important"),x.addClass(f,"pops-hide-important"),x.addClass(c,"pops-no-border-important"),x.addClass(u,"pops-hide-important"),a.view["netdisl-small-window-shrink-status"].value=true;},{capture:true}),a.view["netdisl-small-window-shrink-status"].value?f.click():p.click();},dragMoveCallBack(r,o,l){a.view["netdisk-ui-small-window-position"].value={left:o,top:l};},class:"whitesevPop",style:`
                    ${qe}

                    .pops {
                        --container-title-height: 35px;
                        --content-max-height: ${g.smallWindow["netdisk-ui-small-window-max-height"].value}px;
                        --netdisk-line-space: 8px;
                        --netdisk-icon-size: 24px;
                    }
                    .pops[type-value="alert"]{
                        transform: none;
                    }
                    .pops {
                        max-height: var(--content-max-height);
                    }
                    .pops[type-value=alert] .pops-alert-content{
                        max-height: calc(var(--content-max-height) - var(--container-title-height) - var(--container-bottom-btn-height));
                    }
                    .pops-header-controls button.pops-header-control[type][data-header]{
                        padding: 0px 5px;
                    }
                    .netdisk-url-div{
                        padding: 0px;
                    }
                    .netdisk-icon .netdisk-icon-img{
                        width: var(--netdisk-icon-size);
                        height: var(--netdisk-icon-size);
                        min-width: var(--netdisk-icon-size);
                        min-height: var(--netdisk-icon-size);
                        margin: 0px var(--netdisk-line-space);
                    }
                    .netdisk-status{
                        margin-right: var(--netdisk-line-space);
                    }
                    .netdisk-url{
                        padding: 2px 0px;
                    }
                    `},k.popsStyle.mainViewSmallWindow);let i=a.view["netdisk-ui-small-window-position"].value,s=k.Alias.uiLinkAlias.popsElement;if(i){let r=x.width(s,true),o=x.height(s,true),l=x.width(window),c=x.height(window);const{transformLeft:u,transformTop:p}=x.getTransform(s);let f=l-r+u,w=c-o+p,C=0+u,b=0+p;i.top>w?i.top=w:i.top<b&&(i.top=b),i.left>f?i.left=f:i.left<C&&(i.left=C),s.style.transitionDuration="0s",s.style.left=i.left+"px",s.style.top=i.top+"px",setTimeout(()=>{s.style.transitionDuration="0s";},300);}}else k.Alias.uiLinkAlias=H.alert({title:{text:"网盘",position:"center"},content:{text:t,html:true},btn:{ok:{enable:false},close:{callback(i){k.Alias.uiLinkAlias=undefined,i.close();}}},mask:{clickCallBack(i){i(),k.Alias.uiLinkAlias=undefined;}},class:"whitesevPop",style:`
                    ${qe}

                    .pops {
                        max-height: 60vh;
                    }
					@media screen and (max-width: 600px) {
						.pops {
                       		max-height: 50vh;
                    	}
					}
                    `},k.popsStyle.mainView);let e=g.smallWindow["netdisk-link-view-z-index"].value;e>0&&x.css(k.Alias.uiLinkAlias.popsElement,{"z-index":e}),k.Alias.uiLinkAlias.popsElement.querySelectorAll(".netdisk-url-box-all .netdisk-url-box").forEach(i=>{let s=i.querySelector(".netdisk-link").getAttribute("data-netdisk"),r=parseInt(i.querySelector(".netdisk-link").getAttribute("data-netdisk-index")),o=i.querySelector(".netdisk-link").getAttribute("data-sharecode"),l=i.querySelector(".netdisk-link").getAttribute("data-accesscode");y.check(i,s,r,o,l);});},initViewEvent(){k.setRightClickMenu(k.Alias.uiLinkAlias.$shadowRoot,".whitesevPop .netdisk-url a"),this.registerIconGotoPagePosition(k.Alias.uiLinkAlias.$shadowRoot),this.setNetDiskUrlClickEvent(k.Alias.uiLinkAlias.$shadowRoot,".netdisk-url a"),k.setGlobalRightClickMenu(k.Alias.uiLinkAlias.$shadowRoot.querySelector(".pops .pops-alert-title > p"));},createElementAttributeRuleInfoJSON(a){return {"data-netdisk":a.netDisk,"data-netdisk-index":a.netDiskIndex,"data-sharecode":a.shareCode,"data-accesscode":a.accessCode}},handleElementAttributeRuleInfo(a,n){let t=this.createElementAttributeRuleInfoJSON(a);for(const e in t){const i=t[e];Array.isArray(n)?n.forEach(s=>{s.setAttribute(e,i.toString());}):n.setAttribute(e,i.toString());}},praseElementAttributeRuleInfo(a){let n={netDiskName:a.getAttribute("data-netdisk"),netDiskIndex:parseInt(a.getAttribute("data-netdisk-index")),shareCode:a.getAttribute("data-sharecode"),accessCode:a.getAttribute("data-accesscode")};return isNaN(n.netDiskIndex)&&(h.warn("元素上的netDiskIndex的值是NaN",a),n.netDiskIndex=0),n},createViewBoxElementInfo(a,n,t,e,i,s){let r=x.createElement("div",{className:"netdisk-url-box",innerHTML:`
			<div class="netdisk-url-div">
                <div class="netdisk-icon">
                    <div class="netdisk-icon-img">
                    </div>
                </div>
                <div class="netdisk-status">

                </div>
                <div class="netdisk-url">
                    <a  class="netdisk-link" href="javascript:;" isvisited="false"></a>
                </div>
            </div>
			`}),o=r.querySelector(".netdisk-url-div"),l=r.querySelector(".netdisk-icon"),c=r.querySelector(".netdisk-icon-img"),u=r.querySelector(".netdisk-status"),p=r.querySelector(".netdisk-url"),f=r.querySelector(".netdisk-link");return c.style.cssText=`background: url(${a}) no-repeat;background-size: 100%;`,x.html(f,s),this.handleElementAttributeRuleInfo({netDisk:n,netDiskIndex:t,shareCode:e,accessCode:i},[c,f]),{$viewBox:r,$urlDiv:o,$icon:l,$iconImg:c,$checkValidStatus:u,$url:p,$link:f,html:r.outerHTML}},setNetDiskUrlClickEvent(a,n){x.on(a,"click",n,t=>{let e=t.target;e.setAttribute("isvisited","true");const i=ie.praseElementAttributeRuleInfo(e);t.ctrlKey?this.netDiskUrlClickEvent({data:i,clickMode:"openBlank",$click:e}):this.netDiskUrlClickEvent({data:i,$click:e});}),x.on(a,"auxclick",n,(t,e)=>{if(t.button!==1)return;d.preventEvent(t),e.setAttribute("isvisited","true");const i=ie.praseElementAttributeRuleInfo(e);let s=q.getBlankUrl(i.netDiskName,i.netDiskIndex,i.shareCode,i.accessCode);oe.openBlankUrl(s,i.netDiskName,i.netDiskIndex,i.shareCode,i.accessCode,true);});},netDiskUrlClickEvent(a){const{netDiskName:n,netDiskIndex:t,shareCode:e,accessCode:i}=a.data;let s=a.clickMode??G.function.linkClickMode(a.data.netDiskName),r=()=>{if(a.$click){let o=a.$click.closest(".pops");if(o){let l=o.querySelector('.pops-header-control[type="close"]');l&&l.click();}}};if(s==="copy"||s==="copy-closePopup")oe.copy(n,t,e,i),s==="copy-closePopup"&&r();else if(s==="openBlank"||s==="openBlank-closePopup"){let o=q.getBlankUrl(n,t,e,i);I.isForwardBlankLink(n)?oe.openBlankWithScheme(n,t,e,i):oe.openBlankUrl(o,n,t,e,i),s==="openBlank-closePopup"&&r();}else s==="parseFile"||s==="parseFile-closePopup"?oe.parseFile(n,t,e,i).then(()=>{s==="parseFile-closePopup"&&r();}):(h.error("未知点击动作："+s),m.error("未知点击动作："+s));},registerContextMenu(a,n,t=[],e="whitesevSuspensionContextMenu"){let i=[];t.forEach(r=>{i.push({icon:"",iconIsLoading:false,text:r.text,callback:r.callback});});let s={target:a,targetSelector:n,data:i,isAnimation:false,className:e,only:true};H.rightClickMenu(s);},addLinkView(a,n,t,e,i){if(k.netDiskHistoryMatch.changeMatchedData(a,n,t,e,i),!k.Alias.uiLinkAlias)return;h.info(a,n,t,e);let s=k.src.icon[a],r=A.handleLinkShow(a,n,t,e,i),o=this.createViewBoxElementInfo(s,a,n,t,e,r),l=k.Alias.uiLinkAlias.popsElement.querySelector(".netdisk-url-box-all");x.append(l,o.$viewBox);let c=l.children[l.children.length-1];y.check(c,a,n,t,e);},changeLinkView(a,n,t,e,i){if(k.netDiskHistoryMatch.changeMatchedData(a,n,t,e,i),!k.Alias.uiLinkAlias)return;let s=A.handleLinkShow(a,n,t,e,i),r=k.Alias.uiLinkAlias.popsElement.querySelector(`.netdisk-url a[data-sharecode='${t}'][data-netdisk-index='${n}']`);h.info("修改网盘链接视图"),h.info(r),r.setAttribute("data-accesscode",e),x.html(r,s);},registerIconGotoPagePosition(a){let n,t,e;x.on(a,"click",".whitesevPop .netdisk-icon .netdisk-icon-img",function(i){let r=i.target.getAttribute("data-sharecode");if(g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].value){if(typeof r!="string"){m.error("获取data-sharecode属性失败");return}if(e==null?e=r:e!==r&&(h.info(`上一个搜索：${e}，切换至：${r}`),n=undefined,t=undefined,e=r),n==null&&(n=d.findElementsWithText(document.documentElement,r),t=n.next()),t!=null&&t.value)if(h.success("定位元素",t),t.value.nodeType===Node.ELEMENT_NODE&&t.value.getClientRects().length){if(t.value.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let o=t.value.innerText||t.value.textContent,l,c,u;if(o.includes(r)){let p=Array.from(t.value.childNodes).filter(f=>f.nodeType===Node.TEXT_NODE);for(const f of p)if(f.textContent.includes(r)){l=f,c=f.textContent.indexOf(r),u=c+r.length;break}}try{d.selectElementText(t.value,l,c,u);}catch(p){h.error(p),d.selectElementText(t.value);}}}else if(t.value.nodeType===Node.TEXT_NODE&&t.value.parentElement.getClientRects().length)if(g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let o=t.value.textContent||t.value.nodeValue,l=t.value,c=o.indexOf(r),u=c+r.length;try{d.selectElementText(t.value,l,c,u);}catch(f){h.error(f),d.selectElementText(t.value.parentElement);}let p=globalThis.getSelection();if(p.rangeCount>0){let w=p.getRangeAt(0).getBoundingClientRect(),C=globalThis.scrollY,b=w.top+C-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:b});}else t.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else try{let o=new Range;o.selectNodeContents(t.value);let l=o.getBoundingClientRect(),c=globalThis.scrollY,u=l.top+c-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:u});}catch(o){h.error(o),t.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else h.error("无法定位该元素位置",t.value),m.error(`无法定位该元素位置，类型：<${(t.value.nodeName||t.value.localName||t.value.tagName).toLowerCase()}>`,{html:false});if(t=n.next(),t.done){if(!g.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].value){m.info("已经定位至最后一个元素了");return}n=undefined,t=undefined;}}});}};class Pt extends ce{init(n,t,e){let i="chengtong";if(n!==3){h.warn("解析站暂时只支持单文件解析，非单文件链接的点击动作为新标签页打开"),ie.netDiskUrlClickEvent({data:{netDiskName:i,netDiskIndex:n,shareCode:t,accessCode:e},clickMode:"openBlank"});return}let s=U("chengtong-parse-file-api-host");if(d.isNull(s)){m.error("请先配置文件解析接口地址");return}s.endsWith("/")||(s+="/");let r=s+"?file="+t;d.isNotNull(e)&&(r+="&pass="+e),window.open(r,"_blank");}}class Ut extends ce{constructor(){super(...arguments);O(this,"errorCode",{UnAuthorized:"请先登录坚果云账号"});}async init(t,e,i){const s=this;h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i;let r=await s.getRequestDownloadParams();if(r)if(r.isdir){let o=m.loading("正在遍历多文件信息..."),l=await s.getFolderInfo(r.hash);if(!l){o.close();return}let c=s.parseMoreFile(l,r.hash,r.name);o.close(),k.staticView.moreFile("坚果云文件解析",c);}else {let o=d.formatByteToSize(r.size),l=await s.getFileLink(r.hash,r.name);if(!l)return;I.isForwardDownloadLink("jianguoyun")&&(l=I.parseDataToSchemeUri("jianguoyun",l)),h.info(l),k.staticView.oneFile({title:"坚果云盘单文件直链",fileName:r.name,fileSize:o,downloadUrl:l});}}parseMoreFile(t,e="",i=""){const s=this;h.info("解析多文件信息",t);let r=[];return t.forEach(o=>{let l=o.relPath;l.startsWith("/")&&(l=l.replace(/^\//,"")),r.push({fileName:l,fileSize:o.size,fileType:"",createTime:o.mtime,latestTime:o.mtime,isFolder:false,index:0,async clickEvent(){m.info("正在获取下载链接...");let c=await s.getDirLink(e,l,o.relPath);if(c)return m.success("获取成功！"),I.isForwardDownloadLink("jianguoyun")&&(c=I.parseDataToSchemeUri("jianguoyun",c)),h.info(c),{autoDownload:true,mode:"aBlank",url:c}}});}),r}async getRequestDownloadParams(){const t=this;h.info("获取hash值"),m.info("正在获取请求信息");let e=/var[\s]*PageInfo[\s]*=[\s]*{([\s\S]+)};/i;new FormData().append("pd",t.accessCode);let s={url:`https://www.jianguoyun.com/p/${t.shareCode}`,data:t.accessCode===""?undefined:`pd=${t.accessCode}`,responseType:"html",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),Referer:`https://www.jianguoyun.com/p/${t.shareCode}`}},r;if(t.accessCode===""?r=await _.get(s):r=await _.post(s),!r.status)return;let o=r.data;h.info("请求信息"),h.info(o);let l=o.responseText.match(e);if(l){let c=l[l.length-1];c=`({${c}})`,c=window.eval(c),h.info(c);let u=c.name,p=c.size,f=c.hash,w=c.needsPassword,C=c.owner,b=c.isdir,S=c.errorCode;if(u=decodeURIComponent(u),h.success("是否是文件夹 ===> "+b),h.success("hash ===> "+f),h.success("name ===> "+u),h.success("size ===> "+p),w&&(t.accessCode==null||t.accessCode==="")){m.error("密码不正确!"),k.newAccessCodeView("密码缺失","jianguoyun",t.netDiskIndex,t.shareCode,t.accessCode,v=>{t.init(t.netDiskIndex,t.shareCode,v.accessCode);});return}if(S==="AuthenticationFailed"){m.error("密码错误"),k.newAccessCodeView(undefined,"jianguoyun",t.netDiskIndex,t.shareCode,t.accessCode,v=>{t.init(t.netDiskIndex,t.shareCode,v.accessCode);});return}if(f===""||f==null){h.error("hash为空，可能文件被撤销分享了"),m.error("文件分享已被撤销");return}if(p==null&&b==false){h.error("无size，可能文件被删除了"),m.error(`“${u}”文件已被拥有者（“${C}”）删除`);return}else return {name:u,hash:f,size:p,needsPassword:w,owner:C,isdir:b}}else o.responseText.match("对不起，找不到您指定的文件。")?(h.error("啊噢！ (404) 对不起，找不到您指定的文件。"),m.error("坚果云: 对不起，找不到您指定的文件。")):o.responseText.match("对不起，您的某些输入不正确。")?(h.error("可能该链接不需要访问码或者访问码有问题"),k.newAccessCodeView(undefined,"jianguoyun",t.netDiskIndex,t.shareCode,t.accessCode,c=>{t.init(t.netDiskIndex,t.shareCode,c.accessCode);})):(h.error("获取PageInfo失败"),m.error("坚果云: 获取PageInfo失败"));}async getFileLink(t="",e=""){var l;const i=this;e=encodeURIComponent(e);let s=await _.get({url:`https://www.jianguoyun.com/d/ajax/fileops/pubFileLink?k=${t}&name=${e}&wm=false${i.accessCode===""?"":"&pd="+i.accessCode}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()},allowInterceptConfig:false,onerror:function(){}});if(!s.status){if(d.isNotNull((l=s.data)==null?undefined:l.responseText)){let c=d.toJSON(s.data.responseText);h.error("坚果云",c),c.errorCode==="UnAuthorized"?i.gotoLogin():m.error(c.detailMsg);}else m.error("请求异常");return}let r=s.data;h.info("请求信息",r);let o=d.toJSON(r.responseText);if(h.info("解析JSON",o),o.hasOwnProperty("errorCode")){m.error("坚果云: "+o.detailMsg);return}else {if(o.hasOwnProperty("url"))return o.url;m.error("坚果云: 处理下载链接异常");}}async getDirLink(t="",e="",i="/"){var c;const s=this;e=encodeURIComponent(e);let r=await _.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRLink?k=${t}&dn=${e}&p=${i}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()},allowInterceptConfig:false,onerror:function(){}});if(!r.status){if(d.isNotNull((c=r.data)==null?undefined:c.responseText)){let u=d.toJSON(r.data.responseText);h.error("坚果云",u),u.errorCode==="UnAuthorized"?s.gotoLogin():m.error(u.detailMsg);}else m.error("请求异常");return}let o=r.data;h.info("请求信息",o);let l=d.toJSON(o.responseText);if(h.info(l),l.hasOwnProperty("errorCode")){m.error("坚果云: "+l.detailMsg);return}else {if(l.hasOwnProperty("url"))return l.url;m.error("坚果云: 处理下载链接异常");}}async getFolderInfo(t=""){let e=await _.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRBrowse?hash=${t}&relPath=%2F&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()}});if(!e.status)return;let i=e.data;h.info("请求信息",i);let s=d.toJSON(i.responseText);if(h.info(s),"objects"in s)return s.objects;m.error("坚果云: 处理多文件信息异常");}gotoLogin(){H.confirm({title:{text:"提示",position:"center"},content:{text:"解析失败，原因：当前尚未登录坚果云，是否前往登录？"},btn:{reverse:true,position:"end",ok:{text:"前往",callback:function(t){window.open("https://www.jianguoyun.com/d/login#from=https%3A%2F%2Fwww.jianguoyun.com%2F","_blank");}}}},k.popsStyle.jianGuoYunLoginTip);}}const ne={DEFAULT_HOST_NAME:"www.lanzout.com",MENU_KEY:"lanzou-host-name",get hostname(){return R(this.MENU_KEY,this.DEFAULT_HOST_NAME).value}};let Ke=a=>(a=a.replace(/\/\/.+/gi,""),a=a.replace(/\/\*[\s\S\n]+\*\//gi,""),a);class zt extends ce{constructor(){super(...arguments);O(this,"router",{root(t=""){return t.startsWith("/")&&(t=t.replace(/^\//,"")),`https://${ne.hostname}/${t}`},root_tp(t=""){return t.startsWith("/")&&(t=t.replace(/^\//,"")),`https://${ne.hostname}/tp/${t}`},root_s(t=""){return t.startsWith("/")&&(t=t.replace(/^\//,"")),`https://${ne.hostname}/s/${t}`}});O(this,"regexp",{unicode:{match:/[%\u4e00-\u9fa5]+/g,tip:"中文链接",isUnicode:false},noFile:{match:/div>来晚啦...文件取消分享了<\/div>/g,tip:"来晚啦...文件取消分享了"},noExists:{match:/div>文件不存在，或已删除<\/div>/g,tip:"文件不存在，或已删除"},needVipToShare:{match:/class="fbox">非会员.+请先开通会员/gi,tip:"该链接为非会员用户分享的文件，目前无法下载"},moreFile:{match:/<span id=\"filemore\" onclick=\"more\(\);\">/g},sign:{match:/var[\s]*(posign|postsign|vidksek|skdklds)[\s]*=[\s]*'(.+?)';/},fileName:{match:/<title>(.*)<\/title>/},fileSize:{match:/<span class=\"mtt\">\((.*)\)<\/span>/},loadDownHost:{match:/var[\s]*(vkjxld)[\s]*=[\s]*'(.+?)'/i},loadDown:{match:/var[\s]*(loaddown|oreferr|spototo|domianload|hyggid)[\s]*=[\s]*'(.+?)'/i},appleDown:{match:/var[\s]*appitem[\s]*=[\s]*'(.+?)'/i},uploadTime:{match:/mt2\"\>时间:<\/span>(.+?)[\s]*<span/i}});}async init(t,e,i){h.info(t,e,i),this.netDiskIndex=t,this.shareCode=e,this.accessCode=i,this.regexp.unicode.isUnicode=!!this.shareCode.match(this.regexp.unicode.match),t===2?await this.getMoreFile(this.router.root_s(this.shareCode)):await this.getFileLink();}async getFileLink(t=false){var o,l,c,u,p,f,w,C,b;const e=this;let i=this.router.root(this.shareCode);h.info("蓝奏云-获取文件下载链接"+i);let s=await _.get({url:i,headers:{Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:i},allowInterceptConfig:false,onerror(){}});if(!s.status){if(h.error(s),s.type==="ontimeout")return;if(d.isNull(s.data.responseText)){m.error("请求异常");return}s.data.responseText.includes("div>文件不存在，或者已被删除</div>")?m.error("文件不存在，或者已被删除"):m.error("未知情况");return}let r=s.data;if(r.readyState!==4){h.error(r),m.error("请求失败，请重试");return}if(r.responseText==null){h.error(r),m.error("获取网页内容为空");return}if(e.checkPageCode(r))if(e.isMoreFile(r))await e.getMoreFile();else {h.info(r);let S=Ke(r.responseText);if(t){let N=S.match(/var[\s]*link[\s]*=[\s]*\'tp\/(.+?)\';/i);e.shareCode=N[N.length-1],h.info(`新参数 => ${e.shareCode}`);}let v=x.parseHTML(S,true,true),D=v.querySelector('iframe[class^="ifr"]')||v.querySelector('iframe[class^="n_downlink"]');if(D){let N=D.getAttribute("src");h.error("该链接需要重新通过iframe地址访问获取信息",N),m.info("正在请求下载信息");let $=((o=v.querySelector("body div.d > div"))==null?undefined:o.innerText)||((l=v.querySelector("#filenajax"))==null?undefined:l.innerText)||((u=(c=v.querySelector("title"))==null?undefined:c.textContent)==null?undefined:u.replace(/ - 蓝奏云$/i,"")),z=S.match(/文件大小：<\/span>(.+?)<br>/i)||((p=v.querySelector("div.n_box div.n_file div.n_filesize"))==null?undefined:p.innerText)||((f=v.querySelector(".d2 table tr td .fileinfo:nth-child(1) .fileinforight"))==null?undefined:f.innerText),E=S.match(/上传时间：<\/span>(.+?)<br>/i)||((w=v.querySelector("#file[class=''] .n_file_info span.n_file_infos"))==null?undefined:w.innerText)||((C=v.querySelector(".d2 table tr td .fileinfo:nth-child(3) .fileinforight"))==null?undefined:C.innerText)||((b=v.querySelector("#file[class='filter'] .n_file_info span.n_file_infos"))==null?undefined:b.innerText);z?(Array.isArray(z)&&(z=z[z.length-1]),typeof z=="string"&&(z=z.replaceAll("大小：",""))):h.error("解析文件大小信息失败"),E?(Array.isArray(E)&&(E=E[E.length-1]),E.toString().toLowerCase().startsWith("android")&&(h.error("解析出的文件上传时间信息是Android/xxxx开头"),E=undefined)):h.error("解析文件上传时间信息失败");let T=await e.getLinkByIframe(N,{fileName:$,fileSize:z,fileUploadTime:E});T&&(I.isForwardDownloadLink("lanzou")&&(T=I.parseDataToSchemeUri("lanzou",T)),k.staticView.oneFile({title:"蓝奏云单文件直链",fileName:$,fileSize:z,downloadUrl:T,fileUploadTime:E}));}else await e.getLink(r);}}checkPageCode(t){const e=this;let i=t.responseText;return i.match(e.regexp.noFile.match)?(m.error(e.regexp.noFile.tip),false):i.match(e.regexp.noExists.match)?(m.error(e.regexp.noExists.tip),false):i.match(e.regexp.needVipToShare.match)?(m.error(e.regexp.needVipToShare.tip),false):true}isMoreFile(t){const e=this;return t.responseText.match(e.regexp.moreFile.match)?(h.info("该链接为多文件"),true):(h.info("该链接为单文件"),false)}async getLink(t){const e=this;let i=t.responseText;if(i==null){h.error("shareCode错误，重新从页面中获取"),await e.getFileLink(true);return}i=Ke(i);let s=i.match(/'sign':'(.+?)',/i)||i.match(e.regexp.sign.match),r="",o="",l=i.match(e.regexp.fileName.match),c=l?l[l.length-1].trim():"",u=i.match(e.regexp.fileSize.match)||i.match(/<div class="n_filesize">大小：(.+?)<\/div>/i),p=u?u[u.length-1].trim():"",f=i.match(e.regexp.uploadTime.match)||i.match(/<span class="n_file_infos">(.+?)<\/span>/i),w=f?f[f.length-1].trim():"",C=i.match(/[\s]+url[\s]+:[\s]+'\/ajaxm.php\?file=([0-9]+)',/i)||i.match(/\/\/url[\s]+:[\s]+'\/ajaxm.php\?file=([0-9]+)',/i),b=C?C[C.length-1]:"1";if(s){o=s[s.length-1],h.info(`获取Sign: ${o}`),d.isNotNull(e.accessCode)?(h.info("传入参数=>有密码"),r=e.accessCode):h.info("传入参数=>无密码");let S=await e.getKNDS(),v=await _.post({url:e.router.root("ajaxm.php?file="+b),responseType:"json",headers:{accept:"application/json, text/javascript, */*","Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomAndroidUA(),Origin:"https://"+ne.hostname,Referer:e.router.root(e.shareCode)},data:`action=downprocess&sign=${o}&p=${r}&kd=${S}`});if(!v.status)return;let D=v.data;if(h.info(D),D.readyState===4){let N=d.toJSON(D.responseText),$=`${N.dom}/file/${N.url}`;typeof N.url=="string"&&(N.url.startsWith("http")||N.url.startsWith(N.dom))&&($=N.url),N.zt,"密码不正确".indexOf(N.inf)!=-1?(m.error("密码不正确!"),k.newAccessCodeView(undefined,"lanzou",e.netDiskIndex,e.shareCode,e.accessCode,z=>{e.init(e.netDiskIndex,e.shareCode,z.accessCode);})):(c=N.inf?N.inf:c,h.info($),I.isForwardDownloadLink("lanzou")&&($=I.parseDataToSchemeUri("lanzou",$)),k.staticView.oneFile({title:"蓝奏云单文件直链",fileName:c,fileSize:p,downloadUrl:$,fileUploadTime:w}));}else m.error("请求失败，请重试");}else {let S=i.match(e.regexp.loadDownHost.match),v=i.match(e.regexp.loadDown.match),D=i.match(e.regexp.appleDown.match),N=D[D.length-1];if(d.isNull(v)&&(v=i.match(/var[\s]*(cppat)[\s]*=[\s]*'(.+?)'/i)),d.isNull(S)&&N&&(N=N[N.length-1],S=[N],v=[""],h.success("多文件-当前链接猜测为苹果的文件",N)),d.isNull(S)){m.error("蓝奏云直链：获取sign的域名失败，请反馈开发者",{timeout:3500});return}if(d.isNull(v)){m.error("蓝奏云直链：获取sign失败，请反馈开发者",{timeout:3500});return}let $=`${S[S.length-1]}${v[v.length-1]}`;h.info(c,p,$),h.info($),I.isForwardDownloadLink("lanzou")&&($=I.parseDataToSchemeUri("lanzou",$)),k.staticView.oneFile({title:"蓝奏云单文件直链",fileName:c,fileSize:p,downloadUrl:$,fileUploadTime:w});}}async getLinkByIframe(t,e){const i=this;h.info(t,e);let s=i.router.root(t),r=await _.get({url:s,headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","User-Agent":d.getRandomPCUA(),Referer:i.router.root(i.shareCode)}});if(!r.status)return;let o=r.data;h.info(o);let l=o.responseText,c=l.match(/'websignkey'[\s]*:[\s]*'(.+?)'/i)||l.match(/var[\s]*aihidcms[\s]*=[\s]*'(.*)';/i),u=l.match(/var[\s]*ciucjdsdc[\s]*=[\s]*'(.*)';/i),p=l.match(/var[\s]*ajaxdata[\s]*=[\s]*'(.+)';/i),f=l.match(/'sign':[\s]*'(.+)',/i)||l.match(/var[\s]*wp_sign[\s]*=[\s]*'(.*)';/i),w=l.match(/[^\/\/]url[\s]*:[\s]*'(.+?)'[\s]*,/i)||l.match(/url[\s]*:[\s]*'(.+?)'[\s]*,/),C="ajaxm.php",b="",S="",v="",D="",N=await this.getKNDS();if(w?C=w[w.length-1]:m.error("提取ajaxm.php的具体参数失败，使用默认的"+C),c)b=c[c.length-1];else {m.error("ajaxm.php请求参数 websignkey 获取失败");return}if(u)S=u[u.length-1];else {m.error("ajaxm.php请求参数 websign 获取失败");return}if(p)v=p[p.length-1];else {m.error("ajaxm.php请求参数 signs 获取失败");return}if(f)D=f[f.length-1];else {m.error("ajaxm.php请求参数 sign 获取失败");return}let $={action:"downprocess",signs:v,sign:D,websign:S,websignkey:b,kd:N,ves:1};h.success("请求的路径参数："+C),h.success(["ajaxm.php的请求参数-> ",$]);let z=await _.post(i.router.root(C),{data:d.toSearchParamsStr($),headers:{Accept:"application/json, text/javascript, */*","Content-Type":"application/x-www-form-urlencoded",Referer:i.router.root(i.shareCode),"User-Agent":d.getRandomPCUA()}});if(!z.status)return;let E=z.data;h.info(E);let T=d.toJSON(E.responseText),K=`${T.dom}/file/${T.url}`;if(T.zt,await _.get("https://down-load.lanrar.com/file/kdns.js",{allowInterceptConfig:false}),(await _.get("https://boce.lanosso.com/file/kdns2.js",{allowInterceptConfig:false})).status?h.info("测试killdns2成功，不改变原downloadUrl"):(K+="&lanosso",h.info("测试killdns2失败使用参数 lanosso")),h.success("直链",K),"密码不正确".indexOf(T.inf)!=-1)m.error("密码不正确!"),k.newAccessCodeView(undefined,"lanzou",i.netDiskIndex,i.shareCode,i.accessCode,ae=>{i.init(i.netDiskIndex,i.shareCode,ae.accessCode);});else return e.fileName=d.isNotNull(T.inf)?T.inf:e.fileName,h.info(K),K}async getKNDS(){let t=await _.get("https://down-load.lanrar.com/file/kdns.js",{allowInterceptConfig:false});return t.status&&d.isNotNull(t.data.responseText)?1:0}async getMoreFile(t){const e=this;t==null&&(t=e.router.root(e.shareCode));let i=await _.get({url:t,headers:{Accept:"*/*","User-Agent":d.getRandomAndroidUA(),Referer:t}});if(!i.status)return;let s=i.data;if(h.info(s),s.readyState!==4){m.error("请求失败，请重试");return}let r=s.responseText,o=r.match(/\'fid\':(.+?),/)[1].replaceAll("'",""),l=r.match(/\'uid\':(.+?),/)[1].replaceAll("'",""),c=1,u=r.match(/\'t\':(.+?),/)[1],p=new RegExp(u+`[\\s]*=[\\s]*('|")(.+?)('|");`),f=r.match(p)[2],w=r.match(/\'k\':(.+?),/)[1],C=new RegExp(w+`[\\s]*=[\\s]*('|")(.+?)('|");`),b=r.match(C)[2],v=`lx=${e.shareCode.match(e.regexp.unicode.match)?1:2}&fid=${o}&uid=${l}&pg=${c}&rep=0&t=${f}&k=${b}&up=1&ls=1&pwd=${e.accessCode}`;h.info(`多文件请求参数：${v}`);let D=await _.post({url:e.router.root("filemoreajax.php"),responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","User-Agent":d.getRandomAndroidUA(),Referer:t},data:v});if(!D.status)return;let N=D.data;h.info(N);let $=d.toJSON(N.responseText),z=$.zt,E=$.info;if(z===4)m.error(E);else if(z===1){let T=m.loading("获取文件夹成功，解析文件直链中..."),K=$.text,te=[];h.info(`本链接一共${K.length}个文件`);for(let ae=0;ae<K.length;ae++){let de=K[ae],Re=de.id,Ze=de.name_all,je=de.size,dt=de.icon,ze=de.time;te.push({fileName:Ze,fileSize:je,fileType:dt,createTime:ze,latestTime:ze,isFolder:false,index:0,async clickEvent(){let Ne=await e.parseMoreFile(Re,Ze,je,ze);if(Ne.success)return {autoDownload:true,mode:"aBlank",url:Ne.downloadUrl};h.error("获取下载信息失败：",Ne),m.error(Ne.msg);}});}T.close(),k.staticView.moreFile("蓝奏云文件解析",te);}else "密码不正确".indexOf(E)!==-1?(m.error("密码不正确!"),k.newAccessCodeView(undefined,"lanzou",e.netDiskIndex,e.shareCode,e.accessCode,T=>{e.init(e.netDiskIndex,e.shareCode,T.accessCode);})):"没有了".indexOf(E)!==-1?m.error("没有文件了"):m.error("未知错误");}async parseMoreFile(t,e,i,s){const r=this;let o=await _.get({url:r.router.root(t),headers:{Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:r.router.root(r.shareCode)}});if(h.info(o),!o.status)return {success:false,fileName:e,fileSize:i,fileUploadTime:s,msg:`解析失败，${o.msg}`,downloadUrl:undefined};let c=o.data.responseText,u=x.parseHTML(c,true,true),p=u.querySelector('iframe[class^="ifr"]')||u.querySelector('iframe[class^="n_downlink"]');if(!p)return {success:false,fileName:e,fileSize:i,fileUploadTime:s,msg:"解析iframe链接失败",downloadUrl:undefined};let f=p.getAttribute("src");h.error("该链接需要重新通过iframe地址访问获取信息",f),m.info("正在请求下载信息");let w=await r.getLinkByIframe(f,{fileName:e,fileSize:i,fileUploadTime:s});return w?(I.isForwardDownloadLink("lanzou")&&(w=I.parseDataToSchemeUri("lanzou",w)),{success:true,fileName:e,fileSize:i,fileUploadTime:s,msg:"success",downloadUrl:w}):{success:false,fileName:e,fileSize:i,fileUploadTime:s,msg:"获取下载链接失败",downloadUrl:undefined}}}const Me={LanZouDiskApp:"lanZouY-disk-app",EncryptList:["Y","y","0","Z","z","N","n","M","I","6","m","W","w","1","X","x","L","l","K","7","k","i","U","u","2","V","v","J","j","8","G","g","F","S","s","3","T","t","H","h","f","E","e","D","Q","q","4","R","r","9","d","a","C","c","B","O","o","5","P","p","b","A"],decodeChar(a){for(let n=0;n<this.EncryptList.length;n++)if(a==this.EncryptList[n])return n;return  -1},idEncrypt(a){let n=1,t=0;if(a!=""&&a.length>4){let e;a=a.substring(3,a.length-1);for(let i=0;i<a.length;i++)e=a.charAt(a.length-i-1),t+=this.decodeChar(e)*n,n*=62;}return t},encrypt(a){const n=ye.enc.Utf8.parse(this.LanZouDiskApp),t=ye.enc.Utf8.parse(a);return ye.AES.encrypt(t,n,{mode:ye.mode.ECB,padding:ye.pad.Pkcs7})},encryptHex(a){return this.encrypt(a,this.LanZouDiskApp).ciphertext.toString().toUpperCase()}};class Vt extends ce{constructor(){super(...arguments);O(this,"$data",{devType:6,devModel:"Chrome",extra:2,type:0,offset:1,limit:60});O(this,"uuid");O(this,"userId");O(this,"shareCodeId");}async init(t,e,i){var o,l,c,u;const s=this;h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i,s.shareCodeId=s.getDecodeShareCodeId(e),s.uuid=s.getEncodeUUID();let r=await this.recommendList(s.$data.devType,s.$data.devModel,s.uuid,s.$data.extra,s.getEncodeTimeStamp(),s.shareCode,s.$data.type,s.$data.offset,s.$data.limit);if(r&&r.list.length){if((l=(o=r.list[0])==null?undefined:o.map)!=null&&l.userId)s.userId=(u=(c=r.list[0])==null?undefined:c.map)==null?undefined:u.userId;else {m.error("解析获取【userId】为空");return}if(r.list[0].folderIds==null){h.success("该链接是 单文件");let p=r.list[0].fileList[0],w=await s.parseFolderInfo(r.list[0].fileList,0)[0].clickEvent();if(w&&!Array.isArray(w)){let C=w.url;I.isForwardDownloadLink("lanzouyx")&&(C=I.parseDataToSchemeUri("lanzouyx",C)),k.staticView.oneFile({title:"蓝奏云优享单文件直链",fileName:p.fileName,fileSize:p.fileSize*1024,downloadUrl:C,fileUploadTime:d.formatToTimeStamp(p.updTime),fileLatestTime:d.formatToTimeStamp(p.updTime)});}}else {h.success("该链接是 多文件"),m.info("正在递归文件");let p=m.loading("正在解析多文件中，请稍后..."),f=s.parseFolderInfo(r.list[0].fileList,0);p.close(),h.info("递归完毕"),k.staticView.moreFile("蓝奏云优享解析",f);}}}parseFolderInfo(t,e){const i=this;let s=[],r=[],o=[];return t.forEach(l=>{l.fileType===2?r.push({fileName:l.folderName,fileSize:0,fileType:"",createTime:new Date(l.updTime).getTime(),latestTime:new Date(l.updTime).getTime(),isFolder:true,index:e,async clickEvent(c,u){let p=i.getEncodeTimeStamp(),f=l.folderId,w=await i.getFolderInfo(i.$data.devType,i.$data.devModel,i.uuid,i.$data.extra,p,i.shareCode,f,i.$data.offset,i.$data.limit);return w&&w.list?i.parseFolderInfo(w.list,e+1):[]}}):o.push({fileName:l.fileName,fileSize:l.fileSize*1024,fileType:"",createTime:new Date(l.updTime).getTime(),latestTime:new Date(l.updTime).getTime(),isFolder:false,index:e,async clickEvent(){let c=l.fileId,u=l.userId||i.userId,p=i.uuid;if(d.isNull(u)){m.error("获取【userId】为空");return}if(d.isNull(p)){m.error("获取【uuid】为空");return}let f=await i.getDownloadFileUrl(...i.getDownloadFileParams(c,u,p));if(f)return I.isForwardDownloadLink("lanzouyx")&&(f=I.parseDataToSchemeUri("lanzouyx",f)),{url:f,autoDownload:true,mode:"aBlank"}}});}),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),s=s.concat(r),s=s.concat(o),s}async recommendList(t=this.$data.devType,e=this.$data.devModel,i="",s=this.$data.extra,r="",o="",l=this.$data.type,c=this.$data.offset,u=this.$data.limit){let p=await _.post(`https://api.ilanzou.com/unproved/recommend/list?${d.toSearchParamsStr({devType:t,devModel:e,uuid:i,extra:s,timestamp:r,shareId:o,code:this.accessCode,type:l,offset:c,limit:u})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()},responseType:"json"});if(!p.status)return;let f=d.toJSON(p.data.responseText);if(h.success("获取链接信息：",f),f.code!==200){m.error("请求链接信息失败");return}if(!f.list.length){m.error("获取链接信息为空");return}return f}async getFolderInfo(t=this.$data.devType,e=this.$data.devModel,i="",s=this.$data.extra,r="",o="",l="",c=this.$data.offset,u=this.$data.limit){let p=await _.post(`https://api.ilanzou.com/unproved/share/list?${d.toSearchParamsStr({devType:t,devModel:e,uuid:i,extra:s,timestamp:r,shareId:o,code:this.accessCode,folderId:l,offset:c,limit:u})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()}});if(!p.status)return;let f=d.toJSON(p.data.responseText);if(h.success("获取文件列表信息：",f),f.code===200)return f;m.error(f.msg);}async getDownloadFileUrl(t="",e=1,i=this.$data.devType,s="",r="",o="",l=this.shareCode){return `https://api.ilanzou.com/unproved/file/redirect?${d.toSearchParamsStr({downloadId:t,enable:e,devType:i,uuid:s,timestamp:r,auth:o,shareId:l})}`}getEncodeUUID(t=21){return ((i=21)=>crypto.getRandomValues(new Uint8Array(i)).reduce((s,r)=>(r&=63,s+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r>62?"-":"_",s),""))(t)}getDecodeShareCodeId(t){return Me.idEncrypt(t)}getEncodeTimeStamp(t=Date.now()){return Me.encryptHex(t)}getDownloadFileParams(t,e="",i){const s=this;let r=Date.now(),o=Me.encryptHex(t+"|"+e),l=1,c=s.getEncodeTimeStamp(r),u=Me.encryptHex(t+"|"+r);return [o,l,s.$data.devType,i,c,u,s.shareCode]}gotoLogin(){H.confirm({title:{position:"center",text:"蓝奏云优享"},content:{text:"必须先在【蓝奏云优享】进行登录，然后登录成功后刷新获取必备的下载参数【uuid】和【userId】。",html:false},btn:{reverse:true,position:"end",ok:{text:"前往",enable:true,callback(){window.open("https://www.ilanzou.com","_blank");}}}},k.popsStyle.tianYiYunLoginTip);}}const at={isSupport_GM_download(){try{return typeof Ge=="function"}catch(a){return console.error(a),false}}};class Bt extends ce{constructor(){super(...arguments);O(this,"panelList",[]);O(this,"panelContent","");O(this,"OK_CODE","0000");}async init(t,e,i){const s=this;h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i,s.panelList=[],s.panelContent="";let r=await s.checkLinkValidity(s.shareCode,s.accessCode);if(r)if(r.isFolder){m.info("正在递归文件");let o=m.loading("正在解析多文件中，请稍后..."),l=await s.getShareFolder(r.data.guid);if(!l){o.close();return}let c=await s.getShareFiles(r.data.guid);if(!c){o.close();return}let u=s.getFolderInfo(r.data.guid,l,c,0);o.close(),h.info("递归完毕"),k.staticView.moreFile("奶牛快传文件解析",u);}else {let o;if(r.zipDownload?o=await s.getZipFileDownloadUrl(s.shareCode,r.guid,r.fileName):o=await s.getDownloadUrl(s.shareCode,r.guid,r.id),!o)return;I.isForwardDownloadLink("nainiu")&&(o=I.parseDataToSchemeUri("nainiu",o)),k.staticView.oneFile({title:"奶牛快传单文件直链",fileName:r.fileName,fileType:r.fileType,fileSize:r.fileSize,downloadUrl:o,fileUploadTime:r.fileUploadTime,fileLatestTime:r.fileLatestTime,clickCallBack:l=>{s.downloadFile(r.fileName,o);}});}}async checkLinkValidity(t,e){const i=this;let s=await i.getShareByUniqueUrl(t);if(!s)return  false;let r=s.code,o=s.message;if(r!==i.OK_CODE)return m.error(o),false;{let l=s.data.needPassword,c=s.data.zipDownload;return l&&d.isNull(e)?(m.error("密码缺失!"),k.newAccessCodeView("密码缺失","nainiu",i.netDiskIndex,i.shareCode,i.accessCode,u=>{i.init(i.netDiskIndex,i.shareCode,u.accessCode);}),false):c?(m.success("该链接为zip单文件"),{zipDownload:c,guid:s.data.guid,fileSize:d.formatByteToSize(s.data.firstFolder.size),fileName:s.data.firstFolder.title,fileUploadTime:d.formatTime(s.data.firstFolder.created_at),fileLatestTime:d.formatTime(s.data.firstFolder.updated_at)}):s.data.firstFile==null?(m.success("该链接为文件夹类型"),{isFolder:true,guid:s.data.guid,firstFolder:s.data.firstFolder,data:s.data}):{zipDownload:c,guid:s.data.guid,id:s.data.firstFile.id,fileSize:d.formatByteToSize(s.data.firstFile.file_info.size),fileName:s.data.firstFile.file_info.title,fileType:s.data.firstFile.file_info.format,fileUploadTime:d.formatTime(s.data.firstFile.created_at),fileLatestTime:d.formatTime(s.data.firstFile.updated_at)}}}getFolderInfo(t,e,i,s=0){const r=this;let o=[],l=[],c=[];return e.forEach(u=>{o.push({fileName:u.title,fileSize:0,fileType:"",createTime:u.created_at,latestTime:u.updated_at,isFolder:true,index:s,async clickEvent(){if(!u.child_folder_count&&!u.content_count)return [];let p=await r.getShareFolder(t,u.id);if(!p)return [];let f=await r.getShareFiles(t,u.id);return f?r.getFolderInfo(t,p,f,s+1):[]}});}),i.forEach(u=>{let p=u.file_info.title,f=u.file_info.format??"";f&&(p=p+"."+f),o.push({fileName:p,fileSize:u.file_info.size,fileType:f,createTime:u.created_at,latestTime:u.updated_at,isFolder:false,index:s,async clickEvent(){let w=await r.getDownloadUrl(r.shareCode,t,u.id);w&&(I.isForwardDownloadLink("nainiu")&&(w=I.parseDataToSchemeUri("nainiu",w)),r.downloadFile(p,w));}});}),l.sort((u,p)=>u.fileName.localeCompare(p.fileName)),c.sort((u,p)=>u.fileName.localeCompare(p.fileName)),o=o.concat(l),o=o.concat(c),h.info("getFolderInfo",o),o}async parseMoreFile(t,e){}async getShareFolder(t,e="",i=0,s=100){const r=this;let o=await _.get(`https://cowtransfer.com/core/api/transfer/share/folders?transferGuid=${t}&folderId=${e}&page=${i}&size=${s}`,{headers:{Accept:"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/"}});if(h.success(o),!o.status)return;let l=d.toJSON(o.data.responseText);if(l.code!==r.OK_CODE){m.error(l.message);return}let c=l.data.folders;if(!Array.isArray(c)){m.error("data.folders不是数组");return}return c}async getShareFiles(t,e="",i=0,s=20,r=false){const o=this;let l=await _.get(`https://cowtransfer.com/core/api/transfer/share/files?transferGuid=${t}&folderId=${e}&page=${i}&size=${s}&subContent=${r}`,{headers:{Accept:"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/"}});if(h.success(l),!l.status)return;let c=d.toJSON(l.data.responseText);if(c.code!==o.OK_CODE){m.error(c.message);return}let u=c.data.files;if(!Array.isArray(u)){m.error("data.files不是数组");return}return u}async getShareByUniqueUrl(t){let e=`https://cowtransfer.com/core/api/transfer/share?uniqueUrl=${t}`,i=await _.get({url:e,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+t}});if(h.info(i),!i.status)return;let s=i.data,r=d.toJSON(s.responseText);return h.info("转换的JSON",r),r}async getDownloadUrl(t,e="",i=""){const s=this;let r=`https://cowtransfer.com/core/api/transfer/share/download?transferGuid=${e}&fileId=${i}`,o=await _.get({url:r,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+t}});if(h.info(o),!o.status)return;let l=o.data,c=d.toJSON(l.responseText);if(h.info("转换的JSON",c),c.code===s.OK_CODE)return c.data.downloadUrl;m.error(`奶牛快传-获取直链：${c.message}`);}async getZipFileDownloadUrl(t,e="",i=""){const s=this;let r=`https://cowtransfer.com/core/api/transfer/share/download?transferGuid=${e}&title=${i}`,o=await _.get({url:r,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+t}});if(h.info(o),!o.status)return;let l=o.data,c=d.toJSON(l.responseText);if(h.info("转换的JSON",c),c.code===s.OK_CODE)return c.data.downloadUrl;m.error(`奶牛快传-获取直链：${c.message}`);}async downloadFile(t,e){if(h.info("下载文件：",t,e),window.location.hostname==="cowtransfer.com"){window.open(e,"_blank");return}if(!at.isSupport_GM_download()){m.error("当前脚本环境不支持API 【GM_download】");return}m.info(`调用【GM_download】下载：${t}`);let i=null,s=false,r=false,o=m.loading("下载中...",{showClose:true,onClose(){!s&&typeof i=="function"&&i();}}),l=Ge({url:e,name:t,headers:{Referer:"https://cowtransfer.com/s/"+this.shareCode},onload(){s=true,o.close(),m.success(`下载 ${t} 已完成`,{consoleLogContent:true});},onprogress(c){if(typeof c=="object"&&"loaded"in c&&"total"in c&&!r){let p=(c.loaded/c.total*100).toFixed(2);o.setText(`下载中...${p}%`),c.loaded===c.total&&(r=true);}},onerror(c){o.close(),h.error("下载失败error👉",c),typeof c=="object"&&c.error?m.error(`下载 ${t} 失败或已取消 原因：${c.error}`,{timeout:6e3,consoleLogContent:true}):m.error(`下载 ${t} 失败或已取消`,{consoleLogContent:true});},ontimeout(){o.close(),m.error(`下载 ${t} 请求超时`,{consoleLogContent:true});}});typeof l=="object"&&l!=null&&"abort"in l&&(i=l.abort);}}class Gt extends ce{constructor(){super(...arguments);O(this,"shareId");O(this,"shareMode",1);O(this,"code",{ShareNotFoundFlatDir:"抱歉，该文件的分享平铺目录未找到",ShareNotFound:"抱歉，您访问的页面地址有误，或者该页面不存在。",ShareAuditNotPass:"抱歉，该内容审核不通过",FileNotFound:"抱歉，文件不存在",ShareExpiredError:"抱歉，您访问的页面地址有误，或者该页面不存在",ShareAuditWaiting:"抱歉，该链接处于审核中",ShareInfoNotFound:"抱歉，您访问的页面地址有误，或者该页面不存在",FileTooLarge:"抱歉，文件太大，不支持下载",InvalidSessionKey:"天翼云PC端Cookie未生成，是否前去登录？<br />&nbsp;&nbsp;&nbsp;&nbsp;(注意,需要当前浏览器的UA切换成PC且在登录后要等待进入个人云空间后生成Cookie，不是手机端浏览的个人云空间，那样生成的Cookie无法使用)"});}async init(t,e,i){const s=this;h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i;let r=await s.getShareInfoByCodeV2(e);if(r){if(h.info("解析的JSON信息",r),r.needAccessCode&&d.isNull(s.accessCode)){m.error("密码不正确!"),k.newAccessCodeView(undefined,"tianyiyun",s.netDiskIndex,s.shareCode,s.accessCode,o=>{s.init(s.netDiskIndex,s.shareCode,o.accessCode);});return}if("shareId"in r)this.shareId=r.shareId;else {let o=await s.getShareId(e,i);o&&(this.shareId=o);}if("shareMode"in r&&(this.shareMode=r.shareMode),this.shareId!=null)if(r.isFolder){m.info("正在递归文件");let o=m.loading("正在解析多文件中，请稍后..."),l=r.fileId,c=await s.listShareDir(e,i,undefined,undefined,l,l,undefined,this.shareId,undefined,undefined,undefined);if(!c){o.close();return}let u=s.getFolderInfo(e,i,c,0);o.close(),h.info("递归完毕"),k.staticView.moreFile("天翼云文件解析",u);return}else {let o=await s.getDownloadUrl(s.shareCode,s.accessCode,r.fileId,this.shareId);o&&(I.isForwardDownloadLink("tianyiyun")&&(o=I.parseDataToSchemeUri("tianyiyun",o)),k.staticView.oneFile({title:"天翼云单文件直链",fileName:r.fileName,fileSize:d.formatByteToSize(r.fileSize),downloadUrl:o,fileUploadTime:r.fileCreateDate,fileLatestTime:r.fileLastOpTime}));}}}async getUserBriefInfo(t){const e=this;let i=await _.get("https://cloud.189.cn/api/portal/v2/getUserBriefInfo.action",{headers:{Accept:"application/json;charset=UTF-8",Referer:"https://cloud.189.cn/web/share?code="+t,"User-Agent":d.getRandomPCUA()},allowInterceptConfig:false,onerror(){}});if(h.info(i),!i.status){let r=d.toJSON(i.data.responseText);r.res_code in e.code?m.error(e.code[r.res_code]):m.error("请求异常");return}let s=d.toJSON(i.data.responseText);if(s.res_code===0)return s}async getShareInfoByCodeV2(t){const e=this;let i=await _.post({url:"https://cloud.189.cn/api/open/share/getShareInfoByCodeV2.action",data:`shareCode=${t}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+t,Origin:"https://cloud.189.cn"},allowInterceptConfig:false,onerror(){}});if(!i.status){let o=d.toJSON(i.data.responseText);h.error("获取下载参数失败的JSON信息",o),o.res_code in e.code?m.error(e.code[o.res_code]):m.error(o.res_message);return}let s=i.data;h.info(s);let r=d.toJSON(s.responseText);if(r.res_code==0)return r;e.code.hasOwnProperty(r.res_code)?m.error(e.code[r.res_code]):m.error("获取FileId失败");}async getShareId(t,e){let i=await _.get({url:`https://cloud.189.cn/api/open/share/checkAccessCode.action?shareCode=${t}&accessCode=${e}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:`https://cloud.189.cn/web/share?code=${t}`},responseType:"json"});if(!i.status)return;let s=i.data;h.info(s);let r=d.toJSON(s.responseText);if(r.res_code===0&&"shareId"in r)return r.shareId;m.error("获取shareId失败"),h.info(r);}getNoCacheValue(){let t="";for(let e=0;e<17;e++)t+=d.getRandomValue(1,9);return "0."+t}async getDownloadUrl(t,e,i,s){const r=this;let o=await _.get({url:`https://cloud.189.cn/api/open/file/getFileDownloadUrl.action?fileId=${i}&dt=1&shareId=${s}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":d.getRandomPCUA(),Referer:`https://cloud.189.cn/web/share?code=${t}`,"Sign-Type":1},responseType:"json",allowInterceptConfig:false,onerror(){}});if(h.info(o),!o.status){let u=d.toJSON(o.data.responseText);u.errorCode==="InvalidSessionKey"?r.gotoLogin(r.code.InvalidSessionKey):u.res_code in r.code?m.error(r.code[u.res_code]):m.error("请求异常");return}let l=o.data,c=d.toJSON(l.responseText);if(h.info(c),c.res_code===0)return c.fileDownloadUrl;c.res_code==="InvalidSessionKey"||c.errorCode==="InvalidSessionKey"?r.gotoLogin(r.code.InvalidSessionKey):r.code.hasOwnProperty(c.res_code)?m.error(r.code[c.res_code]):(m.error("请求失败"),h.error(l));}gotoLogin(t=""){H.confirm({title:{position:"center",text:"天翼云"},content:{text:t,html:false},btn:{reverse:true,position:"end",ok:{text:"前往",enable:true,callback(){window.open("https://cloud.189.cn/api/portal/loginUrl.action?redirectURL=https://cloud.189.cn/web/main","_blank");}}}},k.popsStyle.tianYiYunLoginTip);}async listShareDir(t,e,i=1,s=60,r,o,l=true,c,u=5,p="lastOpTime",f=true){const w=this,C={pageNum:i,pageSize:s,fileId:r,shareDirFileId:o,isFolder:l,shareId:c,shareMode:this.shareMode,iconOption:u,orderBy:p,descending:f,accessCode:e};let b=await _.get(`https://cloud.189.cn/api/open/share/listShareDir.action?${d.toSearchParamsStr(C)}`,{headers:{Accept:"application/json;charset=UTF-8",Referer:`https://cloud.189.cn/web/share?code=${t}`,"Sign-Type":1,"User-Agent":d.getRandomPCUA()},responseType:"json",allowInterceptConfig:false,onerror(){}});if(!b.status){let D=d.toJSON(b.data.responseText);h.error("解析文件夹信息失败",D),D.res_code in w.code?m.error(w.code[D.res_code]):"res_message"in D?m.error(D.res_message):m.error("解析文件夹信息失败");return}let S=b.data;h.info(S);let v=d.toJSON(S.responseText);if(v.res_code==0)return v.fileListAO;w.code.hasOwnProperty(v.res_code)?m.error(w.code[v.res_code]):m.error("获取FileId失败");}getFolderInfo(t,e,i,s=0){const r=this;let o=[],l=[],c=[];return i.folderList.forEach(u=>{o.push({fileName:u.name,fileSize:0,fileType:"",createTime:d.formatToTimeStamp(u.createDate),latestTime:d.formatToTimeStamp(u.lastOpTime),isFolder:true,index:s,async clickEvent(){let p=await r.listShareDir(t,e,1,100,u.id,u.id,undefined,r.shareId,undefined,undefined,undefined);return p?r.getFolderInfo(t,e,p,s+1):[]}});}),i.fileList.forEach(u=>{o.push({fileName:u.name,fileSize:u.size,fileType:"",createTime:d.formatToTimeStamp(u.createDate),latestTime:d.formatToTimeStamp(u.lastOpTime),isFolder:false,index:s,async clickEvent(){let p=await r.getDownloadUrl(t,e,u.id,r.shareId);if(p)return I.isForwardDownloadLink("tianyiyun")&&(p=I.parseDataToSchemeUri("tianyiyun",p)),{autoDownload:true,mode:"aBlank",url:p}}});}),l.sort((u,p)=>u.fileName.localeCompare(p.fileName)),c.sort((u,p)=>u.fileName.localeCompare(p.fileName)),o=o.concat(l),o=o.concat(c),h.info("getFolderInfo",o),o}}class Ht extends ce{async init(n,t,e){const i=this;if(h.info(n,t,e),i.netDiskIndex=n,i.shareCode=t,i.accessCode=e,m.info("检查是否已登录UC网盘"),!await i.isLogin()){i.gotoLogin("检测到尚未登录UC网盘，是否前去登录？<br />&nbsp;&nbsp;&nbsp;&nbsp;(注意,需要当前浏览器的UA切换成PC才有登录选项)");return}let r=await i.getStoken(i.shareCode,i.accessCode);if(!r)return;let o=await i.getDetail(i.shareCode,i.accessCode,r);if(!o){m.error("UC网盘：获取detail失败");return}if(o.length===1&&o[0].dir==false&&o[0].file_type===1){let l=o[0],c=await i.getDownload(i.shareCode,r,l.fid,l.share_fid_token);if(!c)return;if(!c[0].download_url){m.error("获取download_url失败");return}k.staticView.oneFile({title:"UC网盘单文件直链",fileName:c[0].file_name,fileSize:d.formatByteToSize(c[0].size),downloadUrl:c[0].download_url,fileUploadTime:d.formatTime(c[0].created_at),fileLatestTime:d.formatTime(c[0].last_update_at),clickCallBack(){i.downloadFile(c[0].file_name,c[0].download_url);}});}else {m.info("正在递归文件");let l=m.loading("正在解析多文件中，请稍后..."),c=i.getFolderInfo(o,r,0);l.close(),h.info("递归完毕"),k.staticView.moreFile("UC网盘文件解析",c);return}}async isLogin(){let n=await _.get("https://drive.uc.cn/",{headers:{"User-Agent":d.getRandomPCUA()}});if(h.success("判断是否已登录UC网盘",n),!!n.status)return n.data.finalUrl==="https://drive.uc.cn/list"?"已登录":false}downloadFile(n,t){if(h.info("调用【GM_download】下载：",arguments),window.location.hostname==="drive.uc.cn"){window.open(t,"_blank");return}if(!at.isSupport_GM_download()){m.error("当前脚本环境不支持API 【GM_download】");return}m.info(`调用【GM_download】下载：${n}`);let e=null,i=false,s=false,r=m.loading("下载中...",{showClose:true,onClose(){!i&&typeof e=="function"&&e();}}),o=Ge({url:t,name:n,headers:{Referer:"https://drive.uc.cn/"},onload(){i=true,r.close(),m.success(`下载 ${n} 已完成`,{consoleLogContent:true});},onprogress(l){if(typeof l=="object"&&"loaded"in l&&"total"in l&&!s){let u=(l.loaded/l.total*100).toFixed(2);r.setText(`下载中...${u}%`),l.loaded===l.total&&(s=true);}},onerror(l){r.close(),h.error("下载失败error👉",l),typeof l=="object"&&l.error?m.error(`下载 ${n} 失败或已取消 原因：${l.error}`,{timeout:6e3,consoleLogContent:true}):m.error(`下载 ${n} 失败或已取消`,{consoleLogContent:true});},ontimeout(){r.close(),m.error(`下载 ${n} 请求超时`,{consoleLogContent:true});}});typeof o=="object"&&o!=null&&"abort"in o&&(e=o.abort);}gotoLogin(n=""){H.confirm({title:{position:"center",text:"UC网盘"},content:{text:n,html:false},btn:{reverse:true,position:"end",ok:{text:"前往",enable:true,callback(){window.open("https://drive.uc.cn","_blank");}}}},k.popsStyle.tianYiYunLoginTip);}async getStoken(n,t){let e=await _.post("https://pc-api.uc.cn/1/clouddrive/share/sharepage/token?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({share_for_transfer:true,passcode:t,pwd_id:n}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"},allowInterceptConfig:false,onerror(){}});if(!e.status){let s=d.toJSON(e.data.responseText);h.error("获取stoken失败JSON信息",s),"message"in s?m.error(s.message):m.error("请求异常，获取stoken失败");return}let i=d.toJSON(e.data.responseText);if(h.info("获取stoken：",i),i.code!==0){h.error("获取stoken失败",i),m.error("获取stoken失败");return}return i.data.stoken}async getDetail(n,t,e,i=0,s=0,r=1,o=50,l=0,c=0,u=1){let p=await _.get(`https://pc-api.uc.cn/1/clouddrive/transfer_share/detail?pr=UCBrowser&fr=h5&pwd_id=${n}&__t=${new Date().getTime()}&passcode=${t}&stoken=${encodeURIComponent(e)}&pdir_fid=${i}&force=${s}&_page=${r}&_size=${o}&_fetch_banner=${l}&_fetch_share=${c}&_fetch_total=${u}&_sort=${encodeURIComponent("file_type:asc,file_name:asc")}`,{headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!p.status)return;let f=d.toJSON(p.data.responseText);if(h.info("获取detail：",f),f.code!==0){h.error("获取detail失败",f),m.error("获取detail失败");return}let w=f.metadata;return w&&w._total&&w._total>w._size?await this.getDetail(n,t,e,i,s,r,w._total,l,c,u):f.data.list}async getDownload(n,t,e,i){let s=await _.post("https://pc-api.uc.cn/1/clouddrive/file/download?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({fids:[e],pwd_id:n,stoken:t,fids_token:[i]}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!s.status)return;let r=d.toJSON(s.data.responseText);if(h.info("获取download：",r),r.code!==0){h.error("获取download失败",r),m.error("获取download失败");return}if(r.data.length===0){h.error("获取download detail失败",r),m.error("获取download detail失败失败");return}return r.data}getFolderInfo(n,t,e=0){const i=this;let s=[],r=[],o=[];return n.forEach(l=>{l.dir==false&&l.file_type===1?o.push({fileName:l.file_name,fileSize:l.size,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:false,index:e,async clickEvent(){let c="",u=await i.getDownload(i.shareCode,t,l.fid,l.share_fid_token);if(u&&u.length?c=u[0].download_url:c="",l.ban)m.error("文件已被禁止下载");else {let p=c;if(I.isForwardDownloadLink("uc")&&(p=I.parseDataToSchemeUri("uc",p)),p===c)i.downloadFile(l.file_name,c);else return {autoDownload:true,mode:"aBlank",url:c}}}}):r.push({fileName:l.file_name,fileSize:l.size,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:true,index:e,async clickEvent(){if(l.include_items===0)return h.success("里面没有文件"),[];let c=await i.getDetail(i.shareCode,i.accessCode,t,l.fid);return c?i.getFolderInfo(c,t,e+1):[]}});}),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),s=s.concat(r),s=s.concat(o),h.info("getFilesInfoByRec",s),s}}class Wt extends ce{constructor(){super(...arguments);O(this,"token");O(this,"code",{1004:"no token",1008:"您没有权限访问",1013:"糟糕，此任务已过期销毁，下次要记得续期",1066:"对方设置的下载 / 预览次数已用完",1088:"糟糕，您访问的页面不存在"});}async init(t,e,i){const s=this;if(h.info(t,e,i),s.netDiskIndex=t,s.shareCode=e,s.accessCode=i,m.info("正在请求直链中..."),!await this.getWssToken())return;let o=await this.getPid();o&&await this.getFileNList(o.bid,o.pid);}async getWssToken(){const t=this;let e=await _.post("https://www.wenshushu.cn/ap/login/anonymous",{responseType:"json",data:JSON.stringify({dev_info:"{}"}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+t.shareCode}});if(h.success(e),!e.status)return;let i=d.toJSON(e.data.responseText);if(i.code===0)return t.token=i.data.token,i.data.token;i.code in t.code?m.error(t.code[i.code]):m.error("获取wss失败");}async getPid(){const t=this;let e=await _.post({url:"https://www.wenshushu.cn/ap/task/mgrtask",responseType:"json",data:JSON.stringify({tid:t.shareCode,password:"",ufileid:""}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+t.shareCode,"x-token":t.token}});if(h.success(e),!e.status)return;let i=e.data,s=d.toJSON(i.responseText);if(s.code===0)return {bid:s.data.boxid,pid:s.data.ufileid};s.code in t.code?m.error(t.code[s.code]):m.error("获取pid失败");}async getFileNList(t,e){const i=this;let s=await _.post("https://www.wenshushu.cn/ap/ufile/nlist",{responseType:"json",data:JSON.stringify({start:0,sort:{name:"asc"},bid:t,pid:e,options:{uploader:"true"},size:50}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+i.shareCode,"x-token":i.token}});if(h.success(s),!s.status)return;let r=s.data,o=d.toJSON(r.responseText);o.code===0?o.data.fileList[0].type===2?(m.error("该链接为多层级文件嵌套，跳转"),oe.openBlankUrl(q.getBlankUrl("wenshushu",i.netDiskIndex,i.shareCode,i.accessCode),"wenshushu",i.netDiskIndex,i.shareCode,i.accessCode)):await i.getDownloadUrl(o.data.fileList[0]):o.code in i.code?m.error(i.code[o.code]):m.error("获取文件信息失败");}async getDownloadUrl(t){const e=this;let i=t.fname,s=d.formatByteToSize(t.size),r=await _.post("https://www.wenshushu.cn/ap/dl/sign",{responseType:"json",data:JSON.stringify({ufileid:t.fid,consumeCode:0}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+e.shareCode,"x-token":e.token}});if(!r.status)return;h.success(r);let o=r.data,l=d.toJSON(o.responseText);if(l.code==0){let c=l.data.url;c===""?m.error("对方的分享流量不足"):(I.isForwardDownloadLink("wenshushu")&&(c=I.parseDataToSchemeUri("wenshushu",c)),k.staticView.oneFile({title:"文叔叔单文件直链",fileName:i,fileSize:s,downloadUrl:c}));}else l.data in e.code?m.error(e.code[l.data]):m.error("获取下载链接失败");}}const $e={netDisk:{baidu:Et,lanzou:zt,lanzouyx:Vt,tianyiyun:Gt,wenshushu:Wt,_123pan:$t,jianguoyun:Ut,nainiu:Bt,uc:Ht,aliyun:Ft,chengtong:Pt}},q={getBlankUrl(a,n,t,e){let i=A.$rule.matchRule[a][n],s=i.blank;t&&(s=V.replaceParam(s,{shareCode:t})),e&&e!==""?s=V.replaceParam(s,{accessCode:e}):s=ke.replaceText(s,A.$extraRule.noAccessCodeRegExp,"");let r=A.$match.matchedInfo.get(a).get(t);if(i.paramMatch){let o=r.matchText.match(i.paramMatch),l={};for(let c=0;c<o.length;c++)l[`$${c}`]=o[c];s=V.replaceParam(s,l);}return s},getCopyUrlInfo(a,n,t,e){let i=A.$rule.matchRule[a][n],s=i.copyUrl;t&&(s=V.replaceParam(s,{shareCode:t})),e&&e!==""?s=V.replaceParam(s,{accessCode:e}):s=ke.replaceText(s,A.$extraRule.noAccessCodeRegExp,"");let r=A.$match.matchedInfo.get(a).get(t);if(i.paramMatch){let o=r.matchText.match(i.paramMatch),l={};for(let c=0;c<o.length;c++)l[`$${c}`]=o[c];s=V.replaceParam(s,l);}return s}},oe={copy(a,n,t,e,i="已复制"){d.setClip(q.getCopyUrlInfo(a,n,t,e)).then(s=>{s?m.success(i):m.error("执行复制失败");}).catch(()=>{m.error("执行复制失败");});},async parseFile(a,n,t,e){$e.netDisk[a]?await new $e.netDisk[a]().init(n,t,e):(h.error(`${a} 未配置解析函数`),m.error("该链接未配置解析函数"));},openBlankUrl(a,n,t,e,i,s=false){var o;h.success(`新标签页打开${s?"（后台打开）":""}`,arguments),Se.$data.enable&&Se.addValue({url:a,netDiskName:n,netDiskIndex:t,shareCode:e,accessCode:i,time:Date.now()}),I.isForwardBlankLink(n)&&(a=I.parseDataToSchemeUri(n,a)),(o=Za("meta[name='referrer']"))==null||o.setAttribute("content","no-referrer");let r=()=>{if(s)ft(a,{active:false});else {let l=window.open(a,"_blank");l&&l.focus();}};d.isNotNull(i)&&G.linkClickMode_openBlank.openBlankWithCopyAccessCode(n)?d.setClip(i).then(()=>{r();}):r();},openBlankWithScheme(a,n,t,e){h.success("scheme新标签页打开",arguments);let i=q.getBlankUrl(a,n,t,e);i=I.parseDataToSchemeUri(a,i),window.open(i,"_blank");}},Zt={async init(a,n,t){let e=q.getBlankUrl("baidu",a,n,t),i=await _.get(e,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36",Host:"pan.baidu.com",Referer:`https://pan.baidu.com/share/init?surl=${n}&pwd=${t}`,"sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',Origin:"https://pan.baidu.com"},...X}),s=i.data.responseText,r=i.data.finalUrl;return typeof r=="string"&&new URL(r).hostname!=="pan.baidu.com"?{...y.status.verify,msg:`<a href='${r}' target='_blank' style="color: red;">触发百度安全验证</a>`,data:i}:!i.status&&d.isNull(s)?{...y.status.error,data:i}:i.data.finalUrl.includes("404.html")?{...y.status.error,data:i}:s.includes("过期时间：")?{...y.status.success,data:i}:s.includes("输入提取")?{...y.status.needAccessCode,data:i}:s.includes("不存在")||s.includes("已失效")?{...y.status.failed,data:i}:{...y.status.unknown,data:i}}},jt={async init(a,n,t){let e=q.getBlankUrl("lanzou",a,n,t),i=new URL(e),s=await _.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:i.hostname,Origin:i.origin,Referer:e},...X});if(!s.status)return {...y.status.error,data:s};let r=s.data.responseText;return d.isNull(r)?{...y.status.failed,data:r}:r.includes("输入密码")?{...y.status.needAccessCode,data:r}:r.includes("来晚啦")||r.includes("不存在")?{...y.status.failed,data:r}:{...y.status.success,data:r}}},qt={async init(a,n,t){let e=new $e.netDisk.lanzouyx;e.shareCodeId=e.getDecodeShareCodeId(n);let i=e.getEncodeTimeStamp(),s=e.getEncodeUUID(),r=await _.post(`https://api.ilanzou.com/unproved/recommend/list?${d.toSearchParamsStr({devType:e.$data.devType,devModel:e.$data.devModel,uuid:s,extra:e.$data.extra,timestamp:i,code:t,shareId:n,type:e.$data.type,offset:e.$data.offset,limit:e.$data.limit})}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()},responseType:"json",...X});if(!r.status)return {...y.status.error,data:r};let o=d.toJSON(r.data.responseText);return h.success("获取链接信息：",o),o.code!==200?{...y.status.error,data:o}:o.list.length?{...y.status.success,data:o}:{...y.status.failed,data:o}}},Kt={async init(a,n,t){let e=await _.post("https://api.cloud.189.cn/open/share/getShareInfoByCodeV2.action",{data:`shareCode=${n}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+n,Origin:"https://cloud.189.cn"},...X}),i=e.data.responseText;return !e.status&&d.isNull(i)?{...y.status.error,data:e}:i.includes("ShareInfoNotFound")||i.includes("ShareNotFound")||i.includes("FileNotFound")||i.includes("ShareAuditWaiting")||i.includes("ShareExpiredError")||i.includes("ShareAuditNotPass")?{...y.status.failed,data:e}:i.includes("needAccessCode")?{...y.status.needAccessCode,data:e}:{...y.status.success,data:e}}},Jt={async init(a,n,t){var s;let e=await _.post("https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous?share_id="+n,{data:JSON.stringify({share_id:n}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://www.aliyundrive.com/",Origin:"https://www.aliyundrive.com"},...X}),i=d.toJSON(e.data.responseText);return !e.status&&d.isNull(i)?{...y.status.error,data:e}:i.code==="ParamFlowException"||i.code==="NotFound.ShareLink"||i.code==="ShareLink.Cancelled"?{...y.status.failed,data:i}:i.file_count===0||((s=i.file_infos)==null?undefined:s.length)===0?{...y.status.failed,data:i}:{...y.status.success,data:i}}},Yt={async init(a,n,t){let e=await _.post("https://www.wenshushu.cn/ap/task/mgrtask",{data:JSON.stringify({tid:n}),headers:{"Content-Type":"application/json","User-Agent":d.getRandomPCUA(),"x-token":"wss:7pmakczzw6i",Host:"www.wenshushu.cn",Origin:"https://www.wenshushu.cn",Referer:q.getBlankUrl("wenshushu",a,n,t)},responseType:"json",...X});if(!e.status&&d.isNull(e.data.responseText))return {...y.status.error,data:e};let i=d.toJSON(e.data.responseText);return i.code!==0?{...y.status.failed,data:i}:{...y.status.success,data:i}}},Xt={async init(a,n,t){let e=await _.get(`https://cowtransfer.com/core/api/transfer/share?uniqueUrl=${n}`,{headers:{"User-Agent":d.getRandomPCUA(),Host:"cowtransfer.com",Origin:"https://cowtransfer.com",Referer:"https://cowtransfer.com/"},...X});if(!e.status&&d.isNull(e.data.responseText))return {...y.status.error,data:e};let i=d.toJSON(e.data.responseText);return i.code!="0000"?{...y.status.failed,data:i}:i.data.needPassword&&i.data.needPassword?{...y.status.needAccessCode,data:i}:{...y.status.success,data:i}}},Qt={async init(a,n,t){let e=await _.get("https://www.123pan.com/api/share/info?shareKey="+n,{headers:{"User-Agent":d.getRandomPCUA(),Host:"www.123pan.com",Origin:"https://www.123pan.com",Referer:"https://www.123pan.com/"},responseType:"json",...X});if(!e.status&&d.isNull(e.data.responseText))return {...y.status.error,data:e};let i=d.toJSON(e.data.responseText);return e.data.responseText.includes("分享页面不存在")||i.code!==0?{...y.status.failed,data:i}:i.data.HasPwd?{...y.status.needAccessCode,data:i}:{...y.status.success,data:i}}},ea={async init(a,n,t){let e=q.getBlankUrl("weiyun",a,n,t),i=await _.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:"share.weiyun.com",Origin:"https://share.weiyun.com",Referer:e},...X});if(!i.status&&d.isNull(i.data.responseText))return {...y.status.error,data:i};let s=i.data.responseText;return s.includes("已删除")||s.includes("违反相关法规")||s.includes("已过期")||s.includes("已经删除")||s.includes("目录无效")?{...y.status.failed,data:i}:s.includes('"need_pwd":1')||s.includes('"pwd":"')?{...y.status.needAccessCode,data:i}:{...y.status.success,data:i}}},ta={async init(a,n,t){let e=await _.post("https://xluser-ssl.xunlei.com/v1/shield/captcha/init",{data:JSON.stringify({client_id:"Xqp0kJBXWhwaTpB6",device_id:"925b7631473a13716b791d7f28289cad",action:"get:/drive/v1/share",meta:{package_name:"pan.xunlei.com",client_version:"1.45.0",captcha_sign:"1.fe2108ad808a74c9ac0243309242726c",timestamp:"1645241033384"}}),headers:{"User-Agent":d.getRandomPCUA(),Host:"pan.xunlei.com",Referer:q.getBlankUrl("xunlei",a,n,t),Origin:"https://pan.xunlei.com"},...X});if(!e.status&&d.isNull(e.data.responseText))return {...y.status.error,data:e};let s=d.toJSON(e.data.responseText).captcha_token,r=await _.get("https://api-pan.xunlei.com/drive/v1/share?share_id="+n,{headers:{"User-Agent":d.getRandomPCUA(),Host:"pan.xunlei.com",Referer:q.getBlankUrl("xunlei",a,n,t),Origin:"https://pan.xunlei.com","x-captcha-token":s,"x-client-id":"Xqp0kJBXWhwaTpB6","x-device-id":"925b7631473a13716b791d7f28289cad"},...X});if(!r.status&&d.isNull(r.data.responseText))return {...y.status.error,data:[e,r]};let o=r.data.responseText;return o.includes("NOT_FOUND")||o.includes("SENSITIVE_RESOURCE")||o.includes("EXPIRED")||o.includes("DELETED")?{...y.status.failed,data:r}:o.includes("PASS_CODE_EMPTY")?{...y.status.needAccessCode,data:r}:{...y.status.success,data:r}}},aa={async init(a,n,t){let e=q.getBlankUrl("chengtong",a,n,t);const s=new URL(e).pathname.split("/")[1].trim();let r="";if(s==="f"||s==="file")r=`https://webapi.ctfile.com/getfile.php?path=${s}&f=${n}&passcode=${t}&token=0&r=${Math.random()}&ref=`;else if(s==="d"||s==="dir")r=`https://webapi.ctfile.com/getdir.php?path=${s}&d=${n}&folder_id=&passcode=${t}&token=0&r=${Math.random()}&ref=`;else return h.warn("未知path",[a,n,t]),{...y.status.unknown,data:null};let o=await _.get(r,{headers:{Host:"webapi.ctfile.com",Origin:"https://url95.ctfile.com",Referer:e,Accept:"application/json, text/javascript, */*; q=0.01","User-Agent":d.getRandomPCUA()},...X}),l=o.data.responseText;if(!o.status&&d.isNull(l))return {...y.status.error,data:o};let c=d.toJSON(l);return c.code===200?{...y.status.success,data:c}:c.code===401?{...y.status.needAccessCode,data:c}:c.code===404||c.code===503||c.code===504?{...y.status.failed,data:c}:{...y.status.unknown,data:c}}},na={async init(a,n,t){let e=await _.post("https://drive.quark.cn/1/clouddrive/share/sharepage/token?pr=ucpro&fr=pc",{data:JSON.stringify({pwd_id:n,passcode:""}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://pan.quark.cn",Referer:q.getBlankUrl("kuake",a,n,t)},...X});if(!e.status&&d.isNull(e.data.responseText))return {...y.status.error,data:e};let i=d.toJSON(e.data.responseText);if(i.message.includes("需要提取码"))return {...y.status.needAccessCode,data:i};if(i.message.includes("ok")){let s=i.data.stoken,r={pwd_id:n,stoken:s,_fetch_share:1,__t:Date.now()},o=await _.get(`https://drive-h.quark.cn/1/clouddrive/share/sharepage/detail?${d.toSearchParamsStr(r)}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://pan.quark.cn",Referer:"https://pan.quark.cn/","User-Agent":d.getRandomPCUA()},...X});if(!o.status||d.isNull(o.data.responseText))return {...y.status.error,data:o};let l=d.toJSON(o.data.responseText);return l.data.share.status==1?l.data.share.partial_violation?{...y.status.partialViolation,data:[i,l]}:{...y.status.success,data:[i,l]}:{...y.status.failed,data:[i,l]}}else return {...y.status.failed,data:i}}},ia={async init(a,n,t){let e=q.getBlankUrl("jianguoyun",a,n,t),i=await _.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:"www.jianguoyun.com",Referer:q.getBlankUrl("jianguoyun",a,n,t),Origin:"https://www.jianguoyun.com"},...X}),s=i.data.responseText;return !i.status&&d.isNull(s)?{...y.status.error,data:i}:s.includes("<h1>啊噢！")?{...y.status.failed,data:i}:{...y.status.success,data:i}}},sa={async init(a,n,t){var o,l,c;let e=q.getBlankUrl("onedrive",a,n,t),i=new URL(e),s=await _.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:i.hostname,Referer:e,Origin:i.origin},...X});if(!s.status){let u=(l=(o=s.data)==null?undefined:o.status)==null?undefined:l.toString();return u==="429"?{...y.status.error,data:s}:u==="404"?{...y.status.failed,data:s}:{...y.status.error,data:s}}let r=s.data.responseText;if(d.isNotNull(r))try{let p=(c=x.parseHTML(r,!0,!0).querySelector("title"))==null?void 0:c.innerHTML;if(p!=null&&p.includes("错误"))return {...y.status.failed,data:s}}catch{}return {...y.status.success,data:s}}},ra={async init(a,n,t){let e=await _.get("https://drive.uc.cn/s/"+n,{headers:{"User-Agent":d.getRandomAndroidUA(),Host:"drive.uc.cn",Referer:q.getBlankUrl("uc",a,n,t),Origin:"https://drive.uc.cn"},...X}),i=e.data.responseText;if(!e.status&&d.isNull(i))return {...y.status.error,data:e};let s=x.parseHTML(i,true,true);if(s.querySelector(".h5-page-main")){let r=s.querySelector(".h5-page-main"),o=r.textContent||r.innerText;return o.includes("失效")||o.includes("不存在")||o.includes("违规")||o.includes("删除")?{...y.status.failed,data:e}:{...y.status.unknown,data:e}}else return s.querySelector(".main-body .input-wrap input")?{...y.status.needAccessCode,data:e}:{...y.status.success,data:e}}},oa={async init(a,n,t){let e=await _.get(`https://webapi.115.com/share/snap?share_code=${n}&offset=0&limit=20&receive_code=&cid=`,{headers:{Accept:"application/json, text/javascript, */*;","User-Agent":d.getRandomPCUA(),Host:"webapi.115.com",Referer:"https://115.com/",Origin:"https://115.com"},...X});if(!e.status)return d.isNull(e.data.responseText)?{...y.status.failed,data:e}:{...y.status.error,data:e};let i=d.toJSON(e.data.responseText);if(i.state)return {...y.status.success,data:i};if(typeof i.error=="string"){if(i.error.includes("访问码"))return {...y.status.needAccessCode,data:i};if(i.error.includes("链接")||i.error.includes("分享已取消"))return {...y.status.failed,data:i}}return {...y.status.unknown,data:i}}},la={loading:{code:1,msg:"验证中...",setIcon(a){x.html(a,j.config.iconSVG.loading);},setView(a,n,t){y.setViewCheckValid(a,"loading",t??this.msg),this.setIcon(a);}},success:{code:200,msg:"有效",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M874.119618 149.859922A510.816461 510.816461 0 0 0 511.997 0.00208a509.910462 509.910462 0 0 0-362.119618 149.857842c-199.817789 199.679789-199.817789 524.581447 0 724.260236a509.969462 509.969462 0 0 0 362.119618 149.857842A508.872463 508.872463 0 0 0 874.119618 874.120158c199.836789-199.679789 199.836789-524.581447 0-724.260236zM814.94268 378.210681L470.999043 744.132295a15.359984 15.359984 0 0 1-5.887994 4.095996c-1.751998 1.180999-2.913997 2.362998-5.276994 2.913997a34.499964 34.499964 0 0 1-13.469986 2.914997 45.547952 45.547952 0 0 1-12.897986-2.303998l-4.095996-2.363997a45.291952 45.291952 0 0 1-7.009992-4.095996l-196.902793-193.789796a34.126964 34.126964 0 0 1-10.555989-25.186973c0-9.37399 3.583996-18.74698 9.98399-25.186974a36.429962 36.429962 0 0 1 50.372947 0l169.98382 167.423824L763.389735 330.220732a37.059961 37.059961 0 0 1 50.371947-1.732998 33.647965 33.647965 0 0 1 11.165988 25.186973 35.544963 35.544963 0 0 1-9.98399 24.575974v-0.04z m0 0"></path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"success",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}},error:{code:-404,msg:"网络异常",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M511.808 692.224c-18.048 0-35.136 3.968-50.432 11.392-25.472 12.416-46.528 33.92-57.792 60.032-5.632 14.144-9.024 29.504-9.024 45.952 0 65.152 52.672 117.824 117.248 117.824 65.28 0 117.952-52.672 117.952-117.824 0-64.64-52.672-117.376-117.952-117.376z m0 178.496c-33.408 0-60.608-27.712-60.608-61.12 0-33.472 27.2-60.672 60.608-60.672s61.248 27.2 61.248 60.672c0 33.472-27.776 61.12-61.248 61.12zM286.784 661.632c3.968 3.392 8.512 5.632 12.992 5.632L438.08 523.328c-60.032 14.72-114.432 49.344-155.328 98.624-9.536 11.84-7.872 30.08 4.032 39.68zM622.912 534.656l-43.008 45.312c45.312 13.056 86.72 40.256 117.376 78.208 5.632 6.784 13.568 10.24 22.08 10.24 6.272 0 12.416-2.24 18.176-6.784 11.904-9.6 13.568-27.84 3.392-39.68-31.808-39.104-72.704-69.12-118.016-87.296zM511.808 391.168c17.024 0 33.408 1.216 49.856 3.456l47.68-49.856c-31.744-6.848-64.064-10.24-97.536-10.24-142.784 0-277.12 63.488-367.232 174.656-10.24 11.904-8.576 30.08 3.904 39.68 5.12 4.48 11.328 6.784 18.176 6.784 7.936 0 15.872-3.968 21.568-10.816 79.872-97.536 197.76-153.664 323.584-153.664zM751.616 400.32l-40.256 41.92c47.04 24.96 89.536 60.032 124.096 102.592 10.24 12.48 27.84 14.208 40.256 3.968 11.968-9.6 13.632-27.84 3.968-39.68-36.16-44.8-79.872-81.088-128.064-108.8zM705.152 244.928l42.56-44.672c-73.664-28.992-153.6-44.224-235.904-44.224-196.672 0-380.864 87.872-505.6 239.744-9.6 12.48-7.872 30.08 3.968 40.256 5.632 3.968 11.904 6.208 18.112 6.208 7.936 0 16.448-3.392 22.144-10.176C163.84 292.608 332.096 212.672 511.808 212.672c66.944 0 132.16 10.752 193.344 32.256zM1017.472 395.776c-40.192-49.92-87.296-92.416-139.456-126.976l-39.68 41.344C889.408 343.04 935.36 383.808 973.888 432c9.6 11.904 27.776 13.568 39.68 3.968 11.84-10.176 14.144-27.712 3.904-40.192zM937.408 104.512c-11.328-10.944-29.312-10.496-40.064 0.832L179.008 854.72c-10.816 11.328-10.496 29.248 0.896 40.064 5.44 5.312 12.48 7.872 19.584 7.872 7.488 0 14.848-2.88 20.416-8.704L938.24 144.576c10.88-11.328 10.496-29.248-0.832-40.064z"></path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"error",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}},verify:{code:-405,msg:"触发安全验证",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
					<path 
						fill="currentColor"
						d="M514.389 1005.60899999c-269.967 0-489.59499999-219.642-489.595-489.59499999S244.42199999 26.405 514.389 26.405 1003.984 246.047 1003.984 516s-219.62800001 489.60899999-489.595 489.60900001z m0-938.24399999C267.00400001 67.365 65.754 268.615 65.754 516s201.264 448.63499999 448.635 448.635S963.024 763.385 963.024 516 761.774 67.365 514.389 67.365z" p-id="9895"></path><path d="M245.993 621.56800001c41.014-8.138 86.112-18.03600001 135.264-29.71000001-0.355 14.145-0.177 26.69199999 0.532 37.65499999-40.318 8.493-82.93 18.92400001-127.836 31.29400001l-7.959-39.23900001z m78.506-261.50200001l-12.206 145.872h53.57500001l13.78999998-178.763H259.249v-36.073h160.727l-16.438 214.821h33.423c-2.471 74.61499999-4.779 135.973-6.895 184.06100002-1.065 53.754-24.399 80.623-70.01399999 80.62299998-19.101 0-41.547-0.53200001-67.36500001-1.598-1.775-13.079-4.06799999-27.047-6.895-41.902 25.46300001 3.181 48.087 4.779 67.898 4.779 24.753 0 37.834-15.033 39.253-45.084 2.11599999-38.898 3.891-87.163 5.31099998-144.807H270.951l16.971-181.945h36.577z m309.248-98.659l-10.076 16.971c42.789 76.03500001 95.833 131.373 159.13 166.025-11.318 14.145-20.685 26.528-28.112 37.13699999-62.231-45.971-112.981-101.30799999-152.235-166.02499998-36.073 64.006-86.466 121.474-151.17000001 172.38699999-6.363-9.18799999-15.21-20.33-26.52799998-33.423 70.369-48.797 124.30000001-113.158 161.77799999-193.086h47.213zM441.194 718.111h191.488c25.46300001-62.942 48.087-128.723 67.89800001-197.318l40.31799999 12.725c-20.862 63.297-42.96699999 124.832-66.301 184.593h93.361v36.60499999H441.19300001v-36.60499999z m27.047-169.73900001l37.137-11.67399999c17.32599998 50.217 31.82600002 94.945 43.5 134.198l-39.253 13.258c-11.674-45.261-25.46300001-90.522-41.383-135.78200001z m27.06099999-91.76399999h218.53500001v36.605H495.30200001v-36.605z m64.17100001 67.885l37.655-10.076c14.854 53.043 27.047 99.369 36.605 138.977l-38.72099999 11.141c-10.254-48.797-22.091-95.477-35.53900001-140.04300001z">
					</path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"verify",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}},failed:{code:0,msg:"已失效",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
						fill="currentColor"
						d="M549.044706 512l166.189176-166.249412a26.383059 26.383059 0 0 0 0-36.98447 26.383059 26.383059 0 0 0-37.044706 0L512 475.015529l-166.249412-166.249411a26.383059 26.383059 0 0 0-36.98447 0 26.383059 26.383059 0 0 0 0 37.044706L475.015529 512l-166.249411 166.249412a26.383059 26.383059 0 0 0 0 36.98447 26.383059 26.383059 0 0 0 37.044706 0L512 548.984471l166.249412 166.249411a26.383059 26.383059 0 0 0 36.98447 0 26.383059 26.383059 0 0 0 0-37.044706L548.984471 512zM512 1024a512 512 0 1 1 0-1024 512 512 0 0 1 0 1024z"></path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"failed",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}},needAccessCode:{code:201,msg:"需要提取码",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M757.810429 373.751333 325.645708 373.751333l0-83.895759c0-103.694687 81.507362-184.922686 185.559183-184.922686 78.121242 0 146.053424 46.74565 173.062568 119.090329 3.865028 10.352789 15.384385 15.609513 25.742291 11.746532 10.351766-3.866051 15.609513-15.390525 11.744485-25.742291C688.844707 121.877815 606.198405 64.918545 511.204891 64.918545c-61.918211 0-119.246895 23.662933-161.423483 66.63156-41.3692 42.142819-64.151066 98.363262-64.151066 158.305469l0 83.895759-20.007683 0c-60.774155 0-110.042255 49.267077-110.042255 110.042255l0 366.139981c0 60.774155 49.267077 110.042255 110.042255 110.042255l492.187769 0c60.775178 0 110.042255-49.267077 110.042255-110.042255L867.852684 483.793588C867.852684 423.01841 818.585607 373.751333 757.810429 373.751333zM827.837318 849.933569c0 38.674834-31.352055 70.02689-70.02689 70.02689L265.62266 919.960459c-38.674834 0-70.02689-31.352055-70.02689-70.02689L195.59577 483.793588c0-38.674834 31.352055-70.02689 70.02689-70.02689l492.187769 0c38.674834 0 70.02689 31.352055 70.02689 70.02689L827.837318 849.933569z"></path>
					<path
					fill="currentColor"
					d="M509.715981 583.832002c-11.048637 0-20.007683 8.959046-20.007683 20.007683l0 110.042255c0 11.048637 8.958022 20.007683 20.007683 20.007683s20.007683-8.958022 20.007683-20.007683L529.723663 603.839685C529.723663 592.790024 520.765641 583.832002 509.715981 583.832002z"></path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"needAccessCode",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}},partialViolation:{code:202,msg:"存在部分违规文件",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
					<path 
					fill="currentColor"
					d="M954.963 810.267L543.112 96.919c-14.07-24.37-49.245-24.37-63.315 0L67.945 810.267c-14.07 24.37 3.518 54.832 31.657 54.832h823.703c28.141 0 45.728-30.463 31.658-54.832zM476.699 306.55c0-19.115 15.64-34.755 34.755-34.755 19.115 0 34.755 15.64 34.755 34.755v281.817c0 19.115-15.64 34.755-34.755 34.755-19.115 0-34.755-15.64-34.755-34.755V306.55z m34.755 445.293c-23.198 0-42.004-18.806-42.004-42.004s18.806-42.004 42.004-42.004c23.198 0 42.004 18.806 42.004 42.004s-18.806 42.004-42.004 42.004z"></path>
				</svg>`);},setView(a,n,t){y.setViewCheckValid(a,"partial-violation",t??this.msg),this.setIcon(a);}},unknown:{code:-200,msg:"未知检查情况",setIcon(a){x.html(a,`
				<svg viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg">
					<path
					fill="currentColor"
					d="M512.473172 1023.995242A511.814852 511.814852 0 0 1 313.545134 40.351073a512.244696 512.244696 0 0 1 398.855715 943.658633 508.815937 508.815937 0 0 1-199.927677 39.985536z m0-943.658634C274.559237 80.336608 80.629391 274.266455 80.629391 512.18039s193.929846 431.843781 431.843781 431.843781 431.843781-193.929846 431.843781-431.843781S751.386745 80.336608 512.473172 80.336608z"></path>
					<path
					fill="currentColor"
					d="M506.475342 716.10662a39.985535 39.985535 0 0 1-39.985536-39.985535v-76.972156c0-79.971071 64.976495-144.947566 144.947566-144.947565a77.971794 77.971794 0 0 0 0-155.943588H445.4974a56.979388 56.979388 0 0 0-56.979387 56.979388 39.985535 39.985535 0 0 1-79.971071 0c0-74.972879 60.977941-136.950458 136.950458-136.950459h164.940333c86.968539 0 157.942864 70.974325 157.942865 157.942865s-69.974687 157.942864-157.942865 157.942864a64.976495 64.976495 0 0 0-64.976494 64.976495v76.972156a39.985535 39.985535 0 0 1-38.985897 39.985535zM505.475703 742.097218a48.982281 48.982281 0 1 0 48.982281 48.982281 48.982281 48.982281 0 0 0-48.982281-48.982281z"></path>
				</svg>
				`);},setView(a,n,t){y.setViewCheckValid(a,"unknown",t??this.msg),this.setIcon(a),y.setViewAgainCheckClickEvent(a,n);}}},ca={baidu:Zt,lanzou:jt,lanzouyx:qt,tianyiyun:Kt,aliyun:Jt,wenshushu:Yt,nainiu:Xt,_123pan:Qt,weiyun:ea,xunlei:ta,_115pan:oa,chengtong:aa,kuake:na,jianguoyun:ia,onedrive:sa,uc:ra},X={allowInterceptConfig:false,onerror(){},ontimeout(){}},y={$data:{isConsuming:false,subscribe:[]},status:la,netDisk:ca,async check(a,n,t,e,i){if(this.$data.subscribe.push({netDiskViewBox:a,netDiskName:n,netDiskIndex:t,shareCode:e,accessCode:i}),!this.$data.isConsuming){this.$data.isConsuming=true;for(let s=0;s<this.$data.subscribe.length;s++){const r=this.$data.subscribe[s];await this.checkLinkValidity(r,true),await d.sleep(250),this.$data.subscribe.splice(s,1),s--;}this.$data.isConsuming=false;}},async checkLinkValidity(a,n){let t=a.netDiskViewBox.querySelector(".netdisk-status");if(this.isViewCheckValid(t)&&!n)return;this.setCheckStatusElementToolTip(a);let e=a.netDiskName;if(!G.function.checkLinkValidity(e)){h.error("未开启checkLinkValidity功能",a);return}let i=this.netDisk[a.netDiskName];if(!i||i&&typeof i.init!="function"){h.error("没有配置该网盘的校验有效性",a);return}this.status.loading.setView(t,a);let s=await i.init(a.netDiskIndex,a.shareCode,a.accessCode);if(!s){h.error("该验证函数的返回值不是有效值",[s,a]);return}s.setView(t,a,s.tipMsg),s.data&&Reflect.set(t,"data-httpx-response",s.data);},setViewAgainCheckClickEvent(a,n){x.on(a,"click",undefined,()=>{const t=a.closest(".netdisk-url-div"),e=t.querySelector(".netdisk-link"),i=ie.praseElementAttributeRuleInfo(e);let s={netDiskViewBox:t,netDiskName:i.netDiskName,netDiskIndex:i.netDiskIndex,shareCode:i.shareCode,accessCode:i.accessCode};this.checkLinkValidity(s,true);},{once:true});},isViewCheckValid(a){return !(!a.hasAttribute("data-check-valid")||a.getAttribute("data-check-valid")==="error")},setViewCheckValid(a,n,t){a.setAttribute("data-check-valid",n),a.setAttribute("data-msg",t),Reflect.set(a,"data-msg",t);},removeViewCheckValid(a){a.removeAttribute("data-check-valid"),a.removeAttribute("data-msg"),Reflect.deleteProperty(a,"data-msg");},isStatusSuccess(a){return Math.floor(a.code/100)===2},getStatusName(a){for(const n of Object.keys(y.status)){let t=this.status[n];if(a.code===t.code)return n}},setCheckStatusElementToolTip(a){if(!G.function.checkLinlValidityHoverTip(a.netDiskName))return;function n(){return a.netDiskViewBox.querySelector(".netdisk-status")}let t=n();if(t.hasAttribute("data-pops-tooltip"))return;t.setAttribute("data-pops-tooltip","true");let e=i=>{let s=Reflect.get(i,"data-msg"),r=i.getAttribute("data-msg");return s??r};j.tooltip({target:t,className:"github-tooltip",isFixed:true,content(){return e(t)},showBeforeCallBack(){let i=e(t);if(i==null||typeof i=="string"&&i.trim()==="")return  false},zIndex(){let i=d.getMaxZIndex(10),s=j.config.InstanceUtils.getPopsMaxZIndex(10).zIndex;return d.getMaxValue(i,s)+100}});}},da={requiredFileMap:new Map,async file(a,n){if(d.isNull(a))return h.error("NetDiskRequire.file的参数path为空",a),false;if(this.requiredFileMap.has(a))return h.warn("NetDiskRequire.file的参数path已引入过",a),true;let t=await _.get(a,n);if(!t.status)return  false;let e=t.data.responseText,i=this.requiredFileMap.get(a);return this.requiredFileMap.set(a,i++),h.info("加载js文件",a),ee.eval(`
		let exports = void 0;
		let module = void 0;
		let define = void 0;
		`+e),await d.sleep(300),true}},nt=a=>({"matchRange-text-before":G.matchRange_text.before(a).toString(),"matchRange-text-after":G.matchRange_text.after(a).toString()}),it=a=>({"matchRange-html-before":G.matchRange_html.before(a).toString(),"matchRange-html-after":G.matchRange_html.after(a).toString()}),Y={KEY:"userRule",userRuleContextDataKey:"userRuleContextData",$data:{__userRule:null,get userRule(){return this.__userRule==null&&(this.__userRule=new d.Dictionary),this.__userRule}},init(){this.parseRule(this.getAllRule()).forEach(n=>{this.$data.userRule.set(n.setting.key,n);});},parseRuleStrToRule(a){function n(e){return typeof e.link_innerText!="string"?{success:false,msg:"regexp缺失的键名: link_innerText，类型: string"}:typeof e.link_innerHTML!="string"?{success:false,msg:"regexp缺失的键名: link_innerHTML，类型: string"}:typeof e.shareCode!="string"?{success:false,msg:"regexp缺失的键名: shareCode，类型: string"}:typeof e.shareCodeNeedRemoveStr!="string"?{success:false,msg:"regexp缺失的键名: shareCodeNeedRemoveStr，类型: string"}:typeof e.uiLinkShow!="string"?{success:false,msg:"regexp缺失的键名: uiLinkShow，类型: string"}:typeof e.blank!="string"?{success:false,msg:"regexp缺失的键名: blank，类型: string"}:typeof e.copyUrl!="string"?{success:false,msg:"regexp缺失的键名: copyUrl，类型: string"}:typeof e.accessCode=="string"&&typeof e.checkAccessCode!="string"?{success:false,msg:"regexp设置了accessCode但是没有设置checkAccessCode"}:typeof e.accessCode!="string"&&typeof e.checkAccessCode=="string"?{success:false,msg:"regexp设置了checkAccessCode但是没有设置accessCode"}:{success:true,msg:"校验rule成功"}}function t(e){return typeof e.name!="string"?{success:false,msg:"setting缺失的键名: name，类型: string"}:typeof e.enable!="boolean"?{success:false,msg:"setting缺失的键名: enable，类型: boolean"}:{success:true,msg:"校验setting成功"}}try{let e=JSON.parse(a);if(typeof e!="object")return {success:!1,msg:"该规则不是object类型"};if(typeof e.key!="string")return {success:!1,msg:"缺失的键名: key，类型: string"};if(typeof e.regexp!="object")return {success:!1,msg:"缺失的键名: regexp，类型: object|Arrany"};if(typeof e.setting!="object")return {success:!1,msg:"缺失的键名: setting，类型: object"};if(Array.isArray(e.regexp))for(const s of e.regexp){let r=n(s);if(!r.success)return r}else {let s=n(e.regexp);if(!s.success)return s}let i=t(e.setting);return i.success?{success:!0,msg:"解析成功",data:e}:i}catch(e){return h.error(e),{success:false,msg:e.message}}},getBindContext(a){let n=new Xe(Y.userRuleContextDataKey);return {rule:a,NetDiskRequire:da,CryptoJS:ye,httpx:_,utils:d,DOMUtils:x,window,unsafeWindow:ee,NetDiskCheckLinkValidity:y,log:h,Qmsg:m,pops:j,setValue:n.set.bind(n),getValue:n.get.bind(n),deleteValue:n.delete.bind(n)}},parseRule(a){function n(e,i,s){const{shareCode:r,shareCodeNeedRemoveStr:o,shareCodeNotMatch:l,checkAccessCode:c,accessCode:u,acceesCodeNotMatch:p,paramMatch:f,...w}=s;let C={...w};return C.link_innerText=V.replaceParam(C.link_innerText,nt(e)),C.link_innerHTML=V.replaceParam(C.link_innerText,it(e)),typeof r=="string"&&(C.shareCode=new RegExp(r,"ig")),typeof o=="string"&&(C.shareCodeNeedRemoveStr=new RegExp(o,"ig")),typeof l=="string"&&(C.shareCodeNotMatch=new RegExp(l,"ig")),typeof c=="string"&&(C.checkAccessCode=new RegExp(c,"ig")),typeof u=="string"&&(C.accessCode=new RegExp(u,"ig")),typeof p=="string"&&(C.acceesCodeNotMatch=new RegExp(p,"ig")),typeof f=="string"&&(C.paramMatch=new RegExp(f,"i")),C}let t=[];for(const e of a){let i={rule:[],setting:{name:e.setting.name,key:e.key,configurationInterface:{matchRange_text:{},matchRange_html:{},function:{},linkClickMode_openBlank:{},schemeUri:{},ownFormList:[]}},isUserRule:true};const s=e.regexp,r=e.key;if(Array.isArray(s)?s.forEach(c=>{i.rule.push(n(r,e,c));}):i.rule.push(n(r,e,s)),e.setting){if(this.initDefaultValue(L.function.enable(r),!!e.setting.enable),i.setting.configurationInterface.function.enable=!!e.setting.enable,typeof e.setting.isBlank=="boolean"&&(this.initDefaultValue(L.function.linkClickMode(r),"openBlank"),i.setting.configurationInterface.function.linkClickMode={openBlank:{default:true,enable:true}}),typeof e.setting.linkClickMode=="object"){let c=d.assign(V.getDefaultLinkClickMode(),e.setting.linkClickMode||{}),u=null,p=Object.keys(c).map(f=>{let w=c[f];if(w.enable)return w.default&&(u=f),{value:f,text:w.text}}).filter(f=>f!=null);u==null&&(u=p[0].value),this.initDefaultValue(L.function.linkClickMode(r),u);}typeof e.setting.openBlankWithCopyAccessCode=="boolean"&&(this.initDefaultValue(L.linkClickMode_openBlank.openBlankWithCopyAccessCode(r),!!e.setting.openBlankWithCopyAccessCode),i.setting.configurationInterface.linkClickMode_openBlank.openBlankWithCopyAccessCode=!!e.setting.openBlankWithCopyAccessCode),typeof e.setting.checkLinkValidity=="boolean"&&(this.initDefaultValue(L.function.checkLinkValidity(r),!!e.setting.checkLinkValidity),i.setting.configurationInterface.function.checkLinkValidity=!!e.setting.checkLinkValidity),typeof e.setting.checkLinkValidityHoverTip=="boolean"&&this.initDefaultValue(L.function.checkLinkValidityHoverTip(r),!!e.setting.checkLinkValidityHoverTip),typeof e.setting.isForward=="boolean"&&(this.initDefaultValue(L.schemeUri.enable(r),!!e.setting.isForward),i.setting.configurationInterface.schemeUri.enable=!!e.setting.isForward),typeof e.setting.schemeUri=="string"&&(this.initDefaultValue(L.schemeUri.uri(r),e.setting.schemeUri),i.setting.configurationInterface.schemeUri.uri=e.setting.schemeUri),typeof e.setting.innerTextAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(L.matchRange_text.before(r),e.setting.innerTextAccessCodeBeforeMaxRange),i.setting.configurationInterface.matchRange_text.before=e.setting.innerTextAccessCodeBeforeMaxRange),typeof e.setting.innerTextAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(L.matchRange_text.after(r),e.setting.innerTextAccessCodeAfterMaxRange),i.setting.configurationInterface.matchRange_text.after=e.setting.innerTextAccessCodeAfterMaxRange),typeof e.setting.innerHTMLAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(L.matchRange_html.before(r),e.setting.innerHTMLAccessCodeBeforeMaxRange),i.setting.configurationInterface.matchRange_html.before=e.setting.innerHTMLAccessCodeBeforeMaxRange),typeof e.setting.innerHTMLAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(L.matchRange_html.after(r),e.setting.innerHTMLAccessCodeAfterMaxRange),i.setting.configurationInterface.matchRange_html.after=e.setting.innerHTMLAccessCodeAfterMaxRange);}if(typeof e.icon=="string"){let c=e.icon;k.src.addIcon(r,c);}const o=Object.getPrototypeOf(async function(){}).constructor;if(typeof e.checkLinkValidityFunction=="string")try{Reflect.set(y.netDisk,r,{init:new o("netDiskIndex","shareCode","accessCode",e.checkLinkValidityFunction).bind(this.getBindContext(e))});}catch(c){h.error(c);}if(typeof e.AuthorizationFunction=="string")try{He.netDisk[r]=new o(e.AuthorizationFunction).bind(this.getBindContext(e));}catch(c){h.error(c);}if(typeof e.AutoFillAccessCodeFunction=="string")try{Se.netDisk[r]=new o("netDiskInfo",e.AutoFillAccessCodeFunction).bind(this.getBindContext(e));}catch(c){h.error(c);}if(typeof e.parseFunction=="string")try{Reflect.set($e.netDisk,r,new Function(e.parseFunction).bind(this.getBindContext(e)));}catch(c){h.error(c);}let l=t.find(c=>c.setting.key===i.setting.key);l?l.rule=l.rule.concat(i.rule):t.push(i);}return t},getNetDiskRuleConfig(){return this.$data.userRule.values()},initDefaultValue(a,n){U(a)==null&&Z(a,n);},getTemplateRule(){let a={key:"规则名",icon:"图标链接字符串或图片的base64字符串",regexp:[{link_innerText:"",link_innerHTML:"",shareCode:"",shareCodeNeedRemoveStr:"",uiLinkShow:"",blank:"",copyUrl:""}],setting:{name:"设置界面的名字",enable:true,linkClickMode:"openBlank",openBlankWithCopyAccessCode:true}};return this.getFormatRule(a)},addRule(a){let n=this.getAllRule();n.push(a),Z(Y.KEY,n);},setRule(a,n){if(Array.isArray(n))Z(Y.KEY,n);else {let t=this.getAllRule(),e=t.findIndex(i=>i.key===a);if(e!==-1)t[e]=null,t[e]=n;else return h.error("覆盖规则失败",n),m.error("覆盖规则失败"),false;this.setRule(a,t);}},deleteRule(a){let n=this.getAllRule(),t=n.findIndex(e=>e.key===a);return t!==-1?(n.splice(t,1),this.setRule(a,n),true):false},clearRule(){Be(Y.KEY);},getAllRule(){return U(Y.KEY,[])},getRule(a){return U(Y.KEY,[]).find(t=>t.key===a)},getFormatRule(a){return JSON.stringify(a||this.getAllRule(),undefined,4)}},ua={rule:[{link_innerText:"pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码|\\?pwd=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码|\\?pwd=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/pan\.baidu\.com\/s\/([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码|pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",blank:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}"},{link_innerText:"pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码|&pwd=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码|&pwd=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/pan\.baidu\.com\/(share|wap)\/init\?surl=([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/(share|wap)\/init\?surl=/gi,checkAccessCode:/(密码|访问码|提取码|&pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",blank:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}"}],setting:{name:"百度网盘",key:"baidu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},ha=()=>({rule:[{link_innerText:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[a-zA-Z0-9]{3,6}|)",link_innerHTML:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[a-zA-Z0-9]{3,6}|)",shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)([a-zA-Z0-9_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{1,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)/gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${ne.hostname}/{#shareCode#} 提取码: {#accessCode#}`,blank:`https://${ne.hostname}/{#shareCode#}`,copyUrl:`https://${ne.hostname}/{#shareCode#}
密码：{#accessCode#}`},{link_innerText:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[a-zA-Z0-9]{3,6}|)",link_innerHTML:"(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[a-zA-Z0-9]{3,6}|)",shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\/([a-zA-Z0-9_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{1,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\//gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${ne.hostname}/s/{#shareCode#} 提取码: {#accessCode#}`,blank:`https://${ne.hostname}/s/{#shareCode#}`,copyUrl:`https://${ne.hostname}/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"蓝奏云",key:"lanzou",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""},ownFormList:[{text:"其它配置",type:"forms",forms:[se("蓝奏云域名",ne.MENU_KEY,ne.DEFAULT_HOST_NAME,"",undefined,`例如：${ne.DEFAULT_HOST_NAME}`)]}]}}}),pa={rule:[{link_innerText:"ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码|\\?code=)[\\s\\S]{0,{#matchRange-text-after#}}[a-zA-Z0-9]{3,6}|)",link_innerHTML:"ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码|\\?code=)[\\s\\S]{0,{#matchRange-html-after#}}[a-zA-Z0-9]{3,6}|)",shareCode:/ilanzou.com\/s\/([a-zA-Z0-9_\-]{5,22})/gi,shareCodeNeedRemoveStr:/ilanzou.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码|\?code=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:"www.ilanzou.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}",copyUrl:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}"}],setting:{name:"蓝奏云优享",key:"lanzouyx",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},fa={rule:[{link_innerText:"(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/cloud.189.cn\/web\/share\?code=([0-9a-zA-Z_\-]){8,14}|cloud.189.cn\/t\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/cloud\.189\.cn\/t\/|cloud.189.cn\/web\/share\?code=/gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"cloud.189.cn/t/{#shareCode#} 提取码: {#accessCode#}",blank:"https://cloud.189.cn/t/{#shareCode#}",copyUrl:`https://cloud.189.cn/t/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"天翼云",key:"tianyiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},ma={rule:[{link_innerText:"caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/caiyun\.139\.com\/m\/i\?([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/caiyun\.139\.com\/m\/i\?/gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"caiyun.139.com/m/i?{#shareCode#} 提取码: {#accessCode#}",blank:"https://caiyun.139.com/m/i?{#shareCode#}",copyUrl:`https://caiyun.139.com/m/i?{#shareCode#}
密码：{#accessCode#}`},{link_innerText:"yun.139.com/link/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"yun.139.com/link/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/yun\.139\.com\/link\/w\/i\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/yun\.139\.com\/link\/w\/i\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"yun.139.com/link/w/i/{#shareCode#} 提取码: {#accessCode#}",blank:"https://yun.139.com/link/w/i/{#shareCode#}",copyUrl:`https://yun.139.com/link/w/i/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"中国移动云盘",key:"hecaiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}}},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:false,uri:""}}}},ga={rule:[{link_innerText:"aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/aliyundrive\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.aliyundrive.com/s/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/s/{#shareCode#}
密码：{#accessCode#}`},{link_innerText:"aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/aliyundrive\.com\/t\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/t\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/t/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.aliyundrive.com/t/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/t/{#shareCode#}
密码：{#accessCode#}`},{link_innerText:"alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/alipan\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/alipan\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"alipan.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.alipan.com/s/{#shareCode#}",copyUrl:`https://www.alipan.com/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"阿里云",key:"aliyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},wa={rule:[{link_innerText:"(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)/f/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)/f/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)\/f\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/(wenshushu.cn|wss.ink|ws28.cn|wss1.cn|ws59.cn|wss.cc)\/f\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/f/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.wenshushu.cn/f/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/f/{#shareCode#}
密码：{#accessCode#}`},{link_innerText:"wenshushu.cn/k/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"wenshushu.cn/k/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/wenshushu.cn\/k\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/wenshushu.cn\/k\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/k/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.wenshushu.cn/k/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/k/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"文叔叔",key:"wenshushu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},ka={rule:[{link_innerText:"cowtransfer.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-text-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"cowtransfer.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,{#matchRange-html-before#}}(密码|访问码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/cowtransfer.com\/s\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/cowtransfer\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"cowtransfer.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://cowtransfer.com/s/{#shareCode#}",copyUrl:`https://cowtransfer.com/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"奶牛",key:"nainiu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:true,isForwardBlankLink:true,uri:""}}}},Ca={rule:[{link_innerText:"weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/weiyun.com\/([0-9a-zA-Z\-_]{7,24})/gi,shareCodeNeedRemoveStr:/weiyun.com\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"share.weiyun.com/{#shareCode#} 提取码: {#accessCode#}",blank:"https://share.weiyun.com/{#shareCode#}",copyUrl:`https://share.weiyun.com/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"微云",key:"weiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},ya={rule:[{link_innerText:"xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,{#matchRange-text-before#}}(\\?pwd=|访问码|提取码|密码|)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,{#matchRange-html-before#}}(\\?pwd=|访问码|提取码|密码|)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/xunlei.com\/s\/([0-9a-zA-Z\-_]{8,30})/gi,shareCodeNeedRemoveStr:/xunlei.com\/s\//gi,checkAccessCode:/(\?pwd=|提取码|密码|访问码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#} 提取码: {#accessCode#}",blank:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}"}],setting:{name:"迅雷云盘",key:"xunlei",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},xa={rule:[{link_innerText:"(pan.jc-box.com|download.jamcz.com|545c.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(pan.jc-box.com|download.jamcz.com|545c.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(pan.jc-box.com|download.jamcz.com|545c.com)\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(pan.jc-box.com|download.jamcz.com|545c.com)\/d\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([a-zA-Z0-9\.]+)\/d\//i,uiLinkShow:"{#$1#}/d/{#shareCode#} 提取码: {#accessCode#}",blank:"https://{#$1#}/d/{#shareCode#}?p={#accessCode#}",copyUrl:`https://{#$1#}/d/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"ct.ghpym.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"ct.ghpym.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/ct.ghpym.com\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/ct.ghpym.com\/d\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([a-zA-Z0-9\.]+)\/d\//i,uiLinkShow:"{#$1#}/d/{#shareCode#} 提取码: {#accessCode#}",blank:"http://{#$1#}/d/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}/d/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/ctfile.com\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/ctfile.com\/d\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/d/{#shareCode#} 提取码: {#accessCode#}",blank:"https://url95.ctfile.com/d/{#shareCode#}?p={#accessCode#}",copyUrl:`https://url95.ctfile.com/d/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"(2k.us|u062.com|545c.com|t00y.com|tc5.us)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(2k.us|u062.com|545c.com|t00y.com|tc5.us)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(2k.us|u062.com|545c.com|t00y.com|tc5.us)\/file\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(2k.us|u062.com|545c.com|t00y.com|tc5.us)\/file\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"u062.com/file/{#shareCode#} 提取码: {#accessCode#}",blank:"https://u062.com/file/{#shareCode#}?p={#accessCode#}",copyUrl:`https://u062.com/file/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc|download.jamcz.com|download.macenjoy.co)\/f\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([0-9a-zA-Z\.]+)\/f\//i,uiLinkShow:"{#$1#}/f/{#shareCode#} 提取码: {#accessCode#}",blank:"http://{#$1#}/f/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}/f/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"url[0-9]{2}.com/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"url[0-9]{2}.com/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/url[0-9]{2}.com\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/url[0-9]{2}.com\/f\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([0-9a-zA-Z\.]+)\/f\//i,uiLinkShow:"{#$1#}/f/{#shareCode#} 提取码: {#accessCode#}",blank:"http://{#$1#}/f/{#shareCode#}?p={#accessCode#}",copyUrl:`http://{#$1#}/f/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4,6}|)",shareCode:/(ctfile.com|089u.com)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(ctfile.com|089u.com)\/f\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/f/{#shareCode#} 提取码: {#accessCode#}",blank:"https://url95.ctfile.com/f/{#shareCode#}?p={#accessCode#}",copyUrl:`https://url95.ctfile.com/f/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`},{link_innerText:"(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4,6}|)",link_innerHTML:"(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=|\\?p=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{6}|)",shareCode:/(089u.com|474b.com)\/dir\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(089u.com|474b.com)\/dir\//gi,checkAccessCode:/(提取码|密码|访问码|\\?password=|\\?p=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{6})/gi,uiLinkShow:"089u.com/dir/{#shareCode#} 提取码: {#accessCode#}",blank:"https://089u.com/dir/{#shareCode#}?p={#accessCode#}",copyUrl:`https://089u.com/dir/{#shareCode#}?p={#accessCode#}
密码：{#accessCode#}`}],setting:{name:"城通网盘",key:"chengtong",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""},ownFormList:[{type:"forms",text:"文件解析配置",forms:[se("<a target='_blank' href='https://github.com/qinlili23333/ctfileGet/'>解析站</a>","chengtong-parse-file-api-host","https://ctfile.qinlili.bid","解析站配置，暂时只支持file，非file为新标签页打开",undefined,"")]}]}}},ba={rule:[{link_innerText:"quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/quark.cn\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/quark.cn\/s\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"quark.cn/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://pan.quark.cn/s/{#shareCode#}",copyUrl:`https://pan.quark.cn/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"夸克网盘",key:"kuake",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},va={rule:[{link_innerText:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",link_innerHTML:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",shareCode:/magnet:\?xt=urn:btih:([0-9a-fA-F]{32,40})/gi,shareCodeNeedRemoveStr:/magnet:\?xt=urn:btih:/gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"magnet:?xt=urn:btih:{#shareCode#}",blank:"magnet:?xt=urn:btih:{#shareCode#}",copyUrl:"magnet:?xt=urn:btih:{#shareCode#}"}],setting:{name:"BT磁力",key:"magnet",configurationInterface:{function:{enable:true,linkClickMode:{openBlank:{default:true}}},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},_a={rule:[{link_innerText:"jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/jianguoyun.com\/p\/([0-9a-zA-Z\-_]{16,24})/gi,shareCodeNeedRemoveStr:/jianguoyun.com\/p\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{3,6})/gi,uiLinkShow:"jianguoyun.com/p/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.jianguoyun.com/p/{#shareCode#}",copyUrl:`https://www.jianguoyun.com/p/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"坚果云",key:"jianguoyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},Aa={rule:[{link_innerText:"[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=\\?e=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=\\?e=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\/([0-9a-zA-Z\-_]+)/gi,shareCodeNeedRemoveStr:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\//gi,checkAccessCode:/(提取码|密码|访问码|\?password=|\?e=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,8})/gi,paramMatch:/([0-9a-zA-Z-_]+).sharepoint.com\/([0-9a-zA-Z-_:]+)\/([0-9a-zA-Z-_:]+)\/personal\/([0-9a-zA-Z-_]+)\/([0-9a-zA-Z-_]+)/i,uiLinkShow:"{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#} 提取码: {#accessCode#}",blank:"https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}?e={#accessCode#}",copyUrl:`https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"OneDrive",key:"onedrive",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:false,uri:""}}}},Sa={rule:[{link_innerText:"(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]+|)",link_innerHTML:"(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]+|)",shareCode:/(drive|fast).uc.cn\/s\/([0-9a-zA-Z]{8,24})/gi,shareCodeNeedRemoveStr:/(drive|fast).uc.cn\/s\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]+)/gi,uiLinkShow:"drive.uc.cn/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://drive.uc.cn/s/{#shareCode#}",copyUrl:`https://drive.uc.cn/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"UC网盘",key:"uc",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true},parseFile:{enable:true},"parseFile-closePopup":{enable:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardLinearChain:false,isForwardBlankLink:false,uri:""}}}},re=function(a,n,t,e,i,s,r,o,l){let c={text:a,type:"slider",description:o,attributes:{},props:{},getValue(){return this.props[P].get(n,t)},getToolTipContent(u){return typeof r=="function"?r(u):`${u}`},callback(u,p){typeof s=="function"&&s(u,p)||this.props[P].set(n,p);},min:e,max:i,step:l};return Reflect.set(c.attributes,le,n),Reflect.set(c.attributes,pe,t),Reflect.set(c.props,P,{get(u,p){return U(u,p)},set(u,p){Z(u,p);}}),c},ue=function(a,n,t,e,i,s){let r=[];typeof e=="function"?r=e():r=e;let o={text:a,type:"select",description:s,attributes:{},props:{},getValue(){return this.props[P].get(n,t)},callback(l,c,u){let p=c;h.info(`选择：${u}`),this.props[P].set(n,p);},data:r};return Reflect.set(o.attributes,le,n),Reflect.set(o.attributes,pe,t),Reflect.set(o.props,P,{get(l,c){return U(l,c)},set(l,c){Z(l,c);}}),o},Ra={rule:[{link_innerText:"(115.com|115cdn.com|anxia.com)/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-text-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-text-after#}}[0-9a-zA-Z]{4}|)",link_innerHTML:"(115.com|115cdn.com|anxia.com)/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,{#matchRange-html-before#}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,{#matchRange-html-after#}}[0-9a-zA-Z]{4}|)",shareCode:/(115.com|115cdn.com|anxia.com)\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/(115.com|115cdn.com|anxia.com)\/s\//gi,checkAccessCode:/(提取码|密码|\?password=|访问码)[\s\S]+/gi,accessCode:/(\?password=|)([0-9a-zA-Z]{4})/i,paramMatch:/(115.com|115cdn.com|anxia.com)/i,uiLinkShow:"{#$1#}/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://{#$1#}/s/{#shareCode#}",copyUrl:`https://{#$1#}/s/{#shareCode#}
密码：{#accessCode#}`}],setting:{name:"115网盘",key:"_115pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:true,linkClickMode:{openBlank:{default:true}},checkLinkValidity:true,checkLinkValidityHoverTip:true},linkClickMode_openBlank:{openBlankWithCopyAccessCode:true},schemeUri:{enable:false,isForwardBlankLink:true,uri:""}}}},Fe={dataKey:"ruleData",$data:{ruleContent:[]},init(){this.initRule();},initRule(){let a=[ua,ha(),pa,fa,ma,ga,wa,ka,et,Ca,ya,Ra,xa,ba,va,_a,Aa,Sa],n=Y.getNetDiskRuleConfig();[...a,...n].forEach(t=>{if(typeof t.setting.key!="string")throw new TypeError("规则未设置key");if(t.rule==null)throw new TypeError("规则未设置rule");const e=t.setting.key,i=t.setting.name,s=t.rule;if(Reflect.has(A.$rule.matchRule,e)){let c=A.$rule.matchRule[e];t.isUserRule?c=[...s,...c]:c=[...c,...s];let u=A.$rule.rule.find(p=>p.setting.key===e);u.rule=c;}else Reflect.set(A.$rule.matchRule,e,t.rule),A.$rule.rule.push(t);Reflect.set(A.$rule.ruleSetting,e,t.setting),t.rule=this.parseRuleMatchRule(t);let r=this.parseRuleSetting(t),o=t.setting.name;k.src.hasIcon(e)&&(o=`
					<div class="netdisk-aside-icon" style="background-image: url(${k.src.icon[e]});"></div>
					<div class="netdisk-aside-text">${i}</div>`);let l=i;t.isUserRule&&(l+=`<div class="netdisk-custom-rule-edit" data-key="${e}" data-type="${t.setting.name}">${j.config.iconSVG.edit}</div>`,l+=`<div class="netdisk-custom-rule-delete" data-key="${e}" data-type="${t.setting.name}">${j.config.iconSVG.delete}</div>`),this.$data.ruleContent.push({id:"netdisk-panel-config-"+e,title:o,headerTitle:l,attributes:{"data-key":e},forms:r,afterRender:c=>{c.$asideLiElement.setAttribute("data-function-enable",G.function.enable(e,true).toString());}});});},parseRuleMatchRule(a){let n=a.rule,t=[],e=a.setting.key;for(let i=0;i<n.length;i++){const s=n[i];typeof s.link_innerText=="string"&&(s.link_innerText=V.replaceParam(s.link_innerText,nt(e))),typeof s.link_innerHTML=="string"&&(s.link_innerHTML=V.replaceParam(s.link_innerHTML,it(e))),t.push(s);}return t},parseRuleSetting(a){let n=[];const t=a.setting.configurationInterface,e=a.setting.key;if(t==null)return [];if(t.function){let i=[];if("enable"in t.function){let s=typeof t.function.enable=="boolean"?t.function.enable:false;i.push(F("启用",L.function.enable(e),s,(r,o)=>{const l="data-function-enable";let p=r.target.getRootNode().querySelector(`.pops-panel-aside li[data-key="${e}"]`);p&&p.setAttribute(l,o.toString());},"开启可允许匹配该规则")),t.function.enable=G.function.enable(e);}if("linkClickMode"in t.function){let s=d.assign(V.getDefaultLinkClickMode(),t.function.linkClickMode||{}),r=null,o=Object.keys(s).map(l=>{let c=s[l];if(c.enable)return c.default&&(r=l),{value:l,text:c.text}}).filter(l=>l!=null);r==null&&(r=o[0].value),i.push(ue("点击动作",L.function.linkClickMode(e),r,o,undefined,"点击匹配到的链接的执行的动作"));for(const l in t.function.linkClickMode){const c=t.function.linkClickMode[l];l===G.function.linkClickMode(e)?c.default=true:c.default=false;}}if("checkLinkValidity"in t.function){const s=typeof t.function.checkLinkValidity=="boolean"?t.function.checkLinkValidity:true;i.push(F("验证链接有效性",L.function.checkLinkValidity(e),s,undefined,"自动请求链接，判断该链接是否有效，在大/小窗内显示验证结果图标")),t.function.checkLinkValidity=G.function.checkLinkValidity(e);}if("checkLinkValidityHoverTip"in t.function){const s=typeof t.function.checkLinkValidityHoverTip=="boolean"?t.function.checkLinkValidityHoverTip:true;i.push(F("验证链接有效性-悬停提示",L.function.checkLinkValidityHoverTip(e),s,undefined,"当鼠标悬停在验证结果图标上时会显示相关验证信息"));}i.length&&n.push({text:"功能",type:"forms",forms:i});}if(t.linkClickMode_openBlank){let i=[];if("openBlankWithCopyAccessCode"in t.linkClickMode_openBlank){const s=typeof t.linkClickMode_openBlank.openBlankWithCopyAccessCode=="boolean"?t.linkClickMode_openBlank.openBlankWithCopyAccessCode:false;i.push(F("跳转时复制访问码",L.linkClickMode_openBlank.openBlankWithCopyAccessCode(e),s,undefined,"当点击动作是【新标签页打开】时且存在访问码，那就会复制访问码到剪贴板")),t.linkClickMode_openBlank.openBlankWithCopyAccessCode=G.linkClickMode_openBlank.openBlankWithCopyAccessCode(e);}i.length&&n.push({text:"点击动作-新标签页打开",type:"forms",forms:i});}if(t.schemeUri){const i=[];if("enable"in t.schemeUri){const s=typeof t.schemeUri.enable=="boolean"?t.schemeUri.enable:false;i.push(F("启用",L.schemeUri.enable(e),s,undefined,"开启后可进行scheme uri转发")),t.schemeUri.enable=G.schemeUri.enable(e);}if("isForwardBlankLink"in t.schemeUri){const s=typeof t.schemeUri.isForwardBlankLink=="boolean"?t.schemeUri.isForwardBlankLink:false;i.push(F("转发新标签页链接",L.schemeUri.isForwardBlankLink(e),s,undefined,"对新标签页打开的链接进行scheme转换")),t.schemeUri.isForwardBlankLink=G.schemeUri.isForwardBlankLink(e);}if("isForwardLinearChain"in t.schemeUri){const s=typeof t.schemeUri.isForwardLinearChain=="boolean"?t.schemeUri.isForwardLinearChain:false;i.push(F("转发直链",L.schemeUri.isForwardLinearChain(e),s,undefined,"对解析的直链进行scheme转换")),t.schemeUri.isForwardLinearChain=G.schemeUri.isForwardLinearChain(e);}if("uri"in t.schemeUri){const s=typeof t.schemeUri.uri=="string"?t.schemeUri.uri:"";i.push(se("Uri链接",L.schemeUri.uri(e),s,"自定义的Scheme的Uri链接",undefined,"jumpwsv://go?package=xx&activity=xx&intentAction=xx&intentData=xx&intentExtra=xx")),t.schemeUri.uri=G.schemeUri.uri(e);}i.length&&n.push({text:"Scheme Uri转发",type:"forms",isFold:true,forms:i});}if(t.matchRange_text){let i=[];if("before"in t.matchRange_text){const s=typeof t.matchRange_text.before=="number"?t.matchRange_text.before:0;i.push(re("间隔前",L.matchRange_text.before(e),s,0,100,undefined,undefined,"提取码间隔前的字符长度")),t.matchRange_text.before=G.matchRange_text.before(e);}if("after"in t.matchRange_text){const s=typeof t.matchRange_text.after=="number"?t.matchRange_text.after:0;i.push(re("间隔后",L.matchRange_text.after(e),s,0,100,undefined,undefined,"提取码间隔后的字符长度")),t.matchRange_text.after=G.matchRange_text.after(e);}i.length&&n.push({text:"提取码文本匹配Text",type:"forms",forms:i});}if(t.matchRange_html){let i=[];if("before"in t.matchRange_html){const s=typeof t.matchRange_html.before=="number"?t.matchRange_html.before:0;i.push(re("间隔前",L.matchRange_html.before(e),s,0,100,undefined,undefined,"提取码间隔前的字符长度")),t.matchRange_html.before=G.matchRange_html.before(e);}if("after"in t.matchRange_html){const s=typeof t.matchRange_html.after=="number"?t.matchRange_html.after:0;i.push(re("间隔后",L.matchRange_html.after(e),s,0,100,undefined,undefined,"提取码间隔后的字符长度")),t.matchRange_html.after=G.matchRange_html.after(e);}i.length&&n.push({text:"提取码文本匹配HTML",type:"forms",forms:i});}return t.ownFormList&&n.push(...t.ownFormList),n},getRulePanelContent(){return this.$data.ruleContent}},Ae={handleShareCode(a,n,t){var r;let e=(r=a.match(n.shareCode))==null?undefined:r.filter(o=>d.isNotNull(o));if(t({status:true,msg:["正则: shareCode","作用: 获取shareCode","结果: ",JSON.stringify(e)]}),d.isNull(e)){t({status:false,msg:"匹配shareCode为空"});return}let i=e[0];t({status:true,msg:["取第一个值: "+i]}),n.shareCodeNeedRemoveStr&&(i=i.replace(n.shareCodeNeedRemoveStr,""),t({status:true,msg:["正则: shareCodeNeedRemoveStr","作用: 删除ShareCode前面不需要的字符串",`结果: ${i}`]}));let s=n.shareCodeNotMatch;if(s!=null&&i.match(s)){h.error(`不可能的shareCode => ${i}`),t({status:false,msg:["正则: shareCodeNotMatch","作用: 用于判断提取到的shareCode是否是错误的shareCode","结果: true 该shareCode不是正确的"]});return}for(const o of A.$extraRule.shareCodeNotMatchRegexpList)if(i.match(o)){h.error(`不可能的shareCode => ${i}`),t({status:false,msg:["正则: 内置的shareCodeNotMatchRegexpList","作用: 使用该正则判断提取到的shareCode是否正确","结果: true 该shareCode不是正确的"]});return}if(i=decodeURI(i),t({status:true,msg:["对shareCode进行解码: "+i]}),g.shareCode.excludeIdenticalSharedCodes.value&&d.isSameChars(i,g.shareCode.excludeIdenticalSharedCodesCoefficient.value)){t({status:false,msg:["已开启【排除分享码】且该分享码命中该规则"]});return}if(i.endsWith("http")||i.endsWith("https")){t({status:false,msg:["该分享码以http|https结尾"]});return}return t({status:true,msg:"处理完毕的shareCode: "+i}),i},handleAccessCode(a,n,t){var s;let e="";if(!n.checkAccessCode)return t({status:true,msg:"因未配置规则checkAccessCode，默认accessCode的值为空"}),"";let i=a.match(n.checkAccessCode);if(t({status:true,msg:["正则: checkAccessCode","作用: 用来判断link_innerText或者link_innerHTML匹配到的字符串中是否存在密码","结果: ",JSON.stringify(i)]}),i){let r=i[i.length-1];t({status:true,msg:"取最后一个值: "+r});let o=(s=r.match(n.accessCode))==null?undefined:s.filter(l=>d.isNotNull(l));if(t({status:true,msg:["正则: accessCode","作用: 用来提取link_innerText或者link_innerHTML匹配到的字符串中的密码","结果: ",JSON.stringify(o)]}),d.isNull(o))return t({status:true,msg:"因↑匹配到的结果为空，默认accessCode的值为空"}),"";o.length&&(e=o[0],t({status:true,msg:"取第一个值: "+e}),e.startsWith("http")&&(t({status:true,msg:"排除不可能的accessCode，重置accessCode的值为空"}),e=""));}if(d.isNotNull(e)){for(const r of A.$extraRule.accessCodeNotMatchRegexpList)if(e.match(r)){e="",t({status:true,msg:["正则: 内置的accessCodeNotMatchRegexpList","作用: 使用该正则判断提取到的accessCode是否正确","结果: true 重置accessCode为空"]});break}n.acceesCodeNotMatch&&e.match(n.acceesCodeNotMatch)&&(e="",t({status:true,msg:["正则: acceesCodeNotMatch","作用: 用于判断提取到的accessCode是否是错误的accessCode","结果: true 重置accessCode为空"]}));}return t({status:true,msg:"处理完毕的accessCode: "+e}),e},handleLinkShow(a,n,t,e,i){let s=V.replaceParam(n.uiLinkShow,{shareCode:t});if(i({status:true,msg:["正则: uiLinkShow","作用: 用于显示在弹窗中的字符串","备注: 对shareCode进行参数替换",`结果: ${s}`]}),e&&e!=""?(s=V.replaceParam(s,{accessCode:e}),i({status:true,msg:["正则: uiLinkShow","作用: 用于显示在弹窗中的字符串","备注: 对accessCode进行参数替换",`结果: ${s}`]})):(s=ke.replaceText(s,A.$extraRule.noAccessCodeRegExp,""),i({status:true,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${s}`]})),n.paramMatch&&d.isNotNull(a)){let r=a.match(n.paramMatch),o={};if(r)for(let l=0;l<r.length;l++)o[`$${l}`]=r[l];s=V.replaceParam(s,o),i({status:true,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(o,undefined,4),`结果: ${s}`]});}return i({status:true,msg:"处理完毕的uiLink: "+s}),s},handleBlank(a,n,t,e,i){let s=V.replaceParam(n.blank,{shareCode:t});if(i({status:true,msg:["正则: blank","作用: 用于点击跳转的链接","备注: 对shareCode进行参数替换",`结果: ${s}`]}),e&&e!=""?(s=V.replaceParam(s,{accessCode:e}),i({status:true,msg:["正则: blank","作用: 用于点击跳转的链接","备注: 对accessCode进行参数替换",`结果: ${s}`]})):(s=ke.replaceText(s,A.$extraRule.noAccessCodeRegExp,""),i({status:true,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${s}`]})),n.paramMatch&&d.isNotNull(a)){let r=a.match(n.paramMatch),o={};if(r)for(let l=0;l<r.length;l++)o[`$${l}`]=r[l];s=V.replaceParam(s,o),i({status:true,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(o,undefined,4),`结果: ${s}`]});}return i({status:true,msg:"处理完毕的blank: "+s}),s},handleCopyUrl(a,n,t,e,i){let s=V.replaceParam(n.copyUrl,{shareCode:t});if(i({status:true,msg:["正则: copyUrl","作用: 用于复制到剪贴板的链接","备注: 对shareCode进行参数替换",`结果: ${s}`]}),e&&e!=""?(s=V.replaceParam(s,{accessCode:e}),i({status:true,msg:["正则: copyUrl","作用: 用于复制到剪贴板的链接","备注: 对accessCode进行参数替换",`结果: ${s}`]})):(s=ke.replaceText(s,A.$extraRule.noAccessCodeRegExp,""),i({status:true,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${s}`]})),n.paramMatch&&d.isNotNull(a)){let r=a.match(n.paramMatch),o={};if(r)for(let l=0;l<r.length;l++)o[`$${l}`]=r[l];s=V.replaceParam(s,o),i({status:true,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(o,undefined,4),`结果: ${s}`]});}return i({status:true,msg:"处理完毕的copyUrl: "+s}),s}},Te={depthQueryShadowRootAllNode(a){let n=[];function t(e){let i=Array.from(e.querySelectorAll("*"));return i.forEach(s=>{if(s.classList&&s.classList.contains("pops-shadow-container"))return;let r=s.shadowRoot;r&&r instanceof ShadowRoot&&n.push({shadowRoot:r,childNode:t(r)});}),i}return t(a),n},ignoreStrRemove(a,n=false){let t=[];return t.length&&t.forEach(e=>{if(e!=null)if(n)e.innerHTML!=null&&(a=a.replaceAll(e.innerHTML,""));else {let i=e.innerText||e.textContent;i!=null&&(i=i.replaceAll(i,""));}}),a},getPageText(a=document.documentElement,n){let t=[];if(t.push((a==null?undefined:a.textContent)||(a==null?undefined:a.innerText)||""),n){let e=this.depthQueryShadowRootAllNode(a);e.length&&e.forEach(i=>{let s=i.shadowRoot.textContent;s&&t.push(s);});}return t=t.filter(e=>e!==""),t},getPageHTML(a=document.documentElement,n){let t=[];if(t.push(a.innerHTML),n){let e=this.depthQueryShadowRootAllNode(a);e.length&&e.forEach(i=>{let s=i.shadowRoot.innerHTML;s&&t.push(s);});}return t=t.filter(e=>e!==""),t},getInputElementValue(a=document.documentElement,n){let t=[];if(Array.from(a.querySelectorAll("input")).forEach(e=>{t.push(e.value);}),n){let e=this.depthQueryShadowRootAllNode(a);e.length&&e.forEach(i=>{for(let s=0;s<i.childNode.length;s++){const r=i.childNode[s];r instanceof HTMLInputElement&&r.value&&t.push(r.value);}});}return t},getTextAreaElementValue(a=document.documentElement,n){let t=[];if(Array.from(a.querySelectorAll("textarea")).forEach(e=>{t.push(e.value);}),n){let e=this.depthQueryShadowRootAllNode(a);e.length&&e.forEach(i=>{for(let s=0;s<i.childNode.length;s++){const r=i.childNode[s];r instanceof HTMLTextAreaElement&&r.value&&t.push(r.value);}});}return t}},Na=`.whitesevPopNetDiskHistoryMatch .pops-confirm-content ul {\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content li {\r
	display: flex;\r
	flex-direction: column;\r
	justify-content: center;\r
	border-radius: 10px;\r
	box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%),\r
		0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%),\r
		0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);\r
	margin: 20px 10px;\r
	padding: 10px;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search {\r
	height: 11%;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-table {\r
	height: calc(85% - 40px);\r
	overflow: auto;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-page {\r
	display: flex;\r
	justify-content: center;\r
	align-items: center;\r
	margin-top: 10px;\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-search\r
	input {\r
	border: none;\r
	border-bottom: 1px solid #000000;\r
	padding: 0px 5px;\r
	line-height: normal;\r
	width: -moz-available;\r
	width: -webkit-fill-available;\r
	width: fill-available;\r
	margin: 5px 5px 0px 5px;\r
	background: none;\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-search\r
	input:focus-visible {\r
	outline: none;\r
	border-bottom: 1px solid #0009ff;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link {\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a {\r
	color: #ff4848;\r
	font-size: 0.8em;\r
	border: none;\r
	word-break: break-word;\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-link\r
	a[isvisited="true"] {\r
	color: #8b8888;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon {\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-icon\r
	.netdisk-icon-img {\r
	width: 28px;\r
	height: 28px;\r
	min-width: 28px;\r
	min-height: 28px;\r
	font-size: 0.8em;\r
	border-radius: 10px;\r
	box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%),\r
		0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%),\r
		0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url {\r
	color: #000;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url {\r
	color: #000;\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-functions\r
	button.btn-delete {\r
	background: #263cf3;\r
	color: #fff;\r
}\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-functions\r
	button.btn-delete:active {\r
	background: #6e7be8;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time,\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-update-time,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url-title,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions {\r
	display: flex;\r
	margin: 5px 0px;\r
}\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link p,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon p,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url p,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url p,\r
.whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time p,\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-update-time\r
	p,\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-url-title\r
	p,\r
.whitesevPopNetDiskHistoryMatch\r
	.pops-confirm-content\r
	.netdiskrecord-functions\r
	p {\r
	min-width: 80px;\r
	max-width: 80px;\r
	align-self: center;\r
}\r
`,Ee={storageKey:"netDiskHistoryMatch",isSetOtherEvent:false,dataPaging:undefined,show(){let a=this.getStorageData(),n="",t=this;a=this.orderNetDiskHistoryMatchData(a);for(let e=0;e<10;e++)a[e]&&(n+=t.getTableHTML(a[e]).html);n=`
        <div class="netdiskrecord-search">
            <input type="text" placeholder="搜索链接/网址/网址标题，可正则搜索">
        </div>
        <div class="netdiskrecord-table"><ul>${n}</ul></div>
        <div class="netdiskrecord-page">

        </div>`,k.Alias.historyAlias=H.confirm({title:{text:"历史匹配记录",position:"center"},content:{text:n,html:true},btn:{reverse:true,position:"space-between",ok:{enable:true,callback(e){e.close(),k.Alias.historyAlias=undefined;}},close:{callback(e){e.close(),k.Alias.historyAlias=undefined;}},cancel:{enable:false},other:{enable:true,text:`清空所有(${a.length})`,type:"xiaomi-primary",callback:e=>{H.confirm({title:{text:"删除",position:"center"},content:{text:"确定清空所有的记录？",html:false},btn:{ok:{enable:true,callback(i){t.clearStorageData(),x.remove(k.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul li")),i.close(),x.html(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page"),""),x.text(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other"),x.text(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other")).replace(/[\d]+/gi,"0"));}},cancel:{text:"取消",enable:true}}});}}},mask:{clickCallBack(e){e(),k.Alias.historyAlias=null;}},class:"whitesevPopNetDiskHistoryMatch",style:Na},k.popsStyle.historyMatchView),this.setDataPaging(a),this.setEvent(k.Alias.historyAlias.$shadowRoot),this.setSearchEvent(),k.setRightClickMenu(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch"),".netdiskrecord-link a",true);},getCSS(){},getTableHTML(a){let n=A.handleLinkShow(a.netDiskName,a.netDiskIndex,a.shareCode,a.accessCode,a.matchText),t=x.createElement("li",{innerHTML:`
			<div class="netdiskrecord-link">
				<p>链接</p>
				<a  href="javascript:;" isvisited="false">${n}</a>
			</div>
			<div class="netdiskrecord-icon">
				<p>网盘</p>
				<div class="netdisk-icon-img"></div>
			</div>
			<div class="netdiskrecord-url">
				<p>网址</p>
				<a href="${a.url}" target="_blank">${a.url}</a>
			</div>
			<div class="netdiskrecord-url-title">
				<p>网址标题</p>
				${a.title}
			</div>
			<div class="netdiskrecord-add-time">
				<p>记录时间</p>
				${d.formatTime(a.addTime)}
			</div>
			<div class="netdiskrecord-update-time">
				<p>更新时间</p>
				${d.formatTime(a.updateTime)}
			</div>
			<div class="netdiskrecord-functions">
				<p>功能</p>
				<button class="btn-delete">删除</button>
			</div>
			`}),e=t.querySelector(".netdiskrecord-link"),i=e.querySelector("a"),s=t.querySelector(".netdiskrecord-icon"),r=t.querySelector(".netdisk-icon-img"),o=t.querySelector(".netdiskrecord-url"),l=t.querySelector(".netdiskrecord-url-title"),c=t.querySelector(".netdiskrecord-add-time"),u=t.querySelector(".netdiskrecord-update-time"),p=t.querySelector(".netdiskrecord-functions"),f=p.querySelector(".btn-delete");if(ie.handleElementAttributeRuleInfo({netDisk:a.netDiskName,netDiskIndex:a.netDiskIndex,shareCode:a.shareCode,accessCode:a.accessCode},i),r.style.cssText=`background: url(${k.src.icon[a.netDiskName]}) no-repeat;background-size:100%`,a.url!==a.topURL){let w=x.createElement("div",{className:"netdiskrecord-top-url",innerHTML:`
				<p>Top网址</p>
				<a href="${a.topURL}" target="_blank">${a.topURL}</a>
				`});x.after(o,w);}return f.setAttribute("data-json",JSON.stringify(a)),Reflect.set(f,"data-json",a),{$liItemContainer:t,$link:e,$linkAnchor:i,$icon:s,$iconImg:r,$url:o,$urlTitle:l,$addTime:c,$updateTime:u,$features:p,$featuresBtnDelete:f,html:t.outerHTML}},setEvent(a){let n=this;k.view.setNetDiskUrlClickEvent(a,".whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a"),x.on(a,"click",".whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete",function(t){var u;let e=H.loading({parent:a.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul"),content:{text:"删除中..."},only:true,addIndexCSS:false}),i=t.target,s=i.getAttribute("data-json");(u=i.closest("li"))==null||u.remove(),n.deleteStorageData(s),e==null||e.close();let r=x.text(a.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other")),o=r.match(/[\d]+/gi),l=parseInt(o[o.length-1]);l--,r=r.replace(/[\d]+/gi,l.toString()),x.text(a.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other"),r);let c=n.getStorageData();c=n.orderNetDiskHistoryMatchData(c),n.dataPaging.refresh(c),n.pageChangeCallBack(c,n.dataPaging.CONFIG.currentPage);});},pageChangeCallBack(a,n){let t=(n-1)*10,e="";for(let i=0;i<10&&a[t];i++){e+=this.getTableHTML(a[t]).html;t++;}k.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li").forEach(i=>i.remove()),x.append(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),e);},setDataPaging(a){let n=this,t=new Ha({data:a,pageCount:10,pageStep:j.isPhone()?2:4,currentPage:1,pageChangeCallBack:function(e){n.pageChangeCallBack(a,e);}});this.dataPaging=t,t.addCSS(k.Alias.historyAlias.$shadowRoot),t.append(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page"));},setSearchEvent(){let a=false,n,t=this;function e(){if(a)return;a=true,n=H.loading({parent:k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul"),content:{text:"搜索中..."},only:true,addIndexCSS:false});let i=k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input").value.trim(),s=t.getStorageData();if(s=t.orderNetDiskHistoryMatchData(s),i===""){let o="";s.forEach((l,c)=>{c>9||(o+=t.getTableHTML(l).html);}),k.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li").forEach(l=>l.remove()),x.append(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),o),n==null||n.close(),a=false,t.setDataPaging(s);return}let r="";s.forEach(o=>{(A.handleLinkShow(o.netDiskName,o.netDiskIndex,o.shareCode,o.accessCode,o.matchText).match(new RegExp(i,"ig"))||o.url.match(new RegExp(i,"ig"))||o.topURL.match(new RegExp(i,"ig"))||o.title.match(new RegExp(i,"ig")))&&(r+=t.getTableHTML(o).html);}),x.remove(k.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li")),x.append(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),r),x.remove(k.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page > *")),n==null||n.close(),n=undefined,a=false;}x.listenKeyboard(k.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input"),"keypress",i=>{i==="Enter"&&e();});},orderNetDiskHistoryMatchData(a){let n=g.historyMatch["netdisk-history-match-ordering-rule"].value,t=n.indexOf("降序")!==-1,e=n.indexOf("记录时间")!==-1?"addTime":"updateTime";return d.sortListByProperty(a,i=>i[e],t),a},queryAccessCode(a,n,t){let e=this.getStorageData();for(let i=0;i<e.length;i++){const s=e[i];if(s.netDiskName===a&&s.shareCode===n)return t&&d.isNotNull(s.accessCode),s.accessCode}},syncAccessCode(a,n,t,e){if(g.historyMatch.saveMatchNetDisk.value){if(Ee.changeMatchedDataAccessCode(a,n,t,e))return h.success("已成功同步访问码至历史匹配记录"),true;h.error("同步访问码至历史匹配记录失败");}return  false},changeMatchedDataAccessCode(a,n,t,e){let i=this.getStorageData(),s=false;for(let r=0;r<i.length;r++){const o=i[r];o.netDiskName===a&&String(o.netDiskIndex)===String(n)&&o.shareCode===t&&(s=true,i[r].accessCode=e,i[r].updateTime=Date.now());}return s&&this.saveStorageData(i),s},changeMatchedData(a,n,t,e,i){if(!g.historyMatch.saveMatchNetDisk.value)return  false;let s=this.getStorageData(),r=false;for(let o=0;o<s.length;o++){const l=s[o];if(l.netDiskName===a&&t.startsWith(l.shareCode)&&l.netDiskIndex===n&&(g.historyMatch["netdisk-history-match-merge-same-link"].value||l.url===window.location.href&&l.topURL===top.window.location.href)){r=true;let c=false;if(i.trim()!==""&&l.matchText!==i&&(c=true,h.success("匹配历史记录 -> 设置新的matchText",[i]),s[o].matchText=i),d.isNotNull(e)&&l.accessCode!==e&&(c=true,h.success("匹配历史记录 -> 修改accessCode"),s[o].accessCode=e),c){s[o].updateTime=Date.now(),s[o].title&&(s[o].title=document.title),g.historyMatch["netdisk-history-match-merge-same-link"].value&&(s[o].url=window.location.href,s[o].topURL=top.window.location.href);break}}}if(!r){r=true,h.success("匹配历史记录 -> 增加新的");let o=Date.now();s=[...s,{url:window.location.href,topURL:top.window.location.href,netDiskName:a,netDiskIndex:n,shareCode:t,accessCode:e,addTime:o,updateTime:o,title:document.title||top.document.title,matchText:i}];}return this.saveStorageData(s),true},checkAndRepairLocalData(){let a=0,n=U(this.storageKey);if(Array.isArray(n))for(let t=0;t<n.length;t++){const e=n[t];typeof e.matchText!="string"&&(e.matchText="",a++);}else n=[];return this.saveStorageData(n),{count:n.length,repairCount:a}},getStorageData(){let a=U(this.storageKey,[]);return a==null&&(a=[],this.saveStorageData(a)),a},saveStorageData(a){Z(this.storageKey,a);},deleteStorageData(a){let n=false,t=this.getStorageData();for(let e=0;e<t.length;e++)if(JSON.stringify(t[e])===a){h.success("删除 ===> ",t[e]),t.splice(e,1),n=true;break}return n&&this.saveStorageData(t),n},clearStorageData(){this.saveStorageData([]);}},Ie={addHost(a){let n=this.getList();n.includes(a)||n.push(a),this.updateList(n);},findHost(a){return this.getList().findIndex(e=>e===a)!==-1},removeHost(a){let n=this.getList(),t=false,e=n.findIndex(i=>i===a);return e!==-1&&(t=true,n.splice(e,1),this.updateList(n)),t},getList(){let a=U(M.neverTipWorkerInitErrorKey,[]);return Array.isArray(a)||(a=[a]),a},updateList(a){Z(M.neverTipWorkerInitErrorKey,a);}},M={isHandleMatch:false,workerInitError:null,neverTipWorkerInitErrorKey:"never-toast-worker-error",delayNotMatchCount:0,postMessageType:"worker-init-error",dispatchMonitorDOMChange:false,blobUrl:"",GM_matchWorker:undefined,init(){this.listenWorkerInitErrorDialog(),this.initWorkerBlobUrl(),this.initWorker(),this.monitorDOMChange();},initWorkerBlobUrl(){const a=`
        (() => {
            function ${M.handleRegularMatch.toString()}

            function ${M.uniqueArr}
            
            this.addEventListener(
            "message",
            function (event) {
                const data = event.data;
                let matchedList = [];
                ${M.handleRegularMatch.name}(data,(matchData)=>{
                	matchedList.push(matchData);
                })
                matchedList = ${M.uniqueArr.name}(matchedList);
                this.postMessage({
					options: data,
					msg: "Match End",
					data: matchedList,
					startTime: data.startTime,
					endTime: Date.now(),
                });
            },
            {
                capture: true,
            }
            );
        })();
  		`;let n=new Blob([a],{type:"application/javascript"}),t=globalThis.URL.createObjectURL(n);globalThis.trustedTypes&&typeof globalThis.trustedTypes.createPolicy=="function"&&(t=globalThis.trustedTypes.createPolicy("workerPolicy",{createScriptURL:i=>i}).createScriptURL(t)),M.blobUrl=t,h.info(`Worker Blob Link ===> ${M.blobUrl}`);},handleRegularMatch(a,n){const t=Object.keys(a.regular),e=a.textList.map(i=>{for(let s=0;s<a.characterMapping.length;s++){const r=a.characterMapping[s];try{typeof r.searchValue=="string"?i=i.replaceAll(r.searchValue,r.replaceValue):i=i.replace(r.searchValue,r.replaceValue);}catch{}}return i});for(const i of t){const s=a.regular[i];for(let r=0;r<s.length;r++){const o=s[r];let l=[];if(a.matchTextRange.includes("innerText")&&l.push(new RegExp(o.link_innerText,"gi")),a.matchTextRange.includes("innerHTML")&&l.push(new RegExp(o.link_innerHTML,"gi")),!a.matchTextRange.length)throw console.error(a),new TypeError("未设置匹配范围");if(!l.length)throw new TypeError("未知的匹配范围: "+a.matchTextRange);for(let c=0;c<l.length;c++){const u=l[c];for(let p=0;p<e.length;p++){let w=e[p].match(u);w&&w.length&&n({netDiskName:i,netDiskIndex:r,data:w});}}}}},uniqueArr(a){return a.filter((n,t,e)=>t===e.findIndex(i=>JSON.stringify(i)===JSON.stringify(n)))},initWorker(){try{M.GM_matchWorker=new Worker(M.blobUrl),M.GM_matchWorker.onmessage=M.onMessage,M.GM_matchWorker.onerror=M.onError;}catch(a){this.workerInitError=a,M.GM_matchWorker={postMessage(n){return new Promise((t,e)=>{let i=[];try{M.handleRegularMatch(n,s=>{i.push(s);});}catch(s){M.onError(s);}finally{i=M.uniqueArr(i),M.onMessage(new MessageEvent("message",{data:{options:n,msg:"Match End",data:i,startTime:n.startTime,endTime:Date.now()}})),t(null);}})}};}},listenWorkerInitErrorDialog(){if(!W.isTopWindow())return;const a=this;x.on(window,"message",n=>{let t=n.data;if(typeof t=="object"&&(t==null?undefined:t.type)===this.postMessageType){let e=t.data;a.registerWorkerInitErrorNeverTipToast(e.hostname),H.confirm({title:{text:"Worker Init Error",position:"center"},content:{text:`
							<div style="padding: 10px;gap: 10px;display: flex;flex-direction: column;">
								<p>链接：${e.url}</p>
								<p>来源：${W.isTopWindow()?"top":"iframe"}</p>
								<p>原因：初始化Worker失败，可能页面使用了Content-Security-Policy策略，执行匹配时如果页面的内容过大会导致页面卡死，请使用Menu模式进行匹配或者使用CSP插件禁用CSP策略（不建议）。</p>
								<p>
									错误信息：
									<span style="color: red;">${e.error}</span>
								</p>
							</div>
							`,html:true},btn:{merge:true,position:"space-between",ok:{text:"添加网站规则",callback(i,s){let r=Q.getTemplateData();r.name="手动匹配："+e.hostname,r.url=`^http(s|):\\/\\/${e.hostname}\\/`,r.data[g.features["netdisk-match-mode"].KEY]="Menu",Q.getRuleView(r).showEditView(false,r,undefined,undefined,undefined,()=>{m.success("添加成功");});}},cancel:{text:"网站规则",callback(i,s){Q.getRuleView().showView();}},other:{enable:true,text:"不再提示",type:"xiaomi-primary",callback(i,s){H.confirm({title:{text:"提示",position:"center"},content:{text:`确定不再弹出该提示？（仅针对域名：${e.hostname}）`},btn:{ok:{callback(r,o){Ie.addHost(e.hostname),r.close();}}}},{PC:{width:"400px",height:"200px"},Mobile:{width:"80vw",height:"200px"}});}}}},{PC:{width:"550px",height:"350px"},Mobile:{width:"88vw",height:"500px"}});}});},dispatchWorkerInitErrorDialog(){top==null||top.postMessage({type:this.postMessageType,data:{url:window.location.href,hostname:window.location.hostname,error:this.workerInitError}},"*");},registerWorkerInitErrorNeverTipToast(a){let n="💀 Worker初始化失败",t=()=>Ie.findHost(a)?n+"（已设置不再提示）":n,e={key:"workerInitErrorNeverTipToast-"+a,text:t(),autoReload:false,isStoreValue:false,showText:t,callback:()=>{Ie.findHost(a)?confirm("是否允许弹出Worker初始化失败的弹窗提示？")&&(Ie.removeHost(a)?m.success("删除成功"):m.error("删除失败"),be.update(e)):this.dispatchWorkerInitErrorDialog();}};be.update(e);},postMessage(a,n){M.GM_matchWorker.postMessage(a,n);},onMessage(a){const n=a.data;n.data.length&&h.success(`成功匹配${n.data.length}个，用时${Date.now()-n.startTime}ms`),n.options.from==="PasteText"&&k.matchPasteText.workerMatchEndCallBack(n),n.options.from.startsWith("FirstLoad")&&M.delayNotMatchCount++,M.successCallBack(n);},onError(a){M.errorCallBack(a);},successCallBack(a){if(!a.data.length){M.matchingEndCallBack();return}const n=[];for(const e of a.data){A.$match.matchedInfoRuleKey.add(e.netDiskName);let i=new Set;e.data.forEach(s=>{i.add(s);}),i.forEach(s=>{let r=A.handleLink(e.netDiskName,e.netDiskIndex,s);r&&n.push({shareCode:r.shareCode,accessCode:r.accessCode,netDiskName:e.netDiskName,netDiskIndex:e.netDiskIndex,matchText:s});});}let t=n.filter((e,i,s)=>s.findIndex(o=>o.accessCode===e.accessCode&&o.netDiskIndex===e.netDiskIndex&&o.netDiskName===e.netDiskName&&o.shareCode===e.shareCode)===i);if(t.forEach(e=>{A.$match.tempMatchedInfo.has(e.netDiskName)&&A.$match.tempMatchedInfo.get(e.netDiskName).set(e.shareCode,e);}),t.forEach(e=>{let{shareCode:i,accessCode:s,netDiskName:r,netDiskIndex:o,matchText:l}=e;const u=A.$rule.rule.find(w=>w.setting.key===r).rule[o];let p=false;if(A.$match.blackMatchedInfo.forEach((w,C)=>{if(C!==e.netDiskName)return;w.has(i)&&(p=true,h.warn(`匹配到黑名单分享码，已过滤：${i}`,JSON.stringify(e)));}),p)return;if(u.shareCodeExcludeRegular&&Array.isArray(u.shareCodeExcludeRegular))for(const w of u.shareCodeExcludeRegular){let C=A.$match.matchedInfo.get(w),b=A.$match.tempMatchedInfo.get(w);if(C.startsWith(i)||b.startsWith(i)){h.warn(`${r}：该分享码【${i}】与已匹配到该分享码的规则【${w}】冲突`);return}}const f=A.$match.matchedInfo.get(r);if(A.$data.isMatchedLink=true,f.startsWith(i)){let w=f.getStartsWith(i);if(typeof w.isForceAccessCode=="boolean"&&w.isForceAccessCode||d.isNotNull(w.accessCode)||d.isNull(s))return;f.set(i,A.getLinkDickObj(s,o,false,l)),k.view.changeLinkView(r,o,i,s,l),h.info(`该匹配项无密码，设置密码 ${r} ${o}: ${i}  ===> ${s}`);}else {if(d.isNull(s)&&g.accessCode.allowQueryHistoryMatchingAccessCode.value){let w=Ee.queryAccessCode(r,i,true);w&&(h.info("历史匹配记录 ==> 查询到访问码："+w),s=w);}f.set(i,A.getLinkDickObj(s,o,false,l)),k.isMatchedNetDiskIconMap.add(r),k.view.addLinkView(r,o,i,s,l),h.success(`添加链接 ${r} ${o}: ${i}  ===> ${s}`);}}),Object.keys(A.$match.tempMatchedInfo.getItems()).forEach(e=>{A.$match.tempMatchedInfo.get(e).clear();}),A.$data.isMatchedLink)switch(g.features["netdisk-behavior-mode"].value){case "suspension_smallwindow".toLowerCase():J.mode.current_suspension_smallwindow_mode.value==="suspension"?k.suspension.show():k.view.show();break;case "suspension_window".toLowerCase():k.suspension.show();break;case "smallwindow".toLowerCase():k.view.show();break;default:h.error("未知的行为模式："+g.features["netdisk-behavior-mode"].value);}M.matchingEndCallBack();},errorCallBack(a){M.matchingEndCallBack(true),h.error("Worker Error",a);},matchingEndCallBack(a){if(a)M.isHandleMatch=false,M.delayNotMatchCount>0&&(M.delayNotMatchCount=0,M.dispatchMonitorDOMChange=true);else {const n=parseFloat(g.match.delaytime.value.toString())*1e3;setTimeout(()=>{M.matchingEndCallBack(true);},n);}},monitorDOMChange(){const a=g.match.isAddedNodesToMatch.value,n=g.match.readClipboard.value,t=g.match.pageMatchRange.value;let e=true,i=true,s=true,r=g.match.depthQueryWithShadowRoot.value;const o={},l=_e.getMappingData();A.$rule.rule.forEach(f=>{let w=f.setting.key;G.function.enable(w)&&(Reflect.has(o,w)?o[w]=[...o[w],...f.rule]:Reflect.set(o,w,f.rule));});async function c(f){if(M.isHandleMatch){M.delayNotMatchCount++;return}if(a&&f&&f.length){let b=false;for(let S=0;S<f.length;S++){const v=f[S];if(v.addedNodes&&v.addedNodes instanceof NodeList&&v.addedNodes.length){b=true;break}}if(!b)return}M.isHandleMatch=true;const w=Date.now();if(n)try{A.$data.clipboardText=await ke.getClipboardText();}catch{}typeof A.$data.clipboardText!="string"&&(A.$data.clipboardText="");const C=[];if(d.isNotNull(A.$data.clipboardText)){let b=A.$data.clipboardText;C.push(b);}{let b=V.getDecodeComponentUrl();C.push(b);}if(e&&(e=false,C.length)){M.postMessage({characterMapping:l,textList:C,matchTextRange:t,regular:o,startTime:w,from:"FirstLoad-DOMChange"});return}if(t.includes("innerText")){let b=Te.getPageText(document.documentElement,r);if(C.push(...b),i){i=false,M.postMessage({characterMapping:l,textList:C,matchTextRange:t,regular:o,startTime:w,from:"FirstLoad-Text-DOMChange"});return}}if(t.includes("innerHTML")){let b=Te.getPageHTML(document.documentElement,r);if(C.push(...b),s){s=false,M.postMessage({characterMapping:l,textList:C,matchTextRange:t,regular:o,startTime:w,from:"FirstLoad-HTML-DOMChange"});return}}{let b=Te.getInputElementValue(document.documentElement,r);C.push(...b);}{let b=Te.getTextAreaElementValue(document.documentElement,r);C.push(...b);}M.postMessage({characterMapping:l,textList:C,matchTextRange:t,regular:o,startTime:w,from:"DOMChange"});}let u=M.dispatchMonitorDOMChange;Object.defineProperty(M,"dispatchMonitorDOMChange",{set:function(f){if(u=f,f){let w=ja("html");c([{addedNodes:w,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:w,target:w[0],type:"attributes"}]);}},get:function(){return u}});let p=g.features["netdisk-match-mode"].value;if(p!=="Menu"){let f=U(this.neverTipWorkerInitErrorKey,[]);if(Array.isArray(f)||(f=[f]),this.workerInitError!=null){h.error("初始化Worker失败，可能页面使用了Content-Security-Policy策略，使用代替函数，该函数执行匹配时如果页面的内容过大会导致页面卡死",this.workerInitError);let w=f.find(C=>C===window.location.hostname);w?this.registerWorkerInitErrorNeverTipToast(w):this.dispatchWorkerInitErrorDialog();}}p==="MutationObserver"?(d.mutationObserver(document.documentElement,{callback:c,config:{childList:g.match["mutationObserver-childList"].value,characterData:g.match["mutationObserver-characterData"].value,subtree:g.match["mutationObserver-subtree"].value}}),this.dispatchMonitorDOMChange=true):p==="Menu"?be.add({key:"performPageTextMatchingManually_"+window.location.href,text:"点击执行文本匹配"+(W.isTopWindow()?"":"（iframe）"),autoReload:false,isStoreValue:false,showText(f){return f},callback:()=>{this.dispatchMonitorDOMChange=true;}}):h.error("未知匹配模式："+p);}},Da={$el:{$select:null,$log:null,$matchText:null,$button:null},reset(){Object.keys(this.$el).forEach(a=>{Reflect.deleteProperty(this.$el,a);});},setLog(a,...n){let t="";n.forEach(i=>{t!==""&&(t+=`
`),typeof i!="string"?t+=JSON.stringify(i,undefined,4):t+=i;});let e=x.createElement("p",{innerText:t},{"data-tag":a});x.append(this.$el.$log,e);},clearLog(){x.html(this.$el.$log);},showUI(a){if(this.reset(),d.isNull(a.regexp)){m.error("请先配置regexp");return}let n=this,e=Y.parseRule([a])[0].rule,i=H.confirm({title:{text:`调试规则 ${a.key}`,position:"center"},content:{text:`
                    <div class="custom-rule-container">
                        <textarea class="custom-rule-match-text" placeholder="请输入需要测试匹配的字符串"></textarea>
                        <div class="custom-rule-input-container">
                        <select class="custom-rule-select-regexp"></select>
                        <button class="custom-rule-run-match-button" type="primary" data-icon="" data-righticon="false">
                            <span>执行</span>
                        </button>
                        </div>
                    </div>
                    <div class="custom-rule-match-log">
                        <div>匹配日志↓</div>
                        <div class="custom-rule-match-log-container"></div>
                    </div>
                    `,html:true},btn:{ok:{enable:false}},style:`
                .custom-rule-container{
                    display: flex;
                    align-items: center;
                }
                .custom-rule-select-regexp{
                    width: 100%;
                    height: 32px;
                    line-height: normal;
                    border: 1px solid rgb(184, 184, 184, var(--pops-bd-opacity));
                    border-radius: 5px;
                    text-align: center;
                    outline: 0;
                    background: rgb(255, 255, 255, var(--pops-bg-opacity));
                    box-shadow: none;
                }
                .custom-rule-input-container{
                    display: flex;
                    flex-wrap: wrap;
                    justify-content: center;
                    margin: 5px;
                    width: 30%;
                }
                .custom-rule-select-regexp-item{

                }
                button.custom-rule-run-match-button{
                    margin-top: 5px;
                }
                textarea.custom-rule-match-text{
                    width: 100%;
                    min-height: 70px;
                    outline: none;
                    margin: 0px;
                    background-image: none;
                    background-color: transparent;
                    display: inline-block;
                    resize: vertical;
                    padding: 5px;
                    line-height: normal;
                    box-sizing: border-box;
                    border: 1px solid rgb(220, 223, 230);
                    appearance: none;
                }
                .custom-rule-match-log{

                }
                .custom-rule-match-log-container{
                    padding: 5px;
                    background: rgb(229, 229, 229);
                }
                .custom-rule-match-log-container p{
                    margin: 2px 0px;
                    border-bottom: 1px solid #000000;
                }
                .custom-rule-match-log-container p:last-child{
                    border-bottom: 0px;
                    margin-bottom: 0px;
                }
                .custom-rule-match-log-container p[data-tag]{
                
                }
                .custom-rule-match-log-container p[data-tag="info"]{

                }
                .custom-rule-match-log-container p[data-tag="success"]{
                    color: green;
                }
                .custom-rule-match-log-container p[data-tag="warn"]{
                    color: yellow;
                }
                .custom-rule-match-log-container p[data-tag="error"]{
                    color: red;
                }
                `},k.popsStyle.customRuleDebugView);this.$el.$select=i.$shadowRoot.querySelector(".custom-rule-select-regexp"),this.$el.$matchText=i.$shadowRoot.querySelector(".custom-rule-match-text"),this.$el.$log=i.$shadowRoot.querySelector(".custom-rule-match-log-container"),this.$el.$button=i.$shadowRoot.querySelector(".custom-rule-run-match-button"),e.forEach((o,l)=>{this.$el.$select.appendChild(x.createElement("option",{className:"custom-rule-select-regexp-item",innerText:"regexp下标:"+l,"data-value":o}));});function s(o){Array.isArray(o.msg)?n.setLog(o.status?"info":"error",...o.msg):n.setLog(o.status?"info":"error",o.msg),o.status||n.setLog("error","执行完毕");}function r(){try{if(d.isNull(n.$el.$matchText.value)){m.error("请先输入待匹配的字符串");return}n.clearLog();let o=a.key,l=n.$el.$select.selectedIndex,c=n.$el.$select.selectedOptions[l]["data-value"];h.info("当前选中的规则: ",c);let u={};u[a.key]=[c];let p=[];if(M.handleRegularMatch({characterMapping:_e.getMappingData(),regular:u,textList:[n.$el.$matchText.value],matchTextRange:["innerText","innerHTML"],startTime:Date.now(),from:"Debug"},f=>{p.push(...f.data);}),!p.length){n.setLog("error","未成功匹配到数据");return}p=M.uniqueArr(p),n.setLog("info","成功匹配到的数据 ==> ",p),p.forEach((f,w)=>{n.setLog("success","当前处理的字符串: "+f),n.setLog("success","当前执行: 对shareCode进行处理获取");let C=Ae.handleShareCode(f,c,s);if(d.isNull(C))return;n.setLog("info"," "),n.setLog("info","================分割线================"),n.setLog("info"," "),n.setLog("success","当前执行: 对accessCode进行处理获取");let b=Ae.handleAccessCode(f,c,s);n.setLog("info"," "),n.setLog("info","================分割线================"),n.setLog("info"," "),n.setLog("success","当前执行: 对uiLinkShow进行处理获取");let S=Ae.handleLinkShow(f,c,C,b,s);n.setLog("info"," "),n.setLog("info","================分割线================"),n.setLog("info"," "),n.setLog("success","当前执行: 对blank进行处理获取");let v=Ae.handleBlank(f,c,C,b,s);n.setLog("info"," "),n.setLog("info","================分割线================"),n.setLog("info"," "),n.setLog("success","当前执行: 对copyUrl进行处理获取");let D=Ae.handleCopyUrl(f,c,C,b,s);n.setLog("success","执行完毕");});}catch(o){h.error(o),n.setLog(o.toString());}}x.on(n.$el.$button,"click",undefined,r);}},Ma=`.pops[type-value="confirm"] .pops-confirm-content {\r
	overflow: hidden;\r
}\r
/* textarea美化 */\r
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"]\r
	.pops-confirm-content\r
	textarea {\r
	width: 100%;\r
	height: 100%;\r
	border: none;\r
	outline: none;\r
	padding: 0;\r
	margin: 0;\r
	-webkit-appearance: none;\r
	-moz-appearance: none;\r
	appearance: none;\r
	background-image: none;\r
	background-color: transparent;\r
\r
	display: inline-block;\r
	resize: vertical;\r
	padding: 5px 15px;\r
	line-height: normal;\r
	box-sizing: border-box;\r
	border: 1px solid #dcdfe6;\r
	transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);\r
	appearance: none;\r
	resize: none;\r
}\r
/* 获得焦点 */\r
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"]\r
	.pops-confirm-content\r
	textarea:focus {\r
	outline: none;\r
	border-color: #3677f0;\r
}\r
/* 提示文字 */\r
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"]\r
	.pops-confirm-content\r
	textarea::placeholder {\r
	color: #c0c4cc;\r
}\r
/* 鼠标hover */\r
.pops.whitesevPopNetDiskCustomRules[type-value="confirm"]\r
	.pops-confirm-content\r
	textarea:hover {\r
	border-color: #c0c4cc;\r
}\r
`,Pe={show(a,n){let t="添加";a&&(t="编辑"),t+="链接识别规则";let e=null;function i(l,c){let u=e.value.trim(),p=Y.parseRuleStrToRule(u);if(p.success){let f=p.data;a?Y.setRule(n,f):Y.addRule(f),m.success("保存成功");}else m.error(p.msg);}function s(l){let c=e.value.trim(),u=Y.parseRuleStrToRule(c);if(u.success){let p=u.data;Da.showUI(p);}else m.error(u.msg);}function r(l){try{let c=JSON.parse(e.value),u=Y.getFormatRule(c);e.value=u,m.success("格式化成功");}catch(c){h.error(c),m.error(c.message,{html:true,timeout:3500});}}if(e=H.confirm({title:{text:t,position:"center"},content:{text:'<textarea class="netdisk-custom-rules" placeholder="请输入规则配置"></textarea>',html:true},btn:{merge:true,mergeReverse:false,reverse:false,position:"space-between",ok:{text:"保存",callback:(l,c)=>{i();}},cancel:{text:"调试",callback:(l,c)=>{s();}},other:{enable:true,text:"格式化",type:"xiaomi-primary",callback:(l,c)=>{r();}}},class:"whitesevPopNetDiskCustomRules",style:Ma},k.popsStyle.customRulesView).$shadowRoot.querySelector("textarea"),a){let l=Y.getRule(n);e.value=Y.getFormatRule(l);}else e.value=Y.getTemplateRule();}},st=`div[class^="netdisk-custom-rule-"] {\r
	display: flex;\r
	align-items: center;\r
	margin-left: 10px;\r
	cursor: pointer;\r
}\r
div[class^="netdisk-custom-rule-"] svg,\r
div[class^="netdisk-custom-rule-"] svg {\r
	width: 1.2em;\r
	height: 1.2em;\r
}\r
/* 控件被禁用的颜色 */\r
aside.pops-panel-aside li[data-key][data-function-enable="false"] {\r
	color: #a8abb2;\r
	filter: grayscale(100%);\r
}\r
/* 左侧网盘图标 */\r
aside.pops-panel-aside .netdisk-aside-icon {\r
	width: 20px;\r
	height: 20px;\r
	background-size: 100% 100%;\r
	background-repeat: no-repeat;\r
}\r
/* 设置间隔 */\r
aside.pops-panel-aside ul li {\r
	gap: 4px;\r
}\r
\r
/* mobile模式 */\r
@media screen and (max-width: 600px) {\r
	/* 隐藏左侧网盘图标 */\r
	aside.pops-panel-aside .netdisk-aside-text {\r
		display: none;\r
	}\r
}\r
`,Ue={show(){var e;if(k.Alias.settingAlias){h.error("设置界面已存在"),m.error("设置界面已存在");return}let a=W.getPanelContentConfig(),n=Fe.getRulePanelContent();a=a.concat(n);let t=H.panel({title:{text:`${((e=we==null?undefined:we.script)==null?undefined:e.name)||ct}-设置`,position:"center"},content:a,btn:{close:{enable:true,callback(i){i.close(),k.Alias.settingAlias=undefined;}}},mask:{clickCallBack(i){i(),k.Alias.settingAlias=undefined;}},class:"whitesevPopSetting",style:st},k.popsStyle.settingView);k.Alias.settingAlias=t,this.setRuleHeaderControlsClickEvent(t.$shadowRoot);},showPanel(a={}){},setRuleHeaderControlsClickEvent(a){x.on(a,"click",".netdisk-custom-rule-edit",function(n){let t=n.target,e=t.getAttribute("data-key");t.getAttribute("data-type"),Pe.show(true,e);}),x.on(a,"click",".netdisk-custom-rule-delete",function(n){let t=n.target,e=t.getAttribute("data-key"),i=t.getAttribute("data-type");H.alert({title:{text:"提示",position:"center"},content:{text:`确定删除规则 ${i}(${e}) 吗？`},btn:{ok:{callback(s){if(Y.deleteRule(e)){let o=k.Alias.settingAlias.$shadowRoot.querySelector(`.pops-panel-aside > ul > li[data-key="${e}"]`),l=o.previousElementSibling,c=o.nextElementSibling;l?l.click():c&&c.click(),o==null||o.remove(),m.success("删除成功"),s.close();}else m.error("删除规则失败");}}}});});}},Ta=`.whitesevSuspension {\r
	top: 0;\r
	position: fixed;\r
	right: 10px;\r
	border-radius: 12px;\r
}\r
.whitesevSuspension .whitesevSuspensionMain {\r
	background: #fff;\r
	border: 1px solid #f2f2f2;\r
	box-shadow: 0 0 15px #e4e4e4;\r
	box-sizing: border-box;\r
	border-radius: inherit;\r
	height: inherit;\r
	width: inherit;\r
}\r
.whitesevSuspension .whitesevSuspensionFloor {\r
	border-bottom: 1px solid #f2f2f2;\r
	position: relative;\r
	box-sizing: border-box;\r
	border-radius: inherit;\r
	height: inherit;\r
	width: inherit;\r
}\r
.whitesevSuspension .whitesevSuspensionFloor .netdisk {\r
	background-position: center center;\r
	background-size: 115% 115%;\r
	background-repeat: no-repeat;\r
	display: flex;\r
	align-items: center;\r
	justify-content: center;\r
	border-radius: inherit;\r
	height: inherit;\r
	width: inherit;\r
}\r
.whitesevSuspension .whitesevSuspensionFloor .netdisk:hover {\r
	transition: all 300ms linear;\r
	background-color: #e4e4e4;\r
	transform: scale(1.1);\r
}\r
.whitesevPop-content p[pop] {\r
	height: 100%;\r
}\r
`,J={position:{suspensionX:me("suspensionX",B.width(window)-50),suspensionY:me("suspensionY",(B.height(window)-50)/2),suspensionMaxX:me("susponsionMax-x",B.width(window)-50),suspensionMaxY:me("suspensionMax-y",B.height(window)-50),isRight:me("isRight",false)},mode:{current_suspension_smallwindow_mode:me("current_suspension_smallwindow_mode","suspension")}},Le={suspensionNode:null,isShow:false,isSetEvent:false,isRandBg:false,show(){this.isShow||(this.isShow=true,this.createUI(),this.setSuspensionPosition()),this.isSetEvent||(this.isSetEvent=true,this.setSuspensionEvent(),this.setResizeEventListener()),this.backgroundSwitch(),this.showSuspension();},showSuspension(){this.suspensionNode.style.display="";},hideSuspension(){this.suspensionNode.style.display="none";},isTopWindow(){return ee.self.window===ee.top.window},createUI(){g.suspension.size.value<15&&(g.suspension.size.value=15),g.suspension.size.value>250&&(g.suspension.size.value=250),g.suspension.opacity.value<.1&&(g.suspension.opacity.value=.1),g.suspension.opacity.value>1&&(g.suspension.opacity.value=1);let a=B.createElement("div",{className:"whitesev-suspension-shadow-container"}),n=a.attachShadow({mode:"open"}),t=g.suspension["suspended-z-index"].value;t<=0&&(t=d.getMaxValue(4e4,d.getMaxZIndex(10))),this.suspensionNode=B.createElement("div",{id:"whitesevSuspensionId",className:"whitesevSuspension",innerHTML:`
					<style type="text/css">
						/* 动态生成z-index */
						#whitesevSuspensionId{
							z-index: ${t};;
						}

						${Ta}

					</style>
					<div class="whitesevSuspensionMain">
					<div class="whitesevSuspensionFloor">
						<div class="netdisk"></div>
					</div>
					</div>
                `},{style:`
                    width: ${g.suspension.size.value}px;
                    height: ${g.suspension.size.value}px;
                    opacity: ${g.suspension.opacity.value}
                `}),n.appendChild(this.suspensionNode),document.body.appendChild(a);},setSuspensionEvent(){let a=k.suspension.suspensionNode,n=new Wa(a),t,e=false,i=false,s=0,r=0;n.on("pan",function(o){if(!e){e=true;let l=a.getBoundingClientRect();s=o.x-l.left,r=o.y-l.top,B.css(a,{cursor:"move",transition:"none"});}if(o.phase==="move"){let l=B.width(window)-g.suspension.size.value,c=B.height(window)-g.suspension.size.value,u=o.x-s,p=o.y-r;u=u>l?l:u,p=p>c?c:p,u=u<0?0:u,p=p<0?0:p,Le.saveSuspensionPosition({x:u,y:p}),B.css(a,{left:u+"px",top:p+"px"});}if(o.phase==="end"){e=false,B.css(a,{cursor:"auto"});let l=parseInt(B.css(a,"left"));if(g.suspension["suspended-button-adsorption-edge"].value){let c=0;l>=B.width(window)/2?(c=B.width(window)-g.suspension.size.value,k.suspension.isTopWindow()&&(J.position.isRight.value=true)):k.suspension.isTopWindow()&&(J.position.isRight.value=false),Le.saveSuspensionPosition({x:c}),B.css(a,{left:c+"px"});}B.css(a,{transition:"left 300ms ease 0s"});}}),n.on("tap",function(o){clearTimeout(t),t=undefined,i?(i=false,Ue.show()):(t=setTimeout(()=>{i=false,g.features["netdisk-behavior-mode"].value.includes("smallwindow")&&(J.mode.current_suspension_smallwindow_mode.value="smallwindow",k.suspension.hideSuspension()),k.view.show();},200),i=true);}),k.setGlobalRightClickMenu(a);},saveSuspensionPosition(a){k.suspension.isTopWindow()&&a!=null&&(typeof a.x=="number"&&(J.position.suspensionX.value=a.x),typeof a.y=="number"&&(J.position.suspensionY.value=a.y),J.position.suspensionMaxX.value=J.position.suspensionMaxX.default,J.position.suspensionMaxY.value=J.position.suspensionMaxY.default);},setResizeEventListener(){B.on(globalThis,"resize",undefined,()=>{let a=document.activeElement;if(d.isPhone()){if(["input","textarea"].includes(a.localName))return;if(a.hasAttribute("contenteditable")&&a.getAttribute("contenteditable")==="true"||a.closest("[contenteditable='true']"))return;if(!document.hasFocus())return}this.setSuspensionPosition();});},setSuspensionPosition(){const a=B.width(window)-g.suspension.size.value,n=B.height(window)-g.suspension.size.value,t=J.position.suspensionMaxX.value,e=J.position.suspensionMaxY.value;J.position.suspensionMaxX.default=a,J.position.suspensionMaxY.default=n;let i=J.position.suspensionX.value,s=J.position.suspensionY.value;if(a!==t){let r=i/t;i=a*r;}if(n!==e){let r=s/e;s=n*r;}i>a?i=a:i<0&&(i=0),s>n?s=n:s<0&&(s=0),g.suspension["suspended-button-adsorption-edge"].value&&(J.position.isRight.value?i=a:i=0),Le.saveSuspensionPosition({x:i,y:s}),B.css(k.suspension.suspensionNode,{left:i+"px",top:s+"px"});},backgroundSwitch(){if(this.isRandBg)return;function a(){let r=[];return k.isMatchedNetDiskIconMap.forEach(o=>{r=[...r,k.src.icon[o]];}),r}function n(r,o){t=a(),B.fadeOut(s,r,function(){e++,e=e<t.length?e:0,o=t[e],B.css(s,{"background-image":`url(${o})`}),B.fadeIn(s,r,function(){setTimeout(()=>{n(parseInt(g.suspension["randbg-time"].value.toString()),o);},parseInt(g.suspension["randbg-show-time"].value.toString()));});});}let t=[],e=0;t=a();let i=t[e],s=k.suspension.suspensionNode.querySelector(".whitesevSuspension .netdisk");B.css(s,{"background-image":`url(${i})`}),!(t.length<2||g.suspension["randbg-time"].value<=0)&&(this.isRandBg=true,n(parseInt(g.suspension["randbg-time"].value.toString().toString()),i));}},Je=`.pops-folder-list .list-name-text {\r
	max-width: 300px;\r
}\r
.netdisk-static-link-onefile .pops-folder-list .list-name-text {\r
	max-width: 220px;\r
}\r
.netdisk-static-link-onefile\r
	.pops-mobile-folder-content\r
	.pops-folder-list\r
	.list-name-text {\r
	max-width: unset;\r
}\r
`,Ia={oneFile(a){h.success("成功获取单文件直链",a),H.folder({title:{text:a.title},folder:[{fileName:a.fileName,fileSize:a.fileSize,fileType:a.fileType??"",createTime:a.fileUploadTime||a.fileLatestTime,latestTime:a.fileLatestTime||a.fileUploadTime,isFolder:false,index:0,async clickEvent(){if(typeof a.clickCallBack=="function")a.clickCallBack(a);else return {autoDownload:true,mode:"aBlank",url:a.downloadUrl}}}],btn:{ok:{text:"下载",callback(){typeof a.clickCallBack=="function"?a.clickCallBack(a):window.open(a.downloadUrl,"_blank");}}},class:"netdisk-static-link-onefile",style:Je},k.popsStyle.oneFileStaticView);},moreFile(a,n=[]){h.success("文件解析信息",n),H.folder({title:{text:a},folder:n,style:Je},k.popsStyle.moreFileStaticView);}},La=function(a="密码错误",n="",t,e,i,s=()=>{}){const r=H.prompt({title:{text:a,position:"center",html:false},btn:{reverse:true,position:"end",cancel:{text:"取消",callback(o,l){r.close();}},ok:{callback:o=>{var S,v,D,N;let l=o.text.replace(/[\s]*/gi,""),c=A.handleLinkShow(n,t,e,l,undefined),u=`.netdisk-url a[data-netdisk='${n}'][data-sharecode='${e}']`,p=`.netdiskrecord-link a[data-netdisk='${n}'][data-sharecode='${e}']`,f=(v=(S=k.Alias.uiLinkAlias)==null?undefined:S.$shadowRoot)==null?undefined:v.querySelector(u),w=(N=(D=k.Alias.historyAlias)==null?undefined:D.$shadowRoot)==null?undefined:N.querySelector(p);f&&(f.setAttribute("data-accesscode",l),x.html(f,c)),w&&(w.setAttribute("data-accesscode",l),x.html(w,c)),h.info(`${n} 重新输入的密码：${l}`);let C={isFindInMatchedDict:false,isUpdatedMatchedDict:false,isUpdatedHistoryMatched:false,accessCode:l},b=A.$match.matchedInfo.get(n);if(b.has(e)){C.isFindInMatchedDict=true,C.isUpdatedMatchedDict=true;let $=b.get(e);b.set(e,A.getLinkDickObj(l,t,true,$.matchText));}C.isUpdatedHistoryMatched=Ee.syncAccessCode(n,t,e,l),s(C),o.close();}}},content:{placeholder:"请重新输入密码",focus:true,select:true,text:i==null?"":typeof i=="string"?i:""},style:`
			input{
				font-size: larger;
			}
			`},k.popsStyle.inputNewAccessCodeView);x.listenKeyboard(r.$shadowRoot,"keypress",o=>{o==="Enter"&&r.$shadowRoot.querySelector(".pops-prompt-btn-ok").click();});},Oa=`.pops[type-value="confirm"] .pops-confirm-content {\r
	overflow: hidden;\r
}\r
.netdisk-match-paste-text {\r
	--textarea-bd-color: #dcdfe6;\r
	display: inline-block;\r
	resize: vertical;\r
	padding: 5px 15px;\r
	line-height: normal;\r
	box-sizing: border-box;\r
	color: #606266;\r
	border: 1px solid var(--textarea-bd-color);\r
	border-radius: 4px;\r
	transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);\r
	outline: none;\r
	margin: 0;\r
	-webkit-appearance: none;\r
	-moz-appearance: none;\r
	appearance: none;\r
	background: none;\r
	width: 100%;\r
	height: 100%;\r
	appearance: none;\r
	resize: none;\r
}\r
.netdisk-match-paste-text:hover {\r
	--textarea-bd-color: #c0c4cc;\r
}\r
.netdisk-match-paste-text:focus {\r
	--textarea-bd-color: #3677f0;\r
}\r
`,$a={show(){let a=H.confirm({title:{text:"主动识别文本",position:"center"},content:{text:`
                    <textarea class="netdisk-match-paste-text"></textarea>
                    `,html:true},btn:{ok:{text:"识别",callback(){var t,e;let n=((e=(t=a.popsElement)==null?undefined:t.querySelector(".netdisk-match-paste-text"))==null?undefined:e.value)||"";n.trim()!==""&&(n=V.replaceChinese(n),M.postMessage({characterMapping:[{searchValue:/[\u4e00-\u9fa5]/g,replaceValue:""}],textList:[n],matchTextRange:g.match.pageMatchRange.value,regular:A.$rule.matchRule,startTime:Date.now(),from:"PasteText"}));}}},class:"whitesevPopNetDiskMatchPasteText",style:Oa},k.popsStyle.matchPasteTextView);a.popsElement.querySelector("textarea").focus();},workerMatchEndCallBack(a){a.data.length?m.success(`成功匹配${a.data.length}个，用时${Date.now()-a.startTime}ms`):m.error("未识别到链接");}},k={Alias:{uiLinkAlias:undefined,historyAlias:undefined,settingAlias:undefined},isMatchedNetDiskIconMap:new Set,defaultForbiddenScroll:false,popsStyle:xt,src:{icon:{},hasIcon(a){return Reflect.has(this.icon,a)},addIcon(a,n){return this.hasIcon(a)?(h.warn("图标字典中已存在该icon："+a),false):Reflect.set(this.icon,a,n)}},suspension:Le,view:ie,staticView:Ia,newAccessCodeView:La,netDiskHistoryMatch:Ee,matchPasteText:$a,setGlobalRightClickMenu(a){k.view.registerContextMenu(a,undefined,[{text:"设置",callback(){h.info("右键菜单-打开-"+this.text),Ue.show();}},{text:"历史匹配记录",callback(){h.info("右键菜单-打开-"+this.text),k.netDiskHistoryMatch.show();}},{text:"添加链接识别规则",callback(){h.info("右键菜单-打开-"+this.text),Pe.show(false);}},{text:"网站规则",callback(){h.info("右键菜单-打开-"+this.text),Q.show();}},{text:"字符映射规则",callback(){h.info("右键菜单-打开-"+this.text),_e.show();}},{text:"主动识别文本",callback(){h.info("右键菜单-打开-"+this.text),k.matchPasteText.show();}}]);},setRightClickMenu(a,n,t){let e=[{text:"复制链接",callback:function(i,s,r){let o=s.target;const{netDiskName:l,netDiskIndex:c,shareCode:u,accessCode:p}=ie.praseElementAttributeRuleInfo(o);oe.copy(l,c,u,p);}},{text:"访问链接",callback:function(i,s,r){let o=s.target;const{netDiskName:l,netDiskIndex:c,shareCode:u,accessCode:p}=ie.praseElementAttributeRuleInfo(o);let f=q.getBlankUrl(l,c,u,p);oe.openBlankUrl(f,l,c,u,p);}},{text:"后台打开",callback:function(i,s,r){let o=s.target;const{netDiskName:l,netDiskIndex:c,shareCode:u,accessCode:p}=ie.praseElementAttributeRuleInfo(o);let f=q.getBlankUrl(l,c,u,p);oe.openBlankUrl(f,l,c,u,p,true);}},{text:"修改访问码",callback:function(i,s,r){let o=i.target,l=s.target;const{netDiskName:c,netDiskIndex:u,shareCode:p,accessCode:f}=ie.praseElementAttributeRuleInfo(l);k.newAccessCodeView(this.text,c,u,p,f,w=>{if(t)if(w.isUpdatedMatchedDict){let C=new Date().getTime(),b=l.closest("li").querySelector(".netdiskrecord-update-time");B.text(b,d.formatTime(C)),l.setAttribute("data-accesscode",w.accessCode),m.success(`
										<div style="text-align: left;">旧: ${f}</div>
										<div style="text-align: left;">新: ${w.accessCode}</div>`,{html:true});}else m.error("修改失败");else o.setAttribute("data-accesscode",w.accessCode),w.isUpdatedMatchedDict?m.success(`
										<div style="text-align: left;">旧: ${f}</div>
										<div style="text-align: left;">新: ${w.accessCode}</div>`,{html:true}):w.isFindInMatchedDict?m.error("修改访问码失败"):m.error("修改访问码失败，因为当前已匹配字典中未找到对应的访问码");});}},{text:"复制全部",callback(i,s,r){let l=s.target.closest(".netdisk-url-box-all"),c=[];l.querySelectorAll(n).forEach(u=>{const{netDiskName:p,netDiskIndex:f,shareCode:w,accessCode:C}=ie.praseElementAttributeRuleInfo(u);let b=q.getCopyUrlInfo(p,f,w,C);c.push(b);}),d.setClip(c.join(`
`)).then(u=>{u?m.success("成功复制全部"):m.error("复制全部失败");}).catch(()=>{m.error("复制全部失败");});}}];t||(e.push({text:"删除当前项",callback:function(i,s,r){let o=s.target,l=o.closest(".netdisk-url-box");const{netDiskName:c,netDiskIndex:u,shareCode:p,accessCode:f}=ie.praseElementAttributeRuleInfo(o);let w=false;A.$match.matchedInfo.forEach((C,b)=>{b===c&&C.forEach((S,v)=>{v===p&&(w=true,C.delete(v),h.info("删除：",b,JSON.stringify(S)));});}),A.$match.matchedInfoRuleKey.clear(),A.$match.matchedInfo.forEach((C,b)=>{C.length&&A.$match.matchedInfoRuleKey.add(b);}),w?l.remove():m.error("发生意外情况，未在已匹配到的信息中到对应的网盘信息");}}),e.push({text:"删除所有项",callback:function(i,s,r){let o=s.target,l=o.closest(".netdisk-url-box-all");ie.praseElementAttributeRuleInfo(o),A.$match.matchedInfo.forEach((c,u)=>{c.clear();}),A.$match.matchedInfoRuleKey.clear(),B.html(l,"");}})),k.view.registerContextMenu(a,n,e);}},H={alert(a,n){return a=this.handleDetails(a,n),j.alert(a)},confirm(a,n){return a=this.handleDetails(a,n),j.confirm(a)},loading(a){return typeof a.animation>"u"&&(a.animation=g.pops.popsAnimation.value),typeof a.forbiddenScroll>"u"&&(a.forbiddenScroll=k.defaultForbiddenScroll),j.loading(a)},prompt(a,n){return a=this.handleDetails(a,n),j.prompt(a)},folder(a,n){return a=this.handleDetails(a,n),a.sort={name:g.popsFolder["pops-folder-sort-name"].value,isDesc:g.popsFolder["pops-folder-sort-is-desc"].value,callback(t,e,i,s){g.popsFolder["pops-folder-sort-name"].value=i,g.popsFolder["pops-folder-sort-is-desc"].value=s;}},j.folder(a)},panel(a,n){return a=this.handleDetails(a,n),j.panel(a)},rightClickMenu(a){return a=this.handleDetails(a),j.rightClickMenu(a)},handleDetails(a,n){if(a=Object.assign({animation:g.pops.popsAnimation.value,drag:g.pops.pcDrag.value,dragLimit:g.pops.pcDragLimit.value,forbiddenScroll:k.defaultForbiddenScroll},a),n!=null)if(j.isPhone()){let t=typeof n.Mobile.width=="function"?n.Mobile.width():n.Mobile.width,e=typeof n.Mobile.height=="function"?n.Mobile.height():n.Mobile.height;a.width=t,a.height=e;}else {let t=typeof n.PC.width=="function"?n.PC.width():n.PC.width,e=typeof n.PC.height=="function"?n.PC.height():n.PC.height;a.width=t,a.height=e;}if(a.mask==null&&(a.mask={}),typeof a.mask.enable!="boolean"&&(a.mask.enable=true),a.mask.clickEvent==null&&(a.mask.clickEvent={}),typeof a.mask.clickEvent.toClose!="boolean"&&(a.mask.clickEvent.toClose=g.pops.clickMaskToCloseDialog.value),g.pops.popsAcrylic.value){let t=`
            .pops {
                --acrylic-opacity: 0.7;
                --acrylic-color: rgba(232, 232, 232, var(--acrylic-opacity));
                --acrylic-blur: 30px;
                --acrylic-saturate: 125%;
                --pops-bg-opacity: var(--acrylic-opacity);
            }
            .pops {
                backdrop-filter: blur(var(--acrylic-blur)) saturate(var(--acrylic-saturate)) !important;
                background-color: var(--acrylic-color) !important;
            }
            .pops[type-value=panel]{
                --aside-bg-color: rgba(221, 221, 221, var(--acrylic-opacity));
				--pops-bg-color: #f2f2f2;
				--title-bg-color: var(--acrylic-color);
				--aside-bg-color: var(--acrylic-color);
				--container-item-bg-color: var(--acrylic-color);
            }
            `;typeof a.style=="string"?a.style+=t:a.style=t;}return a.zIndex=()=>{let e=d.getMaxZIndex(10),i=j.config.InstanceUtils.getPopsMaxZIndex(10).zIndex;return d.getMaxValue(99999,e,i)+10},a}};class Fa{constructor(n){O(this,"option");this.option=n;}async showView(){var r;let n=H.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <form class="rule-form-container" onsubmit="return false">
                        <ul class="rule-form-ulist">
                            
                        </ul>
                        <input type="submit" style="display: none;" />
                    </form>
                    `,html:true},btn:d.assign({ok:{callback:async()=>{await s();}}},this.option.btn||{},true),mask:{enable:true},style:`
                ${j.config.cssText.panelCSS}
                
                .rule-form-container {
                    
                }
                .rule-form-container li{
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    padding: 5px 20px;
                    gap: 10px;
                }
                .pops-panel-item-left-main-text{
                    max-width: 150px;
                }
                .pops-panel-item-right-text{
                    padding-left: 30px;
                }
                .pops-panel-item-right-text,
                .pops-panel-item-right-main-text{
                    text-overflow: ellipsis;
                    overflow: hidden;
                    white-space: nowrap;
                }

                ${((r=this.option)==null?undefined:r.style)??""}
            `,width:typeof this.option.width=="function"?this.option.width():window.innerWidth>500?"500px":"88vw",height:typeof this.option.height=="function"?this.option.height():window.innerHeight>500?"500px":"80vh"}),t=n.$shadowRoot.querySelector(".rule-form-container");n.$shadowRoot.querySelector("input[type=submit]");let e=n.$shadowRoot.querySelector(".rule-form-ulist"),i=await this.option.getView(await this.option.data());e.appendChild(i);const s=async()=>{(await this.option.onsubmit(t,await this.option.data())).success&&(n.close(),await this.option.dialogCloseCallBack(true));};}}class Ea{constructor(n){O(this,"option");this.option=n;}showView(){let n=H.alert({title:{text:this.option.title,position:"center"},content:{text:`
                <div class="filter-container"></div>
                `},btn:{ok:{text:"关闭",type:"default"}},mask:{enable:true},width:window.innerWidth>500?"350px":"80vw",height:window.innerHeight>500?"300px":"70vh",style:`
            .filter-container{
                height: 100%;
                display: flex;
                flex-direction: column;
                gap: 20px;
            }
            .filter-container button{
                text-wrap: wrap;
                padding: 8px;
                height: auto;
                text-align: left;
            }
            `}),t=n.$shadowRoot.querySelector(".filter-container"),e=document.createDocumentFragment();this.option.filterOption.forEach(i=>{let s=document.createElement("button");s.innerText=i.name;let r=async()=>{(await this.option.getAllRuleInfo()).forEach(async l=>{await i.filterCallBack(l.data)?x.show(l.$el,false):x.hide(l.$el,false);}),typeof this.option.execFilterCallBack=="function"&&await this.option.execFilterCallBack(),n.close();};x.on(s,"click",async o=>{d.preventEvent(o),!(typeof i.callback=="function"&&!await i.callback(o,r))&&await r();}),e.appendChild(s);}),t.appendChild(e);}}class rt{constructor(n){O(this,"option");this.option=n;}async showView(n){var s,r,o,l,c,u,p,f,w;let t=H.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <div class="rule-view-container">
                    </div>
                    `,html:true},btn:{merge:true,reverse:false,position:"space-between",ok:{enable:((o=(r=(s=this.option)==null?undefined:s.bottomControls)==null?undefined:r.add)==null?undefined:o.enable)||true,type:"primary",text:"添加",callback:async C=>{this.showEditView(false,await this.option.getAddData(),t.$shadowRoot);}},close:{enable:true,callback(C){t.close();}},cancel:{enable:((u=(c=(l=this.option)==null?undefined:l.bottomControls)==null?undefined:c.filter)==null?undefined:u.enable)||false,type:"default",text:"过滤",callback:(C,b)=>{var D,N,$,z,E,T,K;typeof(($=(N=(D=this.option)==null?undefined:D.bottomControls)==null?undefined:N.filter)==null?undefined:$.callback)=="function"&&this.option.bottomControls.filter.callback();let S=()=>Array.from(t.$shadowRoot.querySelectorAll(".rule-view-container .rule-item")),v=b.target.closest(".pops-confirm-btn").querySelector(".pops-confirm-btn-cancel span");x.text(v).includes("取消")?(S().forEach(te=>{x.show(te,false);}),x.text(v,"过滤")):new Ea({title:((E=(z=this.option.bottomControls)==null?undefined:z.filter)==null?undefined:E.title)??"过滤规则",filterOption:((K=(T=this.option.bottomControls)==null?undefined:T.filter)==null?undefined:K.option)||[],execFilterCallBack(){x.text(v,"取消过滤");},getAllRuleInfo:()=>S().map(ae=>({data:this.parseRuleItemElement(ae).data,$el:ae}))}).showView();}},other:{enable:((w=(f=(p=this.option)==null?undefined:p.bottomControls)==null?undefined:f.clear)==null?undefined:w.enable)||true,type:"xiaomi-primary",text:`清空所有(${(await this.option.data()).length})`,callback:C=>{let b=H.confirm({title:{text:"提示",position:"center"},content:{text:"确定清空所有的数据？",html:false},btn:{ok:{enable:true,callback:async S=>{var D,N,$;if(h.success("清空所有"),typeof(($=(N=(D=this.option)==null?undefined:D.bottomControls)==null?undefined:N.clear)==null?undefined:$.callback)=="function"&&this.option.bottomControls.clear.callback(),(await this.option.data()).length){m.error("清理失败");return}else m.success("清理成功");await this.updateDeleteAllBtnText(t.$shadowRoot),this.clearContent(t.$shadowRoot),b.close();}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}}},mask:{enable:true},width:window.innerWidth>500?"500px":"88vw",height:window.innerHeight>500?"500px":"80vh",style:`
            ${j.config.cssText.panelCSS}
            
            .rule-item{
                display: flex;
                align-items: center;
                line-height: normal;
                font-size: 16px;
                padding: 4px 8px;
                gap: 8px;
            }
            .rule-name{
                flex: 1;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            .rule-controls{
                display: flex;
                align-items: center;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
                gap: 8px;
                padding: 0px;
            }
            .rule-controls-enable{
                
            }
            .rule-controls-edit{
                
            }
            .rule-controls-delete{
                
            }
            .rule-controls-edit,
            .rule-controls-delete{
                width: 16px;
                height: 16px;
                cursor: pointer;
            }
            `}),e=await this.option.data(),i=false;for(let C=0;C<e.length;C++){let b=e[C],S=await this.appendRuleItemElement(t.$shadowRoot,b);(typeof n=="function"?n(b):true)||(i=true,S.forEach(D=>{x.hide(D,false);}));}if(i){let C=t.$shadowRoot.querySelector(".pops-confirm-btn-cancel span");x.text(C,"取消过滤");}}parseViewElement(n){let t=n.querySelector(".rule-view-container"),e=n.querySelector(".pops-confirm-btn button.pops-confirm-btn-other");return {$container:t,$deleteBtn:e}}parseRuleItemElement(n){let t=n.querySelector(".rule-controls-enable"),e=t.querySelector(".pops-panel-switch"),i=t.querySelector(".pops-panel-switch__input"),s=t.querySelector(".pops-panel-switch__core"),r=n.querySelector(".rule-controls-edit"),o=n.querySelector(".rule-controls-delete");return {$enable:t,$enableSwitch:e,$enableSwitchInput:i,$enableSwitchCore:s,$edit:r,$delete:o,data:Reflect.get(n,"data-rule")}}async createRuleItemElement(n,t){let e=await this.option.getDataItemName(n),i=x.createElement("div",{className:"rule-item",innerHTML:`
			<div class="rule-name">${e}</div>
			<div class="rule-controls">
				<div class="rule-controls-enable">
					<div class="pops-panel-switch">
						<input class="pops-panel-switch__input" type="checkbox">
						<span class="pops-panel-switch__core">
							<div class="pops-panel-switch__action">
							</div>
						</span>
					</div>
				</div>
				<div class="rule-controls-edit">
					${j.config.iconSVG.edit}
				</div>
				<div class="rule-controls-delete">
					${j.config.iconSVG.delete}
				</div>
			</div>
			`});Reflect.set(i,"data-rule",n);let s="pops-panel-switch-is-checked";const{$enable:r,$enableSwitch:o,$enableSwitchCore:l,$enableSwitchInput:c,$delete:u,$edit:p}=this.parseRuleItemElement(i);return this.option.itemControls.enable.enable?(x.on(l,"click",async f=>{let w=false;o.classList.contains(s)?(o.classList.remove(s),w=false):(o.classList.add(s),w=true),c.checked=w,await this.option.itemControls.enable.callback(n,w);}),await this.option.itemControls.enable.getEnable(n)&&o.classList.add(s)):r.remove(),this.option.itemControls.edit.enable?x.on(p,"click",f=>{d.preventEvent(f),this.showEditView(true,n,t,i,w=>{n=null,n=w;});}):p.remove(),this.option.itemControls.delete.enable?x.on(u,"click",f=>{d.preventEvent(f);let w=H.confirm({title:{text:"提示",position:"center"},content:{text:"确定删除该条数据？",html:false},btn:{ok:{enable:true,callback:async C=>{h.success("删除数据"),await this.option.itemControls.delete.deleteCallBack(n)?(m.success("成功删除该数据"),i.remove(),await this.updateDeleteAllBtnText(t),w.close()):m.error("删除该数据失败");}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}):u.remove(),i}async appendRuleItemElement(n,t){let{$container:e}=this.parseViewElement(n),i=[],s=Array.isArray(t)?t:[t];for(let r=0;r<s.length;r++){let o=s[r],l=await this.createRuleItemElement(o,n);e.appendChild(l),i.push(l);}return await this.updateDeleteAllBtnText(n),i}async updateRuleContaienrElement(n){this.clearContent(n),this.parseViewElement(n);let t=await this.option.data();await this.appendRuleItemElement(n,t),await this.updateDeleteAllBtnText(n);}async updateRuleItemElement(n,t,e){let i=await this.createRuleItemElement(n,e);t.after(i),t.remove();}clearContent(n){const{$container:t}=this.parseViewElement(n);x.html(t,"");}setDeleteBtnText(n,t,e=false){const{$deleteBtn:i}=this.parseViewElement(n);e?x.html(i,t):x.text(i,t);}async updateDeleteAllBtnText(n){let t=await this.option.data();this.setDeleteBtnText(n,`清空所有(${t.length})`);}showEditView(n,t,e,i,s,r){let o=async c=>{if(c){if(typeof r=="function"){let u=await this.option.getData(t);r(u);}}else if(n||await this.option.deleteData(t),typeof s=="function"){let u=await this.option.getData(t);s(u);}};new Fa({title:n?"编辑":"添加",data:()=>t,dialogCloseCallBack:o,getView:async c=>await this.option.itemControls.edit.getView(c,n),btn:{ok:{enable:true,text:n?"修改":"添加"},cancel:{callback:async(c,u)=>{c.close(),await o(false);}},close:{callback:async(c,u)=>{c.close(),await o(false);}}},onsubmit:async(c,u)=>{let p=await this.option.itemControls.edit.onsubmit(c,n,u);return p.success?n?(m.success("修改成功"),e&&await this.updateRuleItemElement(p.data,i,e)):e&&await this.appendRuleItemElement(e,p.data):n&&m.error("修改失败"),p},style:this.option.itemControls.edit.style,width:this.option.itemControls.edit.width,height:this.option.itemControls.edit.height}).showView();}}const We=function(a,n,t,e,i,s,r,o,l){return {text:a,type:"button",description:n,attributes:{},props:{},buttonIcon:e,buttonIsRightIcon:i,buttonIconIsLoading:s,buttonType:r,buttonText:t,callback(u){typeof o=="function"&&o(u);},afterAddToUListCallBack:l}},Pa=`/* 容器 */\r
.website-rule-container {\r
}\r
/* 每一条规则 */\r
.website-rule-item {\r
	display: flex;\r
	align-items: center;\r
	line-height: normal;\r
	font-size: 16px;\r
	padding: 4px 4px;\r
	gap: 6px;\r
}\r
/* 规则名 */\r
.website-rule-item .website-rule-name {\r
	flex: 1;\r
	white-space: nowrap;\r
	text-overflow: ellipsis;\r
	overflow: hidden;\r
}\r
/* 操作按钮 */\r
.website-rule-item .website-controls {\r
	display: flex;\r
	align-items: center;\r
	text-overflow: ellipsis;\r
	overflow: hidden;\r
	white-space: nowrap;\r
	gap: 8px;\r
	padding: 0px 4px;\r
}\r
/* 编辑和删除按钮 */\r
.website-rule-item .website-rule-edit,\r
.website-rule-item .website-rule-delete {\r
	width: 16px;\r
	height: 16px;\r
	cursor: pointer;\r
}\r
/* 启用按钮 */\r
.website-rule-item .website-rule-enable {\r
}\r
/* 编辑按钮 */\r
.website-rule-item .website-rule-edit {\r
}\r
/* 删除按钮 */\r
.website-rule-item .website-rule-delete {\r
}\r
`;function ot(a){if(a===null||typeof a!="object")return a;let n=Array.isArray(a)?[]:{};for(let t in a)a.hasOwnProperty(t)&&(n[t]=ot(a[t]));return n}const Q={$data:{STORAGE_KEY:"rule",isShowEditView:false},init(){},getTemplateData(){return {uuid:d.generateUUID(),enable:true,name:"",url:"",data:{}}},getRuleView(a){const n=this;let t=j.config.panelHandleContentUtils(),e=a??this.getTemplateData();function i(o){return {get(l,c){return o[l]??c},set(l,c){o[l]=c;}}}function s(o){return {get(l,c){let u=Q.getRule(o)??e,p=W.getValue(l,c);return (u&&Reflect.get(u.data,l))??p},set(l,c){let u=Q.getRule(o)??e;Reflect.set(u.data,l,c),Q.updateRule(u);}}}return new rt({title:"网站规则",data:()=>this.getAllRule(),getAddData:()=>e,getDataItemName:o=>o.name??o.url,updateData:o=>this.updateRule(o),deleteData:o=>(n.$data.isShowEditView=false,this.deleteRule(o.uuid)),getData:o=>this.getAllRule().find(u=>u.uuid===o.uuid)??o,itemControls:{enable:{enable:true,getEnable(o){return o.enable},callback:(o,l)=>{o.enable=l,this.updateRule(o);}},edit:{enable:true,getView:(o,l)=>{n.$data.isShowEditView=true;let c=document.createDocumentFragment();l||(o=e);let u=F("启用","enable",true);Reflect.set(u.props,P,i(o));let p=t.createSectionContainerItem_switch(u),f=se("规则名称","name","","",undefined,"必填");Reflect.set(f.props,P,i(o));let w=t.createSectionContainerItem_input(f),C=se("匹配网址","url","","",undefined,"必填，可正则");Reflect.set(C.props,P,i(o));let b=t.createSectionContainerItem_input(C),S=We("覆盖设置","","自定义",undefined,false,false,"primary",D=>{d.preventEvent(D);let N=W.getPanelContentConfig().concat(Fe.getRulePanelContent()),$=ot(N);function z(E){E.forEach(T=>{if(typeof(T==null?undefined:T.props)=="object"&&Reflect.has(T.props,P)){let te=s(o.uuid);Reflect.set(T.props,P,te);}let K=T.forms;K&&Array.isArray(K)&&z(K);});}for(let E=0;E<$.length;E++){let T=$[E];if(!T.forms)continue;if(typeof T.afterRender=="function"&&(T!=null&&T.id.toString().startsWith("netdisk-panel-config-"))&&(T.afterRender=te=>{let ae=te.asideConfig.attributes["data-key"],de=L.function.enable(ae);te.$asideLiElement.setAttribute("data-function-enable",Q.getRuleDataValue(o.uuid,de,true));}),typeof T.attributes=="object"&&T.forms!=null&&le in T.attributes){let te=T.attributes[le],ae=F("启用",Oe.features.customAccessCodeEnable(te),false,undefined,"启用后将允许执行下面的功能",undefined);Reflect.set(ae.props,P,s(o.uuid));let de=se("自定义访问码",Oe.features.customAccessCode(te),"","让获取的到的链接的访问码都为自定义的访问码",undefined,"请输入自定义访问码",false,false);Reflect.set(de.props,P,s(o.uuid));let Re={text:"额外功能",type:"forms",forms:[ae,de]};T.forms.length?T.forms.splice(1,0,Re):T.forms.push(Re);}let K=T.forms;K&&Array.isArray(K)&&z(K);}H.panel({title:{text:"覆盖设置",position:"center"},content:$,btn:{close:{enable:true,callback(E){E.close();}}},mask:{clickCallBack(E){E();}},only:false,class:"whitesevPopSetting",style:`
										${st}
										
										${Pa}


										/* 隐藏顶部的图标 */
										.netdisk-custom-rule-edit,
										.netdisk-custom-rule-delete,
										/* 隐藏快捷键设置菜单，因为这个是全局唯一的 */
										.netdisk-panel-forms-shortcut-keys-deepMenu{
											display: none !important;
										}
										`},k.popsStyle.settingView);},undefined),v=t.createSectionContainerItem_button(S);return c.appendChild(p),c.appendChild(w),c.appendChild(b),c.appendChild(v),c},onsubmit:(o,l,c)=>{let u=o.querySelectorAll(".rule-form-ulist > li"),p=e;if(l){p.uuid=c.uuid;let w=this.getAllRule().find(C=>C.uuid===p.uuid);w&&(p.data=w.data);}return u.forEach(f=>{let w=Reflect.get(f,"__formConfig__"),C=Reflect.get(w,"attributes"),b=Reflect.get(f,P),S=Reflect.get(C,le);if(S==null)return;let v=Reflect.get(C,pe),D=b.get(S,v);Reflect.has(p,S)?Reflect.set(p,S,D):Reflect.has(p.data,S)?Reflect.set(p.data,S,D):h.error(`${S}不在数据中`);}),p.name==null||p.name.trim()===""?(m.error("规则名称不能为空"),{success:false,data:p}):p.url.trim()===""?(m.error("匹配网址不能为空"),{success:false,data:p}):l?{success:this.updateRule(p),data:p}:{success:this.addRule(p),data:p}}},delete:{enable:true,deleteCallBack:o=>this.deleteRule(o.uuid)}},bottomControls:{filter:{enable:true,title:"过滤规则",option:[{name:"过滤【已启用】的规则",filterCallBack(o){return o.enable}},{name:"过滤【未启用】的规则",filterCallBack(o){return !o.enable}},{name:"过滤【在当前网址生效】的规则",filterCallBack(o){let l=new RegExp(o.url,"ig");return !!window.location.href.match(l)}}]}}})},show(){this.getRuleView().showView();},addRule(a){let n=this.getAllRule();return n.push(a),Ce.set(this.$data.STORAGE_KEY,n),true},getRule(a){return this.getAllRule().find(n=>n.uuid===a)},getRuleData(a){var n;return typeof a=="string"?(n=this.getRule(a))==null?undefined:n.data:a.data},getRuleDataValue(a,n,t){let e=this.getRuleData(a);return (e&&Reflect.get(e,n))??t},updateRule(a){let n=this.getAllRule(),t=false;for(let e=0;e<n.length;e++)if(n[e].uuid===a.uuid){n[e]=a,t=true;break}return Ce.set(this.$data.STORAGE_KEY,n),t},updateRuleValue(a,n,t){let e=this.getAllRule();for(let i=0;i<e.length;i++){const s=e[i];if(s.uuid===a){Reflect.set(s,n,t);break}}Ce.set(this.$data.STORAGE_KEY,e);},deleteRule(a){let n=this.getAllRule(),t=false,e=typeof a=="string"?a:a.uuid;for(let i=0;i<n.length;i++)if(n[i].uuid===e){n.splice(i,1),t=true;break}return Ce.set(this.$data.STORAGE_KEY,n),t},deleteAllRule(){Ce.delete(this.$data.STORAGE_KEY);},getAllRule(){return Ce.get(this.$data.STORAGE_KEY,[])},getUrlMatchedRule(a=window.location.href){return this.getAllRule().filter(t=>{let e=new RegExp(t.url,"ig");return !!a.match(e)})}},Ce=new Xe("websiteRule"),Ua=(a,n,t)=>{if(Q.$data.isShowEditView)return n;let i=Q.getUrlMatchedRule().find(s=>{if(!s.enable)return  false;let r=Q.getRuleData(s);return Reflect.has(r,a)});return i?Reflect.get(Q.getRuleData(i),a):n},za=function(a,n,t){return {KEY:a,default:n,get value(){let e=U(a,n);return typeof t=="function"?t(a,e,n):e},set value(e){Z(a,e);}}},R=function(a,n){return za(a,n,Ua)},g={toast:{position:R("qmsg-config-position","top"),maxnums:R("qmsg-config-maxnums",3),showreverse:R("qmsg-config-showreverse",true)},pops:{popsAnimation:R("popsAnimation","pops-anim-fadein-zoom"),clickMaskToCloseDialog:R("clickMaskToCloseDialog",true),pcDrag:R("pcDrag",true),pcDragLimit:R("pcDragLimit",true),popsAcrylic:R("popsAcrylic",false)},popsFolder:{"pops-folder-sort-name":R("pops-folder-sort-name","fileName"),"pops-folder-sort-is-desc":R("pops-folder-sort-is-desc",false)},smallIconNavgiator:{"pops-netdisk-icon-click-event-find-sharecode":R("pops-netdisk-icon-click-event-find-sharecode",true),"pops-netdisk-icon-click-event-find-sharecode-with-select":R("pops-netdisk-icon-click-event-find-sharecode-with-select",true),"pops-netdisk-icon-click-event-loop-find-sharecode":R("pops-netdisk-icon-click-event-loop-find-sharecode",true)},suspension:{size:R("size",50),opacity:R("opacity",1),"randbg-time":R("randbg-time",1500),"randbg-show-time":R("randbg-show-time",1200),"suspended-button-adsorption-edge":R("suspended-button-adsorption-edge",false),"suspended-z-index":R("suspended-z-index",-1)},smallWindow:{"netdisk-ui-small-window-width":R("netdisk-ui-small-window-width",250),"netdisk-ui-small-window-max-height":R("netdisk-ui-small-window-max-height",200),"netdisk-link-view-z-index":R("netdisk-link-view-z-index",-1)},historyMatch:{saveMatchNetDisk:R("saveMatchNetDisk",false),"netdisk-history-match-ordering-rule":R("netdisk-history-match-ordering-rule","按 更新时间 - 降序"),"netdisk-history-match-merge-same-link":R("netdisk-history-match-merge-same-link",true)},match:{pageMatchRange:R("pageMatchRange",["innerText","innerHTML"]),depthQueryWithShadowRoot:R("depthQueryWithShadowRoot",false),readClipboard:R("readClipboard",false),allowMatchLocationHref:R("allowMatchLocationHref",true),toBeMatchedWithInputElementValue:R("to-be-matched-inputElementValue",false),toBeMatchedTextAreaElementValue:R("to-be-matched-textAreaElementValue",false),delaytime:R("delaytime",.8),isAddedNodesToMatch:R("isAddedNodesToMatch",false),"mutationObserver-childList":R("mutationObserver-childList",true),"mutationObserver-characterData":R("mutationObserver-characterData",true),"mutationObserver-subtree":R("mutationObserver-subtree",true)},features:{"netdisk-match-mode":R("netdisk-match-mode","MutationObserver"),"netdisk-behavior-mode":R("netdisk-behavior-mode","suspension_smallwindow"),autoFillAccessCode:R("autoFillAccessCode",true)},shareCode:{excludeIdenticalSharedCodesCoefficient:R("excludeIdenticalSharedCodesCoefficient",1),excludeIdenticalSharedCodes:R("excludeIdenticalSharedCodes",false)},accessCode:{allowQueryHistoryMatchingAccessCode:R("allowQueryHistoryMatchingAccessCode",true)}};class Va{constructor(n){O(this,"CONFIG",{data:[],pageCount:5,pageStep:3,currentPage:1,pageChangeCallBack:function(n){},prevBtn:{enable:true,callBack:function(){}},nextBtn:{enable:true,callBack:function(){}},firstBtn:{enable:true,callBack:function(){}},lastBtn:{enable:true,callBack:function(){}}});O(this,"PAGE_CONFIG",{getCurrentPage:()=>this.DOM_CONFIG.getAttributeWithPageId(this.DOM_CONFIG.getAttributeWithCurrentPage()),maxPage:1});O(this,"DOM_CONFIG",{dataPagingNode:{localName:"div",id:"whitesev-datapaging",dom:null},firstBtnNode:{localName:"a",className:"pg-first",svgHTML:'<svg t="1694497357294" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4758" width="20"><path d="M730.639277 211.376748l60.943177 60.943176-301.698894 301.698893L428.940384 513.075641z" p-id="4759"></path><path d="M730.496772 814.924547l60.943176-60.943176-301.698893-301.698893L428.797879 513.225654z" p-id="4760"></path><path d="M298.666667 213.333333h85.333333v597.333334H298.666667z" p-id="4761"></path></svg>',get:()=>this.DOM_CONFIG.dataPagingNode.dom.querySelector(`${this.DOM_CONFIG.firstBtnNode.localName}.${this.DOM_CONFIG.firstBtnNode.className}`)},prevBtnNode:{localName:"a",className:"pg-prev",svgHTML:'<svg t="1694497840770" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5272" width="20"><path d="M620.322607 151.04875l60.943176 60.943176-362.038672 362.038672L258.283935 513.087422z" p-id="5273"></path><path d="M620.180101 875.252545l60.943177-60.943176-362.038672-362.038672L258.141429 513.213873z" p-id="5274"></path></svg>',get:()=>this.DOM_CONFIG.dataPagingNode.dom.querySelector(`${this.DOM_CONFIG.prevBtnNode.localName}.${this.DOM_CONFIG.prevBtnNode.className}`)},nextBtnNode:{localName:"a",className:"pg-next",svgHTML:'<svg t="1694497949481" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5465" width="20"><path d="M403.399239 151.02258l-60.943177 60.943177 362.038672 362.038672L765.437911 513.061252z" p-id="5466"></path><path d="M403.576858 875.263008l-60.943176-60.943176 362.038672-362.038672L765.61553 513.224336z" p-id="5467"></path></svg>',get:()=>this.DOM_CONFIG.dataPagingNode.dom.querySelector(`${this.DOM_CONFIG.nextBtnNode.localName}.${this.DOM_CONFIG.nextBtnNode.className}`)},lastBtnNode:{localName:"a",className:"pg-last",svgHTML:'<svg t="1694498035538" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2299" width="20"><path d="M516.266667 490.666667L256 230.4 315.733333 170.666667l320 320L315.733333 810.666667 256 750.933333l260.266667-260.266666zM678.4 170.666667h85.333333v640h-85.333333V170.666667z" p-id="2300"></path></svg>',get:()=>this.DOM_CONFIG.dataPagingNode.dom.querySelector(`${this.DOM_CONFIG.lastBtnNode.localName}.${this.DOM_CONFIG.lastBtnNode.className}`)},setAttributeWithPageId:(n,t)=>{n.setAttribute("page-id",t);},getAttributeWithPageId:n=>n!=null&&n.getAttribute("page-id")?parseInt(n.getAttribute("page-id")):null,hasAttributeWithPageId:n=>n.hasAttribute("page-id"),setAttributeWithCurrentPage:n=>{n.setAttribute("data-current-page","");},getAttributeWithCurrentPage:n=>(n||this.DOM_CONFIG.dataPagingNode.dom).querySelector("a[data-current-page]"),hasAttributeWithCurrentPage:n=>n.hasAttribute("data-current-page"),removeAttributeWithCurrentPage:n=>{n.removeAttribute("data-current-page");},setAttributeWithDisabled:n=>{n.setAttribute("disabled","true");},removeAllAttributeWithDisabled:n=>{(n||this.DOM_CONFIG.dataPagingNode.dom).querySelectorAll("a[class][disabled]").forEach(t=>{t.removeAttribute("disabled");});},getFirstPageNode:n=>(n||this.DOM_CONFIG.dataPagingNode.dom).querySelector("a[page-id='1']"),getLastPageNode:n=>(n||this.DOM_CONFIG.dataPagingNode.dom).querySelector(`a[page-id='${this.PAGE_CONFIG.maxPage}']`),getAllPageNode:n=>(n||this.DOM_CONFIG.dataPagingNode.dom).querySelectorAll("a[page-id]")});this.changeConfig(n);}addCSS(n=document.head){let t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=`@charset "utf-8";
		#${this.DOM_CONFIG.dataPagingNode.id} {
			text-align: center;
			display: inline-block;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} .${this.DOM_CONFIG.firstBtnNode.className},
		#${this.DOM_CONFIG.dataPagingNode.id} .${this.DOM_CONFIG.prevBtnNode.className},
		#${this.DOM_CONFIG.dataPagingNode.id} .${this.DOM_CONFIG.nextBtnNode.className},
		#${this.DOM_CONFIG.dataPagingNode.id} .${this.DOM_CONFIG.lastBtnNode.className} {
			font-family: Arial, sans-serif;
			color: #333;
			font-size: 22px;
			fill: currentColor;
			display: inline-flex;
			justify-content: center;
			align-items: center;
			text-decoration: none;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} a,
		#${this.DOM_CONFIG.dataPagingNode.id} span {
			width: 45px;
			height: 40px;
			border: 1px solid #ebebeb;
			margin-left: -1px;
			color: #000000;
			line-height: 40px;
			float: left;
			font-size: 15px;
			text-decoration: none;
			margin: 0 2px;
			border-radius: 6px;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} a:hover,
		#${this.DOM_CONFIG.dataPagingNode.id} span:hover {
			border-color: #3897cd;
			color: #3897cd;
			position: relative;
			z-index: 1;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} a {
			cursor: pointer;
			user-select: none;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} a[data-current-page] {
			background-color: #222a35;
			color: #fff;
			border-color: #ebebeb;
			position: relative;
			z-index: 1;
		}
		#${this.DOM_CONFIG.dataPagingNode.id} a.${this.DOM_CONFIG.firstBtnNode.className}[disabled="true"],
		#${this.DOM_CONFIG.dataPagingNode.id} a.${this.DOM_CONFIG.prevBtnNode.className}[disabled="true"],
		#${this.DOM_CONFIG.dataPagingNode.id} a.${this.DOM_CONFIG.nextBtnNode.className}[disabled="true"],
		#${this.DOM_CONFIG.dataPagingNode.id} a.${this.DOM_CONFIG.lastBtnNode.className}[disabled="true"]{
			cursor: not-allowed;
			border: 1px solid transparent;
			color: #c9c9c9;
		}
		`,n.appendChild(t);}getDataPagingNode(){let n=this,t=document.createElement(n.DOM_CONFIG.dataPagingNode.localName);n.DOM_CONFIG.dataPagingNode.dom=t,t.id=n.DOM_CONFIG.dataPagingNode.id;let e=document.createElement(n.DOM_CONFIG.firstBtnNode.localName);e.innerHTML=n.DOM_CONFIG.firstBtnNode.svgHTML;let i=document.createElement(n.DOM_CONFIG.prevBtnNode.localName);i.innerHTML=n.DOM_CONFIG.prevBtnNode.svgHTML;let s=document.createElement(n.DOM_CONFIG.nextBtnNode.localName);s.innerHTML=n.DOM_CONFIG.nextBtnNode.svgHTML;let r=document.createElement(n.DOM_CONFIG.lastBtnNode.localName);if(r.innerHTML=n.DOM_CONFIG.lastBtnNode.svgHTML,e.className=n.DOM_CONFIG.firstBtnNode.className,i.className=n.DOM_CONFIG.prevBtnNode.className,s.className=n.DOM_CONFIG.nextBtnNode.className,r.className=n.DOM_CONFIG.lastBtnNode.className,n.PAGE_CONFIG.maxPage=Math.ceil(n.CONFIG.data.length/n.CONFIG.pageCount),n.CONFIG.currentPage<1?n.CONFIG.currentPage=1:n.CONFIG.currentPage>n.PAGE_CONFIG.maxPage&&(n.CONFIG.currentPage=n.PAGE_CONFIG.maxPage),n.PAGE_CONFIG.maxPage<2)return t;n.CONFIG.firstBtn.enable&&(this.setFirstBtnClickEvent(e,t),t.appendChild(e)),n.CONFIG.prevBtn.enable&&(this.setPrevBtnClickEvent(i,t),t.appendChild(i));let o=n.CONFIG.currentPage;if(n.CONFIG.pageStep>n.PAGE_CONFIG.maxPage)for(let l=o;l<=n.PAGE_CONFIG.maxPage;l++){let c=document.createElement("a");n.DOM_CONFIG.setAttributeWithPageId(c,l),c.innerText=l,n.CONFIG.currentPage===l&&n.DOM_CONFIG.setAttributeWithCurrentPage(c),this.setPageBtnClickEvent(c,t),t.appendChild(c);}else if(o+n.CONFIG.pageStep>n.PAGE_CONFIG.maxPage){o=n.PAGE_CONFIG.maxPage;let l=[];for(let c=0;c<n.CONFIG.pageStep;c++){let u=document.createElement("a");n.DOM_CONFIG.setAttributeWithPageId(u,o),u.innerText=o,n.CONFIG.currentPage===o&&n.DOM_CONFIG.setAttributeWithCurrentPage(u),this.setPageBtnClickEvent(u,t),l=[...l,u],o--;}l.reverse(),l.forEach(c=>{t.appendChild(c);});}else for(let l=0;l<n.CONFIG.pageStep;l++){let c=document.createElement("a");n.DOM_CONFIG.setAttributeWithPageId(c,o),c.innerText=o,n.CONFIG.currentPage===o&&n.DOM_CONFIG.setAttributeWithCurrentPage(c),this.setPageBtnClickEvent(c,t),t.appendChild(c),o++;}return n.CONFIG.nextBtn.enable&&(this.setNextBtnClickEvent(s,t),t.appendChild(s)),n.CONFIG.lastBtn.enable&&(this.setLastBtnClickEvent(r,t),t.appendChild(r)),n.CONFIG.currentPage===1?(n.DOM_CONFIG.setAttributeWithDisabled(n.DOM_CONFIG.firstBtnNode.get()),n.DOM_CONFIG.setAttributeWithDisabled(n.DOM_CONFIG.prevBtnNode.get())):n.CONFIG.currentPage===n.PAGE_CONFIG.maxPage&&(n.DOM_CONFIG.setAttributeWithDisabled(n.DOM_CONFIG.nextBtnNode.get()),n.DOM_CONFIG.setAttributeWithDisabled(n.DOM_CONFIG.lastBtnNode.get())),t}setFirstBtnClickEvent(n,t){let e=this;n.onclick=function(){let i=e.DOM_CONFIG.getAttributeWithCurrentPage();if(e.DOM_CONFIG.getAttributeWithPageId(i)===1)return;e.CONFIG.firstBtn.callBack();let s=e.DOM_CONFIG.getAllPageNode(t);for(let r=0;r<e.CONFIG.pageStep;r++){let o=s[r];r===0?e.DOM_CONFIG.setAttributeWithCurrentPage(o):e.DOM_CONFIG.removeAttributeWithCurrentPage(o),e.DOM_CONFIG.setAttributeWithPageId(o,r+1),o.innerText=r+1;}e.DOM_CONFIG.removeAllAttributeWithDisabled(t),e.DOM_CONFIG.getFirstPageNode(t)&&(e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.firstBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.prevBtnNode.get())),e.CONFIG.pageChangeCallBack(1);};}setPrevBtnClickEvent(n,t){let e=this;n.onclick=function(){let i=e.DOM_CONFIG.getAttributeWithCurrentPage();e.DOM_CONFIG.getAttributeWithPageId(i)!==1&&(e.CONFIG.prevBtn.callBack(),e.DOM_CONFIG.hasAttributeWithPageId(i.previousElementSibling)?i.previousElementSibling.click():(e.DOM_CONFIG.getAllPageNode(t).forEach((r,o)=>{let l=e.DOM_CONFIG.getAttributeWithPageId(r);l--,e.DOM_CONFIG.setAttributeWithPageId(r,l),r.innerText=l;}),e.CONFIG.pageChangeCallBack(e.PAGE_CONFIG.getCurrentPage())),e.DOM_CONFIG.removeAllAttributeWithDisabled(t),e.DOM_CONFIG.getFirstPageNode(t)&&e.PAGE_CONFIG.getCurrentPage()==1&&(e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.firstBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.prevBtnNode.get())));};}setNextBtnClickEvent(n,t){let e=this;n.onclick=function(){let i=e.DOM_CONFIG.getAttributeWithCurrentPage();e.DOM_CONFIG.getAttributeWithPageId(i)!==e.PAGE_CONFIG.maxPage&&(e.CONFIG.nextBtn.callBack(),e.DOM_CONFIG.hasAttributeWithPageId(i.nextElementSibling)?i.nextElementSibling.click():(e.DOM_CONFIG.getAllPageNode(t).forEach((r,o)=>{let l=e.DOM_CONFIG.getAttributeWithPageId(r);l++,!(l>e.PAGE_CONFIG.maxPage)&&(e.DOM_CONFIG.setAttributeWithPageId(r,l),r.innerText=l);}),e.CONFIG.pageChangeCallBack(e.PAGE_CONFIG.getCurrentPage())),e.DOM_CONFIG.removeAllAttributeWithDisabled(t),e.DOM_CONFIG.getLastPageNode()&&e.PAGE_CONFIG.getCurrentPage()==e.PAGE_CONFIG.maxPage&&(e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.nextBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.lastBtnNode.get())));};}setLastBtnClickEvent(n,t){let e=this;n.onclick=function(){let i=e.DOM_CONFIG.getAttributeWithCurrentPage();if(e.DOM_CONFIG.getAttributeWithPageId(i)===e.PAGE_CONFIG.maxPage)return;e.CONFIG.lastBtn.callBack();let s=Array.from(e.DOM_CONFIG.getAllPageNode(t));s.reverse();let r=e.PAGE_CONFIG.maxPage,o=0;for(;!(e.PAGE_CONFIG.maxPage-r>3);){let l=s[o];if(l==null)break;o===0?e.DOM_CONFIG.setAttributeWithCurrentPage(l):e.DOM_CONFIG.removeAttributeWithCurrentPage(l),e.DOM_CONFIG.setAttributeWithPageId(l,r),l.innerText=r,r--,o++;}e.DOM_CONFIG.removeAllAttributeWithDisabled(t),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.nextBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.lastBtnNode.get()),e.CONFIG.pageChangeCallBack(e.PAGE_CONFIG.maxPage);};}setPageBtnClickEvent(n,t){let e=this;n.onclick=function(i){let s=i.target;e.DOM_CONFIG.getAllPageNode(t).forEach(r=>{r==s?e.DOM_CONFIG.hasAttributeWithCurrentPage(s)||(e.DOM_CONFIG.setAttributeWithCurrentPage(s),e.CONFIG.pageChangeCallBack(e.PAGE_CONFIG.getCurrentPage())):e.DOM_CONFIG.removeAttributeWithCurrentPage(r);}),e.DOM_CONFIG.removeAllAttributeWithDisabled(t),e.DOM_CONFIG.getFirstPageNode(t)&&e.PAGE_CONFIG.getCurrentPage()==1&&(e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.firstBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.prevBtnNode.get())),e.DOM_CONFIG.getLastPageNode()&&e.PAGE_CONFIG.getCurrentPage()==e.PAGE_CONFIG.maxPage&&(e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.nextBtnNode.get()),e.DOM_CONFIG.setAttributeWithDisabled(e.DOM_CONFIG.lastBtnNode.get()));};}append(n){var e;let t=this;(e=t.DOM_CONFIG.dataPagingNode.dom)==null||e.remove(),t.DOM_CONFIG.dataPagingNode.dom=null,n.appendChild(t.getDataPagingNode());}changeConfig(n){Object.assign(this.CONFIG,n);}refresh(n){if(n.length===this.CONFIG.data.length)return;this.CONFIG.data=[],this.CONFIG.data=n;let t=this.PAGE_CONFIG.getCurrentPage(),e=Math.ceil(n.length/this.CONFIG.pageCount);t>e&&(t=e),this.CONFIG.currentPage=t;let i=this.DOM_CONFIG.dataPagingNode.dom.parentElement;this.append(i);}}var Ba=Va;const Ga="网盘链接识别",lt=false,d=xe.noConflict(),x=B.noConflict(),j=Ve,ye=pt??window.CryptoJS??ee.CryptoJS,Ha=Ba,h=new d.Log(we,ee.console||kt.console);var Ye;const ct=((Ye=we==null?undefined:we.script)==null?undefined:Ye.name)||Ga,Wa=Ve.config.Utils.AnyTouch();h.config({debug:lt,logMaxCount:1e3,autoClearConsole:true,tag:true});m.config(Object.defineProperties({html:true,autoClose:true,showClose:false},{position:{get(){return g.toast.position.value}},maxNums:{get(){return g.toast.maxnums.value}},showReverse:{get(){return g.toast.showreverse.value}},zIndex:{get(){let a=xe.getMaxZIndex(10),n=Ve.config.InstanceUtils.getPopsMaxZIndex(10).zIndex;return xe.getMaxValue(a,n)+100}}}));const be=new d.GM_Menu({GM_getValue:U,GM_setValue:Z,GM_registerMenuCommand:mt,GM_unregisterMenuCommand:gt}),_=new d.Httpx(wt);_.interceptors.request.use(a=>(Ct.handle(a),a));_.interceptors.response.use(undefined,a=>(h.error("拦截器-请求错误",a),a.type==="onabort"?m.warning("请求取消"):a.type==="onerror"?m.error("请求异常"):a.type==="ontimeout"?m.error("请求超时"):m.error("其它错误"),a));_.config({logDetails:lt,headers:{"User-Agent":d.getRandomPCUA()}});ee.Object.defineProperty,ee.Function.prototype.apply,ee.Function.prototype.call,ee.Element.prototype.appendChild,ee.setTimeout;d.addStyle.bind(d);const Za=document.querySelector.bind(document),ja=document.querySelectorAll.bind(document),fe=function(a,n,t,e,i,s="default",r){let o=i,l=()=>r.getShowText(t,o),c=We(a,n,l,"keyboard",false,false,s,async u=>{var w;d.preventEvent(u);let f=(w=u.target.closest(".pops-panel-button"))==null?undefined:w.querySelector("span");if(r.isWaitPress){m.warning("请先执行当前的录入操作");return}if(r.hasOptionValue(t))r.emptyOption(t),m.success("清空快捷键");else {let C=m.loading("请按下快捷键...",{showClose:true,onClose(){r.cancelEnterShortcutKeys();}}),{status:b,option:S,key:v}=await r.enterShortcutKeys(t);C.close(),b?(h.success(["成功录入快捷键",S]),m.success("成功录入")):m.error(`快捷键 ${r.translateKeyboardValueToButtonText(S)} 已被 ${v} 占用`);}x.html(f,l());});return c.attributes={},Reflect.set(c.attributes,Qe,()=>false),c};class qa{constructor(n){O(this,"key","short-cut");O(this,"$data");O(this,"isWaitPress",false);O(this,"currentWaitEnterPressInstanceHandler",null);typeof n=="string"&&(this.key=n),this.$data={otherShortCutOptions:[]};}initConfig(n,t){this.hasOption(n)||this.setOption(n,t);}getStorageKey(){return this.key}getLocalAllOptions(){return U(this.key,[])}hasOption(n){return !!this.getLocalAllOptions().find(i=>i.key===n)}hasOptionValue(n){if(this.hasOption(n)){let t=this.getOption(n);return (t==null?undefined:t.value)!=null}else return  false}getOption(n,t){return this.getLocalAllOptions().find(s=>s.key===n)??t}setOption(n,t){let e=this.getLocalAllOptions(),i=e.findIndex(s=>s.key===n);i==-1?e.push({key:n,value:t}):Reflect.set(e[i],"value",t),Z(this.key,e);}emptyOption(n){let t=false,e=this.getLocalAllOptions(),i=e.findIndex(s=>s.key===n);return i!==-1&&(e[i].value=null,t=true),Z(this.key,e),t}deleteOption(n){let t=false,e=this.getLocalAllOptions(),i=e.findIndex(s=>s.key===n);return i!==-1&&(e.splice(i,1),t=true),Z(this.key,e),t}translateKeyboardValueToButtonText(n){let t="";return n.ohterCodeList.forEach(e=>{t+=d.stringTitleToUpperCase(e,true)+" + ";}),t+=d.stringTitleToUpperCase(n.keyName),t}getShowText(n,t){if(this.hasOption(n)){let e=this.getOption(n);return e.value==null?t:this.translateKeyboardValueToButtonText(e.value)}else return t}async enterShortcutKeys(n){const t=this;return new Promise(e=>{this.isWaitPress=true;let i=x.listenKeyboard(window,"keyup",(s,r,o)=>{const l={keyName:s,keyValue:r,ohterCodeList:o};let c={};try{const u=JSON.stringify(l),p=this.getLocalAllOptions();Array.isArray(this.$data.otherShortCutOptions)&&p.push(...this.$data.otherShortCutOptions);for(let f=0;f<p.length;f++){let w=p[f];if(w.key===n)continue;const C=JSON.stringify(w.value);let b=!1;if(w.value!=null&&u===C&&(b=!0),b){c={status:!1,key:w.key,option:l};return}}this.setOption(n,l),c={status:!0,key:n,option:l};}catch(u){console.log(u),c={status:false,key:n,option:l};}finally{t.isWaitPress=false,i.removeListen(),t.currentWaitEnterPressInstanceHandler=null,e(c);}});t.currentWaitEnterPressInstanceHandler=null,t.currentWaitEnterPressInstanceHandler=()=>{t.isWaitPress=false,i.removeListen();};})}cancelEnterShortcutKeys(){typeof this.currentWaitEnterPressInstanceHandler=="function"&&this.currentWaitEnterPressInstanceHandler();}initGlobalKeyboardListener(n,t){let e=this.getLocalAllOptions();if(!e.length){h.warn("没有设置快捷键");return}const i=this;function s(l,c){x.listenKeyboard(l,"keydown",(u,p,f,w)=>{if(i.isWaitPress)return;t!=null&&t.isPrevent&&d.preventEvent(w),e=i.getLocalAllOptions();let C=e.findIndex(b=>{let S=b.value,v={keyName:u,keyValue:p,ohterCodeList:f};if(JSON.stringify(S)===JSON.stringify(v))return b});if(C!=-1){let b=e[C];b.key in c&&(h.info(["调用快捷键",b]),c[b.key].callback());}},{capture:!!(t!=null&&t.capture)});}let r={},o={};Object.keys(n).forEach(l=>{let c=n[l];(c.target==null||typeof c.target=="string"&&c.target==="")&&(c.target="window"),c.target==="window"?Reflect.set(r,l,c):Reflect.set(o,l,c);}),s(window,r),x.ready(()=>{Object.keys(o).forEach(async l=>{let c=o[l];if(typeof c.target=="string")d.waitNode(c.target,1e4).then(u=>{if(!u)return;let p={};Reflect.set(p,l,c),s(u,p);});else if(typeof c.target=="function"){let u=await c.target();if(u==null)return;let p={};Reflect.set(p,l,c),s(u,p);}else {let u={};Reflect.set(u,l,c),s(c.target,u);}});});}}const he={shortCut:new qa("GM_shortcut"),init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"netdisk-keyboard-open-setting":{target:"window",callback:()=>{h.info("快捷键 ==> 【打开】⚙ 设置"),Ue.show();}},"netdisk-keyboard-open-history-matching-records":{target:"window",callback:()=>{h.info("快捷键 ==> 【打开】⚙ 历史匹配记录"),k.netDiskHistoryMatch.show();}},"netdisk-keyboard-open-user-rule":{target:"window",callback:()=>{h.info("快捷键 ==> 【打开】⚙ 链接识别规则"),Pe.show(false);}},"netdisk-keyboard-open-proactively-recognize-text":{target:"window",callback:()=>{h.info("快捷键 ==> 【打开】⚙ 主动识别文本"),k.matchPasteText.show();}},"netdisk-keyboard-performPageTextMatchingManually":{target:"window",callback(){h.info("快捷键 ==> 执行文本匹配"),M.dispatchMonitorDOMChange=true;}},"netdisk-keyboard-character-mapping":{target:"window",callback(){h.info("快捷键 ==> 【打开】⚙ 字符映射规则"),_e.show();}}}}},Ka=function(a,n,t,e,i,s,r="请至少选择一个选项",o){let l=[];typeof e=="function"?l=e():l=e;let c={text:a,type:"select-multiple",description:s,placeholder:r,attributes:{},props:{},getValue(){return this.props[P].get(n,t)},selectConfirmDialogDetails:o,callback(u){let p=[];u.forEach(f=>{p.push(f.value);}),this.props[P].set(n,p),h.info("多选-选择：",p);},data:l};return Reflect.set(c.attributes,le,n),Reflect.set(c.attributes,pe,t),Reflect.set(c.props,P,{get(u,p){return U(u,p)},set(u,p){Z(u,p);}}),c},Ja={id:"netdisk-panel-config-all-setting",title:"总设置",isDefault:true,forms:[{type:"forms",text:"",forms:[{type:"deepMenu",text:"Toast",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-toast",forms:[ue("位置",g.toast.position.KEY,g.toast.position.default,[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],undefined,`Toast显示在九宫格的位置，默认: ${g.toast.position.default}`),ue("同时最多显示的数量",g.toast.maxnums.KEY,g.toast.maxnums.default,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],undefined,`默认: ${g.toast.maxnums.default}`),F("逆序弹出",g.toast.showreverse.KEY,g.toast.showreverse.value,undefined,"默认是自上往下显示Toast，逆序则是自下往上显示Toast")]}]},{type:"deepMenu",text:"弹窗",forms:[{className:"netdisk-panel-forms-pops",type:"forms",text:"",forms:[ue("动画",g.pops.popsAnimation.KEY,g.pops.popsAnimation.default,[{value:"",text:"无"},{value:"pops-anim-spread",text:"spread"},{value:"pops-anim-shake",text:"shake"},{value:"pops-anim-rolling-left",text:"rolling-left"},{value:"pops-anim-rolling-right",text:"rolling-right"},{value:"pops-anim-slide-top",text:"slide-top"},{value:"pops-anim-slide-bottom",text:"slide-bottom"},{value:"pops-anim-slide-left",text:"slide-left"},{value:"pops-anim-slide-right",text:"slide-right"},{value:"pops-anim-fadein",text:"fadein"},{value:"pops-anim-fadein-zoom",text:"fadein-zoom"},{value:"pops-anim-fadein-alert",text:"fadein-alert"},{value:"pops-anim-don",text:"don"},{value:"pops-anim-roll",text:"roll"},{value:"pops-anim-sandra",text:"sandra"},{value:"pops-anim-gather",text:"gather"}],undefined,`显示/关闭的动画效果，默认: ${g.pops.popsAnimation.default}`),F("点击弹窗遮罩层关闭弹窗",g.pops.clickMaskToCloseDialog.KEY,g.pops.clickMaskToCloseDialog.default,undefined,"点击遮罩层触发关闭弹窗事件"),F("窗口拖拽",g.pops.pcDrag.KEY,g.pops.pcDrag.default,undefined,"长按标题栏可拖拽移动弹窗"),F("限制拖拽距离",g.pops.pcDragLimit.KEY,g.pops.pcDragLimit.default,undefined,"只能在浏览器的可视窗口内拖动"),F("亚克力效果",g.pops.popsAcrylic.KEY,g.pops.popsAcrylic.default,undefined,"")]}]},{type:"deepMenu",text:"文件弹窗",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-pops-folder",forms:[ue("排序名",g.popsFolder["pops-folder-sort-name"].KEY,g.popsFolder["pops-folder-sort-name"].default,[{value:"fileName",text:"文件名"},{value:"latestTime",text:"修改时间"},{value:"fileSize",text:"大小"}],undefined,"当前的规则"),ue("排序规则",g.popsFolder["pops-folder-sort-is-desc"].KEY,g.popsFolder["pops-folder-sort-is-desc"].default,[{value:false,text:"升序"},{value:true,text:"降序"}],undefined,"当前的规则")]}]},{type:"deepMenu",text:"悬浮按钮",forms:[{type:"forms",text:"",forms:[re("大小",g.suspension.size.KEY,g.suspension.size.default,15,250,(a,n)=>{g.suspension.size.value=parseInt(n.toString()),k.suspension.isShow&&(x.css(k.suspension.suspensionNode,{width:g.suspension.size.value,height:g.suspension.size.value}),k.suspension.setSuspensionPosition());},a=>`${a}px`,"悬浮按钮的大小，默认: "+g.suspension.size.default),re("透明度",g.suspension.opacity.KEY,g.suspension.opacity.default,.1,1,(a,n)=>{g.suspension.opacity.value=parseFloat(n.toString()),k.suspension.isShow&&x.css(k.suspension.suspensionNode,{opacity:g.suspension.opacity.value});},undefined,"值越小越透明，默认: "+g.suspension.opacity.default,.1),re("背景轮播时间",g.suspension["randbg-time"].KEY,g.suspension["randbg-time"].default,0,1e4,undefined,a=>`${a}ms`,"淡入/淡出的时间，默认: "+g.suspension["randbg-time"].default+"ms",100),re("背景显示时间",g.suspension["randbg-show-time"].KEY,g.suspension["randbg-show-time"].default,0,1e4,undefined,a=>`${a}ms`,"图标显示的持续时间，默认: 1200",100),F("吸附边缘",g.suspension["suspended-button-adsorption-edge"].KEY,g.suspension["suspended-button-adsorption-edge"].default,undefined,"移动悬浮按钮松开后自动吸附边缘"),se("z-index",g.suspension["suspended-z-index"].KEY,g.suspension["suspended-z-index"].default,"值小于等于0则为动态获取z-index",(a,n,t)=>(g.suspension["suspended-z-index"].value=t,true),"",true)]}]},{type:"deepMenu",text:"大/小链接弹窗",forms:[{type:"forms",text:"小窗",className:"netdisk-panel-forms-small-window",forms:[re("宽度",g.smallWindow["netdisk-ui-small-window-width"].KEY,g.smallWindow["netdisk-ui-small-window-width"].default,50,x.width(window),undefined,a=>`${a}px`,"设置小窗宽度(px)，默认: 250",1),re("高度",g.smallWindow["netdisk-ui-small-window-max-height"].KEY,g.smallWindow["netdisk-ui-small-window-max-height"].default,50,x.height(window),undefined,a=>`${a}px`,"设置小窗最大高度(px)，默认: "+g.smallWindow["netdisk-ui-small-window-max-height"].default,1)]},{type:"forms",text:"",forms:[se("z-index",g.smallWindow["netdisk-link-view-z-index"].KEY,g.smallWindow["netdisk-link-view-z-index"].default,"值小于等于0则为动态获取z-index",(a,n,t)=>(g.smallWindow["netdisk-link-view-z-index"].value=t,true),"",true)]}]}]},{type:"forms",text:"",forms:[{type:"deepMenu",text:"功能",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-function",forms:[ue("匹配模式",g.features["netdisk-match-mode"].KEY,g.features["netdisk-match-mode"].default,[{text:"MutationObserver",value:"MutationObserver"},{text:"Menu",value:"Menu"}],undefined,"MutationObserver是自动监听并识别链接<br>Menu是手动点击油猴菜单进行识别"),ue("行为模式",g.features["netdisk-behavior-mode"].KEY,g.features["netdisk-behavior-mode"].default,[{text:"悬浮按钮+小窗",value:"suspension_smallwindow"},{text:"悬浮按钮+大窗",value:"suspension_window"},{text:"小窗",value:"smallwindow"}],undefined,"匹配到链接时触发的UI执行"),F("自动输入访问码",g.features.autoFillAccessCode.KEY,g.features.autoFillAccessCode.default,undefined,"通过主动点击链接跳转时，会自动输入网盘访问码")]}]},{type:"deepMenu",text:"匹配设置",forms:[{type:"forms",text:"文本匹配范围",forms:[Ka("匹配规则类型",g.match.pageMatchRange.KEY,g.match.pageMatchRange.default,[{value:"innerText",text:"普通文本"},{value:"innerHTML",text:"超文本"}],undefined,"执行的文本匹配规则",undefined,{height:"auto"}),F("深入ShadowRoot获取匹配文本",g.match.depthQueryWithShadowRoot.KEY,g.match.depthQueryWithShadowRoot.default,undefined,"遍历ShadowRoot，获取匹配的内容"),F("匹配剪贴板",g.match.readClipboard.KEY,g.match.readClipboard.default,undefined,"Api兼容性查看：<a href='https://caniuse.com/mdn-api_permissions_permission_clipboard-read' target='_blank'>读取剪贴板权限申请</a>、<a href='https://caniuse.com/mdn-api_clipboard_readtext' target='_blank'>直接读取剪贴板</a>"),F("匹配当前URL",g.match.allowMatchLocationHref.KEY,g.match.allowMatchLocationHref.default,undefined,"提取window.location.href进行匹配"),F("匹配input标签的内容",g.match.toBeMatchedWithInputElementValue.KEY,g.match.toBeMatchedWithInputElementValue.default,undefined,"提取页面中的&lt;input&gt;的内容进行匹配"),F("匹配textarea标签的内容",g.match.toBeMatchedTextAreaElementValue.KEY,g.match.toBeMatchedTextAreaElementValue.default,undefined,"提取页面中的&lt;textarea&gt;的内容进行匹配")]},{type:"forms",text:"MutationObserver观察器",forms:[re("匹配间隔",g.match.delaytime.KEY,g.match.delaytime.default,0,5,undefined,a=>`${a}s`,"匹配文本完毕后的延迟xxx秒允许下一次匹配",.1),F("添加元素时进行匹配",g.match.isAddedNodesToMatch.KEY,g.match.isAddedNodesToMatch.default,undefined,"当监听到页面添加元素时才进行匹配文本"),F("观察器：childList",g.match["mutationObserver-childList"].KEY,g.match["mutationObserver-childList"].default,undefined,"子节点的变动（新增、删除或者更改）"),F("观察器：characterData",g.match["mutationObserver-characterData"].KEY,g.match["mutationObserver-characterData"].default,undefined,"节点内容或节点文本的变动"),F("观察器：subtree",g.match["mutationObserver-subtree"].KEY,g.match["mutationObserver-subtree"].default,undefined,"是否将观察器应用于该节点的所有后代节点")]}]},{type:"deepMenu",text:"网盘图标",forms:[{type:"forms",text:"",forms:[F("点击定位分享码",g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].KEY,g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].default,undefined,"自动滚动页面至包含分享码的元素"),F("选中分享码",g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].KEY,g.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].default,undefined,"使用光标选中分享码/元素"),F("循环定位",g.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].KEY,g.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].default,undefined,"关闭则是每一个元素只定位一次")]}]},{type:"deepMenu",text:"历史匹配记录",forms:[{type:"forms",text:"",className:"netdisk-panel-history-match",forms:[F("保存匹配记录",g.historyMatch.saveMatchNetDisk.KEY,g.historyMatch.saveMatchNetDisk.default,undefined,"将匹配到的链接信息进行本地存储，可点击【油猴菜单-⚙ 历史匹配记录】进行查看"),F("合并相同链接",g.historyMatch["netdisk-history-match-merge-same-link"].KEY,g.historyMatch["netdisk-history-match-merge-same-link"].default,undefined,"将合并匹配到的相同链接，并更新它最后一次匹配到的更新时间、网址信息"),ue("排序规则",g.historyMatch["netdisk-history-match-ordering-rule"].KEY,g.historyMatch["netdisk-history-match-ordering-rule"].default,[{value:"按 记录时间 - 升序",text:"按 记录时间 - 升序"},{value:"按 记录时间 - 降序",text:"按 记录时间 - 降序"},{value:"按 更新时间 - 升序",text:"按 更新时间 - 升序"},{value:"按 更新时间 - 降序",text:"按 更新时间 - 降序"}]),We("修复存储记录","如果【匹配记录】弹窗打不开，可能是存储的数据缺失某些字段，可尝试点击此处进行修复","修复",undefined,undefined,false,"primary",a=>{d.preventEvent(a);try{const{count:n,repairCount:t}=k.netDiskHistoryMatch.checkAndRepairLocalData();t===0?m.info("不存在需要修复的数据"):m.success(`共计: ${n} 条，修复${t}条`);}catch(n){m.error("修复异常："+n.toString());}})]}]},{type:"deepMenu",text:"分享码",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-share-code",forms:[F("排除分享码",g.shareCode.excludeIdenticalSharedCodes.KEY,g.shareCode.excludeIdenticalSharedCodes.default,undefined,"启用后会根据【相同系数】排除掉匹配到的分享码"),re("相同系数",g.shareCode.excludeIdenticalSharedCodesCoefficient.KEY,g.shareCode.excludeIdenticalSharedCodesCoefficient.default,0,1,undefined,a=>a.toString(),"例如分享码: aaaaaaaabb，它的相同系数是0.8，设置相同系数≥0.8时会被排除",.01)]}]},{type:"deepMenu",text:"访问码",forms:[{className:"netdisk-panel-forms-access-code",text:"",type:"forms",forms:[F("允许查询历史匹配记录",g.accessCode.allowQueryHistoryMatchingAccessCode.KEY,g.accessCode.allowQueryHistoryMatchingAccessCode.default,undefined,"当访问码为空时，访问码将从历史匹配记录中查询，优先级：页面匹配 < 历史匹配记录 < 网站规则 < 黑名单")]}]},{type:"deepMenu",className:"netdisk-panel-forms-shortcut-keys-deepMenu",text:"快捷键",forms:[{className:"netdisk-panel-forms-shortcut-keys",text:"",type:"forms",forms:[fe("【打开】⚙ 设置","","netdisk-keyboard-open-setting",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 历史匹配记录","","netdisk-keyboard-open-history-matching-records",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 访问码规则","","netdisk-keyboard-open-accesscode-rule",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 添加链接识别规则","","netdisk-keyboard-open-user-rule",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 网站规则","","netdisk-keyboard-website-rule",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 字符映射规则","","netdisk-keyboard-character-mapping",undefined,"暂无快捷键","default",he.shortCut),fe("【打开】⚙ 识别文本","","netdisk-keyboard-open-proactively-recognize-text",undefined,"暂无快捷键","default",he.shortCut),fe("执行文本匹配","","netdisk-keyboard-performPageTextMatchingManually",undefined,"暂无快捷键","default",he.shortCut)]}]}]}]},W={$data:{__data:null,__oneSuccessExecMenu:null,__onceExec:null,__listenData:null,get data(){return W.$data.__data==null&&(W.$data.__data=new d.Dictionary),W.$data.__data},get oneSuccessExecMenu(){return W.$data.__oneSuccessExecMenu==null&&(W.$data.__oneSuccessExecMenu=new d.Dictionary),W.$data.__oneSuccessExecMenu},get onceExec(){return W.$data.__onceExec==null&&(W.$data.__onceExec=new d.Dictionary),W.$data.__onceExec},get scriptName(){return ct},key:ge,attributeKeyName:le,attributeDefaultValueName:pe},$listener:{get listenData(){return W.$data.__listenData==null&&(W.$data.__listenData=new d.Dictionary),W.$data.__listenData}},init(){this.initPanelDefaultValue(this.getPanelContentConfig().concat(Fe.getRulePanelContent())),this.initExtensionsMenu();},isTopWindow(){return ee.top===ee.self},initExtensionsMenu(){this.isTopWindow()&&be.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:false,isStoreValue:false,showText(a){return a},callback:()=>{Ue.show();}},{key:"showNetDiskHistoryMatch",text:"⚙ 历史匹配记录",autoReload:false,isStoreValue:false,showText(a){return a},callback(){k.netDiskHistoryMatch.show();}},{key:"websiteRule",text:"⚙ 网站规则",autoReload:false,isStoreValue:false,showText(a){return a},callback(){Q.show();}},{key:"charater-mapping",text:"⚙ 字符映射规则",autoReload:false,isStoreValue:false,showText(a){return a},callback(){_e.show();}},{key:"showUserRule",text:"⚙ 添加链接识别规则",autoReload:false,isStoreValue:false,showText(a){return a},callback(){Pe.show(false);}},{key:"showMatchPasteText",text:"⚙ 识别文本",autoReload:false,isStoreValue:false,showText(a){return a},callback(){k.matchPasteText.show();}}]);},initPanelDefaultValue(a){function n(e){if(!e.attributes||e.type==="button")return;let i={},s=e.attributes[le];s!=null&&(i[s]=e.attributes[pe]);let r=e.attributes[Qe];if(typeof r=="function"){let c=r();if(typeof c=="boolean"&&!c)return}let o=e.attributes[yt];o&&typeof o=="object"&&Object.assign(i,o);let l=Object.keys(i);if(!l.length){h.warn("请先配置键",e);return}l.forEach(c=>{let u=i[c];U(c)==null&&Z(c,u);});}function t(e){for(let i=0;i<e.length;i++){let s=e[i];n(s);let r=s.forms;r&&Array.isArray(r)&&t(r);}}for(let e=0;e<a.length;e++){let i=a[e];if(!i.forms)continue;let s=i.forms;s&&Array.isArray(s)&&t(s);}},setValue(a,n){let t=U(ge,{}),e=t[a];t[a]=n,Z(ge,t),this.$listener.listenData.has(a)&&this.$listener.listenData.get(a).callback(a,e,n);},getValue(a,n){let e=U(ge,{})[a];return e??(this.$data.data.has(a)?this.$data.data.get(a):n)},deleteValue(a){let n=U(ge,{}),t=n[a];Reflect.deleteProperty(n,a),Z(ge,n),this.$listener.listenData.has(a)&&this.$listener.listenData.get(a).callback(a,t,undefined);},addValueChangeListener(a,n,t){let e=Math.random();return this.$listener.listenData.set(a,{id:e,key:a,callback:n}),t&&t.immediate&&n(a,this.getValue(a),this.getValue(a)),e},removeValueChangeListener(a){let n=null;for(const[t,e]of this.$listener.listenData.entries())if(e.id===a){n=t;break}typeof n=="string"?this.$listener.listenData.delete(n):console.warn("没有找到对应的监听器");},triggerMenuValueChange(a,n,t){if(this.$listener.listenData.has(a)){let e=this.$listener.listenData.get(a);if(typeof e.callback=="function"){let i=this.getValue(a),s=i,r=i;typeof n<"u"&&arguments.length>1&&(s=n),typeof t<"u"&&arguments.length>2&&(r=t),e.callback(a,r,s);}}},hasKey(a){let n=U(ge,{});return a in n},execMenu(a,n,t=false){if(!(typeof a=="string"||typeof a=="object"&&Array.isArray(a)))throw new TypeError("key 必须是字符串或者字符串数组");let e=[];typeof a=="object"&&Array.isArray(a)?e=[...a]:e.push(a);let i;for(let s=0;s<e.length;s++){const r=e[s];if(!this.$data.data.has(r)){h.warn(`${a} 键不存在`);return}let o=W.getValue(r);if(t&&(o=!o),!o)break;i=o;}i&&n(i);},execMenuOnce(a,n,t,e){if(typeof a!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(a)){h.warn(`${a} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(a))return;this.$data.oneSuccessExecMenu.set(a,1);let i=()=>{let c=W.getValue(a);return typeof t=="function"?t(a,c):c},s=[],r=c=>{let u=i(),p=[];if(c instanceof HTMLStyleElement?p=[c]:Array.isArray(c)&&(p=[...c.filter(f=>f!=null&&f instanceof HTMLStyleElement)]),u)s=s.concat(p);else for(let f=0;f<p.length;f++)p[f].remove(),p.splice(f,1),f--;},o=c=>{let u=[];if(c){let p=n(c,r);p instanceof HTMLStyleElement?u=[p]:Array.isArray(p)&&(u=[...p.filter(f=>f!=null&&f instanceof HTMLStyleElement)]);}for(let p=0;p<s.length;p++)s[p].remove(),s.splice(p,1),p--;s=[...u];};this.addValueChangeListener(a,(c,u,p)=>{let f=p;typeof e=="function"&&(f=e(c,p,u)),o(f);});let l=i();l&&o(l);},execInheritMenuOnce(a,n,t,e){let i=this;const s=(r,o)=>{let l=i.getValue(r),c=i.getValue(o);if(typeof e=="function"){let u=e(l,c);if(u!==undefined)return u}return l};this.execMenuOnce(a,t,()=>s(a,n),()=>s(a,n)),this.execMenuOnce(n,()=>{},()=>false,()=>(this.triggerMenuValueChange(a),false));},onceExec(a,n){if(typeof a!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(a)||(n(),this.$data.onceExec.set(a,1));},getPanelContentConfig(){return [Ja]}};Object.assign(k.src.icon,typeof RESOURCE_ICON>"u"?{}:RESOURCE_ICON);Q.init();Y.init();Fe.init();W.init();A.init();he.init();x.ready(()=>{Se.init(),He.init(),M.init();});

})(Qmsg, DOMUtils, Utils, pops, CryptoJS);