// ==UserScript==
// @name         网盘链接识别
// @namespace    https://greasyfork.org/zh-CN/scripts/445489
// @version      2024.9.18
// @author       WhiteSevs
// @description  识别网页中显示的网盘链接，目前包括百度网盘、蓝奏云、天翼云、中国移动云盘(原:和彩云)、阿里云、文叔叔、奶牛快传、123盘、腾讯微云、迅雷网盘、115网盘、夸克网盘、城通网盘(部分)、坚果云、UC网盘、BT磁力，支持蓝奏云、天翼云(需登录)、123盘、奶牛、UC网盘(需登录)、坚果云(需登录)和阿里云盘(需登录，且限制在网盘页面解析)直链获取下载，页面动态监控加载的链接，可自定义规则来识别小众网盘/网赚网盘或其它自定义的链接。
// @license      GPL-3.0-only
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAACsJJREFUeF7tXW+IHdUVP2c2u8kHIQYL0TRIaK1SgrFFaZsvVkpAo6YR1LJpa9jUd++83SUpSrUNBFRCrVgxNOv+mTOvJBBNmtpamoQG9UNBKLHFDzEtFttKBdOYQENE/Lb75vZd2cVNum/uvXNnZt/MnoGQD+/c8+d3fu+c+2f2PgR+ljQCuKSj5+CBCbDEScAEYAIscQSWePhcAZgASxyBJR4+VwAmQHEIjIyM3DAzM/M1pdSXEfEWALgVANbkaPE0ABwhomdz1GmtSgixHxF3Wg8wC55HxPeVUu8DgP7/jRUrVvxpbGzsY/PQbBK5VwCd9Ha7vVkptRkA9L8yHiKisAxDczaklL8GgAfLsImIryql3gSAqBPnh3nazI0AjUZjbRAEjwLAI3k6aKtLKbUjjuODtvI+cs1m894kSY776Mg49hwAxHkSIRcCSCl10nXy12YMLI9hrxDR/XkoMukQQrQQ8WGTXIGfn0PEZ6IoGvO14U0AKeUJALjH15Ecxr9ARHn2464uCSEOI+K2HHz2VXGUiAZ9lHgRQEp5BgBu9nEgr7FBEGyZmprSZCz8EUIMIuKRwg3ZGfiAiK63E/1/qcwEkFJ+BAArsxrOedzLRPSdnHWmqgvD8EBntj5Ups0UWxeI6NosvmQigBDibUTckMVgAWNKXwHMxSClfBwAtgPA+gLiclX5GhHd6TrImQBhGO5RSu11MHQREY8nSXICEf/R399/bnx8/KLD+CUl2plf3BgEwa1JktyOiN8HgKscAHCuhE4EaDabQ0mSHLBxSCml5weHlFKHWq3WBZsxLHM5AlLKLwLAQwCwCwBWWeLzKBHts5S1fx9ASnkdALxluZPXIiJh6wTLpSMwPDx8U7vd/iEADFtgdTZJko2tVuushawTAZ4EgCdMSpVSW+M4PmaS48/dEZBSWuWgMznfR0R6X8b4WLUA228/Ig5GUXTUaJUFMiMghNiEiK+bFCxbtuxLExMT/zLJ2RLAhnmTRDRiMsif+yMQhuFupdTTaZoQcZfNTqEVAYQQf0TEO1IMXurr69s4OTn5rn94rMEGAYul+Ekiutuky0iAoaGhqwcGBi4ZFD1FRLpK8FMSAkKIHyHiz9PM2bQBIwGklPcBwO9SDH0CAF8hovdKip3NAECj0VgdBMHf05aHSqntcRwfSm0VJjSllD8DgJ90k1NKTcVxbLM8MZnizx0RkFL+BgC6noAi4nNRFD3mSwB96NH1xKnMc3hHfGovbnEoZdweNraAMAxPKaW+0Q1NRFwfRdE7tUe7BwOUUuqTWL3j2u0xHhIZCSCl1K8gdT1pIiKjjh7ErhYujY6OXjM9Pf3ftGBM+TEmT0qpfAzUAukeDsI3P0yAHk6ujWtMABuUaizDBKhxcm1CYwLYoFRjGSZAjZNrExoTwAalGsswAWqcXJvQmAA2KNVYhglQ4+TahMYEsEGpxjK1IYCU8vcAcJvlW8dVTqn+C9+3iGhrHkHUggCmIPIAqhd1mA5qbHw2YWeysehnAWVetGADaMkyzn/Jc6V/dSDAeQBYXTLwvWLOeF5vcrQOBEg9bjYBUPXPTSXaFB8TwIRQj3/OBDC8cNLj+fN2r+oEOE1EX/VBwVTCfHRXYWzBBDDmx7gKMNyF92PfO/pMBPAFKO9Zsyupio7PNz9GAuiAuyzVcrmZo2iA6k4A3/xYEUAb0Xfjtdvt+xBxlVLqeF538jEB8nmrOmt+rAngWvps5ZkA+RDAFu8r5XqBAP9J2f8/R0SfzxrcQuMWgXClxueKVS8QQB8CfbuL48fyOjSZ078IBCg1vsoRYHYSs+BuYN4rgDRbc8CVabMIW5UkwLyZ7O2zAbxR1MWPZVeAeZVH3y5eeHyVJYCr41nlF4sAWf0tetyizwGKDnCx9wHKjs/VHhPgCsR6oS+7JtFHngnABPDhT/XG8hzg8pxxBeAKUL1vsY/HXAG4AvCNJ/M4wC2AW4BPQa3eWG4B3AK4BXAL6F65eCOoelXdyWNuAdwCuAVwC+AWMIcALwN5GejUQisvzHMAngPwHIDnADwH4DlAFw7wPkDlu3x6ADwHyDgHCMPwLqXUJgCYDoLgpampqb9VkSt1JUDW/FgtA6WUvwSAH1yR8Bc7vxSmf9i4Uk8dCeCTHyMBDL8a9j0iOlwlBtSNAL75sSGA/v1Z/TPmCz3/JqIvMAEWDwEppVd+bAhQq3VzDSuAV36YABXfCvYlNBOACbC01s2+35jF6/YLW/aNhysAVwCuAPMRqNpWMFcAx5rsC5ijucLFfePhFsAtgFsAt4AUDviWmMJroKMBjsfxNJABc2RYyeK++VmKc4CevrfPlT9MAEfEZn+cqrR7CR3dcxZnAjhD9unl16XdS5jBPachTAAnuD4Tnr0Bvefu7XMNhwngiljN5JkANUuoazhMAFfEaia/6ATo7+//3Pj4+MWa4VqZcAwEOE9E16UFY7MPkLZu1ro3ENFfK4NYjRwVQtyIiO92CwkR34yiaKMvAY4BwJZuSpRSD8Rx/Nsa4VqZUMIw3KaUSnsr+1dEtM2LAEKIvYi4J4VlB6Mo2lEZ1GrkqBBiEhGbKSE9Q0S7vQggpfwuALyUouRikiTrW63WhRph2/OhSCn1q/qnAeCqlOp8dxzHJ70IMDIycsPMzMw/05QopR6L4/i5nketRg5KKZ8EgCfSQlq+fPnKsbGxj70IoAdLKf8AAJtTmHYmjuNbaoRvT4cyPDx8U7vdPgUAq1Ja86tRFN1lCsS4CtAKwjDcqZTab1DWIiJhMsif+yMgpZwAgGGDpqeISFeJ1MeKADZtQFtRSm2N41ivGvgpCAGb0t8p2ucA4DYi+tDkhhUBZtvA8wDwiFEh4mAURUdNcvy5OwJCiE2I+LrFSKtvv9ZjTYBGo7E2CALdd9ZaODDZ19f3i8nJya6bFBY6WGQeAmEY7lZKPW0BivW334kAs1VAVwBdCWyeSwCg5w2HOvcIvGczgGUuR6DRaKxGRH0Hw0OIuMEGH0TcFUXRmI2sMwFmSXACAO6xNQAAnyilXuysIv4cBMFfoih6x2HskhIdHR29Znp6eo1Saj0iPgAA30qb6S8AzlEiGnQBzboFzFcqpTwDADe7GCpIVm+EHCGiZwvSn6pWCLEfEXcuhu0FbH5ARNe7+pKJALOV4CMAWOlqsCB56sx4w4J0L6h29o2iB8u0mWLrAhFdm8WXzATQxoQQb9v2pizOuYxRSu2I4/igy5isss1m894kSY5nHZ/zuNeI6M6sOr0IoI2GYbhHKbU3qwM5jnulcyx9f476uqoSQrQQ8eEybBlsvOz7G8veBNAONpvNoSRJfgoAaxYRlBeIqJR+3DmHP9w5h089Zi0Yh7N6NUZE+3zt5EKA2TmBfvNE92G9HVw6EYIg2DI1NaVXKIU/QohBRDxSuKGFDexLkuT5VqulSeD95EaAOU+klJ8SQSn1TUS8w9tDOwXepdDOzGdSYRgeUEoNuY7LKH8SEU/29fWdnJiY0LeC5fbkToD5ng0NDV09MDCgSfB1AFiHiOuUUusAINOMtUvUpa8A5pH9cQDYDgDrc8sIgH6vQk+uzyRJcqa/v/9U3kmf72uhBMgRFFZVEAJMgIKArYpaJkBVMlWQn0yAgoCtilomQFUyVZCfTICCgK2KWiZAVTJVkJ9MgIKArYra/wGYigzMiqJYZwAAAABJRU5ErkJggg==
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*/*
// @exclude      /^http(s|)://s1.hdslb.com/.*$/
// @exclude      /^http(s|)://www.bilibili.com/video.*$/
// @exclude      /^http(s|)://message.bilibili.com/.*$/
// @exclude      /^http(s|)://live.bilibili.com/.*$/
// @exclude      /^http(s|)://.*.mail.qq.com/.*$/
// @exclude      /^http(s|)://.*video.qq.com/.*$/
// @exclude      /^http(s|)://.*.vscode-cdn.net/.*$/
// @exclude      /^http(s|)://.*vscode.dev/.*$/
// @exclude      /^http(s|)://cloudgame.ds.163.com/.*$/
// @exclude      /^http(s|)://cloudgame.webapp.163.com/.*$/
// @exclude      /^http(s|)://cg.163.com/.*$/
// @exclude      /^http(s|)://.*.youtube.com/.*$/
// @require      https://update.greasyfork.org/scripts/494167/1413255/CoverUMD.js
// @require      https://update.greasyfork.org/scripts/456470/1413242/%E7%BD%91%E7%9B%98%E9%93%BE%E6%8E%A5%E8%AF%86%E5%88%AB-%E5%9B%BE%E6%A0%87%E5%BA%93.js
// @require      https://update.greasyfork.org/scripts/486152/1448081/Crypto-JS.js
// @require      https://update.greasyfork.org/scripts/465550/1448580/JS-%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.2.2/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.2.9/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.3.2/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@1.6.3/dist/index.umd.js
// @connect      *
// @connect      lanzoub.com
// @connect      lanzouc.com
// @connect      lanzoue.com
// @connect      lanzouf.com
// @connect      lanzoug.com
// @connect      lanzouh.com
// @connect      lanzoui.com
// @connect      lanzouj.com
// @connect      lanzouk.com
// @connect      lanzoul.com
// @connect      lanzoum.com
// @connect      lanzouo.com
// @connect      lanzoup.com
// @connect      lanzouq.com
// @connect      lanzous.com
// @connect      lanzout.com
// @connect      lanzouu.com
// @connect      lanzouv.com
// @connect      lanzouw.com
// @connect      lanzoux.com
// @connect      lanzouy.com
// @connect      lanosso.com
// @connect      lanzn.com
// @connect      lanzog.com
// @connect      lanpw.com
// @connect      lanpv.com
// @connect      lanzv.com
// @connect      wwentua.com
// @connect      ilanzou.com
// @connect      189.cn
// @connect      123pan.com
// @connect      123pan.cn
// @connect      wenshushu.cn
// @connect      jianguoyun.com
// @connect      cowtransfer.com
// @connect      cowcs.com
// @connect      aliyundrive.com
// @connect      baidu.com
// @connect      139.com
// @connect      weiyun.com
// @connect      xunlei.com
// @connect      115.com
// @connect      quark.cn
// @connect      jianguoyun.com
// @connect      uc.cn
// @connect      ctfile.com
// @connect      sharepoint.com
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_download
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-end
// ==/UserScript==

(function (f, je, ve, be) {
  'use strict';

  var Be=Object.defineProperty;var He=(t,s,i)=>s in t?Be(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;var z=(t,s,i)=>He(t,typeof s!="symbol"?s+"":s,i);var Ze=typeof GM_deleteValue<"u"?GM_deleteValue:void 0,ke=typeof GM_download<"u"?GM_download:void 0,De=typeof GM_getResourceText<"u"?GM_getResourceText:void 0,R=typeof GM_getValue<"u"?GM_getValue:void 0,ae=typeof GM_info<"u"?GM_info:void 0,qe=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,M=typeof GM_setValue<"u"?GM_setValue:void 0,We=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,Je=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,Z=typeof unsafeWindow<"u"?unsafeWindow:void 0,Ke=window;const Ye={$data:{get enable(){return B.getValue("httpx-use-cookie-enable")},get useDocumentCookie(){return B.getValue("httpx-use-document-cookie")},cookieRule:[]},fixCookieSplit(t){return d.isNotNull(t)&&!t.trim().endsWith(";")&&(t+=";"),t},concatCookie(t,s){return d.isNull(t)?s:(t=t.trim(),s=s.trim(),t=this.fixCookieSplit(t),s.startsWith(";")&&(s=s.substring(1)),t.concat(s))},handle(t){if(t.fetch||!this.$data.enable)return;let s="",i=t.url;i.startsWith("//")&&(i=window.location.protocol+i);let e=new URL(i);this.$data.useDocumentCookie&&e.hostname.endsWith(window.location.hostname.split(".").slice(-2).join("."))&&(s=this.concatCookie(s,document.cookie.trim()));for(let a=0;a<this.$data.cookieRule.length;a++){let n=this.$data.cookieRule[a];if(e.hostname.match(n.hostname)){let o=B.getValue(n.key);if(d.isNull(o))break;s=this.concatCookie(s,o);}}d.isNotNull(s)&&(t.headers&&t.headers.Cookie?t.headers.Cookie=this.concatCookie(t.headers.Cookie,s):t.headers.Cookie=s,u.info(["Httpx => 设置cookie:",t])),t.headers&&t.headers.Cookie!=null&&d.isNull(t.headers.Cookie)&&delete t.headers.Cookie;}},A=function(t,s){return {KEY:t,default:s,get value(){return R(this.KEY,this.default)},set value(i){M(this.KEY,i);}}},k={toast:{position:A("qmsg-config-position","top"),maxnums:A("qmsg-config-maxnums",3),showreverse:A("qmsg-config-showreverse",!0)},pops:{popsAnimation:A("popsAnimation","pops-anim-fadein-zoom"),clickMaskToCloseDialog:A("clickMaskToCloseDialog",!0),pcDrag:A("pcDrag",!0),pcDragLimit:A("pcDragLimit",!0),popsAcrylic:A("popsAcrylic",!1)},popsFolder:{"pops-folder-sort-name":A("pops-folder-sort-name","fileName"),"pops-folder-sort-is-desc":A("pops-folder-sort-is-desc",!1)},smallIconNavgiator:{"pops-netdisk-icon-click-event-find-sharecode":A("pops-netdisk-icon-click-event-find-sharecode",!0),"pops-netdisk-icon-click-event-find-sharecode-with-select":A("pops-netdisk-icon-click-event-find-sharecode-with-select",!0),"pops-netdisk-icon-click-event-loop-find-sharecode":A("pops-netdisk-icon-click-event-loop-find-sharecode",!0)},suspension:{size:A("size",50),opacity:A("opacity",1),"randbg-time":A("randbg-time",1500),"randbg-show-time":A("randbg-show-time",1200),"suspended-button-adsorption-edge":A("suspended-button-adsorption-edge",!1)},smallWindow:{"netdisk-ui-small-window-width":A("netdisk-ui-small-window-width",250),"netdisk-ui-small-window-max-height":A("netdisk-ui-small-window-max-height",200)},historyMatch:{"netdisk-history-match-ordering-rule":A("netdisk-history-match-ordering-rule","按 更新时间 - 降序"),saveMatchNetDisk:A("saveMatchNetDisk",!1)},match:{pageMatchRange:A("pageMatchRange",["innerText","innerHTML"]),depthQueryWithShadowRoot:A("depthQueryWithShadowRoot",!1),readClipboard:A("readClipboard",!1),allowMatchLocationHref:A("allowMatchLocationHref",!0),toBeMatchedWithInputElementValue:A("to-be-matched-inputElementValue",!1),toBeMatchedTextAreaElementValue:A("to-be-matched-textAreaElementValue",!1),delaytime:A("delaytime",.8),isAddedNodesToMatch:A("isAddedNodesToMatch",!1),"mutationObserver-childList":A("mutationObserver-childList",!0),"mutationObserver-characterData":A("mutationObserver-characterData",!0),"mutationObserver-subtree":A("mutationObserver-subtree",!0)},function:{"netdisk-behavior-mode":A("netdisk-behavior-mode","suspension_smallwindow"),autoFillAccessCode:A("autoFillAccessCode",!0),getTheDirectLinkAfterRedirection:A("getTheDirectLinkAfterRedirection",!1)},aboutShareCode:{excludeIdenticalSharedCodesCoefficient:A("excludeIdenticalSharedCodesCoefficient",1),excludeIdenticalSharedCodes:A("excludeIdenticalSharedCodes",!1)}},Ge="网盘链接识别",Me=!1,d=ve.noConflict(),C=je.noConflict(),j=be,Xe=CryptoJS??window.CryptoJS??Z.CryptoJS,Qe=DataPaging??window.DataPaging??Z.DataPaging,u=new d.Log(ae,Z.console||Ke.console);var Ne;const $e=((Ne=ae==null?void 0:ae.script)==null?void 0:Ne.name)||Ge,et=be.config.Utils.AnyTouch();u.config({debug:Me,logMaxCount:1e3,autoClearConsole:!0,tag:!0});f.config(Object.defineProperties({html:!0,autoClose:!0,showClose:!1},{position:{get(){return k.toast.position.value}},maxNums:{get(){return k.toast.maxnums.value}},showReverse:{get(){return k.toast.showreverse.value}},zIndex:{get(){let t=ve.getMaxZIndex(10),s=be.config.InstanceUtils.getPopsMaxZIndex(t).zIndex;return ve.getMaxValue(t,s)+100}}}));const tt=new d.GM_Menu({GM_getValue:R,GM_setValue:M,GM_registerMenuCommand:qe,GM_unregisterMenuCommand:We}),b=new d.Httpx(Je);b.interceptors.request.use(t=>(Ye.handle(t),t));b.interceptors.response.use(void 0,t=>(u.error(["拦截器-请求错误",t]),t.type==="onabort"?f.warning("请求取消"):t.type==="onerror"?f.error("请求异常"):t.type==="ontimeout"?f.error("请求超时"):f.error("其它错误"),t));b.config({logDetails:Me,headers:{"User-Agent":d.getRandomPCUA()}});Z.Object.defineProperty,Z.Function.prototype.apply,Z.Function.prototype.call,Z.Element.prototype.appendChild,Z.setTimeout;const Le=d.addStyle.bind(d),te="GM_Panel",Ue="data-init",se="data-key",ne="data-default-value",it="data-init-more-value",ee=function(t,s,i,e,a,n){let o=[];typeof e=="function"?o=e():o=e;let r={text:t,type:"select",description:n,attributes:{},getValue(){return R(s,i)},callback(l,c,h){u.info(`选择：${h}`),M(s,c);},data:o};return r.attributes&&(r.attributes[se]=s,r.attributes[ne]=i),r},U=function(t,s,i,e,a){let n={text:t,type:"switch",description:a,attributes:{},getValue(){return !!R(s,i)},callback(o,r){u.success(`${r?"开启":"关闭"} ${t}`),M(s,!!r);},afterAddToUListCallBack:void 0};return n.attributes&&(n.attributes[se]=s,n.attributes[ne]=!!i),n},V={replaceParam(t,s={}){return typeof t!="string"||Object.keys(s).forEach(i=>{let e=s[i];if(d.isNotNull(e)){try{t=t.replaceAll(`{#encodeURI-${i}#}`,encodeURI(e));}catch{u.error(["encodeURI-替换的文本失败",[e]]);}try{t=t.replaceAll(`{#encodeURIComponent-${i}#}`,encodeURIComponent(e));}catch{u.error(["encodeURIComponent-替换的文本失败",[e]]);}try{t=t.replaceAll(`{#decodeURI-${i}#}`,decodeURI(e));}catch{u.error(["decodeURI-替换的文本失败",[e]]);}try{t=t.replaceAll(`{#decodeURIComponent-${i}#}`,decodeURIComponent(e));}catch{u.error(["encodeURIComponent-替换的文本失败",[e]]);}t=t.replaceAll(`{#${i}#}`,e);}}),t},replaceChinese(t){return t.replace(/[\u4e00-\u9fa5]/g,"")},getDecodeComponentUrl(t=window.location.href){try{t=decodeURIComponent(t);}catch{}return t}},_={$flag:{},linkDict:new d.Dictionary,tempLinkDict:new d.Dictionary,matchLink:new Set,hasMatchLink:!1,clipboardText:"",shareCodeNotMatchRegexpList:[/(vipstyle|notexist|ajax|file|download|ptqrshow|xy-privacy|comp|web|undefined|1125|unproved|console|account|favicon|setc)/g],accessCodeNotMatchRegexpList:[/^(font)/gi],noAccessCodeRegExp:/( |提取码:|\n密码：{#accessCode#}|{#accessCode#}|{#encodeURI-accessCode#}|{#encodeURIComponent-accessCode#}|{#decodeURI-accessCode#}|{#encodeURIComponent-accessCode#}|\?pwd=|&pwd=)/gi,regular:{},rule:[],init(){this.initLinkDict();},initLinkDict(){Object.keys(this.regular).forEach(t=>{this.linkDict.set(t,new d.Dictionary),this.tempLinkDict.set(t,new d.Dictionary);});},handleLink(t,s,i){let e=this.handleShareCode(t,s,i);if(d.isNull(e))return;let a=this.handleAccessCode(t,s,i);return a=this.handleAccessCodeByUserRule(t,a,i),{shareCode:e,accessCode:a}},handleShareCode(t,s,i){var r;let e=_.regular[t][s],a=(r=i.match(e.shareCode))==null?void 0:r.filter(l=>d.isNotNull(l));if(d.isNull(a)){u.error(["匹配shareCode为空",{匹配的文本:i,规则:e,正在使用的规则:e.shareCode,网盘名称:t,网盘名称索引下标:s}]);return}let n=a[0];e.shareCodeNeedRemoveStr&&(n=n.replace(e.shareCodeNeedRemoveStr,""));let o=e.shareCodeNotMatch;if(o!=null&&n.match(o)){u.error(`不可能的shareCode => ${n}`);return}for(const l of _.shareCodeNotMatchRegexpList)if(n.match(l)){u.error(`不可能的shareCode => ${n}`);return}if(n=decodeURI(n),!(k.aboutShareCode.excludeIdenticalSharedCodes.value&&d.isSameChars(n,k.aboutShareCode.excludeIdenticalSharedCodesCoefficient.value))&&!(n.endsWith("http")||n.endsWith("https")))return n},handleAccessCode(t,s,i){var o;let e=this.regular[t][s],a="";if(!e.checkAccessCode)return "";let n=i.match(e.checkAccessCode);if(n){let l=(o=n[n.length-1].match(e.accessCode))==null?void 0:o.filter(c=>d.isNotNull(c));if(d.isNull(l))return "";l.length&&(a=l[0],a.startsWith("http")&&(a=""));}if(d.isNotNull(a)){for(const r of _.accessCodeNotMatchRegexpList)if(a.match(r)){a="";break}e.acceesCodeNotMatch&&a.match(e.acceesCodeNotMatch)&&(a="");}return a},handleAccessCodeByUserRule(t,s,i){let e=w.accessCodeRule.getValue(),a=s,n=window.location.href;for(let o=0;o<e.length;o++){let r=e[o],l=new RegExp(r.urlRegexp,"i");if(n.match(l)){for(let c=0;c<r.netdisk.length;c++)if(r.netdisk[c].value===t)return u.success(`使用自定义规则中的提取码 ${t} ${a}`),r.accessCode}}return a},handleLinkShow(t,s,i,e,a){let n=_.regular[t][s];if(n==null)throw f.error("BUG: 获取uiLink规则失败"),u.error(["BUG: 分析参数",t,s,i,e]),new TypeError("获取uiLink规则失败");let o=V.replaceParam(n.uiLinkShow,{shareCode:i});if(e&&e!=""?o=V.replaceParam(o,{accessCode:e}):o=o.replace(_.noAccessCodeRegExp,""),n.paramMatch){let r=_.linkDict.get(t).get(i);if(a=a??(r==null?void 0:r.matchText),d.isNotNull(a)){let l=a.match(n.paramMatch),c={};if(l)for(let h=0;h<l.length;h++)c[`$${h}`]=l[h];o=V.replaceParam(o,c);}}return o},getLinkDickObj(t,s=0,i=!1,e){return {accessCode:t,netDiskIndex:s,isForceAccessCode:i,matchText:e}}},at={tianYiYunLoginTip:{PC:{width:"30vw",height:"280px"},Mobile:{width:"80vw",height:"250px"}},jianGuoYunLoginTip:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},settingView:{PC:{width:"800px",height:"600px"},Mobile:{width:"92vw",height:"80vh"}},setDefaultValueView:{PC:{width:"350px",height:"200px"},Mobile:{width:"350px",height:"200px"}},mainView:{PC:{width:"500px",height:"100%"},Mobile:{width:"88vw",height:"50vh"}},mainViewSmallWindow:{PC:{width:k.smallWindow["netdisk-ui-small-window-width"].value+"px",height:"auto"},Mobile:{width:k.smallWindow["netdisk-ui-small-window-width"].value+"px",height:"auto"}},oneFileStaticView:{PC:{width:"550px",height:"350px"},Mobile:{width:"88vw",height:"300px"}},moreFileStaticView:{PC:{width:"700px",height:"600px"},Mobile:{width:"88vw",height:"500px"}},inputNewAccessCodeView:{PC:{width:"400px",height:"200px"},Mobile:{width:"88vw",height:"160px"}},historyMatchView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRulesView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},customRuleDebugView:{PC:{width:"55vw",height:"70vh"},Mobile:{width:"88vw",height:"70vh"}},matchPasteTextView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleView:{PC:{width:"50vw",height:"65vh"},Mobile:{width:"88vw",height:"60vh"}},accessCodeRuleEditView:{PC:{width:"44vw",height:"50vh"},Mobile:{width:"70vw",height:"45vh"}}},st=function(t){window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/share/init"&&window.location.search.startsWith("?surl=")&&(u.success(["自动填写链接",t]),d.waitNode("div.verify-form #accessCode").then(s=>{var i;if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),(i=document.querySelector("div.verify-form #submitBtn"))==null||i.click();})),window.location.hostname==="pan.baidu.com"&&window.location.pathname==="/wap/init"&&window.location.search.startsWith("?surl=")&&(u.success(["自动填写链接",t]),d.waitNode("div.extractWrap div.extract-content div.extractInputWrap.extract input[type=text]").then(s=>{var i;if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),(i=document.querySelector("div.extractWrap div.extract-content button.m-button"))==null||i.click();}));},nt=function(t){window.location.hostname.match(/lanzou[a-z]{1}.com/gi)&&(u.success(["自动填写链接",t]),d.waitNode("#pwd").then(s=>{var i,e;if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),(i=document.querySelector("#passwddiv div.passwddiv-input > div")||s.nextElementSibling)==null||i.click(),(e=document.querySelector("#sub"))==null||e.click();}),d.waitNode("#f_pwd").then(s=>{d.mutationObserver(s,{config:{attributes:!0,attributeFilter:["style"]},callback:(i,e)=>{var n;let a=document.querySelector("#f_pwd #pwd");if(!d.isVisible(a)){u.error("输入框不可见，不输入密码");return}e.disconnect(),u.success("自动填入访问码并关闭观察者"),f.success("自动填入访问码"),a.value=t.accessCode,d.dispatchEvent(a,"input"),(n=document.querySelector("#f_pwd #sub"))==null||n.click();}});}));},ot=function(t){function s(i,e){let a=0,n=30,o=setInterval(()=>{if(a++,a>n){u.error("结束循环检查，退出。"),clearInterval(o);return}if(!d.isVisible(i)){u.warn(`第 ${a} 次：输入框不可见，不输入密码`);return}e(),clearInterval(o);},500);}window.location.hostname==="cloud.189.cn"&&(u.success(["自动填写链接",t]),d.waitNode("input#code_txt").then(i=>{s(i,()=>{f.success("自动填入访问码");let e=document.querySelector(".btn.btn-primary.visit");i.value=t.accessCode,i._value=t.accessCode,d.dispatchEvent(i,"input"),d.dispatchEvent(e,"click");});})),window.location.hostname==="h5.cloud.189.cn"&&(u.success(["自动填写链接",t]),d.waitNode("input.access-code-input").then(i=>{s(i,()=>{f.success("自动填入访问码"),i.value=t.accessCode,i._value=t.accessCode,d.dispatchEvent(i,"input"),d.dispatchEvent(document.querySelector("div.button"),"click");});}));},rt=function(t){window.location.hostname==="caiyun.139.com"&&(u.success(["自动填写链接",t]),d.waitNode("#token-input").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),document.querySelector("#homepage div.token div.token-form a").click();}),d.waitNode("#app div.token-form input[type=text]").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),document.querySelector("div.token-form a.btn-token").click();}));},re={async waitReactPropsToSet(t,s,i){if(!Array.isArray(i)){this.waitReactPropsToSet(t,s,[i]);return}function e(){let a=null;return typeof t=="string"?a=document.querySelector(t):typeof t=="function"?a=t():t instanceof HTMLElement&&(a=t),a}typeof t=="string"&&!await d.waitNode(t,1e4)||i.forEach(a=>{typeof a.msg=="string"&&u.info(a.msg);function n(){let o=e();if(o==null)return !1;let r=d.getReactObj(o);if(r==null)return !1;let l=r[s];return l==null?!1:!!a.check(l)}d.waitPropertyByInterval(()=>e(),n,250,1e4).then(()=>{let o=e();if(o==null)return;let r=d.getReactObj(o);if(r==null)return;let l=r[s];l!=null&&a.set(l);});});}},lt=function(t){(window.location.hostname==="www.aliyundrive.com"||window.location.hostname==="www.alipan.com")&&(u.success(["自动填写链接",t]),d.waitNode("#root input.ant-input").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,re.waitReactPropsToSet(s,"reactFiber",{check(i){var e;return typeof((e=i==null?void 0:i.memoizedProps)==null?void 0:e.onChange)=="function"},set(i){i.memoizedProps.onChange({currentTarget:s,target:s});}}),document.querySelector('#root button[type="submit"]').click();}),d.waitNode("#root input[name=pwd]").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,re.waitReactPropsToSet(s,"reactFiber",{check(i){var e;return typeof((e=i==null?void 0:i.memoizedProps)==null?void 0:e.onChange)=="function"},set(i){i.memoizedProps.onChange({currentTarget:s,target:s});}}),document.querySelector('#root button[type="submit"]').click();}));},ct=function(t){window.location.hostname==="www.123pan.com"&&(u.success(["自动填写链接",t]),d.waitNode("#app .ca-fot input.ant-input[type=text]").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),re.waitReactPropsToSet(s,"reactProps",{check(e){return typeof(e==null?void 0:e.onChange)=="function"},set(e){e.onChange({target:{value:t.accessCode}});}});let i=s.nextSibling;i==null||i.click();}),d.waitNode("#app .appinput input.ant-input[type=text]").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),re.waitReactPropsToSet(s,"reactProps",{check(e){return typeof(e==null?void 0:e.onChange)=="function"},set(e){e.onChange({target:{value:t.accessCode}});}});let i=s.nextSibling;i==null||i.click();}));},dt=function(t){window.location.hostname==="share.weiyun.com"&&(u.success(["自动填写链接",t]),d.waitNode("#app input.input-txt").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),d.dispatchEvent(s,"change"),setTimeout(()=>{document.querySelector(".form-item button.btn-main").click();},500);}),d.waitNode(".input-wrap input.pw-input").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),d.dispatchEvent(s,"change"),setTimeout(()=>{document.querySelector(".pw-btn-wrap button.btn").click();},500);}));},ut=function(t){window.location.hostname==="pan.xunlei.com"&&(u.success(["自动填写链接",t]),d.waitNode("#__layout div.pass-input-wrap input.td-input__inner").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}u.error("输入框不可见，不输入密码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),d.dispatchEvent(s,"change"),setTimeout(()=>{document.querySelector("#__layout div.pass-input-wrap button.td-button").click();},500);}),d.waitNode("#__layout div.pass-wrapper input.td-input__inner").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}u.error("输入框不可见，不输入密码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),d.dispatchEvent(s,"change"),setTimeout(()=>{document.querySelector("#__layout div.pass-wrapper button.td-button").click();},500);}));},ht=function(t){window.location.hostname==="115.com"&&(u.success(["自动填写链接",t]),d.waitNode("input.text").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),document.querySelector("#js-share_code div.form-decode div.submit a").click();}));},pt=function(t){window.location.hostname==="pan.quark.cn"&&(u.success(["自动填写链接",t]),d.waitNode("#ice-container input.ant-input[class*=ShareReceive]").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),re.waitReactPropsToSet(s,"reactProps",{check(i){return (i==null?void 0:i.onChange)==="function"},set(i){i.onChange({target:{value:t.accessCode}});}}),re.waitReactPropsToSet(s,"reactEventHandlers",{check(i){return (i==null?void 0:i.onChange)==="function"},set(i){i.onChange({target:{value:t.accessCode}});}});}));},ft=function(t){u.success(["自动填写链接",t]),d.waitNode("#passcode").then(s=>{if(!d.isVisible(s)){u.error("输入框不可见，不输入密码");return}f.success("自动填入访问码"),s.value=t.accessCode,d.dispatchEvent(s,"input"),document.querySelector("#main-content .form-group button.btn[type=button]").click();});},le={key:"tempNetDiskInfo",$data:{netDiskInfo:null,enable:k.function.autoFillAccessCode.value},init(){if(this.$data.netDiskInfo=this.getValue(),!!this.$data.netDiskInfo&&this.$data.enable&&!d.isNull(this.$data.netDiskInfo.accessCode)){if(this.$data.netDiskInfo.netDiskName==="baidu"&&this.$data.netDiskInfo.shareCode.startsWith("1")){if(!window.location.href.includes(this.$data.netDiskInfo.shareCode.slice(1,this.$data.netDiskInfo.shareCode.length)))return}else if(!window.location.href.includes(this.$data.netDiskInfo.shareCode))return;if(this.$data.netDiskInfo.netDiskName in le.netDisk){let t=le.netDisk[this.$data.netDiskInfo.netDiskName];typeof t=="function"?t(this.$data.netDiskInfo):u.warn("自动填写访问码失败："+this.$data.netDiskInfo.netDiskName+"，原因：该网盘未适配");}else u.error("网盘名未找到，跳过自动填写："+this.$data.netDiskInfo);}},netDisk:{baidu:st,lanzou:nt,tianyiyun:ot,hecaiyun:rt,aliyun:lt,wenshushu:()=>{},nainiu:()=>{},_123pan:ct,weiyun:dt,xunlei:ut,_115pan:ht,chengtong:ft,kuake:pt,jianguoyun:()=>{},onedrive:()=>{}},setValue(t){M(this.key,t);},getValue(){return R(this.key)}},mt=function(){},L={template:{matchRange_text:{before:t=>`${t}-text-match-range-before`,after:t=>`${t}-text-match-range-after`},matchRange_html:{before:t=>`${t}-html-match-range-before`,after:t=>`${t}-html-match-range-after`},function:{enable:t=>`${t}-enable`,checkLinkValidity:t=>`${t}-check-link-valid`,linkClickMode:t=>`${t}-click-mode`},linkClickMode_openBlank:{openBlankWithCopyAccessCode:t=>`${t}-open-blank-with-copy-accesscode`},schemeUri:{enable:t=>`${t}-scheme-uri-enable`,isForwardLinearChain:t=>`${t}-scheme-uri-forward-linear-chain`,isForwardBlankLink:t=>`${t}-scheme-uri-forward-blank-link`,uri:t=>`${t}-scheme-uri-uri`}}},g={matchRange_text:{before(t,s=20){return parseInt(R(L.template.matchRange_text.before(t),s).toString())},after(t,s=10){return parseInt(R(L.template.matchRange_text.after(t),s).toString())}},matchRange_html:{before(t,s=100){return parseInt(R(L.template.matchRange_html.before(t),s).toString())},after(t,s=15){return parseInt(R(L.template.matchRange_html.after(t),s).toString())}},function:{enable(t,s=!0){return !!R(L.template.function.enable(t),s)},linkClickMode(t,s="copy"){return R(L.template.function.linkClickMode(t),s)},checkLinkValidity(t,s=!1){return !!R(L.template.function.checkLinkValidity(t),s)}},linkClickMode_openBlank:{openBlankWithCopyAccessCode(t,s=!1){return !!R(L.template.linkClickMode_openBlank.openBlankWithCopyAccessCode(t),s)}},schemeUri:{enable(t,s=!1){return !!R(L.template.schemeUri.enable(t),s)},isForwardLinearChain(t,s=!1){return !!R(L.template.schemeUri.isForwardLinearChain(t),s)},isForwardBlankLink(t,s=!1){return !!R(L.template.schemeUri.isForwardBlankLink(t),s)},uri(t,s=""){return R(L.template.schemeUri.uri(t),s)}}},ze={rule:[{enable:g.function.enable("_123pan"),link_innerText:`123pan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("_123pan")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("_123pan")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`123pan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("_123pan")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("_123pan")}}[0-9a-zA-Z]{4}|)`,shareCode:/123pan.com\/s\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/123pan.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"123pan.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://123pan.com/s/{#shareCode#}",copyUrl:`https://123pan.com/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("_123pan")}],setting:{name:"123盘",key:"_123pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!0,isForwardBlankLink:!0,uri:""}}}},Ie={KEY:"_123pan_User_Authorization",set(t){M(this.KEY,t);},get(){return R(this.KEY)}},gt=function(){if(window.location.hostname!=="www.123pan.com"||g.function.linkClickMode(ze.setting.key)!=="parseFile")return;let t=Z.localStorage.getItem("authorToken");d.isNull(t)||(t=t.replace(/^\"/,"").replace(/\"$/,""),u.success("获取123网盘已登录用户的authorToken值👇"),u.success(t),Ie.set(t));},_e={init(){Object.keys(_e.netDisk).forEach(t=>{this.netDisk[t]();});},netDisk:{_123pan:gt,lanzouyx:mt}};class X{constructor(){z(this,"netDiskIndex",0);z(this,"shareCode","");z(this,"accessCode","");}}class kt extends X{init(s,i,e){u.info([s,i,e]),this.netDiskIndex=s,this.shareCode=i,this.accessCode=e;let a=R("baidu-baiduwp-php-url"),n=R("baidu-baiduwp-php-post-form"),o=R("baidu-baiduwp-php-copy-url");if(!a){f.error("请先在设置中配置百度网盘-网址");return}if(!n){f.error("请先在设置中配置百度网盘-表单参数");return}n=V.replaceParam(n,{shareCode:i,accessCode:e});let r=document.createElement("form"),l={},c=new URLSearchParams(n);r.action=a,r.method="post",r.style.display="none",r.target="_blank";for(let[h,p]of c){let m=document.createElement("textarea");m.name=h,m.value=p,r.appendChild(m),l[h]=p;}u.info(["表单数据",l]),document.body.appendChild(r),u.info(["访问网址",a]),o?(Q.copy("baidu",s,i,e,"1.5秒后跳转至解析站"),setTimeout(()=>{r.submit();},1500)):r.submit();}}const D={protocol:"jumpwsv",pathname:"go",parseDataToSchemeUri(t,s){if(!g.schemeUri.enable(t))return s;let e=g.schemeUri.uri(t);return d.isNull(e)&&(e=this.getSchemeUri(this.getIDMSchemeUriOption(s))),e.startsWith(this.protocol)&&(s=s.replace(/&/g,"{-and-}"),s=s.replace(/#/g,"{-number-}")),e=V.replaceParam(e,{intentData:s}),e},isForwardDownloadLink(t){return g.schemeUri.isForwardLinearChain(t)},isForwardBlankLink(t){return g.schemeUri.isForwardBlankLink(t)},getSchemeUri(t){return `${this.protocol}://${this.pathname}?package=${t.package}&activity=${t.activity}&intentAction=${t.intentAction}&intentData=${t.intentData}&intentExtra=${t.intentExtra}`},getIDMSchemeUriOption(t=""){return {package:"idm.internet.download.manager.plus",activity:"idm.internet.download.manager.UrlHandlerDownloader",intentAction:"android.intent.action.VIEW",intentData:t,intentExtra:""}}},K={DEFAULT_HOST_NAME:"www.lanzout.com",MENU_KEY:"lanzou-host-name",get hostname(){return R(this.MENU_KEY,this.DEFAULT_HOST_NAME)}};class wt extends X{constructor(){super(...arguments);z(this,"router",{default(i=""){return i.startsWith("/")&&(i=i.replace(/^\//,"")),`https://${K.hostname}/${i}`},tp(i=""){return i.startsWith("/")&&(i=i.replace(/^\//,"")),`https://${K.hostname}/tp/${i}`},s(i=""){return i.startsWith("/")&&(i=i.replace(/^\//,"")),`https://${K.hostname}/s/${i}`}});z(this,"regexp",{unicode:{match:/[%\u4e00-\u9fa5]+/g,tip:"中文链接",isUnicode:!1},noFile:{match:/div>来晚啦...文件取消分享了<\/div>/g,tip:"来晚啦...文件取消分享了"},noExists:{match:/div>文件不存在，或已删除<\/div>/g,tip:"文件不存在，或已删除"},needVipToShare:{match:/class="fbox">非会员.+请先开通会员/gi,tip:"该链接为非会员用户分享的文件，目前无法下载"},moreFile:{match:/<span id=\"filemore\" onclick=\"more\(\);\">/g},sign:{match:/var[\s]*(posign|postsign|vidksek|skdklds)[\s]*=[\s]*'(.+?)';/},fileName:{match:/<title>(.*)<\/title>/},fileSize:{match:/<span class=\"mtt\">\((.*)\)<\/span>/},loadDownHost:{match:/var[\s]*(vkjxld)[\s]*=[\s]*'(.+?)'/i},loadDown:{match:/var[\s]*(loaddown|oreferr|spototo|domianload|hyggid)[\s]*=[\s]*'(.+?)'/i},appleDown:{match:/var[\s]*appitem[\s]*=[\s]*'(.+?)'/i},uploadTime:{match:/mt2\"\>时间:<\/span>(.+?)[\s]*<span/i}});}async init(i,e,a){u.info([i,e,a]),this.netDiskIndex=i,this.shareCode=e,this.accessCode=a,this.regexp.unicode.isUnicode=!!this.shareCode.match(this.regexp.unicode.match),i===2?await this.getMoreFile(this.router.s(this.shareCode)):await this.getFileLink();}async getFileLink(i=!1){var r,l,c,h,p,m,y,v,T;const e=this;let a=this.router.default(this.shareCode);u.info("蓝奏云-获取文件下载链接"+a);let n=await b.get({url:a,headers:{Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:a},allowInterceptConfig:!1,onerror(){}});if(!n.status){if(u.error(n),n.type==="ontimeout")return;if(d.isNull(n.data.responseText)){f.error("请求异常");return}n.data.responseText.includes("div>文件不存在，或者已被删除</div>")?f.error("文件不存在，或者已被删除"):f.error("未知情况");return}let o=n.data;if(o.readyState!==4){u.error(o),f.error("请求失败，请重试");return}if(o.responseText==null){u.error(o),f.error("获取网页内容为空");return}if(e.checkPageCode(o))if(e.isMoreFile(o))await e.getMoreFile();else {u.info(o);let $=o.responseText;if(i){let q=$.match(/var[\s]*link[\s]*=[\s]*\'tp\/(.+?)\';/i);e.shareCode=q[q.length-1],u.info(`新参数 => ${e.shareCode}`);}let N=C.parseHTML($,!0,!0),O=N.querySelector('iframe[class^="ifr"]')||N.querySelector('iframe[class^="n_downlink"]');if(O){let q=O.getAttribute("src");u.error(["该链接需要重新通过iframe地址访问获取信息",q]),f.info("正在请求下载信息");let G=((r=N.querySelector("body div.d > div"))==null?void 0:r.innerText)||((l=N.querySelector("#filenajax"))==null?void 0:l.innerText)||((h=(c=N.querySelector("title"))==null?void 0:c.textContent)==null?void 0:h.replace(/ - 蓝奏云$/i,"")),P=$.match(/文件大小：<\/span>(.+?)<br>/i)||((p=N.querySelector("div.n_box div.n_file div.n_filesize"))==null?void 0:p.innerText)||((m=N.querySelector(".d2 table tr td .fileinfo:nth-child(1) .fileinforight"))==null?void 0:m.innerText),E=$.match(/上传时间：<\/span>(.+?)<br>/i)||((y=N.querySelector("#file[class=''] .n_file_info span.n_file_infos"))==null?void 0:y.innerText)||((v=N.querySelector(".d2 table tr td .fileinfo:nth-child(3) .fileinforight"))==null?void 0:v.innerText)||((T=N.querySelector("#file[class='filter'] .n_file_info span.n_file_infos"))==null?void 0:T.innerText);P?(Array.isArray(P)&&(P=P[P.length-1]),typeof P=="string"&&(P=P.replaceAll("大小：",""))):u.error("解析文件大小信息失败"),E?(Array.isArray(E)&&(E=E[E.length-1]),E.toString().toLowerCase().startsWith("android")&&(u.error("解析出的文件上传时间信息是Android/xxxx开头"),E=void 0)):u.error("解析文件上传时间信息失败");let W=await e.getLinkByIframe(q,{fileName:G,fileSize:P,fileUploadTime:E});W&&(D.isForwardDownloadLink("lanzou")&&(W=D.parseDataToSchemeUri("lanzou",W)),w.staticView.oneFile({title:"蓝奏云单文件直链",fileName:G,fileSize:P,downloadUrl:W,fileUploadTime:E}));}else await e.getLink(o);}}checkPageCode(i){const e=this;let a=i.responseText;return a.match(e.regexp.noFile.match)?(f.error(e.regexp.noFile.tip),!1):a.match(e.regexp.noExists.match)?(f.error(e.regexp.noExists.tip),!1):a.match(e.regexp.needVipToShare.match)?(f.error(e.regexp.needVipToShare.tip),!1):!0}isMoreFile(i){const e=this;return i.responseText.match(e.regexp.moreFile.match)?(u.info("该链接为多文件"),!0):(u.info("该链接为单文件"),!1)}async getLink(i){const e=this;let a=i.responseText;if(a==null){u.error("shareCode错误，重新从页面中获取"),await e.getFileLink(!0);return}let n=a.match(e.regexp.sign.match),o="",r="",l=a.match(e.regexp.fileName.match),c=a.match(e.regexp.fileSize.match)||a.match(/<div class="n_filesize">大小：(.+?)<\/div>/i),h=a.match(e.regexp.uploadTime.match)||a.match(/<span class="n_file_infos">(.+?)<\/span>/i);if(l?l=l[l.length-1].trim():l="",c?c=c[c.length-1].trim():c="",h&&(h=h[h.length-1].trim()),n){r=n[n.length-1],u.info(`获取Sign: ${r}`),d.isNotNull(e.accessCode)?(u.info("传入参数=>有密码"),o=e.accessCode):u.info("传入参数=>无密码");let p=await b.post({url:e.router.default("ajaxm.php"),responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","User-Agent":d.getRandomAndroidUA(),Referer:e.router.default(e.shareCode)},data:`action=downprocess&sign=${r}&p=${o}`});if(!p.status)return;let m=p.data;if(u.info(m),m.readyState===4){let y=d.toJSON(m.responseText),v=`${y.dom}/file/${y.url}`;typeof y.url=="string"&&(y.url.startsWith("http")||y.url.startsWith(y.dom))&&(v=y.url),y.zt,"密码不正确".indexOf(y.inf)!=-1?(f.error("密码不正确!"),w.newAccessCodeView(void 0,"lanzou",e.netDiskIndex,e.shareCode,e.accessCode,T=>{e.init(e.netDiskIndex,e.shareCode,T);})):(l=y.inf?y.inf:l,v=await I.getRedirectFinalUrl(v,d.getRandomAndroidUA()),u.info(v),D.isForwardDownloadLink("lanzou")&&(v=D.parseDataToSchemeUri("lanzou",v)),w.staticView.oneFile({title:"蓝奏云单文件直链",fileName:l,fileSize:c,downloadUrl:v,fileUploadTime:h}));}else f.error("请求失败，请重试");}else {let p=a.match(e.regexp.loadDownHost.match),m=a.match(e.regexp.loadDown.match),y=a.match(e.regexp.appleDown.match);if(d.isNull(m)&&(m=a.match(/var[\s]*(cppat)[\s]*=[\s]*'(.+?)'/i)),d.isNull(p)&&y&&(y=y[y.length-1],p=[y],m=[""],u.success(["多文件-当前链接猜测为苹果的文件",y])),d.isNull(p)){f.error("蓝奏云直链：获取sign的域名失败，请反馈开发者",{timeout:3500});return}if(d.isNull(m)){f.error("蓝奏云直链：获取sign失败，请反馈开发者",{timeout:3500});return}let v=`${p[p.length-1]}${m[m.length-1]}`;u.info([l,c,v]),v=await I.getRedirectFinalUrl(v,d.getRandomAndroidUA()),u.info(v),D.isForwardDownloadLink("lanzou")&&(v=D.parseDataToSchemeUri("lanzou",v)),w.staticView.oneFile({title:"蓝奏云单文件直链",fileName:l,fileSize:c,downloadUrl:v,fileUploadTime:h});}}async getLinkByIframe(i,e){const a=this;u.info([i,e]);let n=a.router.default(i),o=await b.get({url:n,headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","User-Agent":d.getRandomPCUA(),Referer:a.router.default(a.shareCode)}});if(!o.status)return;let r=o.data;u.info(r);let l=r.responseText,c=l.match(/var[\s]*aihidcms[\s]*=[\s]*'(.*)';/i),h=l.match(/var[\s]*ciucjdsdc[\s]*=[\s]*'(.*)';/i),p=l.match(/var[\s]*ajaxdata[\s]*=[\s]*'(.+)';/i),m=l.match(/'sign':[\s]*'(.+)',/i),y=l.match(/url[\s]*:[\s]*'(.+)'[\s]*,/),v="ajaxm.php",T="",$="",N="",O="";if(y?v=y[y.length-1]:f.error("提取ajaxm.php的具体参数失败，使用默认的"+v),c)T=c[c.length-1];else {f.error("ajaxm.php请求参数 websignkey 获取失败");return}if(h)$=h[h.length-1];else {f.error("ajaxm.php请求参数 websign 获取失败");return}if(p)N=p[p.length-1];else {f.error("ajaxm.php请求参数 signs 获取失败");return}if(m)O=m[m.length-1];else {f.error("ajaxm.php请求参数 sign 获取失败");return}let q={action:"downprocess",signs:N,sign:O,websign:$,websignkey:T,ves:1,kd:1};u.success("请求的路径参数："+y),u.success("ajaxm.php的请求参数-> "+q);let G=await b.post({url:a.router.default(v),headers:{Accept:"application/json, text/javascript, */*","Content-Type":"application/x-www-form-urlencoded",Referer:a.router.default(a.shareCode),"User-Agent":d.getRandomPCUA()},data:d.toSearchParamsStr(q)});if(!G.status)return;let P=G.data;u.info(P);let E=d.toJSON(P.responseText),W=`${E.dom}/file/${E.url}`;if(E.zt,u.success(["直链",W]),"密码不正确".indexOf(E.inf)!=-1)f.error("密码不正确!"),w.newAccessCodeView(void 0,"lanzou",a.netDiskIndex,a.shareCode,a.accessCode,ce=>{a.init(a.netDiskIndex,a.shareCode,ce);});else return e.fileName=d.isNotNull(E.inf)?E.inf:e.fileName,W=await I.getRedirectFinalUrl(W,d.getRandomAndroidUA()),u.info(W),W}async getMoreFile(i){const e=this;i==null&&(i=e.router.default(e.shareCode));let a=await b.get({url:i,headers:{Accept:"*/*","User-Agent":d.getRandomAndroidUA(),Referer:i}});if(!a.status)return;let n=a.data;if(u.info(n),n.readyState!==4){f.error("请求失败，请重试");return}let o=n.responseText,r=o.match(/\'fid\':(.+?),/)[1].replaceAll("'",""),l=o.match(/\'uid\':(.+?),/)[1].replaceAll("'",""),c=1,h=o.match(/\'t\':(.+?),/)[1],p=new RegExp(h+`[\\s]*=[\\s]*('|")(.+?)('|");`),m=o.match(p)[2],y=o.match(/\'k\':(.+?),/)[1],v=new RegExp(y+`[\\s]*=[\\s]*('|")(.+?)('|");`),T=o.match(v)[2],N=`lx=${e.shareCode.match(e.regexp.unicode.match)?1:2}&fid=${r}&uid=${l}&pg=${c}&rep=0&t=${m}&k=${T}&up=1&ls=1&pwd=${e.accessCode}`;u.info(`多文件请求参数：${N}`);let O=await b.post({url:e.router.default("filemoreajax.php"),responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","User-Agent":d.getRandomAndroidUA(),Referer:i},data:N});if(!O.status)return;let q=O.data;u.info(q);let G=d.toJSON(q.responseText),P=G.zt,E=G.info;if(P===4)f.error(E);else if(P===1){let W=f.loading("获取文件夹成功，解析文件直链中..."),ce=G.text,Se=[];u.info(`本链接一共${ce.length}个文件`);for(let xe=0;xe<ce.length;xe++){let de=ce[xe],Pe=de.id,Re=de.name_all,Te=de.size,Oe=de.icon,Ce=de.time;Se.push({fileName:Re,fileSize:Te,fileType:Oe,createTime:Ce,latestTime:Ce,isFolder:!1,index:0,async clickEvent(){let fe=await e.parseMoreFile(Pe,Re,Te,Ce);if(fe.success)return {autoDownload:!0,mode:"aBlank",url:fe.downloadUrl};u.error(["获取下载信息失败：",fe]),f.error(fe.msg);}});}W.close(),w.staticView.moreFile("蓝奏云文件解析",Se);}else "密码不正确".indexOf(E)!==-1?(f.error("密码不正确!"),w.newAccessCodeView(void 0,"lanzou",e.netDiskIndex,e.shareCode,e.accessCode,W=>{e.init(e.netDiskIndex,e.shareCode,W);})):"没有了".indexOf(E)!==-1?f.error("没有文件了"):f.error("未知错误");}async parseMoreFile(i,e,a,n){const o=this;let r=await b.get({url:o.router.default(i),headers:{Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:o.router.default(o.shareCode)}});if(u.info(r),!r.status)return {success:!1,fileName:e,fileSize:a,fileUploadTime:n,msg:`解析失败，${r.msg}`,downloadUrl:void 0};let c=r.data.responseText,h=C.parseHTML(c,!0,!0),p=h.querySelector('iframe[class^="ifr"]')||h.querySelector('iframe[class^="n_downlink"]');if(!p)return {success:!1,fileName:e,fileSize:a,fileUploadTime:n,msg:"解析iframe链接失败",downloadUrl:void 0};let m=p.getAttribute("src");u.error(["该链接需要重新通过iframe地址访问获取信息",m]),f.info("正在请求下载信息");let y=await o.getLinkByIframe(m,{fileName:e,fileSize:a,fileUploadTime:n});return y?(D.isForwardDownloadLink("lanzou")&&(y=D.parseDataToSchemeUri("lanzou",y)),{success:!0,fileName:e,fileSize:a,fileUploadTime:n,msg:"success",downloadUrl:y}):{success:!1,fileName:e,fileSize:a,fileUploadTime:n,msg:"获取下载链接失败",downloadUrl:void 0}}}const F={alert(t,s){return t=this.handleDetails(t,s),j.alert(t)},confirm(t,s){return t=this.handleDetails(t,s),j.confirm(t)},loading(t){return typeof t.animation>"u"&&(t.animation=k.pops.popsAnimation.value),typeof t.forbiddenScroll>"u"&&(t.forbiddenScroll=w.defaultForbiddenScroll),j.loading(t)},prompt(t,s){return t=this.handleDetails(t,s),j.prompt(t)},folder(t,s){return t=this.handleDetails(t,s),t.sort={name:k.popsFolder["pops-folder-sort-name"].value,isDesc:k.popsFolder["pops-folder-sort-is-desc"].value,callback(i,e,a,n){k.popsFolder["pops-folder-sort-name"].value=a,k.popsFolder["pops-folder-sort-is-desc"].value=n;}},j.folder(t)},panel(t,s){return t=this.handleDetails(t,s),j.panel(t)},rightClickMenu(t){return t=this.handleDetails(t),j.rightClickMenu(t)},handleDetails(t,s){if(t=Object.assign({animation:k.pops.popsAnimation.value,drag:k.pops.pcDrag.value,dragLimit:k.pops.pcDragLimit.value,forbiddenScroll:w.defaultForbiddenScroll},t),s!=null&&(t.width=j.isPhone()?s.Mobile.width:s.PC.width,t.height=j.isPhone()?s.Mobile.height:s.PC.height),t.mask==null&&(t.mask={}),typeof t.mask.enable!="boolean"&&(t.mask.enable=!0),t.mask.clickEvent==null&&(t.mask.clickEvent={}),typeof t.mask.clickEvent.toClose!="boolean"&&(t.mask.clickEvent.toClose=k.pops.clickMaskToCloseDialog.value),k.pops.popsAcrylic.value){let i=`
            .pops {
                --acrylic-opacity: 0.7;
                --acrylic-color: rgba(232, 232, 232, var(--acrylic-opacity));
                --acrylic-blur: 30px;
                --acrylic-saturate: 125%;
                --pops-bg-opacity: var(--acrylic-opacity);
            }
            .pops {
                backdrop-filter: blur(var(--acrylic-blur)) saturate(var(--acrylic-saturate));
                background-color: var(--acrylic-color);
            }
            .pops[type-value=panel]{
                --aside-bg-color: rgba(221, 221, 221, var(--acrylic-opacity));
            }
            `;typeof t.style=="string"?t.style+=i:t.style=i;}return t.zIndex=()=>{let i=d.getMaxZIndex(10),e=j.config.InstanceUtils.getPopsMaxZIndex(i).zIndex;return d.getMaxValue(i,e)+100},t}},me={LanZouDiskApp:"lanZouY-disk-app",EncryptList:["Y","y","0","Z","z","N","n","M","I","6","m","W","w","1","X","x","L","l","K","7","k","i","U","u","2","V","v","J","j","8","G","g","F","S","s","3","T","t","H","h","f","E","e","D","Q","q","4","R","r","9","d","a","C","c","B","O","o","5","P","p","b","A"],decodeChar(t){for(let s=0;s<this.EncryptList.length;s++)if(t==this.EncryptList[s])return s;return -1},idEncrypt(t){let s=1,i=0;if(t!=""&&t.length>4){let e;t=t.substring(3,t.length-1);for(let a=0;a<t.length;a++)e=t.charAt(t.length-a-1),i+=this.decodeChar(e)*s,s*=62;}return i},encrypt(t){const s=Cryptojs.enc.Utf8.parse(this.LanZouDiskApp),i=Cryptojs.enc.Utf8.parse(t);return Cryptojs.AES.encrypt(i,s,{mode:Cryptojs.mode.ECB,padding:Cryptojs.pad.Pkcs7})},encryptHex(t){return this.encrypt(t,this.LanZouDiskApp).ciphertext.toString().toUpperCase()}};class yt extends X{constructor(){super(...arguments);z(this,"uuid");z(this,"userId");z(this,"shareCodeId");}async init(i,e,a){var r,l,c,h;const n=this;u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a,n.shareCodeId=n.getDecodeShareCodeId(e),n.uuid=n.getEncodeUUID();let o=await this.recommendList(3,"Chrome",n.uuid,2,n.getEncodeTimeStamp(),n.shareCodeId,0,1,60);if(o&&o.list.length){if((l=(r=o.list[0])==null?void 0:r.map)!=null&&l.userId)n.userId=(h=(c=o.list[0])==null?void 0:c.map)==null?void 0:h.userId;else {f.error("解析获取【userId】为空");return}if(o.list[0].folderIds==null){u.success("该链接是 单文件");let p=o.list[0].fileList[0],y=await n.parseFolderInfo(o.list[0].fileList,0)[0].clickEvent();if(y&&!Array.isArray(y)){let v=y.url;D.isForwardDownloadLink("lanzouyx")&&(v=D.parseDataToSchemeUri("lanzouyx",v)),w.staticView.oneFile({title:"蓝奏云优享单文件直链",fileName:p.fileName,fileSize:p.fileSize*1024,downloadUrl:v,fileUploadTime:d.formatToTimeStamp(p.updTime),fileLatestTime:d.formatToTimeStamp(p.updTime)});}}else {u.success("该链接是 多文件"),f.info("正在递归文件");let p=f.loading("正在解析多文件中，请稍后..."),m=n.parseFolderInfo(o.list[0].fileList,0);p.close(),u.info("递归完毕"),w.staticView.moreFile("蓝奏云优享解析",m);}}}parseFolderInfo(i,e){const a=this;let n=[],o=[],r=[];return i.forEach(l=>{l.fileType===2?o.push({fileName:l.folderName,fileSize:0,fileType:"",createTime:new Date(l.updTime).getTime(),latestTime:new Date(l.updTime).getTime(),isFolder:!0,index:e,async clickEvent(c,h){let p=Date.now(),m=a.getEncodeTimeStamp(p),y=l.folderId,v=await a.getFolderInfo(3,"Chrome",a.uuid,2,m,a.shareCodeId,y,1,60);return v&&v.list?a.parseFolderInfo(v.list,e+1):[]}}):r.push({fileName:l.fileName,fileSize:l.fileSize*1024,fileType:"",createTime:new Date(l.updTime).getTime(),latestTime:new Date(l.updTime).getTime(),isFolder:!1,index:e,async clickEvent(){let c=l.fileId,h=l.userId||a.userId,p=a.uuid;if(d.isNull(h)){f.error("获取【userId】为空");return}if(d.isNull(p)){f.error("获取【uuid】为空");return}let m=await a.getDownloadFileUrl(...a.getDownloadFileParams(c,h,p));if(m)return D.isForwardDownloadLink("lanzouyx")&&(m=D.parseDataToSchemeUri("lanzouyx",m)),{url:m,autoDownload:!0,mode:"aBlank"}}});}),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),n=n.concat(o),n=n.concat(r),n}async recommendList(i=3,e="Chrome",a="",n=2,o="",r="",l=0,c=1,h=60){let p=await b.post(`https://api.ilanzou.com/unproved/recommend/list?devType=${i}&devModel=${e}&uuid=${a}&extra=${n}&timestamp=${o}&shareId=${r}&type=${l}&offset=${c}&limit=${h}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()},responseType:"json"});if(!p.status)return;let m=d.toJSON(p.data.responseText);if(u.success(["获取链接信息：",m]),m.code!==200){f.error("请求链接信息失败");return}if(!m.list.length){f.error("获取链接信息为空");return}return m}async getFolderInfo(i=6,e="Chrome",a="",n=2,o="",r="",l="",c=1,h=60){let p=await b.post(`https://api.ilanzou.com/unproved/share/list?devType=${i}&devModel=${e}&uuid=${a}&extra=${n}&timestamp=${o}&shareId=${r}&folderId=${l}&offset=${c}&limit=${h}`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()}});if(!p.status)return;let m=d.toJSON(p.data.responseText);if(u.success(["获取文件列表信息：",m]),m.code===200)return m;f.error(m.msg);}async getDownloadFileUrl(i="",e=1,a=6,n="",o="",r=""){let l=await b.options(`https://api.ilanzou.com/unproved/file/redirect?downloadId=${i}&enable=${e}&devType=${a}&uuid=${n}&timestamp=${o}&auth=${r}`,{});if(l.status){if(u.success(l),l.data.responseText){let c=d.toJSON(l.data.responseText);u.error(c),f.error(c.msg);return}return l.data.finalUrl}}getEncodeUUID(i=21){return ((a=21)=>crypto.getRandomValues(new Uint8Array(a)).reduce((n,o)=>(o&=63,n+=o<36?o.toString(36):o<62?(o-26).toString(36).toUpperCase():o>62?"-":"_",n),""))(i)}getDecodeShareCodeId(i){return me.idEncrypt(i)}getEncodeTimeStamp(i=Date.now()){return me.encryptHex(i)}getDownloadFileParams(i,e="",a){const n=this;let o=Date.now(),r=me.encryptHex(i+"|"+e),l=1,c=6,h=n.getEncodeTimeStamp(o),p=me.encryptHex(i+"|"+o);return [r,l,c,a,h,p]}gotoLogin(){F.confirm({title:{position:"center",text:"蓝奏云优享"},content:{text:"必须先在【蓝奏云优享】进行登录，然后登录成功后刷新获取必备的下载参数【uuid】和【userId】。",html:!1},btn:{reverse:!0,position:"end",ok:{text:"前往",enable:!0,callback(){window.open("https://www.ilanzou.com","_blank");}}}},w.popsStyle.tianYiYunLoginTip);}}class xt extends X{constructor(){super(...arguments);z(this,"shareId");z(this,"shareMode",1);z(this,"code",{ShareNotFoundFlatDir:"抱歉，该文件的分享平铺目录未找到",ShareNotFound:"抱歉，您访问的页面地址有误，或者该页面不存在。",ShareAuditNotPass:"抱歉，该内容审核不通过",FileNotFound:"抱歉，文件不存在",ShareExpiredError:"抱歉，您访问的页面地址有误，或者该页面不存在",ShareAuditWaiting:"抱歉，该链接处于审核中",ShareInfoNotFound:"抱歉，您访问的页面地址有误，或者该页面不存在",FileTooLarge:"抱歉，文件太大，不支持下载",InvalidSessionKey:"天翼云PC端Cookie未生成，是否前去登录？<br />&nbsp;&nbsp;&nbsp;&nbsp;(注意,需要当前浏览器的UA切换成PC且在登录后要等待进入个人云空间后生成Cookie，不是手机端浏览的个人云空间，那样生成的Cookie无法使用)"});}async init(i,e,a){const n=this;u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a;let o=await n.getShareInfoByCodeV2(e);if(o){if(u.info(["解析的JSON信息",o]),o.needAccessCode&&d.isNull(n.accessCode)){f.error("密码不正确!"),w.newAccessCodeView(void 0,"tianyiyun",n.netDiskIndex,n.shareCode,n.accessCode,r=>{n.init(n.netDiskIndex,n.shareCode,r);});return}if("shareId"in o?this.shareId=o.shareId:this.shareId=await n.getShareId(e,a),"shareMode"in o&&(this.shareMode=o.shareMode),this.shareId!=null)if(o.isFolder){f.info("正在递归文件");let r=f.loading("正在解析多文件中，请稍后..."),l=o.fileId,c=await n.listShareDir(e,a,void 0,void 0,l,l,void 0,this.shareId,void 0,void 0,void 0);if(!c){r.close();return}let h=n.getFolderInfo(e,a,c,0);r.close(),u.info("递归完毕"),w.staticView.moreFile("天翼云文件解析",h);return}else {let r=await n.getDownloadUrl(n.shareCode,n.accessCode,o.fileId,this.shareId);r&&(D.isForwardDownloadLink("tianyiyun")&&(r=D.parseDataToSchemeUri("tianyiyun",r)),w.staticView.oneFile({title:"天翼云单文件直链",fileName:o.fileName,fileSize:d.formatByteToSize(o.fileSize),downloadUrl:r,fileUploadTime:o.fileCreateDate,fileLatestTime:o.fileLastOpTime}));}}}async getUserBriefInfo(i){const e=this;let a=await b.get("https://cloud.189.cn/api/portal/v2/getUserBriefInfo.action",{headers:{Accept:"application/json;charset=UTF-8",Referer:"https://cloud.189.cn/web/share?code="+i,"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror(){}});if(u.info(a),!a.status){let o=d.toJSON(a.data.responseText);o.res_code in e.code?f.error(e.code[o.res_code]):f.error("请求异常");return}let n=d.toJSON(a.data.responseText);if(n.res_code===0)return n}async getShareInfoByCodeV2(i){const e=this;let a=await b.post({url:"https://cloud.189.cn/api/open/share/getShareInfoByCodeV2.action",data:`shareCode=${i}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+i,Origin:"https://cloud.189.cn"},allowInterceptConfig:!1,onerror(){}});if(!a.status){let r=d.toJSON(a.data.responseText);u.error(["获取下载参数失败的JSON信息",r]),r.res_code in e.code?f.error(e.code[r.res_code]):f.error(r.res_message);return}let n=a.data;u.info(n);let o=d.toJSON(n.responseText);if(o.res_code==0)return o;e.code.hasOwnProperty(o.res_code)?f.error(e.code[o.res_code]):f.error("获取FileId失败");}async getShareId(i,e){let a=await b.get({url:`https://cloud.189.cn/api/open/share/checkAccessCode.action?shareCode=${i}&accessCode=${e}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:`https://cloud.189.cn/web/share?code=${i}`},responseType:"json"});if(!a.status)return;let n=a.data;u.info(n);let o=d.toJSON(n.responseText);if(o.res_code===0&&"shareId"in o)return o.shareId;f.error("获取shareId失败"),u.info(o);}getNoCacheValue(){let i="";for(let e=0;e<17;e++)i+=d.getRandomValue(1,9);return "0."+i}async getDownloadUrl(i,e,a,n){const o=this;let r=await b.get({url:`https://cloud.189.cn/api/open/file/getFileDownloadUrl.action?fileId=${a}&dt=1&shareId=${n}`,headers:{Accept:"application/json;charset=UTF-8","Cache-Control":"no-cache","User-Agent":d.getRandomPCUA(),Referer:`https://cloud.189.cn/web/share?code=${i}`,"Sign-Type":1},responseType:"json",allowInterceptConfig:!1,onerror(){}});if(u.info(r),!r.status){let h=d.toJSON(r.data.responseText);h.errorCode==="InvalidSessionKey"?o.gotoLogin(o.code.InvalidSessionKey):h.res_code in o.code?f.error(o.code[h.res_code]):f.error("请求异常");return}let l=r.data,c=d.toJSON(l.responseText);if(u.info(c),c.res_code===0)return c.fileDownloadUrl;c.res_code==="InvalidSessionKey"||c.errorCode==="InvalidSessionKey"?o.gotoLogin(o.code.InvalidSessionKey):o.code.hasOwnProperty(c.res_code)?f.error(o.code[c.res_code]):(f.error("请求失败"),u.error(l));}gotoLogin(i=""){F.confirm({title:{position:"center",text:"天翼云"},content:{text:i,html:!1},btn:{reverse:!0,position:"end",ok:{text:"前往",enable:!0,callback(){window.open("https://cloud.189.cn/api/portal/loginUrl.action?redirectURL=https://cloud.189.cn/web/main","_blank");}}}},w.popsStyle.tianYiYunLoginTip);}async listShareDir(i,e,a=1,n=60,o,r,l=!0,c,h=5,p="lastOpTime",m=!0){const y=this,v={pageNum:a,pageSize:n,fileId:o,shareDirFileId:r,isFolder:l,shareId:c,shareMode:this.shareMode,iconOption:h,orderBy:p,descending:m,accessCode:e};let T=await b.get(`https://cloud.189.cn/api/open/share/listShareDir.action?${d.toSearchParamsStr(v)}`,{headers:{Accept:"application/json;charset=UTF-8",Referer:`https://cloud.189.cn/web/share?code=${i}`,"Sign-Type":1,"User-Agent":d.getRandomPCUA()},responseType:"json",allowInterceptConfig:!1,onerror(){}});if(!T.status){let O=d.toJSON(T.data.responseText);u.error(["解析文件夹信息失败",O]),O.res_code in y.code?f.error(y.code[O.res_code]):"res_message"in O?f.error(O.res_message):f.error("解析文件夹信息失败");return}let $=T.data;u.info($);let N=d.toJSON($.responseText);if(N.res_code==0)return N.fileListAO;y.code.hasOwnProperty(N.res_code)?f.error(y.code[N.res_code]):f.error("获取FileId失败");}getFolderInfo(i,e,a,n=0){const o=this;let r=[],l=[],c=[];return a.folderList.forEach(h=>{r.push({fileName:h.name,fileSize:0,fileType:"",createTime:d.formatToTimeStamp(h.createDate),latestTime:d.formatToTimeStamp(h.lastOpTime),isFolder:!0,index:n,async clickEvent(){let p=await o.listShareDir(i,e,1,100,h.id,h.id,void 0,o.shareId,void 0,void 0,void 0);return p?o.getFolderInfo(i,e,p,n+1):[]}});}),a.fileList.forEach(h=>{r.push({fileName:h.name,fileSize:h.size,fileType:"",createTime:d.formatToTimeStamp(h.createDate),latestTime:d.formatToTimeStamp(h.lastOpTime),isFolder:!1,index:n,async clickEvent(){let p=await o.getDownloadUrl(i,e,h.id,o.shareId);if(p)return D.isForwardDownloadLink("tianyiyun")&&(p=D.parseDataToSchemeUri("tianyiyun",p)),{autoDownload:!0,mode:"aBlank",url:p}}});}),l.sort((h,p)=>h.fileName.localeCompare(p.fileName)),c.sort((h,p)=>h.fileName.localeCompare(p.fileName)),r=r.concat(l),r=r.concat(c),u.info(["getFolderInfo",r]),r}}class Ct extends X{constructor(){super(...arguments);z(this,"token");z(this,"code",{1004:"no token",1008:"您没有权限访问",1013:"糟糕，此任务已过期销毁，下次要记得续期",1066:"对方设置的下载 / 预览次数已用完",1088:"糟糕，您访问的页面不存在"});}async init(i,e,a){const n=this;if(u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a,f.info("正在请求直链中..."),!await this.getWssToken())return;let r=await this.getPid();r&&await this.getFileNList(r.bid,r.pid);}async getWssToken(){const i=this;let e=await b.post({url:"https://www.wenshushu.cn/ap/login/anonymous",responseType:"json",dataType:"json",data:JSON.stringify({dev_info:"{}"}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+i.shareCode}});if(u.success(e),!e.status)return;let a=d.toJSON(e.data.responseText);if(a.code===0)return i.token=a.data.token,a.data.token;a.code in i.code?f.error(i.code[a.code]):f.error("获取wss失败");}async getPid(){const i=this;let e=await b.post({url:"https://www.wenshushu.cn/ap/task/mgrtask",dataType:"json",responseType:"json",data:JSON.stringify({tid:i.shareCode,password:"",ufileid:""}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+i.shareCode,"x-token":i.token}});if(u.success(e),!e.status)return;let a=e.data,n=d.toJSON(a.responseText);if(n.code===0)return {bid:n.data.boxid,pid:n.data.ufileid};n.code in i.code?f.error(i.code[n.code]):f.error("获取pid失败");}async getFileNList(i,e){const a=this;let n=await b.post({url:"https://www.wenshushu.cn/ap/ufile/nlist",dataType:"json",responseType:"json",data:JSON.stringify({start:0,sort:{name:"asc"},bid:i,pid:e,options:{uploader:"true"},size:50}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+a.shareCode,"x-token":a.token}});if(u.success(n),!n.status)return;let o=n.data,r=d.toJSON(o.responseText);r.code===0?r.data.fileList[0].type===2?(f.error("该链接为多层级文件嵌套，跳转"),Q.openBlank(I.getBlankUrl("wenshushu",a.netDiskIndex,a.shareCode,a.accessCode),"wenshushu",a.netDiskIndex,a.shareCode,a.accessCode)):await a.getDownloadUrl(r.data.fileList[0]):r.code in a.code?f.error(a.code[r.code]):f.error("获取文件信息失败");}async getDownloadUrl(i){const e=this;let a=i.fname,n=d.formatByteToSize(i.size),o=await b.post({url:"https://www.wenshushu.cn/ap/dl/sign",dataType:"json",responseType:"json",data:JSON.stringify({ufileid:i.fid,consumeCode:0}),headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomAndroidUA(),Referer:"https://www.wenshushu.cn/f/"+e.shareCode,"x-token":e.token}});if(!o.status)return;u.success(o);let r=o.data,l=d.toJSON(r.responseText);if(l.code==0){let c=l.data.url;c===""?f.error("对方的分享流量不足"):(D.isForwardDownloadLink("wenshushu")&&(c=D.parseDataToSchemeUri("wenshushu",c)),w.staticView.oneFile({title:"文叔叔单文件直链",fileName:a,fileSize:n,downloadUrl:c}));}else l.data in e.code?f.error(e.code[l.data]):f.error("获取下载链接失败");}}class vt extends X{constructor(){super(...arguments);z(this,"panelList",[]);z(this,"Authorization","");z(this,"code",{5113:"您今日下载流量已超出10GB限制，购买VIP会员即可体验无限流量下载",5103:"分享码错误或者分享地址错误",5104:"分享已过期","-1000":"获取出错","-2000":"请求异常","-3000":"请求意外中止","-4000":"请求超时",104:"文件已失效"});}async init(i,e,a){const n=this;if(u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a,n.panelList=[],n.Authorization=Ie.get(),!await n.checkLinkValidity())return;let r=await n.getFiles();if(r)if(r.length===1&&r[0].Type==0){let l=r[0];if(l.Status==104){f.error("文件已失效");return}let c=l.DownloadUrl,h="";if(c===""){let y=await n.getFileDownloadInfo(l.Etag,l.FileId,l.S3KeyFlag,n.shareCode,l.Size);y&&y.code===0?(c=y.data.DownloadURL,D.isForwardDownloadLink("_123pan")&&(c=D.parseDataToSchemeUri("_123pan",c)),h=d.formatByteToSize(l.Size)):y&&y.code===401?(c="javascript:;",h="请登录后下载"):(c="javascript:;",h="获取下载链接失败");}else D.isForwardDownloadLink("_123pan")&&(c=D.parseDataToSchemeUri("_123pan",c)),h=d.formatByteToSize(l.Size);let p=new Date(l.CreateAt).getTime(),m=new Date(l.UpdateAt).getTime();p=d.formatTime(p),m=d.formatTime(m),w.staticView.oneFile({title:"123盘单文件直链",fileName:l.FileName,fileSize:h,downloadUrl:c,fileUploadTime:p,fileLatestTime:m});}else {f.info("正在递归文件");let l=f.loading("正在解析多文件中，请稍后..."),c=n.getFolderInfo(r,0);l.close(),u.info("递归完毕"),w.staticView.moreFile("123盘文件解析",c);}}async checkLinkValidity(){const i=this;f.info("正在校验链接有效性");let e=`https://www.123pan.com/s/${i.shareCode}`,a=await b.get({url:e,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://www.123pan.com"}});if(u.info(a),!a.status)return !1;let o=a.data.responseText.match(/window.g_initialProps[\s]*=[\s]*\{(.+?)\};/s);if(o){u.info(o);let r=d.toJSON(`{${o[o.length-1]}}`);if(u.info(r),r.res.code!==0)return f.error(r.res.message),!1;if(r.res.data.HasPwd&&(i.accessCode==null||i.accessCode===""))f.error("密码缺失!"),w.newAccessCodeView("密码缺失","_123pan",i.netDiskIndex,i.shareCode,i.accessCode,c=>{i.init(i.netDiskIndex,i.shareCode,c);});else return !0}else f.error("校验链接-获取初始化内容失败");}async getFiles(i=0){const e=this,a={limit:100,next:1,orderBy:"share_id",orderDirection:"desc",shareKey:e.shareCode,SharePwd:e.accessCode,ParentFileId:i,Page:1};let n=`https://www.123pan.com/b/api/share/get?${d.toSearchParamsStr(a)}`,o=await b.get({url:n,headers:{Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:`https://www.123pan.com/s/${e.shareCode}`}});if(u.info(o),!o.status)return;let r=o.data,l=d.toJSON(r.responseText);if(l.code===0)return l.data.InfoList;l.code===5103?w.newAccessCodeView(void 0,"_123pan",e.netDiskIndex,e.shareCode,e.accessCode,c=>{e.init(e.netDiskIndex,e.shareCode,c);}):e.code[l.code]?f.error(e.code[l.code]):"message"in l?f.error(l.message):f.error("123盘：未知的JSON格式");}async getFilesByRec(i){const e=this;let a=await b.get({url:`https://www.123pan.com/b/api/share/get?limit=100&next=1&orderBy=share_id&orderDirection=desc&shareKey=${e.shareCode}&SharePwd=${e.accessCode}&ParentFileId=${i}&Page=1`,headers:{Accept:"*/*","User-Agent":d.getRandomAndroidUA(),Referer:`https://www.123pan.com/s/${e.shareCode}`}});if(!a.status)return;let n=a.data;u.info(n);let o=d.toJSON(n.responseText);if(o.code==0)return o.data.InfoList}getFolderInfo(i,e){const a=this;let n=[],o=[],r=[];return i.forEach(l=>{l.Type?o.push({fileName:l.FileName,fileSize:0,fileType:"",createTime:new Date(l.CreateAt).getTime(),latestTime:new Date(l.UpdateAt).getTime(),isFolder:!0,index:e,async clickEvent(){let c=await a.getFilesByRec(l.FileId);return c?a.getFolderInfo(c,e+1):[]}}):r.push({fileName:l.FileName,fileSize:l.Size,fileType:"",createTime:new Date(l.CreateAt).getTime(),latestTime:new Date(l.UpdateAt).getTime(),isFolder:!1,index:e,async clickEvent(){if(l.Status==104)f.error("文件已失效");else if(l.DownloadUrl){let c=l.DownloadUrl;return D.isForwardDownloadLink("_123pan")&&(c=D.parseDataToSchemeUri("_123pan",c)),{url:c,autoDownload:!0,mode:"aBlank"}}else {let c=await a.getFileDownloadInfo(l.Etag,l.FileId,l.S3KeyFlag,a.shareCode,l.Size);if(c&&c.code===0)return {url:c.data.DownloadURL,autoDownload:!0,mode:"aBlank"};c&&c.code===401?f.error("请登录后下载"):f.error("获取下载链接失败");}}});}),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),n=n.concat(o),n=n.concat(r),n}async getFileDownloadInfo(i,e,a,n,o){const r=this;let l=r.getFileDownloadAuth(),c={"App-Version":"3",Platform:"web","Content-Type":"application/json;charset=UTF-8",Host:"www.123pan.com",Accept:"*/*","User-Agent":d.getRandomPCUA(),Referer:"https://www.123pan.com/s/"+n,Origin:"https://www.123pan.com"};r.Authorization&&Reflect.set(c,"Authorization","Bearer "+r.Authorization),u.success("获取下载链接加密参数："+l);let h=await b.post({url:`https://www.123pan.com/a/api/share/download/info?${l[0]}=${l[1]}`,data:JSON.stringify({Etag:i,FileID:e,S3keyFlag:a,ShareKey:n,Size:o}),responseType:"json",headers:c});if(!h.status)return;let p=h.data,m=d.toJSON(p.responseText);return u.info(m),m.code==0?(m.data.DownloadURL=await r.decodeDownloadUrl(m.data.DownloadURL),m):{code:m.code}}getFileDownloadAuth(){function i(n){var o,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8;if(arguments.length!==0){typeof n=="object"?o=n:((""+n).length===10&&(n=1e3*parseInt(n)),o=new Date(n));var l=n+6e4*new Date(n).getTimezoneOffset(),c=l+36e5*r;return o=new Date(c),{y:o.getFullYear(),m:o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,d:o.getDate()<10?"0"+o.getDate():o.getDate(),h:o.getHours()<10?"0"+o.getHours():o.getHours(),f:o.getMinutes()<10?"0"+o.getMinutes():o.getMinutes()}}}function e(n){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,r=function(){for(var m,y=[],v=0;v<256;v++){m=v;for(var T=0;T<8;T++)m=1&m?3988292384^m>>>1:m>>>1;y[v]=m;}return y},l=r(),c=n,h=-1,p=0;p<c.length;p++)h=h>>>8^l[255&(h^c.charCodeAt(p))];return h=(-1^h)>>>0,h.toString(o)}function a(n){var o="web",r=3,l=Math.round((new Date().getTime()+60*new Date().getTimezoneOffset()*1e3+288e5)/1e3).toString(),c="a,d,e,f,g,h,l,m,y,i,j,n,o,p,k,q,r,s,t,u,b,c,v,w,s,z",h=Math.round(1e7*Math.random()),p,m,y,v,T,$,N,O,q;for(var G in p=c.split(","),m=i(l),y=m.y,v=m.m,T=m.d,$=m.h,N=m.f,O=[y,v,T,$,N].join(""),q=[],O)q.push(p[Number(O[G])]);var P,E;return P=e(q.join("")),E=e("".concat(l,"|").concat(h,"|").concat(n,"|").concat(o,"|").concat(r,"|").concat(P)),[P,"".concat(l,"-").concat(h,"-").concat(E)]}return a("/a/api/share/download/info")}async decodeDownloadUrl(i){const e=this;if(i==="")return "";let n=new URL(i).search.replace(/^\?params=/gi,"");n=n.split("&")[0];try{let o=decodeURI(atob(n));u.info("正在获取重定向直链"),f.info("正在获取重定向直链");let r=await b.get({url:o,responseType:"json",headers:{"User-Agent":d.getRandomAndroidUA(),Referer:"https://www.123pan.com/s/"+e.shareCode,Origin:"https://www.123pan.com"},allowInterceptConfig:!1,onerror:function(){}});if(u.info(r),!r.status&&r.data.status!==210){let p=new URL(o);return p.searchParams.has("auto_redirect")?(p.searchParams.set("auto_redirect","1"),p.toString()):o}let l=r.data,c=d.toJSON(l.responseText),h=new URL(c.data.redirect_url);return h.searchParams.set("auto_redirect","1"),u.success(c),h.toString()}catch(o){return u.error(o),i}}}class bt extends X{constructor(){super(...arguments);z(this,"errorCode",{UnAuthorized:"请先登录坚果云账号"});}async init(i,e,a){const n=this;u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a;let o=await n.getRequestDownloadParams();if(o)if(o.isdir){let r=f.loading("正在遍历多文件信息..."),l=await n.getFolderInfo(o.hash);if(!l){r.close();return}let c=n.parseMoreFile(l,o.hash,o.name);r.close(),w.staticView.moreFile("坚果云文件解析",c);}else {let r=d.formatByteToSize(o.size),l=await n.getFileLink(o.hash,o.name);if(!l)return;D.isForwardDownloadLink("jianguoyun")&&(l=D.parseDataToSchemeUri("jianguoyun",l)),u.info(l),w.staticView.oneFile({title:"坚果云盘单文件直链",fileName:o.name,fileSize:r,downloadUrl:l});}}parseMoreFile(i,e="",a=""){const n=this;u.info(["解析多文件信息",i]);let o=[];return i.forEach(r=>{let l=r.relPath;l.startsWith("/")&&(l=l.replace(/^\//,"")),o.push({fileName:l,fileSize:r.size,fileType:"",createTime:r.mtime,latestTime:r.mtime,isFolder:!1,index:0,async clickEvent(){f.info("正在获取下载链接...");let c=await n.getDirLink(e,l,r.relPath);if(c)return f.success("获取成功！"),D.isForwardDownloadLink("jianguoyun")&&(c=D.parseDataToSchemeUri("jianguoyun",c)),u.info(c),{autoDownload:!0,mode:"aBlank",url:c}}});}),o}async getRequestDownloadParams(){const i=this;u.info("获取hash值"),f.info("正在获取请求信息");let e=/var[\s]*PageInfo[\s]*=[\s]*{([\s\S]+)};/i;new FormData().append("pd",i.accessCode);let n={url:`https://www.jianguoyun.com/p/${i.shareCode}`,data:i.accessCode===""?void 0:`pd=${i.accessCode}`,responseType:"html",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),Referer:`https://www.jianguoyun.com/p/${i.shareCode}`}},o;if(i.accessCode===""?o=await b.get(n):o=await b.post(n),!o.status)return;let r=o.data;u.info("请求信息"),u.info(r);let l=r.responseText.match(e);if(l){let c=l[l.length-1];c=`({${c}})`,c=window.eval(c),u.info(c);let h=c.name,p=c.size,m=c.hash,y=c.needsPassword,v=c.owner,T=c.isdir,$=c.errorCode;if(h=decodeURIComponent(h),u.success("是否是文件夹 ===> "+T),u.success("hash ===> "+m),u.success("name ===> "+h),u.success("size ===> "+p),y&&(i.accessCode==null||i.accessCode==="")){f.error("密码不正确!"),w.newAccessCodeView("密码缺失","jianguoyun",i.netDiskIndex,i.shareCode,i.accessCode,N=>{i.init(i.netDiskIndex,i.shareCode,N);});return}if($==="AuthenticationFailed"){f.error("密码错误"),w.newAccessCodeView(void 0,"jianguoyun",i.netDiskIndex,i.shareCode,i.accessCode,N=>{i.init(i.netDiskIndex,i.shareCode,N);});return}if(m===""||m==null){u.error("hash为空，可能文件被撤销分享了"),f.error("文件分享已被撤销");return}if(p==null&&T==!1){u.error("无size，可能文件被删除了"),f.error(`“${h}”文件已被拥有者（“${v}”）删除`);return}else return {name:h,hash:m,size:p,needsPassword:y,owner:v,isdir:T}}else r.responseText.match("对不起，找不到您指定的文件。")?(u.error("啊噢！ (404) 对不起，找不到您指定的文件。"),f.error("坚果云: 对不起，找不到您指定的文件。")):r.responseText.match("对不起，您的某些输入不正确。")?(u.error("可能该链接不需要访问码或者访问码有问题"),w.newAccessCodeView(void 0,"jianguoyun",i.netDiskIndex,i.shareCode,i.accessCode,c=>{i.init(i.netDiskIndex,i.shareCode,c);})):(u.error("获取PageInfo失败"),f.error("坚果云: 获取PageInfo失败"));}async getFileLink(i="",e=""){var l;const a=this;e=encodeURIComponent(e);let n=await b.get({url:`https://www.jianguoyun.com/d/ajax/fileops/pubFileLink?k=${i}&name=${e}&wm=false${a.accessCode===""?"":"&pd="+a.accessCode}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror:function(){}});if(!n.status){if(d.isNotNull((l=n.data)==null?void 0:l.responseText)){let c=d.toJSON(n.data.responseText);u.error(["坚果云",c]),c.errorCode==="UnAuthorized"?a.gotoLogin():f.error(c.detailMsg);}else f.error("请求异常");return}let o=n.data;u.info(["请求信息",o]);let r=d.toJSON(o.responseText);if(u.info(["解析JSON",r]),r.hasOwnProperty("errorCode")){f.error("坚果云: "+r.detailMsg);return}else {if(r.hasOwnProperty("url"))return r.url;f.error("坚果云: 处理下载链接异常");}}async getDirLink(i="",e="",a="/"){var c;const n=this;e=encodeURIComponent(e);let o=await b.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRLink?k=${i}&dn=${e}&p=${a}&forwin=1&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror:function(){}});if(!o.status){if(d.isNotNull((c=o.data)==null?void 0:c.responseText)){let h=d.toJSON(o.data.responseText);u.error(["坚果云",h]),h.errorCode==="UnAuthorized"?n.gotoLogin():f.error(h.detailMsg);}else f.error("请求异常");return}let r=o.data;u.info(["请求信息",r]);let l=d.toJSON(r.responseText);if(u.info(l),l.hasOwnProperty("errorCode")){f.error("坚果云: "+l.detailMsg);return}else {if(l.hasOwnProperty("url"))return l.url;f.error("坚果云: 处理下载链接异常");}}async getFolderInfo(i=""){let e=await b.get({url:`https://www.jianguoyun.com/d/ajax/dirops/pubDIRBrowse?hash=${i}&relPath=%2F&_=${new Date().getTime()}`,responseType:"json",headers:{"User-Agent":d.getRandomPCUA()}});if(!e.status)return;let a=e.data;u.info(["请求信息",a]);let n=d.toJSON(a.responseText);if(u.info(n),"objects"in n)return n.objects;f.error("坚果云: 处理多文件信息异常");}gotoLogin(){F.confirm({title:{text:"提示",position:"center"},content:{text:"解析失败，原因：当前尚未登录坚果云，是否前往登录？"},btn:{reverse:!0,position:"end",ok:{text:"前往",callback:function(i){window.open("https://www.jianguoyun.com/d/login#from=https%3A%2F%2Fwww.jianguoyun.com%2F","_blank");}}}},w.popsStyle.jianGuoYunLoginTip);}}class _t extends X{constructor(){super(...arguments);z(this,"panelList",[]);z(this,"panelContent","");z(this,"OK_CODE","0000");}async init(i,e,a){const n=this;u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a,n.panelList=[],n.panelContent="";let o=await n.checkLinkValidity(n.shareCode,n.accessCode);if(o)if(o.isFolder){f.info("正在递归文件");let r=f.loading("正在解析多文件中，请稍后..."),l=await n.getShareFolder(o.data.guid);if(!l){r.close();return}let c=await n.getShareFiles(o.data.guid);if(!c){r.close();return}let h=n.getFolderInfo(o.data.guid,l,c,0);r.close(),u.info("递归完毕"),w.staticView.moreFile("奶牛快传文件解析",h);}else {let r;if(o.zipDownload?r=await n.getZipFileDownloadUrl(n.shareCode,o.guid,o.fileName):r=await n.getDownloadUrl(n.shareCode,o.guid,o.id),!r)return;D.isForwardDownloadLink("nainiu")&&(r=D.parseDataToSchemeUri("nainiu",r)),w.staticView.oneFile({title:"奶牛快传单文件直链",fileName:o.fileName,fileType:o.fileType,fileSize:o.fileSize,downloadUrl:r,fileUploadTime:o.fileUploadTime,fileLatestTime:o.fileLatestTime,clickCallBack:l=>{n.downloadFile(o.fileName,r);}});}}async checkLinkValidity(i,e){const a=this;let n=await a.getShareByUniqueUrl(i);if(!n)return !1;let o=n.code,r=n.message;if(o!==a.OK_CODE)return f.error(r),!1;{let l=n.data.needPassword,c=n.data.zipDownload;return l&&d.isNull(e)?(f.error("密码缺失!"),w.newAccessCodeView("密码缺失","nainiu",a.netDiskIndex,a.shareCode,a.accessCode,h=>{a.init(a.netDiskIndex,a.shareCode,h);}),!1):c?(f.success("该链接为zip单文件"),{zipDownload:c,guid:n.data.guid,fileSize:d.formatByteToSize(n.data.firstFolder.size),fileName:n.data.firstFolder.title,fileUploadTime:d.formatTime(n.data.firstFolder.created_at),fileLatestTime:d.formatTime(n.data.firstFolder.updated_at)}):n.data.firstFile==null?(f.success("该链接为文件夹类型"),{isFolder:!0,guid:n.data.guid,firstFolder:n.data.firstFolder,data:n.data}):{zipDownload:c,guid:n.data.guid,id:n.data.firstFile.id,fileSize:d.formatByteToSize(n.data.firstFile.file_info.size),fileName:n.data.firstFile.file_info.title,fileType:n.data.firstFile.file_info.format,fileUploadTime:d.formatTime(n.data.firstFile.created_at),fileLatestTime:d.formatTime(n.data.firstFile.updated_at)}}}getFolderInfo(i,e,a,n=0){const o=this;let r=[],l=[],c=[];return e.forEach(h=>{r.push({fileName:h.title,fileSize:0,fileType:"",createTime:h.created_at,latestTime:h.updated_at,isFolder:!0,index:n,async clickEvent(){if(!h.child_folder_count&&!h.content_count)return [];let p=await o.getShareFolder(i,h.id);if(!p)return [];let m=await o.getShareFiles(i,h.id);return m?o.getFolderInfo(i,p,m,n+1):[]}});}),a.forEach(h=>{let p=h.file_info.title,m=h.file_info.format??"";m&&(p=p+"."+m),r.push({fileName:p,fileSize:h.file_info.size,fileType:m,createTime:h.created_at,latestTime:h.updated_at,isFolder:!1,index:n,async clickEvent(){let y=await o.getDownloadUrl(o.shareCode,i,h.id);y&&(D.isForwardDownloadLink("nainiu")&&(y=D.parseDataToSchemeUri("nainiu",y)),o.downloadFile(p,y));}});}),l.sort((h,p)=>h.fileName.localeCompare(p.fileName)),c.sort((h,p)=>h.fileName.localeCompare(p.fileName)),r=r.concat(l),r=r.concat(c),u.info(["getFolderInfo",r]),r}async parseMoreFile(i,e){}async getShareFolder(i,e="",a=0,n=100){const o=this;let r=await b.get(`https://cowtransfer.com/core/api/transfer/share/folders?transferGuid=${i}&folderId=${e}&page=${a}&size=${n}`,{headers:{Accept:"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/"}});if(u.success(r),!r.status)return;let l=d.toJSON(r.data.responseText);if(l.code!==o.OK_CODE){f.error(l.message);return}let c=l.data.folders;if(!Array.isArray(c)){f.error("data.folders不是数组");return}return c}async getShareFiles(i,e="",a=0,n=20,o=!1){const r=this;let l=await b.get(`https://cowtransfer.com/core/api/transfer/share/files?transferGuid=${i}&folderId=${e}&page=${a}&size=${n}&subContent=${o}`,{headers:{Accept:"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/"}});if(u.success(l),!l.status)return;let c=d.toJSON(l.data.responseText);if(c.code!==r.OK_CODE){f.error(c.message);return}let h=c.data.files;if(!Array.isArray(h)){f.error("data.files不是数组");return}return h}async getShareByUniqueUrl(i){let e=`https://cowtransfer.com/core/api/transfer/share?uniqueUrl=${i}`,a=await b.get({url:e,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+i}});if(u.info(a),!a.status)return;let n=a.data,o=d.toJSON(n.responseText);return u.info(["转换的JSON",o]),o}async getDownloadUrl(i,e="",a=""){const n=this;let o=`https://cowtransfer.com/core/api/transfer/share/download?transferGuid=${e}&fileId=${a}`,r=await b.get({url:o,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+i}});if(u.info(r),!r.status)return;let l=r.data,c=d.toJSON(l.responseText);if(u.info(["转换的JSON",c]),c.code===n.OK_CODE)return c.data.downloadUrl;f.error(`奶牛快传-获取直链：${c.message}`);}async getZipFileDownloadUrl(i,e="",a=""){const n=this;let o=`https://cowtransfer.com/core/api/transfer/share/download?transferGuid=${e}&title=${a}`,r=await b.get({url:o,headers:{"User-Agent":d.getRandomPCUA(),Referer:"https://cowtransfer.com/s/"+i}});if(u.info(r),!r.status)return;let l=r.data,c=d.toJSON(l.responseText);if(u.info(["转换的JSON",c]),c.code===n.OK_CODE)return c.data.downloadUrl;f.error(`奶牛快传-获取直链：${c.message}`);}async downloadFile(i,e){const a=this;if(u.info(["下载文件：",i,e]),f.info(`调用【GM_download】下载：${i}`),typeof ke>"u"){f.error("当前脚本环境缺失API 【GM_download】");return}let n,o=f.loading("下载中...",{showClose:!0,onClose(){typeof n=="function"&&n();}}),r=!1,l=ke({url:e,name:i,headers:{Referer:"https://cowtransfer.com/s/"+a.shareCode},onload(){o.close(),f.success(`下载 ${i} 已完成`);},onprogress(c){if(typeof c=="object"&&"loaded"in c&&"total"in c&&!r){let p=(c.loaded/c.total*100).toFixed(2);o.setText(`下载中...${p}%`),c.loaded===c.total&&(r=!0);}},onerror(c){o.close(),u.error(["下载失败error👉",c]),typeof c=="object"&&c.error?f.error(`下载 ${i} 失败或已取消 原因：${c.error}`,{timeout:6e3}):f.error(`下载 ${i} 失败或已取消`);},ontimeout(){o.close(),f.error(`下载 ${i} 请求超时`);}});typeof l=="object"&&"abort"in l&&(n=l.abort);}}class At extends X{async init(s,i,e){const a=this;if(u.info([s,i,e]),a.netDiskIndex=s,a.shareCode=i,a.accessCode=e,f.info("检查是否已登录UC网盘"),!await a.isLogin()){a.gotoLogin("检测到尚未登录UC网盘，是否前去登录？<br />&nbsp;&nbsp;&nbsp;&nbsp;(注意,需要当前浏览器的UA切换成PC才有登录选项)");return}let o=await a.getStoken(a.shareCode,a.accessCode);if(!o)return;let r=await a.getDetail(a.shareCode,a.accessCode,o);if(!r){f.error("UC网盘：获取detail失败");return}if(r.length===1&&r[0].dir==!1&&r[0].file_type===1){let l=r[0],c=await a.getDownload(a.shareCode,o,l.fid,l.share_fid_token);if(!c)return;if(!c[0].download_url){f.error("获取download_url失败");return}w.staticView.oneFile({title:"UC网盘单文件直链",fileName:c[0].file_name,fileSize:d.formatByteToSize(c[0].size),downloadUrl:c[0].download_url,fileUploadTime:d.formatTime(c[0].created_at),fileLatestTime:d.formatTime(c[0].last_update_at),clickCallBack(){a.downloadFile(c[0].file_name,c[0].download_url);}});}else {f.info("正在递归文件");let l=f.loading("正在解析多文件中，请稍后..."),c=a.getFolderInfo(r,o,0);l.close(),u.info("递归完毕"),w.staticView.moreFile("UC网盘文件解析",c);return}}async isLogin(){let s=await b.get("https://drive.uc.cn/",{headers:{"User-Agent":d.getRandomPCUA()}});if(u.success(["判断是否已登录UC网盘",s]),!!s.status)return s.data.finalUrl==="https://drive.uc.cn/list"?"已登录":!1}downloadFile(s,i){if(u.info(["调用【GM_download】下载：",arguments]),f.info(`调用【GM_download】下载：${s}`),typeof ke>"u"){f.error("当前脚本环境缺失API 【GM_download】");return}let e=f.loading("下载中..."),a=!1;return ke({url:i,name:s,headers:{Referer:"https://drive.uc.cn/"},onload(){e.close(),f.success(`下载 ${s} 已完成`);},onprogress(n){if(typeof n=="object"&&"loaded"in n&&"total"in n&&!a){let r=(n.loaded/n.total*100).toFixed(2);e.setText(`下载中...${r}%`),n.loaded===n.total&&(a=!0);}},onerror(n){e.close(),u.error(["下载失败error👉",n]),typeof n=="object"&&n.error?f.error(`下载 ${s} 失败或已取消 原因：${n.error}`,{timeout:6e3}):f.error(`下载 ${s} 失败或已取消`);},ontimeout(){e.close(),f.error(`下载 ${s} 请求超时`);}})}gotoLogin(s=""){F.confirm({title:{position:"center",text:"UC网盘"},content:{text:s,html:!1},btn:{reverse:!0,position:"end",ok:{text:"前往",enable:!0,callback(){window.open("https://drive.uc.cn","_blank");}}}},w.popsStyle.tianYiYunLoginTip);}async getStoken(s,i){let e=await b.post("https://pc-api.uc.cn/1/clouddrive/share/sharepage/token?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({share_for_transfer:!0,passcode:i,pwd_id:s}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"},allowInterceptConfig:!1,onerror(){}});if(!e.status){let n=d.toJSON(e.data.responseText);u.error(["获取stoken失败JSON信息",n]),"message"in n?f.error(n.message):f.error("请求异常，获取stoken失败");return}let a=d.toJSON(e.data.responseText);if(u.info(["获取stoken：",a]),a.code!==0){u.error(["获取stoken失败",a]),f.error("获取stoken失败");return}return a.data.stoken}async getDetail(s,i,e,a=0,n=0,o=1,r=50,l=0,c=0,h=1){let p=await b.get(`https://pc-api.uc.cn/1/clouddrive/transfer_share/detail?pr=UCBrowser&fr=h5&pwd_id=${s}&__t=${new Date().getTime()}&passcode=${i}&stoken=${encodeURIComponent(e)}&pdir_fid=${a}&force=${n}&_page=${o}&_size=${r}&_fetch_banner=${l}&_fetch_share=${c}&_fetch_total=${h}&_sort=${encodeURIComponent("file_type:asc,file_name:asc")}`,{headers:{Accept:"application/json, text/plain, */*","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!p.status)return;let m=d.toJSON(p.data.responseText);if(u.info(["获取detail：",m]),m.code!==0){u.error(["获取detail失败",m]),f.error("获取detail失败");return}let y=m.metadata;return y&&y._total&&y._total>y._size?await this.getDetail(s,i,e,a,n,o,y._total,l,c,h):m.data.list}async getDownload(s,i,e,a){let n=await b.post("https://pc-api.uc.cn/1/clouddrive/file/download?entry=ft&fr=pc&pr=UCBrowser",{data:JSON.stringify({fids:[e],pwd_id:s,stoken:i,fids_token:[a]}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://drive.uc.cn",Referer:"https://drive.uc.cn/"}});if(!n.status)return;let o=d.toJSON(n.data.responseText);if(u.info(["获取download：",o]),o.code!==0){u.error(["获取download失败",o]),f.error("获取download失败");return}if(o.data.length===0){u.error(["获取download detail失败",o]),f.error("获取download detail失败失败");return}return o.data}getFolderInfo(s,i,e=0){const a=this;let n=[],o=[],r=[];return s.forEach(l=>{l.dir==!1&&l.file_type===1?r.push({fileName:l.file_name,fileSize:l.size,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:!1,index:e,async clickEvent(){let c=await a.getDownload(a.shareCode,i,l.fid,l.share_fid_token);if(c&&c.length?c=c[0].download_url:c="",l.ban)f.error("文件已被禁止下载");else {let h=c;if(D.isForwardDownloadLink("uc")&&(h=D.parseDataToSchemeUri("uc",h)),h===c)a.downloadFile(l.file_name,c);else return {autoDownload:!0,mode:"aBlank",url:c}}}}):o.push({fileName:l.file_name,fileSize:l.size,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:!0,index:e,async clickEvent(){if(l.include_items===0)return u.success("里面没有文件"),[];let c=await a.getDetail(a.shareCode,a.accessCode,i,l.fid);return c?a.getFolderInfo(c,i,e+1):[]}});}),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),n=n.concat(o),n=n.concat(r),u.info(["getFilesInfoByRec",n]),n}}class St extends X{constructor(){super(...arguments);z(this,"X_Share_Token_Data",{expire_time:"2000-01-01T00:00:00.000Z",expires_in:7200,share_token:""});z(this,"X_Device_Id",null);z(this,"X_Canary","client=web,app=share,version=v2.3.1");}async init(i,e,a){const n=this;if(u.info([i,e,a]),n.netDiskIndex=i,n.shareCode=e,n.accessCode=a,n.X_Device_Id=n.get_X_Device_Id(),u.info("生成X_Device_Id："+n.X_Device_Id),globalThis.location.hostname!=="www.aliyundrive.com"&&globalThis.location.hostname!=="www.alipan.com"){let c=I.getBlankUrl("aliyun",n.netDiskIndex,n.shareCode,n.accessCode),h=f.error(`请在阿里云盘页面解析，<a href="${c}">点我前往</a>`,{html:!0,timeout:1e4});C.on(h.$Qmsg.querySelector("a[href]"),"click",void 0,p=>{d.preventEvent(p),Q.openBlank(c,"aliyun",n.netDiskIndex,n.shareCode,n.accessCode);});return}let o=await this.list_by_share(e,"root");if(!o)return;f.info("正在解析链接");let r=f.loading("正在解析多文件中，请稍后..."),l=n.getFolderInfo(o,0);r.close(),u.info("解析完毕"),w.staticView.moreFile("阿里云盘文件解析",l);}getFolderInfo(i,e=0){const a=this;let n=[],o=[],r=[];return i.forEach(l=>{l.type!=="folder"?r.push({fileName:l.name,fileSize:l.size,fileType:l.file_extension,createTime:new Date(l.created_at).getTime(),latestTime:new Date(l.updated_at).getTime(),isFolder:!1,index:e,async clickEvent(){let c=await a.get_share_link_download_url(l.share_id,l.file_id);if(!c)return;let h=c;return D.isForwardDownloadLink("aliyun")&&(h=D.parseDataToSchemeUri("aliyun",h)),{autoDownload:!0,mode:"aBlank",url:h}}}):o.push({fileName:l.name,fileSize:0,fileType:"",createTime:l.created_at,latestTime:l.updated_at,isFolder:!0,index:e,async clickEvent(){let c=await a.list_by_share(l.share_id,l.file_id);return c?a.getFolderInfo(c,e+1):[]}});}),o.sort((l,c)=>l.fileName.localeCompare(c.fileName)),r.sort((l,c)=>l.fileName.localeCompare(c.fileName)),n=n.concat(o),n=n.concat(r),u.info(["getFilesInfoByRec",n]),n}async list_by_share(i,e,a="name",n="DESC"){const o=this;let r=await b.post("https://api.aliyundrive.com/adrive/v2/file/list_by_share",{data:JSON.stringify({share_id:i,parent_file_id:e,limit:20,image_thumbnail_process:"image/resize,w_256/format,jpeg",image_url_process:"image/resize,w_1920/format,jpeg/interlace,1",video_thumbnail_process:"video/snapshot,t_1000,f_jpg,ar_auto,w_256",order_by:a,order_direction:n}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":o.X_Canary,"X-Device-Id":o.X_Device_Id,"X-Share-Token":await o.get_X_Share_Token(o.shareCode,o.accessCode),"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror(){}});if(!r.status){o.handle_request_error(r);return}let l=d.toJSON(r.data.responseText);return u.info(["列出文件列表：",l]),l.items}async get_share_link_download_url(i,e){const a=this;let n=await b.post("https://api.aliyundrive.com/v2/file/get_share_link_download_url",{data:JSON.stringify({expire_sec:600,file_id:e,share_id:i}),headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer "+a.getAuthorization(),"X-Share-Token":await a.get_X_Share_Token(a.shareCode,a.accessCode),"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror(){}});if(!n.status){a.handle_request_error(n);return}let o=d.toJSON(n.data.responseText);return u.info(["获取文件的下载链接：",o]),o.download_url}handle_request_error(i){u.error(i);let e=d.toJSON(i.data.responseText);f.error(e.message);}getAuthorization(){let i=Z.localStorage.getItem("token");if(d.isNotNull(i)&&i!=null){let a=d.toJSON(i).access_token;return u.success(["获取阿里云盘的access_token：",a]),a}else u.error("获取access_token失败，请先登录账号！"),f.error("获取access_token失败，请先登录账号！");}async get_X_Share_Token(i,e){const a=this;if(new Date<new Date(a.X_Share_Token_Data.expire_time))return a.X_Share_Token_Data.share_token;let n=await b.post("https://api.aliyundrive.com/v2/share_link/get_share_token",{data:JSON.stringify({share_id:i,share_pwd:e}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:"https://www.aliyundrive.com",Referer:"https://www.aliyundrive.com/","X-Canary":a.X_Canary,"X-Device-Id":a.X_Device_Id,"User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror(){}});if(!n.status){a.handle_request_error(n);return}let o=d.toJSON(n.data.responseText);return a.X_Share_Token_Data=o,u.info(["获取share_token：",a.X_Share_Token_Data]),a.X_Share_Token_Data.share_token}get_X_Device_Id(){for(var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,e=[],a=0;a<256;++a)e.push((a+256).toString(16).substr(1));function n(){return crypto.getRandomValues(new Uint8Array(16))}var o=function(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=(e[l[c+0]]+e[l[c+1]]+e[l[c+2]]+e[l[c+3]]+"-"+e[l[c+4]]+e[l[c+5]]+"-"+e[l[c+6]]+e[l[c+7]]+"-"+e[l[c+8]]+e[l[c+9]]+"-"+e[l[c+10]]+e[l[c+11]]+e[l[c+12]]+e[l[c+13]]+e[l[c+14]]+e[l[c+15]]).toLowerCase();if(!function(p){return typeof p=="string"&&i.test(p)}(h))throw TypeError("Stringified UUID is invalid");return h},r=function(l,c,h){var p=(l=l||{}).random||(l.rng||n)();return p[6]=15&p[6]|64,p[8]=63&p[8]|128,o(p)};return r()}}const we={netDisk:{baidu:kt,lanzou:wt,lanzouyx:yt,tianyiyun:xt,wenshushu:Ct,_123pan:vt,jianguoyun:bt,nainiu:_t,uc:At,aliyun:St}},I={isAllowMode(t){return ["copy","openBlank"].includes(t)},isAllowExtendMode(t){return ["parseFile"].includes(t)},getBlankUrl(t,s,i,e){let a=_.regular[t][s],n=a.blank;i&&(n=V.replaceParam(n,{shareCode:i})),e&&e!==""?n=V.replaceParam(n,{accessCode:e}):n=n.replace(_.noAccessCodeRegExp,"");let o=_.linkDict.get(t).get(i);if(a.paramMatch){let r=o.matchText.match(a.paramMatch),l={};for(let c=0;c<r.length;c++)l[`$${c}`]=r[c];n=V.replaceParam(n,l);}return n},getCopyUrlInfo(t,s,i,e){let a=_.regular[t][s],n=a.copyUrl;i&&(n=V.replaceParam(n,{shareCode:i})),e&&e!==""?n=V.replaceParam(n,{accessCode:e}):n=n.replace(_.noAccessCodeRegExp,"");let o=_.linkDict.get(t).get(i);if(a.paramMatch){let r=o.matchText.match(a.paramMatch),l={};for(let c=0;c<r.length;c++)l[`$${c}`]=r[c];n=V.replaceParam(n,l);}return n},async getRedirectFinalUrl(t,s){if(!k.function.getTheDirectLinkAfterRedirection.value)return t;f.success("获取重定向后的直链"),u.info("开始获取重定向后的直链");let i=await b.head({url:t,headers:{"User-Agent":s,Referer:window.location.origin}});return i.status?i.data.finalUrl:t}},Q={copy(t,s,i,e,a="已复制"){d.setClip(I.getCopyUrlInfo(t,s,i,e)),f.success(a);},async parseFile(t,s,i,e){f.info("正在获取直链"),we.netDisk[t]?await new we.netDisk[t]().init(s,i,e):(u.error(`${t} 不存在解析`),f.error("该链接不存在解析功能"));},openBlank(t,s,i,e,a){var n;u.success(["新标签页打开",[...arguments]]),le.$data.enable&&le.setValue({url:t,netDiskName:s,netDiskIndex:i,shareCode:e,accessCode:a}),D.isForwardBlankLink(s)&&(t=D.parseDataToSchemeUri(s,t)),(n=document.querySelector("meta[name='referrer']"))==null||n.setAttribute("content","no-referrer"),d.isNotNull(a)&&g.linkClickMode_openBlank.openBlankWithCopyAccessCode(s)?d.setClip(a).then(()=>{window.open(t,"_blank");}):window.open(t,"_blank");},openBlankWithScheme(t,s,i,e){let a=I.getBlankUrl(t,s,i,e);a=D.parseDataToSchemeUri(t,a),window.open(a,"_blank");}},Rt={async init(t,s,i){let e=I.getBlankUrl("baidu",t,s,i),a=await b.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:"pan.baidu.com",Referer:e,Origin:"https://pan.baidu.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),n=a.data.responseText;return !a.status&&d.isNull(n)||a.data.finalUrl.includes("404.html")?x.status.error:n.includes("过期时间：")?x.status.success:n.includes("输入提取")?x.status.needAccessCode:n.includes("不存在")||n.includes("已失效")?x.status.failed:x.status.unknown}},Tt={async init(t,s,i){let e=I.getBlankUrl("lanzou",t,s,i),a=new URL(e),n=await b.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:a.hostname,Origin:a.origin,Referer:e},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!n.status)return x.status.error;let o=n.data.responseText;return d.isNull(o)?x.status.failed:o.includes("输入密码")?x.status.needAccessCode:o.includes("来晚啦")||o.includes("不存在")?x.status.failed:x.status.success}},Dt={async init(t,s,i){let e=new we.netDisk.lanzouyx;e.uuid=e.getEncodeUUID(),e.shareCodeId=e.getDecodeShareCodeId(s);let a=3,n="Chrome",o=2,r=e.getEncodeTimeStamp(),p=await b.post(`https://api.ilanzou.com/unproved/recommend/list?devType=${a}&devModel=${n}&uuid=${e.uuid}&extra=${o}&timestamp=${r}&shareId=${e.shareCodeId}&type=0&offset=1&limit=60`,{headers:{Accept:"application/json, text/plain, */*",Origin:"https://www.ilanzou.com",Referer:"https://www.ilanzou.com/","Sec-Fetch-Site":"same-site",Host:"api.ilanzou.com","User-Agent":d.getRandomPCUA()},responseType:"json",allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!p.status)return x.status.error;let m=d.toJSON(p.data.responseText);return u.success(["获取链接信息：",m]),m.code!==200?x.status.error:m.list.length?x.status.success:x.status.failed}},Lt={async init(t,s,i){let e=await b.post("https://api.cloud.189.cn/open/share/getShareInfoByCodeV2.action",{data:`shareCode=${s}`,headers:{Accept:"application/json;charset=UTF-8","Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),"Sign-Type":1,Referer:"https://cloud.189.cn/web/share?code="+s,Origin:"https://cloud.189.cn"},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),a=e.data.responseText;return !e.status&&d.isNull(a)?x.status.error:a.includes("ShareInfoNotFound")||a.includes("ShareNotFound")||a.includes("FileNotFound")||a.includes("ShareAuditWaiting")||a.includes("ShareExpiredError")||a.includes("ShareAuditNotPass")?x.status.failed:a.includes("needAccessCode")?x.status.needAccessCode:x.status.success}},Nt={async init(t,s,i){let e=await b.post("https://caiyun.139.com/stapi/custom/outlink/brief",{data:"linkId="+s,headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":d.getRandomPCUA(),Host:"caiyun.139.com",Referer:I.getBlankUrl("hecaiyun",t,s,i),Origin:"https://caiyun.139.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!e.status)return x.status.error;let a=d.toJSON(e.data.responseText);return a.code==0?a.data.isPasswd==="1"?x.status.needAccessCode:x.status.success:x.status.failed}},Mt={async init(t,s,i){var n;let e=await b.post("https://api.aliyundrive.com/adrive/v3/share_link/get_share_by_anonymous?share_id="+s,{data:JSON.stringify({share_id:s}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json","User-Agent":d.getRandomPCUA(),Referer:"https://www.aliyundrive.com/",Origin:"https://www.aliyundrive.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),a=d.toJSON(e.data.responseText);return !e.status&&d.isNull(a)?x.status.error:a.code==="ParamFlowException"||a.code==="NotFound.ShareLink"||a.code==="ShareLink.Cancelled"||a.file_count===0||((n=a.file_infos)==null?void 0:n.length)===0?x.status.failed:x.status.success}},$t={async init(t,s,i){let e=await b.post("https://www.wenshushu.cn/ap/task/mgrtask",{data:JSON.stringify({tid:s}),headers:{"Content-Type":"application/json","User-Agent":d.getRandomPCUA(),"x-token":"wss:7pmakczzw6i",Host:"www.wenshushu.cn",Origin:"https://www.wenshushu.cn",Referer:I.getBlankUrl("wenshushu",t,s,i)},responseType:"json",allowInterceptConfig:!1,onerror(){},ontimeout(){}});return !e.status&&d.isNull(e.data.responseText)?x.status.error:d.toJSON(e.data.responseText).code!==0?x.status.failed:x.status.success}},Ut={async init(t,s,i){let e=await b.get("https://cowtransfer.com/core/api/transfer/share?uniqueUrl="+s,{headers:{"User-Agent":d.getRandomPCUA(),Host:"cowtransfer.com",Origin:"https://cowtransfer.com/",Referer:"https://cowtransfer.com/"}});if(!e.status&&d.isNull(e.data.responseText))return x.status.error;let a=d.toJSON(e.data.responseText);return a.code!="0000"?x.status.failed:a.data.needPassword&&a.data.needPassword?x.status.needAccessCode:x.status.success}},zt={async init(t,s,i){let e=await b.get("https://www.123pan.com/api/share/info?shareKey="+s,{headers:{"User-Agent":d.getRandomPCUA(),Host:"www.123pan.com",Origin:"https://www.123pan.com/",Referer:"https://www.123pan.com/"},allowInterceptConfig:!1,onerror(){},ontimeout(){},responseType:"json"});if(!e.status&&d.isNull(e.data.responseText))return x.status.error;let a=d.toJSON(e.data.responseText);return e.data.responseText.includes("分享页面不存在")||a.code!==0?x.status.failed:a.data.HasPwd?x.status.needAccessCode:x.status.success}},It={async init(t,s,i){let e=I.getBlankUrl("weiyun",t,s,i),a=await b.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:"share.weiyun.com",Origin:"https://share.weiyun.com",Referer:e},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!a.status&&d.isNull(a.data.responseText))return x.status.error;let n=a.data.responseText;return n.includes("已删除")||n.includes("违反相关法规")||n.includes("已过期")||n.includes("已经删除")||n.includes("目录无效")?x.status.failed:n.includes('"need_pwd":1')||n.includes('"pwd":"')?x.status.needAccessCode:x.status.success}},Et={async init(t,s,i){let e=await b.post("https://xluser-ssl.xunlei.com/v1/shield/captcha/init",{data:JSON.stringify({client_id:"Xqp0kJBXWhwaTpB6",device_id:"925b7631473a13716b791d7f28289cad",action:"get:/drive/v1/share",meta:{package_name:"pan.xunlei.com",client_version:"1.45.0",captcha_sign:"1.fe2108ad808a74c9ac0243309242726c",timestamp:"1645241033384"}}),headers:{"User-Agent":d.getRandomPCUA(),Host:"pan.xunlei.com",Referer:I.getBlankUrl("xunlei",t,s,i),Origin:"https://pan.xunlei.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!e.status&&d.isNull(e.data.responseText))return x.status.error;let n=d.toJSON(e.data.responseText).captcha_token,o=await b.get("https://api-pan.xunlei.com/drive/v1/share?share_id="+s,{headers:{"User-Agent":d.getRandomPCUA(),Host:"pan.xunlei.com",Referer:I.getBlankUrl("xunlei",t,s,i),Origin:"https://pan.xunlei.com","x-captcha-token":n,"x-client-id":"Xqp0kJBXWhwaTpB6","x-device-id":"925b7631473a13716b791d7f28289cad"},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!o.status&&d.isNull(o.data.responseText))return x.status.error;let r=o.data.responseText;return r.includes("NOT_FOUND")||r.includes("SENSITIVE_RESOURCE")||r.includes("EXPIRED")||r.includes("DELETED")?x.status.failed:r.includes("PASS_CODE_EMPTY")?x.status.needAccessCode:x.status.success}},Vt={async init(t,s,i){let e=await b.get(`https://webapi.115.com/share/snap?share_code=${s}&offset=0&limit=20&receive_code=&cid=`,{headers:{Accept:"application/json, text/javascript, */*;","User-Agent":d.getRandomPCUA(),Host:"webapi.115.com",Referer:"https://115.com/",Origin:"https://115.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!e.status)return d.isNull(e.data.responseText)?x.status.failed:x.status.error;let a=d.toJSON(e.data.responseText);if(a.state)return x.status.success;if(typeof a.error=="string"){if(a.error.includes("访问码"))return x.status.needAccessCode;if(a.error.includes("链接")||a.error.includes("分享已取消"))return x.status.failed}return x.status.unknown}},Ft={async init(t,s,i){let e=I.getBlankUrl("chengtong",t,s,i);const n=new URL(e).pathname.split("/")[1].trim();let o="";if(n==="f"||n==="file")o=`https://webapi.ctfile.com/getfile.php?path=${n}&f=${s}&passcode=${i}&token=0&r=${Math.random()}&ref=`;else if(n==="d"||n==="dir")o=`https://webapi.ctfile.com/getdir.php?path=${n}&d=${s}&folder_id=&passcode=${i}&token=0&r=${Math.random()}&ref=`;else return u.warn(["未知path",[t,s,i]]),x.status.unknown;let r=await b.get(o,{headers:{Host:"webapi.ctfile.com",Origin:"https://url95.ctfile.com",Referer:e,Accept:"application/json, text/javascript, */*; q=0.01","User-Agent":d.getRandomPCUA()},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),l=r.data.responseText;if(!r.status&&d.isNull(l))return x.status.error;let c=d.toJSON(l);return c.code===200?x.status.success:c.code===401?x.status.needAccessCode:c.code===404||c.code===503?x.status.failed:x.status.unknown}},Pt={async init(t,s,i){let a=await b.post("https://drive.quark.cn/1/clouddrive/share/sharepage/token?pr=ucpro&fr=pc",{data:JSON.stringify({pwd_id:s,passcode:""}),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8","User-Agent":d.getRandomPCUA(),Origin:"https://pan.quark.cn",Referer:I.getBlankUrl("kuake",t,s,i)},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!a.status&&d.isNull(a.data.responseText))return x.status.error;let n=d.toJSON(a.data.responseText);return n.message.includes("需要提取码")?x.status.needAccessCode:n.message.includes("ok")?x.status.success:x.status.failed}},Ot={async init(t,s,i){let e=I.getBlankUrl("jianguoyun",t,s,i),a=await b.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:"www.jianguoyun.com",Referer:I.getBlankUrl("jianguoyun",t,s,i),Origin:"https://www.jianguoyun.com"},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),n=a.data.responseText;return !a.status&&d.isNull(n)?x.status.error:n.includes("<h1>啊噢！")?x.status.failed:x.status.success}},Bt={async init(t,s,i){var r,l,c,h;let e=I.getBlankUrl("onedrive",t,s,i),a=new URL(e),n=await b.get(e,{headers:{"User-Agent":d.getRandomPCUA(),Host:a.hostname,Referer:e,Origin:a.origin},allowInterceptConfig:!1,onerror(){},ontimeout(){}});if(!n.status){let p=(l=(r=n.data)==null?void 0:r.status)==null?void 0:l.toString();return p==="429"?x.status.error:p==="404"?x.status.failed:x.status.error}let o=n.data.responseText;if(d.isNotNull(o))try{if((h=(c=C.parseHTML(o,!0,!0).querySelector("title"))==null?void 0:c.innerHTML)!=null&&h.includes("错误"))return x.status.failed}catch{}return x.status.success}},Ht={async init(t,s,i){let e=await b.get("https://drive.uc.cn/s/"+s,{headers:{"User-Agent":d.getRandomAndroidUA(),Host:"drive.uc.cn",Referer:I.getBlankUrl("uc",t,s,i),Origin:"https://drive.uc.cn"},allowInterceptConfig:!1,onerror(){},ontimeout(){}}),a=e.data.responseText;if(!e.status&&d.isNull(a))return x.status.error;let n=C.parseHTML(a,!0,!0);if(n.querySelector(".h5-page-main")){let o=n.querySelector(".h5-page-main"),r=o.textContent||o.innerText;return r.includes("失效")||r.includes("不存在")||r.includes("违规")||r.includes("删除")?x.status.failed:x.status.unknown}else return n.querySelector(".main-body .input-wrap input")?x.status.needAccessCode:x.status.success}},ue={view:{"netdisl-small-window-shrink-status":A("netdisl-small-window-shrink-status",!1),"netdisk-ui-small-window-position":A("netdisk-ui-small-window-position",null)}},ie={show(){w.Alias.uiLinkAlias==null?(this.createView(),this.initViewEvent()):w.Alias.uiLinkAlias.show();},getCSS(){return `
        .netdisk-url-box{
            border-bottom: 1px solid #e4e6eb;
        }
        .netdisk-url-div{display:flex;align-items:center;width:100%;padding:5px 0px 5px 0px}
        .netdisk-icon{display:contents}
        .netdisk-icon .netdisk-icon-img{
            cursor: pointer;
            width: 28px;
            height: 28px;
            min-width: 28px;
            min-height: 28px;
            font-size: 0.8em;
            margin: 0px 10px;
        }
        .netdisk-url-div .netdisk-icon,
        .netdisk-url-div .netdisk-status{
            flex: 0 0 auto;
        }
        .netdisk-url-div .netdisk-url{
            flex: 1;
        }
        .netdisk-icon .netdisk-icon-img{
            border-radius: 10px;
            box-shadow: 0 .3px .6px rgb(0 0 0 / 6%),0 .7px 1.3px rgb(0 0 0 / 8%),0 1.3px 2.5px rgb(0 0 0 / 10%),0 2.2px 4.5px rgb(0 0 0 / 12%),0 4.2px 8.4px rgb(0 0 0 / 14%),0 10px 20px rgb(0 0 0 / 20%)
        }
        .netdisk-status[data-check-failed]{
            padding: 5px 5px;
        }
        .netdisk-url{padding:5px 5px;}
        .netdisk-url a {
            color: #ff4848!important;
            min-height: 28px;
            overflow-x: hidden;
            overflow-y: auto;
            font-size: 0.8em;
            border: none;
            display: flex;
            align-items: center;
            width: 100%;
            height: 100%;
            padding: 0px;
            word-break: break-word;
            text-align: left;
        }
        .netdisk-status{
            display: none;
        }
        .netdisk-status[data-check-valid]{
            display: flex;
            align-items: center;
            width: 15px;
            height: 15px;
        }
        .netdisk-status[data-check-valid="failed"]{
            color: red;
        }
        .netdisk-status[data-check-valid="error"]{
            cursor: pointer;
        }
        .netdisk-status[data-check-valid="success"]{
            color: green;
        }
        .netdisk-status[data-check-valid="loading"] svg{
            animation: rotating 2s linear infinite;
        }
        .netdisk-url-box:has(.netdisk-status[data-check-valid="failed"]){
            text-decoration: line-through;
        }
        .whitesevPop-whitesevPopSetting :focus-visible{outline-offset:0;outline:0}
        .netdisk-url a[isvisited=true]{color:#8b8888!important}
        .netdisk-url a:active{box-shadow:0 0 0 1px #616161 inset}
        .netdisk-url a:focus-visible{outline:0}
        .whitesevPop-content p[pop]{text-indent:0}
        .whitesevPop-button[type=primary]{border-color:#2d8cf0;background-color:#2d8cf0}
        `},createView(){let t="";w.isMatchedNetDiskIconMap.forEach(i=>{let a=_.linkDict.get(i).getItems();Object.keys(a).forEach(n=>{let o=a[n],r=_.handleLinkShow(i,o.netDiskIndex,n,o.accessCode,o.matchText);t=t+this.getViewHTML(w.src.icon[i],i,o.netDiskIndex,n,o.accessCode,r);});});let s=`
            <div class="netdisk-url-box-all">
                ${t}
            </div>`;if(k.function["netdisk-behavior-mode"].value.toLowerCase().includes("smallwindow")){w.Alias.uiLinkAlias=F.alert({title:{text:"网盘",position:"center"},content:{text:s,html:!0},btn:{ok:{enable:!1},close:{callback(a){k.function["netdisk-behavior-mode"].value.toLowerCase().includes("suspension")?(J.mode.current_suspension_smallwindow_mode.value="suspension",a.hide(),w.suspension.show()):(w.Alias.uiLinkAlias=void 0,a.close());}}},mask:{enable:!1},animation:"",beforeAppendToPageCallBack(a,n){let o=a.querySelector(".pops-header-control"),r=a.querySelector(".pops-alert-content"),l=C.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                    <path fill="currentColor" d="M290.816 774.144h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m462.848-524.288h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m188.416 323.584c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
                                    </path>
                                </svg>
                                </i>
                                `},{type:"launch","data-header":!0}),c=C.createElement("button",{className:"pops-header-control",innerHTML:`
                                <i class="pops-icon">
                                <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                    <path fill="currentColor" d="M618.496 425.984h167.936c12.288 0 20.48 8.192 20.48 20.48s-8.192 20.48-20.48 20.48h-219.136c-12.288 0-20.48-8.192-20.48-20.48v-2.048-206.848c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v163.84l210.944-198.656c8.192-8.192 20.48-8.192 28.672 0s8.192 20.48 0 28.672l-208.896 194.56z m-192.512 172.032h-167.936c-12.288 0-20.48-8.192-20.48-20.48s8.192-20.48 20.48-20.48h219.136c12.288 0 20.48 8.192 20.48 20.48v208.896c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-163.84l-210.944 198.656c-8.192 8.192-20.48 8.192-28.672 0s-8.192-20.48 0-28.672l208.896-194.56z m516.096-24.576c0 12.288-8.192 20.48-20.48 20.48s-20.48-8.192-20.48-20.48v-389.12c0-34.816-26.624-61.44-61.44-61.44h-655.36c-34.816 0-61.44 26.624-61.44 61.44v655.36c0 34.816 26.624 61.44 61.44 61.44h655.36c34.816 0 61.44-26.624 61.44-61.44v-94.208c0-12.288 8.192-20.48 20.48-20.48s20.48 8.192 20.48 20.48v94.208c0 57.344-45.056 102.4-102.4 102.4h-655.36c-57.344 0-102.4-45.056-102.4-102.4v-655.36c0-57.344 45.056-102.4 102.4-102.4h655.36c57.344 0 102.4 45.056 102.4 102.4v389.12z">
                                    </path>
                                </svg>
                                </i>
                                `},{type:"shrink","data-header":!0});C.before(o,l),C.before(o,c),C.on(l,"click",void 0,function(){l.classList.add("pops-hide-important"),c.classList.remove("pops-hide-important"),r.classList.remove("pops-hide-important"),ue.view["netdisl-small-window-shrink-status"].value=!1;},{capture:!0}),C.on(c,"click",void 0,function(){c.classList.add("pops-hide-important"),l.classList.remove("pops-hide-important"),r.classList.add("pops-hide-important"),r.classList.add("pops-no-border-important"),ue.view["netdisl-small-window-shrink-status"].value=!0;},{capture:!0}),ue.view["netdisl-small-window-shrink-status"].value?c.click():l.click();},dragMoveCallBack(a,n,o){ue.view["netdisk-ui-small-window-position"].value={left:n,top:o};},class:"whitesevPop",style:`
                    ${this.getCSS()}

                    .pops {
                        --container-title-height: 35px;
                        --content-max-height: ${k.smallWindow["netdisk-ui-small-window-max-height"].value}px;
                        --netdisk-line-space: 8px;
                        --netdisk-icon-size: 24px;
                    }
                    .pops[type-value="alert"]{
                        transform: none;
                    }
                    .pops {
                        max-height: var(--content-max-height);
                    }
                    .pops[type-value=alert] .pops-alert-content{
                        max-height: calc(var(--content-max-height) - var(--container-title-height) - var(--container-bottom-btn-height));
                    }
                    .pops-header-controls button.pops-header-control[type][data-header]{
                        padding: 0px 5px;
                    }
                    .netdisk-url-div{
                        padding: 0px;
                    }
                    .netdisk-icon .netdisk-icon-img{
                        width: var(--netdisk-icon-size);
                        height: var(--netdisk-icon-size);
                        min-width: var(--netdisk-icon-size);
                        min-height: var(--netdisk-icon-size);
                        margin: 0px var(--netdisk-line-space);
                    }
                    .netdisk-status{
                        margin-right: var(--netdisk-line-space);
                    }
                    .netdisk-url{
                        padding: 2px 0px;
                    }
                    `},w.popsStyle.mainViewSmallWindow);let i=ue.view["netdisk-ui-small-window-position"].value,e=w.Alias.uiLinkAlias.popsElement;if(i){let a=C.width(e,!0),n=C.height(e,!0),o=C.width(window),r=C.height(window);const{transformLeft:l,transformTop:c}=C.getTransform(e);let h=o-a+l,p=r-n+c,m=0+l,y=0+c;i.top>p?i.top=p:i.top<y&&(i.top=y),i.left>h?i.left=h:i.left<m&&(i.left=m),e.style.transitionDuration="0s",e.style.left=i.left+"px",e.style.top=i.top+"px",setTimeout(()=>{e.style.transitionDuration="0s";},300);}}else w.Alias.uiLinkAlias=F.alert({title:{text:"网盘",position:"center"},content:{text:s,html:!0},btn:{ok:{enable:!1},close:{callback(i){w.Alias.uiLinkAlias=void 0,i.close();}}},mask:{clickCallBack(i){i(),w.Alias.uiLinkAlias=void 0;}},class:"whitesevPop",style:`
                    ${this.getCSS()}

                    .pops {
                        max-height: ${j.isPhone()?"50vh":"60vh"};
                    }
                    `},w.popsStyle.mainView);w.Alias.uiLinkAlias.popsElement.querySelectorAll(".netdisk-url-box-all .netdisk-url-box").forEach(i=>{let e=i.querySelector(".netdisk-link").getAttribute("data-netdisk"),a=parseInt(i.querySelector(".netdisk-link").getAttribute("data-netdisk-index")),n=i.querySelector(".netdisk-link").getAttribute("data-sharecode"),o=i.querySelector(".netdisk-link").getAttribute("data-accesscode");x.check(i,e,a,n,o);});},initViewEvent(){w.setRightClickMenu(w.Alias.uiLinkAlias.$shadowRoot,".whitesevPop .netdisk-url a"),this.registerIconGotoPagePosition(w.Alias.uiLinkAlias.$shadowRoot),this.setNetDiskUrlClickEvent(w.Alias.uiLinkAlias.$shadowRoot,".netdisk-url a"),w.setGlobalRightClickMenu(w.Alias.uiLinkAlias.$shadowRoot.querySelector(".pops .pops-alert-title > p"));},createElementAttributeRuleInfo(t){let s={"data-netdisk":t.netDisk,"data-netdisk-index":t.netDiskIndex,"data-sharecode":t.shareCode,"data-accesscode":t.accessCode},i="";return Object.keys(s).forEach(e=>{i+=`${e}="${s[e]}" `;}),i},praseElementAttributeRuleInfo(t){let s={netDiskName:t.getAttribute("data-netdisk"),netDiskIndex:parseInt(t.getAttribute("data-netdisk-index")),shareCode:t.getAttribute("data-sharecode"),accessCode:t.getAttribute("data-accesscode")};return isNaN(s.netDiskIndex)&&(u.warn(["元素上的netDiskIndex的值是NaN",t]),s.netDiskIndex=0),s},getViewHTML(t,s,i,e,a,n){return `
        <div class="netdisk-url-box">
            <div class="netdisk-url-div">
                <div class="netdisk-icon">
                    <div class="netdisk-icon-img"
                        style="background: url(${t}) no-repeat;background-size: 100%;"
						${this.createElementAttributeRuleInfo({netDisk:s,netDiskIndex:i,shareCode:e,accessCode:a})}
                    </div>
                </div>
                <div class="netdisk-status">

                </div>
                <div class="netdisk-url">
                    <a  class="netdisk-link"
                        href="javascript:;" 
                        isvisited="false"
						${this.createElementAttributeRuleInfo({netDisk:s,netDiskIndex:i,shareCode:e,accessCode:a})}>${n}</a>
                </div>
            </div>
        </div>`},setNetDiskUrlClickEvent(t,s){function i(e){e.target.setAttribute("isvisited","true");let a=e.target;const{netDiskName:n,netDiskIndex:o,shareCode:r,accessCode:l}=ie.praseElementAttributeRuleInfo(a);let c=g.function.linkClickMode(n);if(c==="copy")Q.copy(n,o,r,l);else if(c==="openBlank"){let h=I.getBlankUrl(n,o,r,l);g.schemeUri.isForwardBlankLink(n)?Q.openBlankWithScheme(n,o,r,l):Q.openBlank(h,n,o,r,l);}else c==="parseFile"?Q.parseFile(n,o,r,l):(u.error("未知点击动作："+c),f.error("未知点击动作："+c));}C.on(t,"click",s,i);},registerContextMenu(t,s,i=[],e="whitesevSuspensionContextMenu"){let a=[];i.forEach(o=>{a.push({icon:"",iconIsLoading:!1,text:o.text,callback:o.callback});});let n={target:t,targetSelector:s,data:a,isAnimation:!1,className:e,only:!0};F.rightClickMenu(n);},addLinkView(t,s,i,e,a){if(w.netDiskHistoryMatch.setNetDiskHistoryMatchData(t,s,i,e,a),!w.Alias.uiLinkAlias)return;u.info([t,s,i,e]);let n=w.src.icon[t],o=_.handleLinkShow(t,s,i,e,a),r=this.getViewHTML(n,t,s,i,e,o),l=w.Alias.uiLinkAlias.popsElement.querySelector(".netdisk-url-box-all");C.append(l,r),x.check(l.children[l.children.length-1],t,s,i,e);},changeLinkView(t,s,i,e,a){if(w.netDiskHistoryMatch.setNetDiskHistoryMatchData(t,s,i,e,a),!w.Alias.uiLinkAlias)return;let n=_.handleLinkShow(t,s,i,e,a),o=w.Alias.uiLinkAlias.popsElement.querySelector(`.netdisk-url a[data-sharecode='${i}'][data-netdisk-index='${s}']`);u.info("修改网盘链接视图"),u.info(o),o.setAttribute("data-accesscode",e),C.html(o,n);},registerIconGotoPagePosition(t){let s,i,e;C.on(t,"click",".whitesevPop .netdisk-icon .netdisk-icon-img",function(a){let o=a.target.getAttribute("data-sharecode");if(k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].value){if(typeof o!="string"){f.error("获取data-sharecode属性失败");return}if(e==null?e=o:e!==o&&(u.info(`上一个搜索：${e}，切换至：${o}`),s=void 0,i=void 0,e=o),s==null&&(s=d.findElementsWithText(document.documentElement,o),i=s.next()),i!=null&&i.value)if(u.success(["定位元素",i]),i.value.nodeType===Node.ELEMENT_NODE&&i.value.getClientRects().length){if(i.value.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let r=i.value.innerText||i.value.textContent,l,c,h;if(r.includes(o)){let p=Array.from(i.value.childNodes).filter(m=>m.nodeType===Node.TEXT_NODE);for(const m of p)if(m.textContent.includes(o)){l=m,c=m.textContent.indexOf(o),h=c+o.length;break}}try{d.selectElementText(i.value,l,c,h);}catch(p){u.error(p),d.selectElementText(i.value);}}}else if(i.value.nodeType===Node.TEXT_NODE&&i.value.parentElement.getClientRects().length)if(k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].value){let r=i.value.textContent||i.value.nodeValue,l=i.value,c=r.indexOf(o),h=c+o.length;try{d.selectElementText(i.value,l,c,h);}catch(m){u.error(m),d.selectElementText(i.value.parentElement);}let p=globalThis.getSelection();if(p.rangeCount>0){let y=p.getRangeAt(0).getBoundingClientRect(),v=globalThis.scrollY,T=y.top+v-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:T});}else i.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else try{let r=new Range;r.selectNodeContents(i.value);let l=r.getBoundingClientRect(),c=globalThis.scrollY,h=l.top+c-globalThis.innerHeight/2;globalThis.scrollTo({behavior:"smooth",top:h});}catch(r){u.error(r),i.value.parentElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});}else u.error(["无法定位该元素位置",i.value]),f.error(`无法定位该元素位置，类型：<${(i.value.nodeName||i.value.localName||i.value.tagName).toLowerCase()}>`,{html:!1});if(i=s.next(),i.done){if(!k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].value){f.info("已经定位至最后一个元素了");return}s=void 0,i=void 0;}}});}},jt={loading:{code:1,msg:"验证中",setView(t,s){x.setViewCheckValid(t,"loading"),t.innerHTML=j.config.iconSVG.loading;}},success:{code:200,msg:"该链接有效",setView(t,s){x.setViewCheckValid(t,"success"),t.innerHTML=`
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
				<path
				fill="currentColor"
				d="M874.119618 149.859922A510.816461 510.816461 0 0 0 511.997 0.00208a509.910462 509.910462 0 0 0-362.119618 149.857842c-199.817789 199.679789-199.817789 524.581447 0 724.260236a509.969462 509.969462 0 0 0 362.119618 149.857842A508.872463 508.872463 0 0 0 874.119618 874.120158c199.836789-199.679789 199.836789-524.581447 0-724.260236zM814.94268 378.210681L470.999043 744.132295a15.359984 15.359984 0 0 1-5.887994 4.095996c-1.751998 1.180999-2.913997 2.362998-5.276994 2.913997a34.499964 34.499964 0 0 1-13.469986 2.914997 45.547952 45.547952 0 0 1-12.897986-2.303998l-4.095996-2.363997a45.291952 45.291952 0 0 1-7.009992-4.095996l-196.902793-193.789796a34.126964 34.126964 0 0 1-10.555989-25.186973c0-9.37399 3.583996-18.74698 9.98399-25.186974a36.429962 36.429962 0 0 1 50.372947 0l169.98382 167.423824L763.389735 330.220732a37.059961 37.059961 0 0 1 50.371947-1.732998 33.647965 33.647965 0 0 1 11.165988 25.186973 35.544963 35.544963 0 0 1-9.98399 24.575974v-0.04z m0 0"></path>
			</svg>
			`,x.setViewAgainCheckClickEvent(t,s);}},error:{code:-404,msg:"网络异常",setView(t,s){x.setViewCheckValid(t,"error"),t.innerHTML=`
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
				<path
				fill="currentColor"
				d="M511.808 692.224c-18.048 0-35.136 3.968-50.432 11.392-25.472 12.416-46.528 33.92-57.792 60.032-5.632 14.144-9.024 29.504-9.024 45.952 0 65.152 52.672 117.824 117.248 117.824 65.28 0 117.952-52.672 117.952-117.824 0-64.64-52.672-117.376-117.952-117.376z m0 178.496c-33.408 0-60.608-27.712-60.608-61.12 0-33.472 27.2-60.672 60.608-60.672s61.248 27.2 61.248 60.672c0 33.472-27.776 61.12-61.248 61.12zM286.784 661.632c3.968 3.392 8.512 5.632 12.992 5.632L438.08 523.328c-60.032 14.72-114.432 49.344-155.328 98.624-9.536 11.84-7.872 30.08 4.032 39.68zM622.912 534.656l-43.008 45.312c45.312 13.056 86.72 40.256 117.376 78.208 5.632 6.784 13.568 10.24 22.08 10.24 6.272 0 12.416-2.24 18.176-6.784 11.904-9.6 13.568-27.84 3.392-39.68-31.808-39.104-72.704-69.12-118.016-87.296zM511.808 391.168c17.024 0 33.408 1.216 49.856 3.456l47.68-49.856c-31.744-6.848-64.064-10.24-97.536-10.24-142.784 0-277.12 63.488-367.232 174.656-10.24 11.904-8.576 30.08 3.904 39.68 5.12 4.48 11.328 6.784 18.176 6.784 7.936 0 15.872-3.968 21.568-10.816 79.872-97.536 197.76-153.664 323.584-153.664zM751.616 400.32l-40.256 41.92c47.04 24.96 89.536 60.032 124.096 102.592 10.24 12.48 27.84 14.208 40.256 3.968 11.968-9.6 13.632-27.84 3.968-39.68-36.16-44.8-79.872-81.088-128.064-108.8zM705.152 244.928l42.56-44.672c-73.664-28.992-153.6-44.224-235.904-44.224-196.672 0-380.864 87.872-505.6 239.744-9.6 12.48-7.872 30.08 3.968 40.256 5.632 3.968 11.904 6.208 18.112 6.208 7.936 0 16.448-3.392 22.144-10.176C163.84 292.608 332.096 212.672 511.808 212.672c66.944 0 132.16 10.752 193.344 32.256zM1017.472 395.776c-40.192-49.92-87.296-92.416-139.456-126.976l-39.68 41.344C889.408 343.04 935.36 383.808 973.888 432c9.6 11.904 27.776 13.568 39.68 3.968 11.84-10.176 14.144-27.712 3.904-40.192zM937.408 104.512c-11.328-10.944-29.312-10.496-40.064 0.832L179.008 854.72c-10.816 11.328-10.496 29.248 0.896 40.064 5.44 5.312 12.48 7.872 19.584 7.872 7.488 0 14.848-2.88 20.416-8.704L938.24 144.576c10.88-11.328 10.496-29.248-0.832-40.064z"></path>
			</svg>
			`,x.setViewAgainCheckClickEvent(t,s);}},failed:{code:0,msg:"该链接已失效",setView(t,s){x.setViewCheckValid(t,"failed"),t.innerHTML=`
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
				<path
					fill="currentColor"
					d="M549.044706 512l166.189176-166.249412a26.383059 26.383059 0 0 0 0-36.98447 26.383059 26.383059 0 0 0-37.044706 0L512 475.015529l-166.249412-166.249411a26.383059 26.383059 0 0 0-36.98447 0 26.383059 26.383059 0 0 0 0 37.044706L475.015529 512l-166.249411 166.249412a26.383059 26.383059 0 0 0 0 36.98447 26.383059 26.383059 0 0 0 37.044706 0L512 548.984471l166.249412 166.249411a26.383059 26.383059 0 0 0 36.98447 0 26.383059 26.383059 0 0 0 0-37.044706L548.984471 512zM512 1024a512 512 0 1 1 0-1024 512 512 0 0 1 0 1024z"></path>
			</svg>
			`,x.setViewAgainCheckClickEvent(t,s);}},needAccessCode:{code:201,msg:"该链接缺失提取码",setView(t,s){x.setViewCheckValid(t,"needAccessCode"),t.innerHTML=`
			<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
				<path
				fill="currentColor"
				d="M757.810429 373.751333 325.645708 373.751333l0-83.895759c0-103.694687 81.507362-184.922686 185.559183-184.922686 78.121242 0 146.053424 46.74565 173.062568 119.090329 3.865028 10.352789 15.384385 15.609513 25.742291 11.746532 10.351766-3.866051 15.609513-15.390525 11.744485-25.742291C688.844707 121.877815 606.198405 64.918545 511.204891 64.918545c-61.918211 0-119.246895 23.662933-161.423483 66.63156-41.3692 42.142819-64.151066 98.363262-64.151066 158.305469l0 83.895759-20.007683 0c-60.774155 0-110.042255 49.267077-110.042255 110.042255l0 366.139981c0 60.774155 49.267077 110.042255 110.042255 110.042255l492.187769 0c60.775178 0 110.042255-49.267077 110.042255-110.042255L867.852684 483.793588C867.852684 423.01841 818.585607 373.751333 757.810429 373.751333zM827.837318 849.933569c0 38.674834-31.352055 70.02689-70.02689 70.02689L265.62266 919.960459c-38.674834 0-70.02689-31.352055-70.02689-70.02689L195.59577 483.793588c0-38.674834 31.352055-70.02689 70.02689-70.02689l492.187769 0c38.674834 0 70.02689 31.352055 70.02689 70.02689L827.837318 849.933569z"></path>
				<path
				fill="currentColor"
				d="M509.715981 583.832002c-11.048637 0-20.007683 8.959046-20.007683 20.007683l0 110.042255c0 11.048637 8.958022 20.007683 20.007683 20.007683s20.007683-8.958022 20.007683-20.007683L529.723663 603.839685C529.723663 592.790024 520.765641 583.832002 509.715981 583.832002z"></path>
			</svg>
			`,x.setViewAgainCheckClickEvent(t,s);}},unknown:{code:-200,msg:"未知检查情况",setView(t,s){x.setViewCheckValid(t,"unknown"),t.innerHTML=`
			<svg viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg">
				<path
				fill="currentColor"
				d="M512.473172 1023.995242A511.814852 511.814852 0 0 1 313.545134 40.351073a512.244696 512.244696 0 0 1 398.855715 943.658633 508.815937 508.815937 0 0 1-199.927677 39.985536z m0-943.658634C274.559237 80.336608 80.629391 274.266455 80.629391 512.18039s193.929846 431.843781 431.843781 431.843781 431.843781-193.929846 431.843781-431.843781S751.386745 80.336608 512.473172 80.336608z"></path>
				<path
				fill="currentColor"
				d="M506.475342 716.10662a39.985535 39.985535 0 0 1-39.985536-39.985535v-76.972156c0-79.971071 64.976495-144.947566 144.947566-144.947565a77.971794 77.971794 0 0 0 0-155.943588H445.4974a56.979388 56.979388 0 0 0-56.979387 56.979388 39.985535 39.985535 0 0 1-79.971071 0c0-74.972879 60.977941-136.950458 136.950458-136.950459h164.940333c86.968539 0 157.942864 70.974325 157.942865 157.942865s-69.974687 157.942864-157.942865 157.942864a64.976495 64.976495 0 0 0-64.976494 64.976495v76.972156a39.985535 39.985535 0 0 1-38.985897 39.985535zM505.475703 742.097218a48.982281 48.982281 0 1 0 48.982281 48.982281 48.982281 48.982281 0 0 0-48.982281-48.982281z"></path>
			</svg>
			`,x.setViewAgainCheckClickEvent(t,s);}}},Zt={baidu:Rt,lanzou:Tt,lanzouyx:Dt,tianyiyun:Lt,hecaiyun:Nt,aliyun:Mt,wenshushu:$t,nainiu:Ut,_123pan:zt,weiyun:It,xunlei:Et,_115pan:Vt,chengtong:Ft,kuake:Pt,jianguoyun:Ot,onedrive:Bt,uc:Ht},x={$data:{isSubscribing:!1,subscribe:[]},status:jt,netDisk:Zt,async check(t,s,i,e,a){if(this.$data.subscribe.push({netDiskViewBox:t,netDiskName:s,netDiskIndex:i,shareCode:e,accessCode:a}),!this.$data.isSubscribing){this.$data.isSubscribing=!0;for(let n=0;n<this.$data.subscribe.length;n++){const o=this.$data.subscribe[n];await this.checkLinkValidity(o,!0),await d.sleep(250),this.$data.subscribe.splice(n,1),n--;}this.$data.isSubscribing=!1;}},async checkLinkValidity(t,s){let i=t.netDiskViewBox.querySelector(".netdisk-status");if(this.isViewCheckValid(i)&&!s)return;if(!_.regular[t.netDiskName][t.netDiskIndex].checkLinkValidity){u.error(["未配置checkLinkValidity",t]);return}let a=this.netDisk[t.netDiskName];if(!a||a&&typeof a.init!="function"){u.error(["没有配置该网盘的校验有效性",t]);return}this.status.loading.setView(i,t);let n=await a.init(t.netDiskIndex,t.shareCode,t.accessCode);if(!n){u.error(["该验证函数的返回值不是有效值",[n,t]]);return}n.setView(i,t);},setViewAgainCheckClickEvent(t,s){C.on(t,"click",void 0,()=>{const i=t.closest(".netdisk-url-div"),e=i.querySelector(".netdisk-link"),a=ie.praseElementAttributeRuleInfo(e);let n={netDiskViewBox:i,netDiskName:a.netDiskName,netDiskIndex:a.netDiskIndex,shareCode:a.shareCode,accessCode:a.accessCode};this.checkLinkValidity(n,!0);},{once:!0});},isViewCheckValid(t){return !(!t.hasAttribute("data-check-valid")||t.getAttribute("data-check-valid")==="error")},setViewCheckValid(t,s){t.setAttribute("data-check-valid",s);},removeViewCheckValid(t){t.removeAttribute("data-check-valid");},isStatusSuccess(t){return Math.floor(t.code/100)===2},getStatusName(t){for(const s of Object.keys(x.status)){let i=this.status[s];if(t.code===i.code)return s}}},qt={requiredFileMap:new Map,async file(t,s){if(d.isNull(t))return u.error(["NetDiskRequire.file的参数path为空",t]),!1;if(this.requiredFileMap.has(t))return u.warn(["NetDiskRequire.file的参数path已引入过",t]),!0;let i=await b.get(t,s);if(!i.status)return !1;let e=i.data.responseText,a=this.requiredFileMap.get(t);this.requiredFileMap.set(t,a++),u.info(["加载js文件",t]),Z.eval(`
		let exports = void 0;
		let module = void 0;
		let define = void 0;
		`+e),await d.sleep(300);}},he={handleShareCode(t,s,i){var o;let e=(o=t.match(s.shareCode))==null?void 0:o.filter(r=>d.isNotNull(r));if(i({status:!0,msg:["正则: shareCode","作用: 获取shareCode","结果: ",JSON.stringify(e)]}),d.isNull(e)){i({status:!1,msg:"匹配shareCode为空"});return}let a=e[0];i({status:!0,msg:["取第一个值: "+a]}),s.shareCodeNeedRemoveStr&&(a=a.replace(s.shareCodeNeedRemoveStr,""),i({status:!0,msg:["正则: shareCodeNeedRemoveStr","作用: 删除ShareCode前面不需要的字符串",`结果: ${a}`]}));let n=s.shareCodeNotMatch;if(n!=null&&a.match(n)){u.error(`不可能的shareCode => ${a}`),i({status:!1,msg:["正则: shareCodeNotMatch","作用: 用于判断提取到的shareCode是否是错误的shareCode","结果: true 该shareCode不是正确的"]});return}for(const r of _.shareCodeNotMatchRegexpList)if(a.match(r)){u.error(`不可能的shareCode => ${a}`),i({status:!1,msg:["正则: 内置的shareCodeNotMatchRegexpList","作用: 使用该正则判断提取到的shareCode是否正确","结果: true 该shareCode不是正确的"]});return}if(a=decodeURI(a),i({status:!0,msg:["对shareCode进行解码: "+a]}),k.aboutShareCode.excludeIdenticalSharedCodes.value&&d.isSameChars(a,k.aboutShareCode.excludeIdenticalSharedCodesCoefficient.value)){i({status:!1,msg:["已开启【排除分享码】且该分享码命中该规则"]});return}if(a.endsWith("http")||a.endsWith("https")){i({status:!1,msg:["该分享码以http|https结尾"]});return}return i({status:!0,msg:"处理完毕的shareCode: "+a}),a},handleAccessCode(t,s,i){var n;let e="";if(!s.checkAccessCode)return i({status:!0,msg:"因未配置规则checkAccessCode，默认accessCode的值为空"}),"";let a=t.match(s.checkAccessCode);if(i({status:!0,msg:["正则: checkAccessCode","作用: 用来判断link_innerText或者link_innerHTML匹配到的字符串中是否存在密码","结果: ",JSON.stringify(a)]}),a){let o=a[a.length-1];i({status:!0,msg:"取最后一个值: "+o});let r=(n=o.match(s.accessCode))==null?void 0:n.filter(l=>d.isNotNull(l));if(i({status:!0,msg:["正则: accessCode","作用: 用来提取link_innerText或者link_innerHTML匹配到的字符串中的密码","结果: ",JSON.stringify(r)]}),d.isNull(r))return i({status:!0,msg:"因↑匹配到的结果为空，默认accessCode的值为空"}),"";r.length&&(e=r[0],i({status:!0,msg:"取第一个值: "+e}),e.startsWith("http")&&(i({status:!0,msg:"排除不可能的accessCode，重置accessCode的值为空"}),e=""));}if(d.isNotNull(e)){for(const o of _.accessCodeNotMatchRegexpList)if(e.match(o)){e="",i({status:!0,msg:["正则: 内置的accessCodeNotMatchRegexpList","作用: 使用该正则判断提取到的accessCode是否正确","结果: true 重置accessCode为空"]});break}s.acceesCodeNotMatch&&e.match(s.acceesCodeNotMatch)&&(e="",i({status:!0,msg:["正则: acceesCodeNotMatch","作用: 用于判断提取到的accessCode是否是错误的accessCode","结果: true 重置accessCode为空"]}));}return i({status:!0,msg:"处理完毕的accessCode: "+e}),e},handleLinkShow(t,s,i,e,a){let n=V.replaceParam(s.uiLinkShow,{shareCode:i});if(a({status:!0,msg:["正则: uiLinkShow","作用: 用于显示在弹窗中的字符串","备注: 对shareCode进行参数替换",`结果: ${n}`]}),e&&e!=""?(n=V.replaceParam(n,{accessCode:e}),a({status:!0,msg:["正则: uiLinkShow","作用: 用于显示在弹窗中的字符串","备注: 对accessCode进行参数替换",`结果: ${n}`]})):(n=n.replace(_.noAccessCodeRegExp,""),a({status:!0,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${n}`]})),s.paramMatch&&d.isNotNull(t)){let o=t.match(s.paramMatch),r={};if(o)for(let l=0;l<o.length;l++)r[`$${l}`]=o[l];n=V.replaceParam(n,r),a({status:!0,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(r,void 0,4),`结果: ${n}`]});}return a({status:!0,msg:"处理完毕的uiLink: "+n}),n},handleBlank(t,s,i,e,a){let n=V.replaceParam(s.blank,{shareCode:i});if(a({status:!0,msg:["正则: blank","作用: 用于点击跳转的链接","备注: 对shareCode进行参数替换",`结果: ${n}`]}),e&&e!=""?(n=V.replaceParam(n,{accessCode:e}),a({status:!0,msg:["正则: blank","作用: 用于点击跳转的链接","备注: 对accessCode进行参数替换",`结果: ${n}`]})):(n=n.replace(_.noAccessCodeRegExp,""),a({status:!0,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${n}`]})),s.paramMatch&&d.isNotNull(t)){let o=t.match(s.paramMatch),r={};if(o)for(let l=0;l<o.length;l++)r[`$${l}`]=o[l];n=V.replaceParam(n,r),a({status:!0,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(r,void 0,4),`结果: ${n}`]});}return a({status:!0,msg:"处理完毕的blank: "+n}),n},handleCopyUrl(t,s,i,e,a){let n=V.replaceParam(s.copyUrl,{shareCode:i});if(a({status:!0,msg:["正则: copyUrl","作用: 用于复制到剪贴板的链接","备注: 对shareCode进行参数替换",`结果: ${n}`]}),e&&e!=""?(n=V.replaceParam(n,{accessCode:e}),a({status:!0,msg:["正则: copyUrl","作用: 用于复制到剪贴板的链接","备注: 对accessCode进行参数替换",`结果: ${n}`]})):(n=n.replace(_.noAccessCodeRegExp,""),a({status:!0,msg:["正则: 内置的noAccessCodeRegExp","作用: 因accessCode为空，使用该正则去除不需要的字符串",`结果: ${n}`]})),s.paramMatch&&d.isNotNull(t)){let o=t.match(s.paramMatch),r={};if(o)for(let l=0;l<o.length;l++)r[`$${l}`]=o[l];n=V.replaceParam(n,r),a({status:!0,msg:["正则: paramMatch","作用: 用于对matchText进行提取需要的关键内容，替换关键字：{#$1#}、{#$2#}...","参数: "+JSON.stringify(r,void 0,4),`结果: ${n}`]});}return a({status:!0,msg:"处理完毕的copyUrl: "+n}),n}},Ee={addBlockCSS(...t){let s=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(i=>{Array.isArray(i)?s=s.concat(i):s.push(i);}),Le(`${s.join(`,
`)}{display: none !important;}`)},setGMResourceCSS(t){let s=typeof De=="function"?De(t.keyName):"";typeof s=="string"&&s?Le(s):Ee.addLinkNode(t.url);},async addLinkNode(t){let s=document.createElement("link");return s.rel="stylesheet",s.type="text/css",s.href=t,C.ready(()=>{document.head.appendChild(s);}),s},fixUrl(t){return t=t.trim(),t.match(/^http(s|):\/\//i)||(t.startsWith("/")||(t+="/"),t=window.location.origin+t),t},async getClipboardText(){function t(e){navigator.clipboard.readText().then(a=>{e(a);}).catch(a=>{u.error(["读取剪贴板内容失败👉",a]),e("");});}function s(e){navigator.permissions.query({name:"clipboard-read"}).then(a=>{t(e);}).catch(a=>{u.error(["申请剪贴板权限失败，尝试直接读取👉",a.message??a.name??a.stack]),t(e);});}function i(){var e,a;return !(typeof((e=navigator==null?void 0:navigator.clipboard)==null?void 0:e.readText)!="function"||typeof((a=navigator==null?void 0:navigator.permissions)==null?void 0:a.query)!="function")}return new Promise(e=>{if(!i()){e("");return}document.hasFocus()?s(e):window.addEventListener("focus",()=>{s(e);},{once:!0});})}},ge={depthQueryShadowRootAllNode(t){let s=[];function i(e){let a=Array.from(e.querySelectorAll("*"));return a.forEach(n=>{if(n.classList&&n.classList.contains("pops-shadow-container"))return;let o=n.shadowRoot;o&&o instanceof ShadowRoot&&s.push({shadowRoot:o,childNode:i(o)});}),a}return i(t),s},ignoreStrRemove(t,s=!1){let i=[];return i.length&&i.forEach(e=>{if(e!=null)if(s)e.innerHTML!=null&&(t=t.replaceAll(e.innerHTML,""));else {let a=e.innerText||e.textContent;a!=null&&(a=a.replaceAll(a,""));}}),t},getPageText(t=document.documentElement,s){let i=[];if(i.push(t.innerText||t.textContent||""),s){let e=this.depthQueryShadowRootAllNode(t);e.length&&e.forEach(a=>{let n=a.shadowRoot.textContent;n&&i.push(n);});}return i},getPageHTML(t=document.documentElement,s){let i=[];if(i.push(t.innerHTML),s){let e=this.depthQueryShadowRootAllNode(t);e.length&&e.forEach(a=>{let n=a.shadowRoot.innerHTML;i.push(n);});}return i},getInputElementValue(t=document.documentElement,s){let i=[];if(Array.from(t.querySelectorAll("input")).forEach(e=>{i.push(e.value);}),s){let e=this.depthQueryShadowRootAllNode(t);e.length&&e.forEach(a=>{for(let n=0;n<a.childNode.length;n++){const o=a.childNode[n];o instanceof HTMLInputElement&&i.push(o.value);}});}return i},getTextAreaElementValue(t=document.documentElement,s){let i=[];if(Array.from(t.querySelectorAll("textarea")).forEach(e=>{i.push(e.value);}),s){let e=this.depthQueryShadowRootAllNode(t);e.length&&e.forEach(a=>{for(let n=0;n<a.childNode.length;n++){const o=a.childNode[n];o instanceof HTMLTextAreaElement&&i.push(o.value);}});}return i}},S={isHandleMatch:!1,delayNotMatchCount:0,dispatchMonitorDOMChange:!1,blobUrl:"",GM_matchWorker:void 0,init(){this.initWorkerBlobLink(),this.initWorker(),this.monitorDOMChange();},initWorkerBlobLink(){const t=`
        (() => {
            function ${S.handleRegularMatch.toString()}

            function ${S.uniqueArr}
            
            this.addEventListener(
            "message",
            function (event) {
                const data = event.data;
                let matchedList = [];
                ${S.handleRegularMatch.name}(data,(matchData)=>{
                	matchedList.push(matchData);
                })
                matchedList = ${S.uniqueArr.name}(matchedList);
                this.postMessage({
					options: data,
					msg: "Match End",
					data: matchedList,
					startTime: data.startTime,
					endTime: Date.now(),
                });
            },
            {
                capture: true,
            }
            );
        })();
  		`;let s=new Blob([t]);S.blobUrl=window.URL.createObjectURL(s),u.info(`Worker Blob Link ===> ${S.blobUrl}`);},handleRegularMatch(t,s){const i=Object.keys(t.regular);for(const e of i){const a=t.regular[e];for(let n=0;n<a.length;n++){const o=a[n];if(o.enable!=null&&!o.enable)continue;let r=[];if(t.matchTextRange.includes("innerText")&&r.push(new RegExp(o.link_innerText,"gi")),t.matchTextRange.includes("innerHTML")&&r.push(new RegExp(o.link_innerHTML,"gi")),!t.matchTextRange.length)throw console.error(t),new TypeError("未设置匹配范围");if(!r.length)throw new TypeError("未知的匹配范围: "+t.matchTextRange);for(let l=0;l<r.length;l++){const c=r[l];for(let h=0;h<t.textList.length;h++){let m=t.textList[h].match(c);m&&m.length&&s({netDiskName:e,netDiskIndex:n,data:m});}}}}},uniqueArr(t){return t.filter((s,i,e)=>i===e.findIndex(a=>JSON.stringify(a)===JSON.stringify(s)))},initWorker(){try{S.GM_matchWorker=new Worker(S.blobUrl),S.GM_matchWorker.onmessage=S.onMessage,S.GM_matchWorker.onerror=S.onError;}catch(t){u.error(["初始化Worker失败，可能页面使用了Content-Security-Policy策略，使用另类方法",t.message]),S.GM_matchWorker={postMessage(s){return new Promise((i,e)=>{let a=[];try{S.handleRegularMatch(s,n=>{a.push(n);});}catch(n){S.onError(n);}finally{a=S.uniqueArr(a),S.onMessage(new MessageEvent("message",{data:{options:s,msg:"Match End",data:a,startTime:s.startTime,endTime:Date.now()}})),i(null);}})}};}},postMessage(t,s){S.GM_matchWorker.postMessage(t,s);},onMessage(t){const s=t.data;s.data.length&&u.success(`成功匹配${s.data.length}个，用时${Date.now()-s.startTime}ms`),s.options.from==="PasteText"&&w.matchPasteText.workerMatchEndCallBack(s),s.options.from.startsWith("FirstLoad")&&S.delayNotMatchCount++,S.successCallBack(s);},onError(t){S.errorCallBack(t);},successCallBack(t){if(!t.data.length){S.matchingEndCallBack();return}const s=[];for(const e of t.data){_.matchLink.add(e.netDiskName);let a=new Set;e.data.forEach(n=>{a.add(n);}),a.forEach(n=>{let o=_.handleLink(e.netDiskName,e.netDiskIndex,n);o&&s.push({shareCode:o.shareCode,accessCode:o.accessCode,netDiskName:e.netDiskName,netDiskIndex:e.netDiskIndex,matchText:n});});}let i=s.filter((e,a,n)=>n.findIndex(r=>r.accessCode===e.accessCode&&r.netDiskIndex===e.netDiskIndex&&r.netDiskName===e.netDiskName&&r.shareCode===e.shareCode)===a);if(i.forEach(e=>{_.tempLinkDict.has(e.netDiskName)&&_.tempLinkDict.get(e.netDiskName).set(e.shareCode,e);}),i.forEach(e=>{const{shareCode:a,accessCode:n,netDiskName:o,netDiskIndex:r,matchText:l}=e,c=_.regular[o][r];if(c.shareCodeExcludeRegular&&Array.isArray(c.shareCodeExcludeRegular))for(const p of c.shareCodeExcludeRegular){let m=_.linkDict.get(p),y=_.tempLinkDict.get(p);if(m.startsWith(a)||y.startsWith(a)){u.warn(`${o}：该分享码【${a}】与已匹配到该分享码的规则【${p}】冲突`);return}}const h=_.linkDict.get(o);if(_.hasMatchLink=!0,h.startsWith(a)){let p=h.getStartsWith(a);if(typeof p.isForceAccessCode=="boolean"&&p.isForceAccessCode||d.isNotNull(p.accessCode)||d.isNull(n))return;h.set(a,_.getLinkDickObj(n,r,!1,l)),w.view.changeLinkView(o,r,a,n,l),u.info(`该匹配项无密码，设置密码 ${o} ${r}: ${a}  ===> ${n}`);}else h.set(a,_.getLinkDickObj(n,r,!1,l)),w.isMatchedNetDiskIconMap.add(o),w.view.addLinkView(o,r,a,n,l),u.success(`添加链接 ${o} ${r}: ${a}  ===> ${n}`);}),Object.keys(_.tempLinkDict.getItems()).forEach(e=>{_.tempLinkDict.get(e).clear();}),_.hasMatchLink)switch(k.function["netdisk-behavior-mode"].value){case"suspension_smallwindow".toLowerCase():J.mode.current_suspension_smallwindow_mode.value==="suspension"?w.suspension.show():w.view.show();break;case"suspension_window".toLowerCase():w.suspension.show();break;case"smallwindow".toLowerCase():w.view.show();break;default:u.error(["未知的行为模式："+k.function["netdisk-behavior-mode"].value]);}S.matchingEndCallBack();},errorCallBack(t){S.matchingEndCallBack(!0),u.error(["Worker Error",t]);},matchingEndCallBack(t){if(t)S.isHandleMatch=!1,S.delayNotMatchCount>0&&(S.delayNotMatchCount=0,S.dispatchMonitorDOMChange=!0);else {const s=parseFloat(k.match.delaytime.value.toString())*1e3;setTimeout(()=>{S.matchingEndCallBack(!0);},s);}},monitorDOMChange(){const t=k.match.isAddedNodesToMatch.value,s=k.match.readClipboard.value,i=k.match.pageMatchRange.value;let e=!0,a=!0,n=!0,o=k.match.depthQueryWithShadowRoot.value;async function r(c){if(S.isHandleMatch){S.delayNotMatchCount++;return}if(t&&c&&c.length){let m=!1;for(let y=0;y<c.length;y++){const v=c[y];if(v.addedNodes&&v.addedNodes instanceof NodeList&&v.addedNodes.length){m=!0;break}}if(!m)return}S.isHandleMatch=!0;const h=Date.now();if(s)try{_.clipboardText=await Ee.getClipboardText();}catch{}typeof _.clipboardText!="string"&&(_.clipboardText="");const p=[];if(_.clipboardText.trim()!==""&&p.push(_.clipboardText),k.match.allowMatchLocationHref&&p.push(V.getDecodeComponentUrl()),k.match.toBeMatchedWithInputElementValue&&p.push(...ge.getInputElementValue(document.documentElement,o)),k.match.toBeMatchedTextAreaElementValue&&p.push(...ge.getTextAreaElementValue(document.documentElement,o)),e&&(e=!1,p.length)){S.postMessage({textList:p,matchTextRange:i,regular:_.regular,startTime:h,from:"FirstLoad-DOMChange"});return}if(i.includes("innerText")){let m=ge.getPageHTML(document.documentElement,o);if(p.push(...m),a){a=!1,S.postMessage({textList:p,matchTextRange:i,regular:_.regular,startTime:h,from:"FirstLoad-Text-DOMChange"});return}}if(i.includes("innerHTML")){let m=ge.getPageHTML(document.documentElement,o);if(p.push(...m),n){n=!1,S.postMessage({textList:p,matchTextRange:i,regular:_.regular,startTime:h,from:"FirstLoad-HTML-DOMChange"});return}}S.postMessage({textList:p,matchTextRange:i,regular:_.regular,startTime:h,from:"DOMChange"});}d.mutationObserver(document.documentElement,{callback:r,config:{childList:k.match["mutationObserver-childList"].value,characterData:k.match["mutationObserver-characterData"].value,subtree:k.match["mutationObserver-subtree"].value}});let l=S.dispatchMonitorDOMChange;Object.defineProperty(S,"dispatchMonitorDOMChange",{set:function(c){l=c,c&&r([{addedNodes:[document.documentElement]}]);},get:function(){return l}}),this.dispatchMonitorDOMChange=!0;}},Wt={$el:{$select:null,$log:null,$matchText:null,$button:null},reset(){Object.keys(this.$el).forEach(t=>{Reflect.deleteProperty(this.$el,t);});},setLog(t,...s){let i="";s.forEach(a=>{i!==""&&(i+=`
`),typeof a!="string"?i+=JSON.stringify(a,void 0,4):i+=a;});let e=C.createElement("p",{innerText:i},{"data-tag":t});C.append(this.$el.$log,e);},clearLog(){this.$el.$log.innerHTML="";},showUI(t){if(this.reset(),d.isNull(t.regexp)){f.error("请先配置regexp");return}let s=this,e=H.parseRule([t])[0].rule,a=F.confirm({title:{text:`调试规则 ${t.key}`,position:"center"},content:{text:`
                    <div class="custom-rule-container">
                        <textarea class="custom-rule-match-text" placeholder="请输入需要测试匹配的字符串"></textarea>
                        <div class="custom-rule-input-container">
                        <select class="custom-rule-select-regexp"></select>
                        <button class="custom-rule-run-match-button" type="primary" data-icon="" data-righticon="false">
                            <span>执行</span>
                        </button>
                        </div>
                    </div>
                    <div class="custom-rule-match-log">
                        <div>匹配日志↓</div>
                        <div class="custom-rule-match-log-container"></div>
                    </div>
                    `,html:!0},btn:{ok:{enable:!1}},style:`
                .custom-rule-container{
                    display: flex;
                    align-items: center;
                }
                .custom-rule-select-regexp{
                    width: 100%;
                    height: 32px;
                    line-height: 32px;
                    border: 1px solid rgb(184, 184, 184, var(--pops-bd-opacity));
                    border-radius: 5px;
                    text-align: center;
                    outline: 0;
                    background: rgb(255, 255, 255, var(--pops-bg-opacity));
                    box-shadow: none;
                }
                .custom-rule-input-container{
                    display: flex;
                    flex-wrap: wrap;
                    justify-content: center;
                    margin: 5px;
                    width: 30%;
                }
                .custom-rule-select-regexp-item{

                }
                button.custom-rule-run-match-button{
                    margin-top: 5px;
                }
                textarea.custom-rule-match-text{
                    width: 100%;
                    min-height: 70px;
                    outline: none;
                    margin: 0px;
                    background-image: none;
                    background-color: transparent;
                    display: inline-block;
                    resize: vertical;
                    padding: 5px;
                    line-height: 1.5;
                    box-sizing: border-box;
                    border: 1px solid rgb(220, 223, 230);
                    appearance: none;
                }
                .custom-rule-match-log{

                }
                .custom-rule-match-log-container{
                    padding: 5px;
                    background: rgb(229, 229, 229);
                }
                .custom-rule-match-log-container p{
                    margin: 2px 0px;
                    border-bottom: 1px solid #000000;
                }
                .custom-rule-match-log-container p:last-child{
                    border-bottom: 0px;
                    margin-bottom: 0px;
                }
                .custom-rule-match-log-container p[data-tag]{
                
                }
                .custom-rule-match-log-container p[data-tag="info"]{

                }
                .custom-rule-match-log-container p[data-tag="success"]{
                    color: green;
                }
                .custom-rule-match-log-container p[data-tag="warn"]{
                    color: yellow;
                }
                .custom-rule-match-log-container p[data-tag="error"]{
                    color: red;
                }
                `},w.popsStyle.customRuleDebugView);this.$el.$select=a.$shadowRoot.querySelector(".custom-rule-select-regexp"),this.$el.$matchText=a.$shadowRoot.querySelector(".custom-rule-match-text"),this.$el.$log=a.$shadowRoot.querySelector(".custom-rule-match-log-container"),this.$el.$button=a.$shadowRoot.querySelector(".custom-rule-run-match-button"),e.forEach((r,l)=>{this.$el.$select.appendChild(C.createElement("option",{className:"custom-rule-select-regexp-item",innerText:"regexp下标:"+l,"data-value":r}));});function n(r){Array.isArray(r.msg)?s.setLog(r.status?"info":"error",...r.msg):s.setLog(r.status?"info":"error",r.msg),r.status||s.setLog("error","执行完毕");}function o(){try{if(d.isNull(s.$el.$matchText.value)){f.error("请先输入待匹配的字符串");return}s.clearLog();let r=t.key,l=s.$el.$select.selectedIndex,c=s.$el.$select.selectedOptions[l]["data-value"];u.info(["当前选中的规则: ",c]);let h={};h[t.key]=[c];let p=[];if(S.handleRegularMatch({regular:h,textList:[s.$el.$matchText.value],matchTextRange:["innerText","innerHTML"],startTime:Date.now(),from:"Debug"},m=>{p.push(...m.data);}),!p.length){s.setLog("error","未成功匹配到数据");return}p=S.uniqueArr(p),s.setLog("info","成功匹配到的数据 ==> ",p),p.forEach((m,y)=>{s.setLog("success","当前处理的字符串: "+m),s.setLog("success","当前执行: 对shareCode进行处理获取");let v=he.handleShareCode(m,c,n);if(d.isNull(v))return;s.setLog("info"," "),s.setLog("info","================分割线================"),s.setLog("info"," "),s.setLog("success","当前执行: 对accessCode进行处理获取");let T=he.handleAccessCode(m,c,n);s.setLog("info"," "),s.setLog("info","================分割线================"),s.setLog("info"," "),s.setLog("success","当前执行: 对uiLinkShow进行处理获取");let $=he.handleLinkShow(m,c,v,T,n);s.setLog("info"," "),s.setLog("info","================分割线================"),s.setLog("info"," "),s.setLog("success","当前执行: 对blank进行处理获取");let N=he.handleBlank(m,c,v,T,n);s.setLog("info"," "),s.setLog("info","================分割线================"),s.setLog("info"," "),s.setLog("success","当前执行: 对copyUrl进行处理获取");let O=he.handleCopyUrl(m,c,v,T,n);s.setLog("success","执行完毕");});}catch(r){u.error(r),s.setLog(r.toString());}}C.on(s.$el.$button,"click",void 0,o);}},H={key:"userRule",dataKey:"userRuleData",$data:{userRule:new d.Dictionary},init(){typeof R(this.dataKey)!="object"&&M(this.dataKey,{}),this.parseRule(this.getAllRule()).forEach(s=>{this.$data.userRule.set(s.setting.key,s);});},getCSS(){return `
        .pops[type-value=confirm] .pops-confirm-content{
            overflow: hidden;
        }
        /* textarea美化 */
        .pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea{
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            padding: 0;
            margin: 0;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: none;
            background-color: transparent;

            display: inline-block;
            resize: vertical;
            padding: 5px 15px;
            line-height: 1.5;
            box-sizing: border-box;
            border: 1px solid #dcdfe6;
            transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
            appearance: none;
            resize: none;
        }
        /* 获得焦点 */
        .pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea:focus{
            outline: none;
            border-color: #3677f0;
        }
        /* 提示文字 */
        .pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea::placeholder {
            color: #c0c4cc;
        }
        /* 鼠标hover */
        .pops.whitesevPopNetDiskCustomRules[type-value="confirm"] .pops-confirm-content textarea:hover {
            border-color: #c0c4cc;
        }
          `},parseRuleStrToRule(t){function s(e){return typeof e.link_innerText!="string"?{success:!1,msg:"regexp缺失的键名: link_innerText，类型: string"}:typeof e.link_innerHTML!="string"?{success:!1,msg:"regexp缺失的键名: link_innerHTML，类型: string"}:typeof e.shareCode!="string"?{success:!1,msg:"regexp缺失的键名: shareCode，类型: string"}:typeof e.shareCodeNeedRemoveStr!="string"?{success:!1,msg:"regexp缺失的键名: shareCodeNeedRemoveStr，类型: string"}:typeof e.uiLinkShow!="string"?{success:!1,msg:"regexp缺失的键名: uiLinkShow，类型: string"}:typeof e.blank!="string"?{success:!1,msg:"regexp缺失的键名: blank，类型: string"}:typeof e.copyUrl!="string"?{success:!1,msg:"regexp缺失的键名: copyUrl，类型: string"}:typeof e.accessCode=="string"&&typeof e.checkAccessCode!="string"?{success:!1,msg:"regexp设置了accessCode但是没有设置checkAccessCode"}:typeof e.accessCode!="string"&&typeof e.checkAccessCode=="string"?{success:!1,msg:"regexp设置了checkAccessCode但是没有设置accessCode"}:{success:!0,msg:"校验rule成功"}}function i(e){return typeof e.name!="string"?{success:!1,msg:"setting缺失的键名: name，类型: string"}:typeof e.enable!="boolean"?{success:!1,msg:"setting缺失的键名: enable，类型: boolean"}:{success:!0,msg:"校验setting成功"}}try{let e=JSON.parse(t);if(typeof e!="object")return {success:!1,msg:"该规则不是object类型"};if(typeof e.key!="string")return {success:!1,msg:"缺失的键名: key，类型: string"};if(typeof e.regexp!="object")return {success:!1,msg:"缺失的键名: regexp，类型: object|Arrany"};if(typeof e.setting!="object")return {success:!1,msg:"缺失的键名: setting，类型: object"};if(Array.isArray(e.regexp))for(const n of e.regexp){let o=s(n);if(!o.success)return o}else {let n=s(e.regexp);if(!n.success)return n}let a=i(e.setting);return a.success?{success:!0,msg:"解析成功",data:e}:a}catch(e){return u.error(e),{success:!1,msg:e.message}}},showUI(t,s){const i=this;let e="添加";t&&(e="编辑"),e+="自定义规则";let a=null;function n(c,h){let p=a.value.trim(),m=i.parseRuleStrToRule(p);if(m.success){let y=m.data;t?i.setRule(s,y):i.addRule(y),f.success("保存成功");}else f.error(m.msg);}function o(c){let h=a.value.trim(),p=i.parseRuleStrToRule(h);if(p.success){let m=p.data;Wt.showUI(m);}else f.error(p.msg);}function r(c){try{let h=JSON.parse(a.value),p=H.getFormatRule(h);a.value=p,f.success("格式化成功");}catch(h){u.error(h),f.error(h.message,{html:!0,timeout:3500});}}if(a=F.confirm({title:{text:e,position:"center"},content:{text:'<textarea class="netdisk-custom-rules" placeholder="请输入自定义规则"></textarea>',html:!0},btn:{merge:!0,mergeReverse:!1,reverse:!1,position:"space-between",ok:{text:"保存",callback:(c,h)=>{n();}},cancel:{text:"调试",callback:(c,h)=>{o();}},other:{enable:!0,text:"格式化",type:"xiaomi-primary",callback:(c,h)=>{r();}}},class:"whitesevPopNetDiskCustomRules",style:this.getCSS()},w.popsStyle.customRulesView).$shadowRoot.querySelector("textarea"),t){let c=this.getRule(s);a.value=this.getFormatRule(c);}else a.value=this.getTemplateRule();},getBindContext(t){function s(a,n){let o=R(H.dataKey),r=o[t.key];r[a]=n,M(H.dataKey,o);}function i(a,n){return R(H.dataKey)[t.key][a]??n}function e(a){let n=R(H.dataKey),o=n[t.key];Reflect.deleteProperty(o,a),M(H.dataKey,n);}return {rule:t,NetDiskRequire:qt,CryptoJS:Xe,httpx:b,utils:d,DOMUtils:C,window,unsafeWindow:Z,NetDiskCheckLinkValidity:x,log:u,Qmsg:f,pops:j,setValue:s,getValue:i,deleteValue:e}},parseRule(t){function s(e,a){const{shareCode:n,shareCodeNeedRemoveStr:o,shareCodeNotMatch:r,checkAccessCode:l,accessCode:c,acceesCodeNotMatch:h,paramMatch:p,...m}=a;let y={enable:g.function.enable(e.key,!!e.setting.enable),checkLinkValidity:g.function.checkLinkValidity(e.key,!!e.setting.checkLinkValidity),...m};return typeof n=="string"&&(y.shareCode=new RegExp(n,"ig")),typeof o=="string"&&(y.shareCodeNeedRemoveStr=new RegExp(o,"ig")),typeof r=="string"&&(y.shareCodeNotMatch=new RegExp(r,"ig")),typeof l=="string"&&(y.checkAccessCode=new RegExp(l,"ig")),typeof c=="string"&&(y.accessCode=new RegExp(c,"ig")),typeof h=="string"&&(y.acceesCodeNotMatch=new RegExp(h,"ig")),typeof p=="string"&&(y.paramMatch=new RegExp(p,"i")),y}let i=[];for(const e of t){let a={rule:[],setting:{name:e.setting.name,key:e.key,configurationInterface:{matchRange_text:{},matchRange_html:{},function:{},linkClickMode_openBlank:{},schemeUri:{},ownFormList:[]}},isUserRule:!0};const n=e.regexp,o=e.key;if(Array.isArray(n)?n.forEach(c=>{a.rule.push(s(e,c));}):a.rule.push(s(e,n)),e.setting&&(this.initDefaultValue(L.template.function.enable(o),!!e.setting.enable),a.setting.configurationInterface.function.enable=!!e.setting.enable,typeof e.setting.isBlank=="boolean"&&(this.initDefaultValue(L.template.function.linkClickMode(o),"openBlank"),a.setting.configurationInterface.function.linkClickMode="openBlank"),typeof e.setting.linkClickMode=="string"&&I.isAllowMode(e.setting.linkClickMode)&&(this.initDefaultValue(L.template.function.linkClickMode(o),e.setting.linkClickMode),a.setting.configurationInterface.function.linkClickMode="openBlank"),typeof e.setting.linkClickMode_extend=="object"&&Array.isArray(e.setting.linkClickMode_extend)&&e.setting.linkClickMode_extend.forEach(c=>{I.isAllowExtendMode(c)&&(a.setting.configurationInterface.function.linkClickMode_extend==null&&(a.setting.configurationInterface.function.linkClickMode_extend=[]),a.setting.configurationInterface.function.linkClickMode_extend.push(c));}),typeof e.setting.openBlankWithCopyAccessCode=="boolean"&&(this.initDefaultValue(L.template.linkClickMode_openBlank.openBlankWithCopyAccessCode(o),!!e.setting.openBlankWithCopyAccessCode),a.setting.configurationInterface.linkClickMode_openBlank.openBlankWithCopyAccessCode=!!e.setting.openBlankWithCopyAccessCode),typeof e.setting.checkLinkValidity=="boolean"&&(this.initDefaultValue(L.template.function.checkLinkValidity(o),!!e.setting.checkLinkValidity),a.setting.configurationInterface.function.checkLinkValidity=!!e.setting.checkLinkValidity),typeof e.setting.isForward=="boolean"&&(this.initDefaultValue(L.template.schemeUri.enable(o),!!e.setting.isForward),a.setting.configurationInterface.schemeUri.enable=!!e.setting.isForward),typeof e.setting.schemeUri=="string"&&(this.initDefaultValue(L.template.schemeUri.uri(o),e.setting.schemeUri),a.setting.configurationInterface.schemeUri.uri=e.setting.schemeUri),typeof e.setting.innerTextAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(L.template.matchRange_text.before(o),e.setting.innerTextAccessCodeBeforeMaxRange),a.setting.configurationInterface.matchRange_text.before=e.setting.innerTextAccessCodeBeforeMaxRange),typeof e.setting.innerTextAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(L.template.matchRange_text.after(o),e.setting.innerTextAccessCodeAfterMaxRange),a.setting.configurationInterface.matchRange_text.after=e.setting.innerTextAccessCodeAfterMaxRange),typeof e.setting.innerHTMLAccessCodeBeforeMaxRange=="number"&&(this.initDefaultValue(L.template.matchRange_html.before(o),e.setting.innerHTMLAccessCodeBeforeMaxRange),a.setting.configurationInterface.matchRange_html.before=e.setting.innerHTMLAccessCodeBeforeMaxRange),typeof e.setting.innerHTMLAccessCodeAfterMaxRange=="number"&&(this.initDefaultValue(L.template.matchRange_html.after(o),e.setting.innerHTMLAccessCodeAfterMaxRange),a.setting.configurationInterface.matchRange_html.after=e.setting.innerHTMLAccessCodeAfterMaxRange)),typeof e.icon=="string"){let c=e.icon;w.src.addIcon(o,c);}const r=Object.getPrototypeOf(async function(){}).constructor;if(typeof e.checkLinkValidityFunction=="string")try{Reflect.set(x.netDisk,o,{init:new r("netDiskIndex","shareCode","accessCode",e.checkLinkValidityFunction).bind(this.getBindContext(e))});}catch(c){u.error(c);}if(typeof e.AuthorizationFunction=="string")try{_e.netDisk[o]=new r(e.AuthorizationFunction).bind(this.getBindContext(e));}catch(c){u.error(c);}if(typeof e.AutoFillAccessCodeFunction=="string")try{le.netDisk[o]=new r("netDiskInfo",e.AutoFillAccessCodeFunction).bind(this.getBindContext(e));}catch(c){u.error(c);}if(typeof e.parseFunction=="string")try{Reflect.set(we.netDisk,o,new Function(e.parseFunction).bind(this.getBindContext(e)));}catch(c){u.error(c);}let l=i.find(c=>c.setting.key===a.setting.key);l?l.rule=l.rule.concat(a.rule):i.push(a);}return i},getNetDiskRuleConfig(){return this.$data.userRule.values()},initDefaultValue(t,s){R(t)==null&&M(t,s);},getTemplateRule(){let t={key:"规则名",icon:"图标链接字符串或图片的base64字符串",regexp:[{link_innerText:"",link_innerHTML:"",shareCode:"",shareCodeNeedRemoveStr:"",uiLinkShow:"",blank:"",copyUrl:""}],setting:{name:"设置界面的名字",enable:!0,linkClickMode:"openBlank",openBlankWithCopyAccessCode:!0}};return this.getFormatRule(t)},addRule(t){let s=this.getAllRule();s.push(t),M(H.key,s);},setRule(t,s){if(Array.isArray(s))M(H.key,s);else {let i=this.getAllRule(),e=i.findIndex(a=>a.key===t);if(e!==-1)i[e]=null,i[e]=s;else return u.error(["覆盖规则失败",s]),f.error("覆盖规则失败"),!1;this.setRule(t,i);}},deleteRule(t){let s=this.getAllRule(),i=s.findIndex(e=>e.key===t);return i!==-1?(s.splice(i,1),this.setRule(t,s),!0):!1},clearRule(){Ze(H.key);},getAllRule(){return R(H.key,[])},getRule(t){return R(H.key,[]).find(i=>i.key===t)},getFormatRule(t){return JSON.stringify(t||this.getAllRule(),void 0,4)}},Jt={rule:[{enable:g.function.enable("baidu"),link_innerText:`pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,${g.matchRange_text.before("baidu")}}(密码|访问码|提取码|\\?pwd=)[\\s\\S]{0,${g.matchRange_text.after("baidu")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`pan.baidu.com/s/[0-9a-zA-Z-_]{6,24}([\\s\\S]{0,${g.matchRange_html.before("baidu")}}(密码|访问码|提取码|\\?pwd=)[\\s\\S]{0,${g.matchRange_html.after("baidu")}}[0-9a-zA-Z]{4}|)`,shareCode:/pan\.baidu\.com\/s\/([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码|pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",blank:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/s/{#shareCode#}?pwd={#accessCode#}",checkLinkValidity:g.function.checkLinkValidity("baidu")},{enable:g.function.enable("baidu"),link_innerText:`pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,${g.matchRange_text.after("baidu")}}(密码|访问码|提取码|&pwd=)[\\s\\S]{0,${g.matchRange_text.after("baidu")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`pan.baidu.com/(share|wap)/init\\?surl=[0-9a-zA-Z-_]{5,24}([\\s\\S]{0,${g.matchRange_html.before("baidu")}}(密码|访问码|提取码|&pwd=)[\\s\\S]{0,${g.matchRange_html.after("baidu")}}[0-9a-zA-Z]{4}|)`,shareCode:/pan\.baidu\.com\/(share|wap)\/init\?surl=([0-9a-zA-Z-_]+)/gi,shareCodeNeedRemoveStr:/pan\.baidu\.com\/(share|wap)\/init\?surl=/gi,checkAccessCode:/(密码|访问码|提取码|&pwd=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",blank:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",copyUrl:"https://pan.baidu.com/share/init?surl={#shareCode#}&pwd={#accessCode#}",checkLinkValidity:g.function.checkLinkValidity("baidu")}],setting:{name:"百度网盘",key:"baidu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},Ve=function(t,s,i,e,a,n="",o,r){let l={text:t,type:"input",isNumber:!!o,isPassword:!!r,attributes:{},description:e,getValue(){return R(s,i)},callback(c,h){M(s,h);},placeholder:n};return l.attributes&&(l.attributes[se]=s,l.attributes[ne]=i),l},Kt={rule:[{enable:g.function.enable("lanzou"),link_innerText:`(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,${g.matchRange_text.before("lanzou")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("lanzou")}}[a-zA-Z0-9]{3,6}|)`,link_innerHTML:`(lanzou[a-z]{0,1}|lan[a-z]{2}).com/(tp/|u/|)([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,${g.matchRange_text.before("lanzou")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("lanzou")}}[a-zA-Z0-9]{3,6}|)`,shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)([a-zA-Z0-9_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{1,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/(tp\/|u\/|)/gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${K.hostname}/{#shareCode#} 提取码: {#accessCode#}`,blank:`https://${K.hostname}/{#shareCode#}`,copyUrl:`https://${K.hostname}/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("lanzou")},{enable:g.function.enable("lanzou"),link_innerText:`(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,${g.matchRange_text.before("lanzou")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("lanzou")}}[a-zA-Z0-9]{3,6}|)`,link_innerHTML:`(lanzou[a-z]{0,1}|lan[a-z]{2}).com/s/([a-zA-Z0-9_-]{5,22}|[%0-9a-zA-Z]{4,90}|[\\u4e00-\\u9fa5]{1,20})([\\s\\S]{0,${g.matchRange_html.before("lanzou")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("lanzou")}}[a-zA-Z0-9]{3,6}|)`,shareCode:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\/([a-zA-Z0-9_\-]{5,22}|[%0-9a-zA-Z]{4,90}|[\u4e00-\u9fa5]{1,20})/gi,shareCodeNeedRemoveStr:/(lanzou[a-z]{0,1}|lan[a-z]{2}).com\/s\//gi,shareCodeExcludeRegular:["lanzouyx"],checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:`${K.hostname}/s/{#shareCode#} 提取码: {#accessCode#}`,blank:`https://${K.hostname}/s/{#shareCode#}`,copyUrl:`https://${K.hostname}/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("lanzou")}],setting:{name:"蓝奏云",key:"lanzou",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!1,isForwardBlankLink:!1,uri:""},ownFormList:[{text:"其它配置",type:"forms",forms:[Ve("蓝奏云域名",K.MENU_KEY,K.DEFAULT_HOST_NAME,"",void 0,`例如：${K.DEFAULT_HOST_NAME}`)]}]}}},Yt={rule:[{enable:g.function.enable("lanzouyx"),link_innerText:`ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,${g.matchRange_text.before("lanzouyx")}}(密码|访问码|提取码|\\?code=)[\\s\\S]{0,${g.matchRange_text.after("lanzouyx")}}[a-zA-Z0-9]{3,6}|)`,link_innerHTML:`ilanzou.com/s/([a-zA-Z0-9_-]{5,22})([\\s\\S]{0,${g.matchRange_html.before("lanzouyx")}}(密码|访问码|提取码|\\?code=)[\\s\\S]{0,${g.matchRange_html.after("lanzouyx")}}[a-zA-Z0-9]{3,6}|)`,shareCode:/ilanzou.com\/s\/([a-zA-Z0-9_\-]{5,22})/gi,shareCodeNeedRemoveStr:/ilanzou.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码|\?code=)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{3,})/gi,uiLinkShow:"www.ilanzou.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}",copyUrl:"https://www.ilanzou.com/s/{#shareCode#}?code={#accessCode#}",checkLinkValidity:g.function.checkLinkValidity("lanzouyx")}],setting:{name:"蓝奏云优享",key:"lanzouyx",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!1,isForwardBlankLink:!1,uri:""}}}},Gt={rule:[{enable:g.function.enable("tianyiyun"),link_innerText:`(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_text.before("tianyiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("tianyiyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`(cloud.189.cn/web/share\\?code=([0-9a-zA-Z_-]){8,14}|cloud.189.cn/t/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_html.before("tianyiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("tianyiyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/cloud.189.cn\/web\/share\?code=([0-9a-zA-Z_\-]){8,14}|cloud.189.cn\/t\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/cloud\.189\.cn\/t\/|cloud.189.cn\/web\/share\?code=/gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"cloud.189.cn/t/{#shareCode#} 提取码: {#accessCode#}",blank:"https://cloud.189.cn/t/{#shareCode#}",copyUrl:`https://cloud.189.cn/t/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("tianyiyun")}],setting:{name:"天翼云",key:"tianyiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!1,isForwardBlankLink:!1,uri:""}}}},Xt={rule:[{enable:g.function.enable("hecaiyun"),link_innerText:`caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("hecaiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("hecaiyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`caiyun.139.com/m/i\\?([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("hecaiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("hecaiyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/caiyun\.139\.com\/m\/i\?([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/caiyun\.139\.com\/m\/i\?/gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"caiyun.139.com/m/i?{#shareCode#} 提取码: {#accessCode#}",blank:"https://caiyun.139.com/m/i?{#shareCode#}",copyUrl:`https://caiyun.139.com/m/i?{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("hecaiyun")},{enable:g.function.enable("hecaiyun"),link_innerText:`yun.139.com/link/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("hecaiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("hecaiyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`yun.139.com/link/w/i/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("hecaiyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("hecaiyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/yun\.139\.com\/link\/w\/i\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/yun\.139\.com\/link\/w\/i\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"yun.139.com/link/w/i/{#shareCode#} 提取码: {#accessCode#}",blank:"https://yun.139.com/link/w/i/{#shareCode#}",copyUrl:`https://yun.139.com/link/w/i/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("hecaiyun")}],setting:{name:"中国移动云盘",key:"hecaiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!1,uri:""}}}},Qt={rule:[{enable:g.function.enable("aliyun"),link_innerText:`aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("aliyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`aliyundrive.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("aliyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/aliyundrive\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.aliyundrive.com/s/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("aliyun")},{enable:g.function.enable("aliyun"),link_innerText:`aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("aliyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`aliyundrive.com/t/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("aliyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/aliyundrive\.com\/t\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/aliyundrive\.com\/t\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"aliyundrive.com/t/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.aliyundrive.com/t/{#shareCode#}",copyUrl:`https://www.aliyundrive.com/t/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("aliyun")},{enable:g.function.enable("aliyun"),link_innerText:`alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("aliyun")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`alipan.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("aliyun")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("aliyun")}}[0-9a-zA-Z]{4}|)`,shareCode:/alipan\.com\/s\/([a-zA-Z0-9_\-]{8,14})/g,shareCodeNeedRemoveStr:/alipan\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"alipan.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.alipan.com/s/{#shareCode#}",copyUrl:`https://www.alipan.com/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("aliyun")}],setting:{name:"阿里云",key:"aliyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!0,isForwardBlankLink:!0,uri:""}}}},ei={rule:[{enable:g.function.enable("wenshushu"),link_innerText:`(wenshushu.cn/f/([a-zA-Z0-9_-]{8,14})|wenshushu.cn/k/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_text.before("wenshushu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("wenshushu")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`(wenshushu.cn/f/([a-zA-Z0-9_-]{8,14})|wenshushu.cn/k/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_html.before("wenshushu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("wenshushu")}}[0-9a-zA-Z]{4}|)`,shareCode:/wenshushu.cn\/f\/([a-zA-Z0-9_-]{8,14})|wenshushu.cn\/k\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/wenshushu.cn\/f\/|wenshushu.cn\/k\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/f/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.wenshushu.cn/f/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/f/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("wenshushu")},{enable:g.function.enable("wenshushu"),link_innerText:`(wss.ink/f/([a-zA-Z0-9_-]{8,14})|ws28.cn/f/([a-zA-Z0-9_-]{8,14})|wss1.cn/f/([a-zA-Z0-9_-]{8,14})|ws59.cn/f/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_text.before("wenshushu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("wenshushu")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`(wss.ink/f/([a-zA-Z0-9_-]{8,14})|ws28.cn/f/([a-zA-Z0-9_-]{8,14})|wss1.cn/f/([a-zA-Z0-9_-]{8,14})|ws59.cn/f/([a-zA-Z0-9_-]{8,14}))([\\s\\S]{0,${g.matchRange_html.before("wenshushu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("wenshushu")}}[0-9a-zA-Z]{4}|)`,shareCode:/wss.ink\/f\/([a-zA-Z0-9_-]{8,14})|ws28.cn\/f\/([a-zA-Z0-9_-]{8,14})|wss1.cn\/f\/([a-zA-Z0-9_-]{8,14})|ws59.cn\/f\/([a-zA-Z0-9_-]{8,14})/gi,shareCodeNeedRemoveStr:/wss.ink\/f\/|ws28.cn\/f\/|wss1.cn\/f\/|ws59.cn\/f\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/[0-9a-zA-Z]{4}/gi,uiLinkShow:"www.wenshushu.cn/f/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.wenshushu.cn/f/{#shareCode#}",copyUrl:`https://www.wenshushu.cn/f/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("wenshushu")}],setting:{name:"文叔叔",key:"wenshushu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!0,isForwardBlankLink:!0,uri:""}}}},ti={rule:[{enable:g.function.enable("nainiu"),link_innerText:`cowtransfer.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_text.before("nainiu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_text.after("nainiu")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`cowtransfer.com/s/([a-zA-Z0-9_-]{8,14})([\\s\\S]{0,${g.matchRange_html.before("nainiu")}}(密码|访问码|提取码)[\\s\\S]{0,${g.matchRange_html.after("nainiu")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/cowtransfer.com\/s\/([a-zA-Z0-9_\-]{8,14})/gi,shareCodeNeedRemoveStr:/cowtransfer\.com\/s\//gi,checkAccessCode:/(密码|访问码|提取码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"cowtransfer.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://cowtransfer.com/s/{#shareCode#}",copyUrl:`https://cowtransfer.com/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("nainiu")}],setting:{name:"奶牛",key:"nainiu",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!0,isForwardBlankLink:!0,uri:""}}}},ii={rule:[{enable:g.function.enable("weiyun"),link_innerText:`weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,${g.matchRange_text.before("weiyun")}(访问码|密码|提取码)[\\s\\S]{0,${g.matchRange_text.after("weiyun")}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`weiyun.com/[0-9a-zA-Z-_]{7,24}([\\s\\S]{0,${g.matchRange_html.before("weiyun")}(访问码|密码|提取码)[\\s\\S]{0,${g.matchRange_html.after("weiyun")}[0-9a-zA-Z]{4,6}|)`,shareCode:/weiyun.com\/([0-9a-zA-Z\-_]{7,24})/gi,shareCodeNeedRemoveStr:/weiyun.com\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"share.weiyun.com/{#shareCode#} 提取码: {#accessCode#}",blank:"https://share.weiyun.com/{#shareCode#}",copyUrl:`https://share.weiyun.com/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("weiyun")}],setting:{name:"微云",key:"weiyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},ai={rule:[{enable:g.function.enable("xunlei"),link_innerText:`xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,${g.matchRange_text.before("xunlei")}}(\\?pwd=|访问码|提取码|密码|)[\\s\\S]{0,${g.matchRange_text.after("xunlei")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`xunlei.com/s/[0-9a-zA-Z-_]{8,30}([\\s\\S]{0,${g.matchRange_html.before("xunlei")}}(\\?pwd=|访问码|提取码|密码|)[\\s\\S]{0,${g.matchRange_html.after("xunlei")}}[0-9a-zA-Z]{4}|)`,shareCode:/xunlei.com\/s\/([0-9a-zA-Z\-_]{8,30})/gi,shareCodeNeedRemoveStr:/xunlei.com\/s\//gi,checkAccessCode:/(\?pwd=|提取码|密码|访问码)[\s\S]+/g,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#} 提取码: {#accessCode#}",blank:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}",copyUrl:"https://pan.xunlei.com/s/{#shareCode#}?pwd={#accessCode#}",checkLinkValidity:g.function.checkLinkValidity("xunlei")}],setting:{name:"迅雷云盘",key:"xunlei",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},si={rule:[{enable:g.function.enable("_115pan"),link_innerText:`115.com/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,${g.matchRange_text.before("_115pan")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("_115pan")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`115.com/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,${g.matchRange_html.before("_115pan")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("_115pan")}}[0-9a-zA-Z]{4}|)`,shareCode:/115.com\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/115.com\/s\//gi,checkAccessCode:/(提取码|密码|\?password=|访问码)[\s\S]+/gi,accessCode:/(\?password=|)([0-9a-zA-Z]{4})/i,uiLinkShow:"115.com/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://115.com/s/{#shareCode#}",copyUrl:`https://115.com/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("_115pan")}],setting:{name:"115网盘",key:"_115pan",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},ni={rule:[{enable:g.function.enable("chengtong"),link_innerText:`(ct.ghpym.com|pan.jc-box.com|download.jamcz.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`(ct.ghpym.com|pan.jc-box.com|download.jamcz.com)/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/(ct.ghpym.com|pan.jc-box.com|download.jamcz.com)\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(ct.ghpym.com|pan.jc-box.com|download.jamcz.com)\/d\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([a-zA-Z0-9\.]+)\/d\//i,uiLinkShow:"{#$1#}/d/{#shareCode#} 提取码: {#accessCode#}",blank:"https://{#$1#}/d/{#shareCode#}",copyUrl:`https://{#$1#}/d/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")},{enable:g.function.enable("chengtong"),link_innerText:`ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`ctfile.com/d/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/ctfile.com\/d\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/ctfile.com\/d\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/d/{#shareCode#} 提取码: {#accessCode#}",blank:"https://url95.ctfile.com/d/{#shareCode#}",copyUrl:`https://url95.ctfile.com/d/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")},{enable:g.function.enable("chengtong"),link_innerText:`(2k.us|u062.com|545c.com|t00y.com)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`(2k.us|u062.com|545c.com|t00y.com)/file/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/(2k.us|u062.com|545c.com|t00y.com)\/file\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(2k.us|u062.com|545c.com|t00y.com)\/file\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"u062.com/file/{#shareCode#} 提取码: {#accessCode#}",blank:"https://u062.com/file/{#shareCode#}",copyUrl:`https://u062.com/file/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")},{enable:g.function.enable("chengtong"),link_innerText:`(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(pan.jc-box.com|545c.com|down.jc-box.com|download.cx05.cc)\/f\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,paramMatch:/([0-9a-zA-Z\.+])\/f\//i,uiLinkShow:"{#$1#}/f/{#shareCode#} 提取码: {#accessCode#}",blank:"http://{#$1#}/f/{#shareCode#}",copyUrl:`http://{#$1#}/f/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")},{enable:g.function.enable("chengtong"),link_innerText:`(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`(ctfile.com|089u.com)/f/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,shareCode:/(ctfile.com|089u.com)\/f\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(ctfile.com|089u.com)\/f\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,6})/gi,uiLinkShow:"url95.ctfile.com/f/{#shareCode#} 提取码: {#accessCode#}",blank:"https://url95.ctfile.com/f/{#shareCode#}",copyUrl:`https://url95.ctfile.com/f/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")},{enable:g.function.enable("chengtong"),link_innerText:`(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_text.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("chengtong")}}[0-9a-zA-Z]{4,6}|)`,link_innerHTML:`(089u.com|474b.com)/dir/[0-9a-zA-Z-_]{8,26}([\\s\\S]{0,${g.matchRange_html.before("_chengtong")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("chengtong")}}[0-9a-zA-Z]{6}|)`,shareCode:/(089u.com|474b.com)\/dir\/([0-9a-zA-Z\-_]{8,26})/gi,shareCodeNeedRemoveStr:/(089u.com|474b.com)\/dir\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{6})/gi,uiLinkShow:"089u.com/dir/{#shareCode#} 提取码: {#accessCode#}",blank:"https://089u.com/dir/{#shareCode#}",copyUrl:`https://089u.com/dir/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("chengtong")}],setting:{name:"城通网盘",key:"chengtong",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},oi={rule:[{enable:g.function.enable("kuake"),link_innerText:`quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,${g.matchRange_text.before("kuake")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("kuake")}}[0-9a-zA-Z]{4}|)`,link_innerHTML:`quark.cn/s/[0-9a-zA-Z-_]{8,24}([\\s\\S]{0,${g.matchRange_html.before("kuake")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("kuake")}}[0-9a-zA-Z]{4}|)`,shareCode:/quark.cn\/s\/([0-9a-zA-Z\-_]{8,24})/gi,shareCodeNeedRemoveStr:/quark.cn\/s\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"quark.cn/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://pan.quark.cn/s/{#shareCode#}",copyUrl:`https://pan.quark.cn/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("kuake")}],setting:{name:"夸克网盘",key:"kuake",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},ri={rule:[{enable:g.function.enable("magnet"),link_innerText:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",link_innerHTML:"magnet:\\?xt=urn:btih:[0-9a-fA-F]{32,40}",shareCode:/magnet:\?xt=urn:btih:([0-9a-fA-F]{32,40})/gi,shareCodeNeedRemoveStr:/magnet:\?xt=urn:btih:/gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4})/gi,uiLinkShow:"magnet:?xt=urn:btih:{#shareCode#}",blank:"magnet:?xt=urn:btih:{#shareCode#}",copyUrl:"magnet:?xt=urn:btih:{#shareCode#}",checkLinkValidity:g.function.checkLinkValidity("magnet")}],setting:{name:"BT磁力",key:"magnet",configurationInterface:{function:{enable:!0,linkClickMode:"openBlank"},schemeUri:{enable:!1,isForwardBlankLink:!0,uri:""}}}},li={rule:[{enable:g.function.enable("jianguoyun"),link_innerText:`jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,${g.matchRange_text.before("jianguoyun")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("jianguoyun")}}[0-9a-zA-Z]+|)`,link_innerHTML:`jianguoyun.com/p/[0-9a-zA-Z-_]{16,24}([\\s\\S]{0,${g.matchRange_html.before("jianguoyun")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("jianguoyun")}}[0-9a-zA-Z]+|)`,shareCode:/jianguoyun.com\/p\/([0-9a-zA-Z\-_]{16,24})/gi,shareCodeNeedRemoveStr:/jianguoyun.com\/p\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{3,6})/gi,uiLinkShow:"jianguoyun.com/p/{#shareCode#} 提取码: {#accessCode#}",blank:"https://www.jianguoyun.com/p/{#shareCode#}",copyUrl:`https://www.jianguoyun.com/p/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("jianguoyun")}],setting:{name:"坚果云",key:"jianguoyun",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!1,isForwardBlankLink:!1,uri:""}}}},ci={rule:[{enable:g.function.enable("onedrive"),link_innerText:`[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,${g.matchRange_text.before("onedrive")}}(访问码|密码|提取码|\\?password=\\?e=)[\\s\\S]{0,${g.matchRange_text.after("onedrive")}}[0-9a-zA-Z]+|)`,link_innerHTML:`[0-9a-zA-Z-_]+.sharepoint.com/[0-9a-zA-Z-_:]+/[0-9a-zA-Z-_:]+/personal/[0-9a-zA-Z-_]+/[0-9a-zA-Z-_]+([\\s\\S]{0,${g.matchRange_html.before("onedrive")}}(访问码|密码|提取码|\\?password=\\?e=)[\\s\\S]{0,${g.matchRange_html.after("onedrive")}}[0-9a-zA-Z]+|)`,shareCode:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\/([0-9a-zA-Z\-_]+)/gi,shareCodeNeedRemoveStr:/[0-9a-zA-Z-_]+\/[0-9a-zA-Z-_:]+\/[0-9a-zA-Z-_:]+\/personal\/[0-9a-zA-Z-_]+\//gi,checkAccessCode:/(提取码|密码|访问码|\?password=|\?e=)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]{4,8})/gi,paramMatch:/([0-9a-zA-Z-_]+).sharepoint.com\/([0-9a-zA-Z-_:]+)\/([0-9a-zA-Z-_:]+)\/personal\/([0-9a-zA-Z-_]+)\/([0-9a-zA-Z-_]+)/i,uiLinkShow:"{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#} 提取码: {#accessCode#}",blank:"https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}?e={#accessCode#}",copyUrl:`https://{#$1#}.sharepoint.com/{#$2#}/{#$3#}/personal/{#$4#}/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("onedrive")}],setting:{name:"OneDrive",key:"onedrive",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardBlankLink:!1,uri:""}}}},di={rule:[{enable:g.function.enable("uc"),link_innerText:`(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,${g.matchRange_text.before("uc")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_text.after("uc")}}[0-9a-zA-Z]+|)`,link_innerHTML:`(drive|fast).uc.cn/s/[0-9a-zA-Z]{8,24}([\\s\\S]{0,${g.matchRange_html.before("uc")}}(访问码|密码|提取码|\\?password=)[\\s\\S]{0,${g.matchRange_html.after("uc")}}[0-9a-zA-Z]+|)`,shareCode:/(drive|fast).uc.cn\/s\/([0-9a-zA-Z]{8,24})/gi,shareCodeNeedRemoveStr:/(drive|fast).uc.cn\/s\//gi,checkAccessCode:/(提取码|密码|访问码)[\s\S]+/gi,accessCode:/([0-9a-zA-Z]+)/gi,uiLinkShow:"drive.uc.cn/s/{#shareCode#} 提取码: {#accessCode#}",blank:"https://drive.uc.cn/s/{#shareCode#}",copyUrl:`https://drive.uc.cn/s/{#shareCode#}
密码：{#accessCode#}`,checkLinkValidity:g.function.checkLinkValidity("uc")}],setting:{name:"UC网盘",key:"uc",configurationInterface:{matchRange_text:{before:20,after:10},matchRange_html:{before:100,after:15},function:{enable:!0,linkClickMode:"openBlank",linkClickMode_extend:["parseFile"],checkLinkValidity:!0},linkClickMode_openBlank:{openBlankWithCopyAccessCode:!0},schemeUri:{enable:!1,isForwardLinearChain:!1,isForwardBlankLink:!1,uri:""}}}},Y=function(t,s,i,e,a,n,o,r,l){let c={text:t,type:"slider",description:r,attributes:{},getValue(){return R(s,i)},getToolTipContent(h){return typeof o=="function"?o(h):`${h}`},callback(h,p){typeof n=="function"&&n(h,p)||M(s,p);},min:e,max:a,step:l};return c.attributes&&(c.attributes[se]=s,c.attributes[ne]=i),c},Ae={$data:{ruleContent:[]},init(){this.initRule();},initRule(){let t=[Jt,Kt,Yt,Gt,Xt,Qt,ei,ti,ze,ii,ai,si,ni,oi,ri,li,ci,di],s=H.getNetDiskRuleConfig();[...t,...s].forEach(i=>{if(typeof i.setting.key!="string")throw new TypeError("规则未设置key");if(i.rule==null)throw new TypeError("规则未设置rule");const e=i.setting.key,a=i.setting.name,n=i.rule;if(Reflect.has(_.regular,e)){let c=_.regular[e];i.isUserRule?c=[...n,...c]:c=[...c,...n];let h=_.rule.find(p=>p.setting.key===e);h.rule=c;}else Reflect.set(_.regular,e,i.rule),_.rule.push(i);let o=this.parseRuleToViewConfig(i),r=i.setting.name;w.src.hasIcon(e)&&(j.isPhone()?r=`
					<div style="
						width: 20px;
						height: 20px;
						background: url(${w.src.icon[e]}) no-repeat;
						background-size: 100% 100%;
						">`:r=`
					<div style="
						width: 20px;
						height: 20px;
						background: url(${w.src.icon[e]}) no-repeat;
						background-size: 100% 100%;
						"></div>
					<div style="margin-left: 4px;">${a}</div>`);let l=a;i.isUserRule&&(l+=`<div class="netdisk-custom-rule-edit" data-key="${e}" data-type="${i.setting.name}">${j.config.iconSVG.edit}</div>`,l+=`<div class="netdisk-custom-rule-delete" data-key="${e}" data-type="${i.setting.name}">${j.config.iconSVG.delete}</div>`),this.$data.ruleContent.push({id:"netdisk-panel-config-"+e,title:r,headerTitle:l,attributes:{"data-key":e},forms:o});});},parseRuleToViewConfig(t){let s=[];const i=t.setting.configurationInterface,e=t.setting.key;if(i==null)return [];if(i.matchRange_text){let a=[];if("before"in i.matchRange_text){const n=typeof i.matchRange_text.before=="number"?i.matchRange_text.before:0;a.push(Y("间隔前",L.template.matchRange_text.before(e),n,0,100,void 0,void 0,"提取码间隔前的字符长度"));}if("after"in i.matchRange_text){const n=typeof i.matchRange_text.after=="number"?i.matchRange_text.after:0;a.push(Y("间隔后",L.template.matchRange_text.after(e),n,0,100,void 0,void 0,"提取码间隔后的字符长度"));}a.length&&s.push({text:"提取码文本匹配Text",type:"forms",forms:a});}if(i.matchRange_html){let a=[];if("before"in i.matchRange_html){const n=typeof i.matchRange_html.before=="number"?i.matchRange_html.before:0;a.push(Y("间隔前",L.template.matchRange_html.before(e),n,0,100,void 0,void 0,"提取码间隔前的字符长度"));}if("after"in i.matchRange_html){const n=typeof i.matchRange_html.after=="number"?i.matchRange_html.after:0;a.push(Y("间隔后",L.template.matchRange_html.after(e),n,0,100,void 0,void 0,"提取码间隔后的字符长度"));}a.length&&s.push({text:"提取码文本匹配HTML",type:"forms",forms:a});}if(i.function){let a=[];if("enable"in i.function){let n=typeof i.function.enable=="boolean"?i.function.enable:!1;a.push(U("启用",L.template.function.enable(e),n,void 0,"开启可允许匹配该规则"));}if("linkClickMode"in i.function){let n=typeof i.function.linkClickMode=="string"?i.function.linkClickMode:"copy",o=[{value:"copy",text:"复制到剪贴板"},{value:"openBlank",text:"新标签页打开"}],r={parseFile:"文件解析"};i.function.linkClickMode_extend&&Array.isArray(i.function.linkClickMode_extend)&&i.function.linkClickMode_extend.forEach(l=>{l in r&&o.push({value:l,text:r[l]});}),a.push(ee("点击动作",L.template.function.linkClickMode(e),n,o,void 0,"点击匹配到的链接的执行的动作"));}if("checkLinkValidity"in i.function){const n=typeof i.function.checkLinkValidity=="boolean"?i.function.checkLinkValidity:!0;a.push(U("验证链接有效性",L.template.function.checkLinkValidity(e),n,void 0,"自动请求链接，判断该链接是否有效，在大/小窗内显示验证结果图标"));}a.length&&s.push({text:"功能",type:"forms",forms:a});}if(i.linkClickMode_openBlank){let a=[];if("openBlankWithCopyAccessCode"in i.linkClickMode_openBlank){const n=typeof i.linkClickMode_openBlank.openBlankWithCopyAccessCode=="boolean"?i.linkClickMode_openBlank.openBlankWithCopyAccessCode:!1;a.push(U("跳转时复制访问码",L.template.linkClickMode_openBlank.openBlankWithCopyAccessCode(e),n,void 0,"当点击动作是【新标签页打开】时且存在访问码，那就会复制访问码到剪贴板"));}a.length&&s.push({text:"点击动作-新标签页打开",type:"forms",forms:a});}if(i.schemeUri){const a=[];if("enable"in i.schemeUri){const n=typeof i.schemeUri.enable=="boolean"?i.schemeUri.enable:!1;a.push(U("启用",L.template.schemeUri.enable(e),n,void 0,"开启后可进行scheme uri转发"));}if("isForwardBlankLink"in i.schemeUri){const n=typeof i.schemeUri.isForwardBlankLink=="boolean"?i.schemeUri.isForwardBlankLink:!1;a.push(U("转发直链",L.template.schemeUri.isForwardBlankLink(e),n,void 0,"对解析的直链进行scheme转换"));}if("isForwardLinearChain"in i.schemeUri){const n=typeof i.schemeUri.isForwardLinearChain=="boolean"?i.schemeUri.isForwardLinearChain:!1;a.push(U("转发新标签页链接",L.template.schemeUri.isForwardBlankLink(e),n,void 0,"对新标签页打开的链接进行scheme转换"));}if("uri"in i.schemeUri){const n=typeof i.schemeUri.uri=="string"?i.schemeUri.uri:"";a.push(Ve("Uri链接",L.template.schemeUri.uri(e),n,"自定义的Scheme的Uri链接",void 0,"jumpwsv://go?package=xx&activity=xx&intentAction=xx&intentData=xx&intentExtra=xx"));}a.length&&s.push({text:"Scheme Uri转发",type:"forms",forms:a});}return i.ownFormList&&s.push(...i.ownFormList),s},getRulePanelContent(){return this.$data.ruleContent}},ye={show(){var i;if(w.Alias.settingAlias){u.error("设置界面已存在"),f.error("设置界面已存在");return}let t=B.getPanelContentConfig(),s=Ae.getRulePanelContent();t=t.concat(s),w.Alias.settingAlias=F.panel({title:{text:`${((i=ae==null?void 0:ae.script)==null?void 0:i.name)||$e}-设置`,position:"center"},content:t,btn:{close:{enable:!0,callback(e){e.close(),w.Alias.settingAlias=void 0;}}},mask:{clickCallBack(e){e(),w.Alias.settingAlias=void 0;}},class:"whitesevPopSetting",style:`
				div[class^="netdisk-custom-rule-"]{
					display: flex;
					align-items: center;
					margin-left: 10px;
					cursor: pointer;
				}
				div[class^="netdisk-custom-rule-"] svg,
				div[class^="netdisk-custom-rule-"] svg{
					width: 1.2em;
					height: 1.2em;
				}
				`},w.popsStyle.settingView),C.on(w.Alias.settingAlias.$shadowRoot,"click",".netdisk-custom-rule-edit",function(e){let a=e.target,n=a.getAttribute("data-key");a.getAttribute("data-type"),H.showUI(!0,n);}),C.on(w.Alias.settingAlias.$shadowRoot,"click",".netdisk-custom-rule-delete",function(e){let a=e.target,n=a.getAttribute("data-key"),o=a.getAttribute("data-type");F.alert({title:{text:"提示",position:"center"},content:{text:`确定删除自定义规则 ${o}(${n}) 吗？`},btn:{ok:{callback(r){if(H.deleteRule(n)){let c=w.Alias.settingAlias.$shadowRoot.querySelector(`.pops-panel-aside > ul > li[data-key="${n}"]`),h=c.previousElementSibling,p=c.nextElementSibling;h?h.click():p&&p.click(),c==null||c.remove(),f.success("删除成功"),r.close();}else f.error("删除自定义规则失败");}}}});});}},J={position:{suspensionX:A("suspensionX",C.width(window)-k.suspension.size.value),suspensionY:A("suspensionY",(C.height(window)-k.suspension.size.value)/2),isRight:A("isRight",!1)},mode:{current_suspension_smallwindow_mode:A("current_suspension_smallwindow_mode","suspension")}},ui={suspensionNode:null,isShow:!1,isSetEvent:!1,isRandBg:!1,show(){this.isShow||(this.isShow=!0,this.createUI(),this.setSuspensionPosition()),this.isSetEvent||(this.isSetEvent=!0,this.setSuspensionEvent(),this.setResizeEventListener()),this.backgroundSwitch(),this.showSuspension();},showSuspension(){this.suspensionNode.style.display="";},hideSuspension(){this.suspensionNode.style.display="none";},isTopWindow(){return Z.self.window===Z.top.window},createUI(){k.suspension.size.value<15&&(k.suspension.size.value=15),k.suspension.size.value>250&&(k.suspension.size.value=250),k.suspension.opacity.value<.1&&(k.suspension.opacity.value=.1),k.suspension.opacity.value>1&&(k.suspension.opacity.value=1);let t=C.createElement("div",{className:"whitesev-suspension-shadow-container"}),s=t.attachShadow({mode:"open"});this.suspensionNode=C.createElement("div",{id:"whitesevSuspensionId",className:"whitesevSuspension",innerHTML:`
                <style type="text/css">

                ${this.getCSS()}

                </style>
                <div class="whitesevSuspensionMain">
                <div class="whitesevSuspensionFloor">
                    <div class="netdisk"></div>
                </div>
                </div>
                `},{style:`
                    width: ${k.suspension.size.value}px;
                    height: ${k.suspension.size.value}px;
                    opacity: ${k.suspension.opacity.value}
                `}),s.appendChild(this.suspensionNode),document.body.appendChild(t);},setSuspensionEvent(){let t=w.suspension.suspensionNode,s=new et(t),i,e=!1,a=!1,n=0,o=0;s.on("pan",function(r){if(!e){e=!0;let l=t.getBoundingClientRect();n=r.x-l.left,o=r.y-l.top,C.css(t,{cursor:"move",transition:"none"});}if(r.phase==="move"){let l=C.width(window)-k.suspension.size.value,c=C.height(window)-k.suspension.size.value,h=r.x-n,p=r.y-o;h=h>l?l:h,p=p>c?c:p,h=h<0?0:h,p=p<0?0:p,w.suspension.isTopWindow()&&(J.position.suspensionX.value=h,J.position.suspensionY.value=p),C.css(t,{left:h+"px",top:p+"px"});}if(r.phase==="end"){e=!1,C.css(t,{cursor:"auto"});let l=parseInt(C.css(t,"left"));if(k.suspension["suspended-button-adsorption-edge"].value){let c=0;l>=C.width(window)/2?(c=C.width(window)-k.suspension.size.value,w.suspension.isTopWindow()&&(J.position.isRight.value=!0)):w.suspension.isTopWindow()&&(J.position.isRight.value=!1),w.suspension.isTopWindow()&&(J.position.suspensionX.value=c),C.css(t,{left:c+"px"});}C.css(t,{transition:"left 300ms ease 0s"});}}),s.on(["click","tap"],function(r){clearTimeout(i),i=void 0,a?(a=!1,ye.show()):(i=setTimeout(()=>{a=!1,k.function["netdisk-behavior-mode"].value.includes("smallwindow")&&(J.mode.current_suspension_smallwindow_mode.value="smallwindow",w.suspension.hideSuspension()),w.view.show();},200),a=!0);}),w.setGlobalRightClickMenu(t);},setResizeEventListener(){C.on(globalThis,"resize",void 0,()=>{let t=document.activeElement;if(d.isPhone()){if(["input","textarea"].includes(t.localName))return;if(t.hasAttribute("contenteditable")&&t.getAttribute("contenteditable")==="true"||t.closest("[contenteditable='true']"))return;if(!document.hasFocus())return}this.setSuspensionPosition();});},setSuspensionPosition(){let t=C.width(window)-k.suspension.size.value,s=C.height(window)-k.suspension.size.value,i=J.position.suspensionX.value,e=J.position.suspensionY.value;k.suspension["suspended-button-adsorption-edge"].value&&(J.position.isRight.value?i=t:i=0,e>s?e=s:e<0&&(e=0),w.suspension.isTopWindow()&&(J.position.suspensionX.value=i,J.position.suspensionY.value=e)),C.css(w.suspension.suspensionNode,{left:i+"px",top:e+"px"});},getCSS(){return `
            .whitesevSuspension{
                top: 0;
                position: fixed;
                right: 10px;
                border-radius: 12px;
                z-index: ${d.getMaxValue(4e3,d.getMaxZIndex(10))};
            }
            .whitesevSuspension .whitesevSuspensionMain{
                background: #fff;
                border: 1px solid #f2f2f2;
                box-shadow: 0 0 15px #e4e4e4;
                box-sizing: border-box;
                border-radius: inherit;
                height: inherit;
                width: inherit;
            }
            .whitesevSuspension .whitesevSuspensionFloor{
                border-bottom: 1px solid #f2f2f2;
                position: relative;
                box-sizing: border-box;
                border-radius: inherit;
                height: inherit;
                width: inherit;
            }
            .whitesevSuspension .whitesevSuspensionFloor .netdisk{
                background-position: center center;
                background-size: 115% 115%;
                background-repeat: no-repeat;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: inherit;
                height: inherit;
                width: inherit;
            }
            .whitesevSuspension .whitesevSuspensionFloor .netdisk:hover{
                transition: all 300ms linear;
                background-color: #e4e4e4;
                transform: scale(1.1);
            }
            .whitesevPop-content p[pop]{
                height: 100%;
            }
        `},backgroundSwitch(){if(this.isRandBg)return;function t(){let o=[];return w.isMatchedNetDiskIconMap.forEach(r=>{o=[...o,w.src.icon[r]];}),o}function s(o,r){i=t(),C.fadeOut(n,o,function(){e++,e=e<i.length?e:0,r=i[e],C.css(n,{"background-image":`url(${r})`}),C.fadeIn(n,o,function(){setTimeout(()=>{s(parseInt(k.suspension["randbg-time"].value.toString()),r);},parseInt(k.suspension["randbg-show-time"].value.toString()));});});}let i=[],e=0;i=t();let a=i[e],n=w.suspension.suspensionNode.querySelector(".whitesevSuspension .netdisk");C.css(n,{"background-image":`url(${a})`}),!(i.length<2||k.suspension["randbg-time"].value<=0)&&(this.isRandBg=!0,s(parseInt(k.suspension["randbg-time"].value.toString().toString()),a));}},hi={getCSS(){return `
        .pops-folder-list .list-name-text{
            max-width: 300px;
        }
        .netdisk-static-link-onefile .pops-folder-list .list-name-text{
            max-width: 220px;
        }
        .netdisk-static-link-onefile .pops-mobile-folder-content .pops-folder-list .list-name-text{
            max-width: unset;
        }
        `},oneFile(t){u.success(["成功获取单文件直链",t]),F.folder({title:{text:t.title},folder:[{fileName:t.fileName,fileSize:t.fileSize,fileType:t.fileType??"",createTime:t.fileUploadTime||t.fileLatestTime,latestTime:t.fileLatestTime||t.fileUploadTime,isFolder:!1,index:0,async clickEvent(){if(typeof t.clickCallBack=="function")t.clickCallBack(t);else return {autoDownload:!0,mode:"aBlank",url:t.downloadUrl}}}],btn:{ok:{text:"下载",callback(){typeof t.clickCallBack=="function"?t.clickCallBack(t):window.open(t.downloadUrl,"_blank");}}},class:"netdisk-static-link-onefile",style:this.getCSS()},w.popsStyle.oneFileStaticView);},moreFile(t,s=[]){u.success(["文件解析信息",s]),F.folder({title:{text:t},folder:s,style:this.getCSS()},w.popsStyle.moreFileStaticView);}},pi=function(t="密码错误",s="",i,e,a,n=()=>{}){const o=F.prompt({title:{text:t,position:"center",html:!1},btn:{reverse:!0,position:"end",cancel:{text:"取消"},ok:{callback:r=>{var v,T,$,N;let l=r.text.replace(/[\s]*/gi,""),c=_.handleLinkShow(s,i,e,l,void 0),h=`.netdisk-url a[data-netdisk='${s}'][data-sharecode='${e}']`,p=`.netdiskrecord-link a[data-netdisk='${s}'][data-sharecode='${e}']`,m=(T=(v=w.Alias.uiLinkAlias)==null?void 0:v.$shadowRoot)==null?void 0:T.querySelector(h),y=(N=($=w.Alias.historyAlias)==null?void 0:$.$shadowRoot)==null?void 0:N.querySelector(p);m&&(m.setAttribute("data-accesscode",l),C.html(m,c)),y&&(y.setAttribute("data-accesscode",l),C.html(y,c)),u.info(`${s} 重新输入的密码：${l}`),n(l),r.close();}}},content:{placeholder:"请重新输入密码",focus:!0,select:!0,text:a==null?"":typeof a=="string"?a:""}},w.popsStyle.inputNewAccessCodeView);C.listenKeyboard(o.$shadowRoot,"keypress",r=>{r==="Enter"&&o.$shadowRoot.querySelector(".pops-prompt-btn-ok").click();});},fi={storageKey:"netDiskHistoryMatch",isSetOtherEvent:!1,dataPaging:void 0,show(){let t=this.getNetDiskHistoryMatchData(),s="",i=this;t=this.orderNetDiskHistoryMatchData(t);for(let e=0;e<10;e++)t[e]&&(s+=i.getTableHTML(t[e]));s=`
        <div class="netdiskrecord-search">
            <input type="text" placeholder="搜索链接/网址/网址标题，可正则搜索">
        </div>
        <div class="netdiskrecord-table"><ul>${s}</ul></div>
        <div class="netdiskrecord-page">

        </div>`,w.Alias.historyAlias=F.confirm({title:{text:"历史匹配记录",position:"center"},content:{text:s,html:!0},btn:{reverse:!0,position:"space-between",ok:{enable:!0,callback(e){e.close(),w.Alias.historyAlias=void 0;}},close:{callback(e){e.close(),w.Alias.historyAlias=void 0;}},cancel:{enable:!1},other:{enable:!0,text:`清空所有(${t.length})`,type:"xiaomi-primary",callback:e=>{F.confirm({title:{text:"删除",position:"center"},content:{text:"确定清空所有的记录？",html:!1},btn:{ok:{enable:!0,callback(a){i.clearNetDiskHistoryMatchData(),C.remove(w.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul li")),a.close(),C.html(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page"),""),C.text(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other"),C.text(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other")).replace(/[\d]+/gi,"0"));}},cancel:{text:"取消",enable:!0}}});}}},mask:{clickCallBack(e){e(),w.Alias.historyAlias=null;}},class:"whitesevPopNetDiskHistoryMatch",style:this.getCSS()},w.popsStyle.historyMatchView),this.setDataPaging(t),this.setEvent(w.Alias.historyAlias.$shadowRoot),this.setSearchEvent(),w.setRightClickMenu(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch"),".netdiskrecord-link a",!0);},getCSS(){return `
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content ul{

        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content li{
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-radius: 10px;
            box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%), 0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%), 0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);
            margin: 20px 10px;
            padding: 10px;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search{
            height: 11%;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-table{
            height: calc( 85% - 40px);
            overflow: auto;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-page{
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search input{
            border: none;
            border-bottom: 1px solid #000000;
            padding: 0px 5px;
            line-height: 28px;
            width: -moz-available;
            width: -webkit-fill-available;
            width: fill-available;
            margin: 5px 5px 0px 5px;
            background: none;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-search input:focus-visible{
            outline: none;
            border-bottom: 1px solid #0009ff;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link{
        
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a{
            color: #ff4848;
            font-size: 0.8em;
            border: none;
            word-break: break-word;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a[isvisited=true]{
            color: #8b8888;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon{
        
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon .netdisk-icon-img{
            width: 28px;
            height: 28px;
            min-width: 28px;
            min-height: 28px;
            font-size: 0.8em;
            border-radius: 10px;
            box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%), 0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%), 0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url{
            color: #000;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url{
            color: #000;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete{
            background: #263cf3;
            color: #fff;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete:active{
            background: #6e7be8;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-update-time,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url-title,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions{
            display: flex;
            margin: 5px 0px;
        }
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-icon p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-top-url p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-add-time p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-update-time p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-url-title p,
        .whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions p{
            min-width: 80px;
            max-width: 80px;
            align-self: center;
        }
        `},getTableHTML(t){let s=_.handleLinkShow(t.netDiskName,t.netDiskIndex,t.shareCode,t.accessCode,t.matchText);return `
		<li>
			<div class="netdiskrecord-link">
				<p>链接</p>
				<a  href="javascript:;"
					isvisited="false"
					${ie.createElementAttributeRuleInfo({netDisk:t.netDiskName,netDiskIndex:t.netDiskIndex,shareCode:t.shareCode,accessCode:t.accessCode})}>${s}</a>
			</div>
			<div class="netdiskrecord-icon">
				<p>网盘</p>
				<div class="netdisk-icon-img" style="background: url(${w.src.icon[t.netDiskName]}) no-repeat;background-size:100%"></div>
			</div>
			${t.url===t.topURL?`
			<div class="netdiskrecord-url">
				<p>网址</p>
				<a href="${t.url}" target="_blank">${t.url}</a>
			</div>
			`:`
			<div class="netdiskrecord-url">
				<p>网址</p>
				<a href="${t.url}" target="_blank">${t.url}</a>
			</div>
			<div class="netdiskrecord-top-url">
				<p>TOP网址</p>
				<a href="${t.topURL}" target="_blank">${t.topURL}</a>
			</div>
			`}
			<div class="netdiskrecord-url-title">
				<p>网址标题</p>
				${t.title}
			</div>
			<div class="netdiskrecord-add-time">
				<p>记录时间</p>
				${d.formatTime(t.addTime)}
			</div>
			<div class="netdiskrecord-update-time">
				<p>更新时间</p>
				${d.formatTime(t.updateTime)}
			</div>
			<div class="netdiskrecord-functions">
				<p>功能</p>
				<button class="btn-delete" data-json='${JSON.stringify(t)}'>删除</button>
			</div>
		</li>`},setEvent(t){let s=this;w.view.setNetDiskUrlClickEvent(t,".whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-link a"),C.on(t,"click",".whitesevPopNetDiskHistoryMatch .pops-confirm-content .netdiskrecord-functions button.btn-delete",function(i){var h;let e=F.loading({parent:t.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul"),content:{text:"删除中..."},only:!0,addIndexCSS:!1}),a=i.target,n=a.getAttribute("data-json");(h=a.closest("li"))==null||h.remove(),s.deleteNetDiskHistoryMatchData(n),e==null||e.close();let o=C.text(t.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other")),r=o.match(/[\d]+/gi),l=parseInt(r[r.length-1]);l--,o=o.replace(/[\d]+/gi,l.toString()),C.text(t.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-btn-other"),o);let c=s.getNetDiskHistoryMatchData();c=s.orderNetDiskHistoryMatchData(c),s.dataPaging.refresh(c),s.pageChangeCallBack(c,s.dataPaging.CONFIG.currentPage);});},pageChangeCallBack(t,s){let i=(s-1)*10,e="";for(let a=0;a<10&&t[i];a++){e+=this.getTableHTML(t[i]);i++;}w.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li").forEach(a=>a.remove()),C.append(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),e);},setDataPaging(t){let s=this,i=new Qe({data:t,pageCount:10,pageStep:j.isPhone()?2:4,currentPage:1,pageChangeCallBack:function(e){s.pageChangeCallBack(t,e);}});this.dataPaging=i,i.addCSS(w.Alias.historyAlias.$shadowRoot),i.append(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page"));},setSearchEvent(){let t=!1,s,i=this;function e(){if(t)return;t=!0,s=F.loading({parent:w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .pops-confirm-content ul"),content:{text:"搜索中..."},only:!0,addIndexCSS:!1});let a=w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input").value.trim(),n=i.getNetDiskHistoryMatchData();if(n=i.orderNetDiskHistoryMatchData(n),a===""){let r="";n.forEach((l,c)=>{c>9||(r+=i.getTableHTML(l));}),w.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li").forEach(l=>l.remove()),C.append(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),r),s==null||s.close(),t=!1,i.setDataPaging(n);return}let o="";n.forEach(r=>{(_.handleLinkShow(r.netDiskName,r.netDiskIndex,r.shareCode,r.accessCode,r.matchText).match(new RegExp(a,"ig"))||r.url.match(new RegExp(a,"ig"))||r.topURL.match(new RegExp(a,"ig"))||r.title.match(new RegExp(a,"ig")))&&(o+=i.getTableHTML(r));}),C.remove(w.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul li")),C.append(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-table ul"),o),C.remove(w.Alias.historyAlias.$shadowRoot.querySelectorAll(".whitesevPopNetDiskHistoryMatch .netdiskrecord-page > *")),s==null||s.close(),s=void 0,t=!1;}C.listenKeyboard(w.Alias.historyAlias.$shadowRoot.querySelector(".whitesevPopNetDiskHistoryMatch .netdiskrecord-search input"),"keypress",a=>{a==="Enter"&&e();});},orderNetDiskHistoryMatchData(t){let s=k.historyMatch["netdisk-history-match-ordering-rule"].value,i=s.indexOf("降序")!==-1,e=s.indexOf("记录时间")!==-1?"addTime":"updateTime";return d.sortListByProperty(t,a=>a[e],i),t},setNetDiskHistoryMatchData(t,s,i,e,a){if(!k.historyMatch.saveMatchNetDisk.value)return;let n=this.getNetDiskHistoryMatchData();for(let r=0;r<n.length;r++){const l=n[r];if(l.url===window.location.href&&l.topURL===top.window.location.href&&l.netDiskName===t&&i.startsWith(l.shareCode)&&l.netDiskIndex===s){if(l.matchText!==a){u.success(["匹配历史记录 -> 设置新的matchText",[a]]),n[r].matchText=a,n[r].updateTime=Date.now(),n[r].title&&(n[r].title=document.title),M(this.storageKey,n);return}if(l.accessCode!==e){u.success("匹配历史记录 -> 修改accessCode"),n[r].accessCode=e,n[r].updateTime=Date.now(),n[r].title&&(n[r].title=document.title),M(this.storageKey,n);return}if(l.accessCode===e)return}}u.success("匹配历史记录 -> 增加新的");let o=Date.now();n=[...n,{url:window.location.href,topURL:top.window.location.href,netDiskName:t,netDiskIndex:s,shareCode:i,accessCode:e,addTime:o,updateTime:o,title:document.title||top.document.title,matchText:a}],M(this.storageKey,n);},getNetDiskHistoryMatchData(){let t=R(this.storageKey);return t==null&&(t=[],M(this.storageKey,t)),t},checkAndRepairLocalData(){let t=0,s=R(this.storageKey);if(Array.isArray(s))for(let i=0;i<s.length;i++){const e=s[i];typeof e.matchText!="string"&&(e.matchText="",t++);}else s=[];return M(this.storageKey,s),{count:s.length,repairCount:t}},deleteNetDiskHistoryMatchData(t){let s=!1,i=this.getNetDiskHistoryMatchData();for(let e=0;e<i.length;e++)if(JSON.stringify(i[e])===t){u.success(["删除 ===> ",i[e]]),i.splice(e,1),s=!0;break}return s&&M(this.storageKey,i),s},clearNetDiskHistoryMatchData(){M(this.storageKey,[]);}},mi={accessCodeRuleDialogClassName:"whitesevPopNetDiskAccessCodeRule",show(){let t=this,s=F.confirm({title:{text:"自定义访问码规则",position:"center"},content:{text:`
                    <div class="netdisk-accesscode-rule-table">
                        <ul>
                        ${t.getShowItemHTML()}
                        </ul>
                    </div>
                    `,html:!0},btn:{merge:!0,reverse:!1,position:"space-between",ok:{enable:!0,text:"添加",callback(i){t.showRule(i);}},close:{callback(i){i.close();}},cancel:{enable:!0},other:{enable:!0,type:"xiaomi-primary",text:"清空所有",callback(i){F.confirm({title:{text:"删除",position:"center"},content:{text:"确定清空所有的规则？",html:!1},btn:{ok:{enable:!0,callback:function(e){if(u.success("清空所有"),t.deleteAllValue(),t.getValue().length){f.error("清空全部规则失败");return}else f.success("已清空全部规则");t.setDeleteAllBtnText(i.animElement),i.animElement.querySelector(".pops-confirm-content ul").innerHTML="",e.close();}},cancel:{text:"取消",enable:!0}}});}}},class:this.accessCodeRuleDialogClassName,style:this.getCSS()},w.popsStyle.accessCodeRuleView);t.setDeleteAllBtnText(s.animElement),this.setEvent(s);},getShowItemHTML(){let t="";return this.getValue().forEach(s=>{let i="";s.netdisk.forEach(e=>{i+=e.name,i+="、";}),i=i.replace(/、$/g,""),t+=`
            <li>
                <div class="accesscode-rule-url-regexp">
                <p>匹配规则</p>
                ${s.urlRegexp}
                </div>
                <div class="accesscode-rule-netdisk-name">
                <p>匹配网盘</p>
                ${i}
                </div>
                <div class="accesscode-rule-accesscode">
                <p>固定值</p>
                ${s.accessCode}
                </div>
                <div class="accesscode-rule-functions" data-json='${JSON.stringify(s)}'>
                <p>功能</p>
                <button style="background: #46cb31;color: #fff;" data-edit>修改</button>
                <button style="background: #263cf3;color: #fff;" data-delete>删除</button>
                </div>
            </li>
              `;}),t},getCSS(){return `
        .pops-confirm-content .whitesev-accesscode-rule{
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 15px 15px;
        }
        
        .pops-confirm-content div.netdisk-accesscode-rule-table{
            /* height: calc( 85% - 40px); */
            overflow: auto;
        }

        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-url-regexp,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-netdisk-name,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-accesscode,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-functions{
            display: flex;
            margin: 5px 0px;
        }

        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-url-regexp p,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-netdisk-name p,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-accesscode p,
        .pops-confirm-content .netdisk-accesscode-rule-table .accesscode-rule-functions p{
            min-width: 80px;
            max-width: 80px;
            align-self: center;
        }
        .pops-confirm-content .netdisk-accesscode-rule-table li {
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-radius: 10px;
            box-shadow: 0 0.3px 0.6px rgb(0 0 0 / 6%), 0 0.7px 1.3px rgb(0 0 0 / 8%), 0 1.3px 2.5px rgb(0 0 0 / 10%), 0 2.2px 4.5px rgb(0 0 0 / 12%), 0 4.2px 8.4px rgb(0 0 0 / 14%), 0 10px 20px rgb(0 0 0 / 20%);
            margin: 20px 10px;
            padding: 10px;
        }
        `},showRule(t,s=!1,i){let e=this,a=F.confirm({title:{text:s?"修改规则":"添加规则",position:"center"},content:{text:`
                    <div class="whitesev-accesscode-rule">
                        <div type-name>匹配网站</div>
                        <div class="pops-panel-input">
                        <input type="text" placeholder="请输入需要匹配的正则规则" val-key="access-rule-url" />
                        </div>
                    </div>
                    <div class="whitesev-accesscode-rule">
                        <div>匹配网盘</div>
                        <div class="pops-panel-select">
                        <select val-key="access-rule-netdisk" multiple="true" style="height: auto;">
                        </select>
                        </div>
                    </div>
                    <div class="whitesev-accesscode-rule">
                        <div>固定值</div>
                        <div class="pops-panel-input">
                        <input type="text" placeholder="请输入固定的访问码" val-key="access-rule-accesscode" />
                        </div>
                    </div>
                    `,html:!0},btn:{ok:{enable:!0,text:s?"修改":"添加",callback(r){let l=r.popsElement,c=l.querySelector('input[val-key="access-rule-url"]').value,h=[],p=l.querySelector('select[val-key="access-rule-netdisk"]');Array.from(p.selectedOptions).forEach(y=>{h.push({name:y.value,value:y.getAttribute("data-value")});});let m=l.querySelector('input[val-key="access-rule-accesscode"]').value;if(!e.checkRuleUrlValid(c)){u.error(["验证失败",c]);return}s?e.changeValue(i,{urlRegexp:c,netdisk:h,accessCode:m})?(u.success(["修改成功",{urlRegexp:c,netdisk:h,accessCode:m}]),f.success("修改成功"),t.animElement.querySelector(".netdisk-accesscode-rule-table ul").innerHTML=e.getShowItemHTML(),a.close()):f.error("修改失败"):e.addValue({urlRegexp:c,netdisk:h,accessCode:m})?(f.success("添加成功"),t.animElement.querySelector(".netdisk-accesscode-rule-table ul").innerHTML=e.getShowItemHTML(),e.setDeleteAllBtnText(t.animElement),a.close()):f.error("已存在重复的规则");}},cancel:{text:"取消",enable:!0}},class:"whitesevPopNetDiskAccessCodeRuleAddOrEdit",style:`
                ${j.config.cssText.panelCSS}

                .whitesevPopNetDiskAccessCodeRuleAddOrEdit .whitesev-accesscode-rule{
                    display: flex;
                    justify-content: space-between;
                    margin: 4px 4px;
                }
                .whitesevPopNetDiskAccessCodeRuleAddOrEdit .whitesev-accesscode-rule select{
                    height: 150px;
                }
                `},w.popsStyle.accessCodeRuleEditView);this.setRuleEvent(a.element);const n=a.$shadowRoot.querySelector("select");let o=document.createDocumentFragment();if(_.rule.forEach(r=>{let l=C.createElement("option",{innerText:r.setting.name},{"data-value":r.setting.key});o.appendChild(l);}),n.appendChild(o),s){a.element.querySelector('.whitesev-accesscode-rule input[val-key="access-rule-url"]').value=i.urlRegexp;let r=a.element.querySelectorAll('.whitesev-accesscode-rule select[val-key="access-rule-netdisk"] option');i.netdisk.forEach(l=>{r.forEach(c=>{if(c.getAttribute("data-value")===l.value){c.selected=!0,u.success(["选中",c]);return}});}),a.element.querySelector('.whitesev-accesscode-rule input[val-key="access-rule-accesscode"]').value=i.accessCode;}},setDeleteAllBtnText(t){let s=t.querySelector(".pops-confirm-btn button.pops-confirm-btn-other");if(s)s.textContent=`清空所有(${this.getValue().length})`;else if(t.getRootNode()instanceof ShadowRoot){let i=t.getRootNode();i.querySelector(".whitesevPopNetDiskAccessCodeRule .pops-confirm-btn button.pops-confirm-btn-other").textContent=`清空所有(${this.getValue().length})`;}},checkRuleUrlValid(t){if(d.isNull(t))return f.error("匹配网站的正则不能为空或纯空格"),!1;try{new RegExp(t);}catch(s){return u.error(s),f.error("匹配网站的正则错误</br>"+s.message,{html:!0,timeout:5e3}),!1}return !0},setEvent(t){let s=this;C.on(t.animElement,"click",".netdisk-accesscode-rule-table div.accesscode-rule-functions button[data-delete]",function(){let i=this.closest(".accesscode-rule-functions").getAttribute("data-json"),e=d.toJSON(i);u.success(["删除👉",e]),s.deleteValue(e)?(this.closest("li").remove(),s.setDeleteAllBtnText(t.animElement)):f.error("删除失败");}),C.on(t.element,"click",".netdisk-accesscode-rule-table div.accesscode-rule-functions button[data-edit]",function(){let i=this.closest(".accesscode-rule-functions").getAttribute("data-json"),e=d.toJSON(i);u.success(["修改👉",e]);let a=Object.assign({},t);a.animElement=a.element,s.showRule(a,!0,e);});},setRuleEvent(t){},getValue(){return R("accessCodeRule",[])},setValue(t){let s=this.getValue();s.push(t),M("accessCodeRule",s);},changeValue(t,s){let i=!1,e=this.getValue(),a=JSON.stringify(t);for(let n=0;n<e.length;n++)if(JSON.stringify(e[n])===a){e[n]=s,i=!0;break}return M("accessCodeRule",e),i},addValue(t){let s=!0,i=this.getValue();for(let e=0;e<i.length;e++)if(i[e].urlRegexp===t.urlRegexp&&i[e].netdisk===t.netdisk){s=!1;break}return s&&(i.push(t),this.setValue(t)),s},deleteValue(t){let s=!1,i=this.getValue(),e=JSON.stringify(t);for(let a=0;a<i.length;a++)if(JSON.stringify(i[a])===e){i.splice(a,1),s=!0;break}return s&&M("accessCodeRule",i),s},deleteAllValue(){M("accessCodeRule",[]);}},gi={show(){let t=F.confirm({title:{text:"主动识别文本",position:"center"},content:{text:`
                    <textarea class="netdisk-match-paste-text"></textarea>
                    `,html:!0},btn:{ok:{text:"识别",callback(){var i,e;let s=((e=(i=t.popsElement)==null?void 0:i.querySelector(".netdisk-match-paste-text"))==null?void 0:e.value)||"";s.trim()!==""&&(s=V.replaceChinese(s),S.postMessage({textList:[s],matchTextRange:k.match.pageMatchRange.value,regular:_.regular,startTime:Date.now(),from:"PasteText"}));}}},class:"whitesevPopNetDiskMatchPasteText",style:this.getCSS()},w.popsStyle.matchPasteTextView);t.popsElement.querySelector("textarea").focus();},getCSS(){return `
		.pops[type-value=confirm] .pops-confirm-content{
			overflow: hidden;
		}
		.netdisk-match-paste-text {
			--textarea-bd-color: #dcdfe6;
			display: inline-block;
			resize: vertical;
			padding: 5px 15px;
			line-height: 1.5;
			box-sizing: border-box;
			color: #606266;
			border: 1px solid var(--textarea-bd-color);
			border-radius: 4px;
			transition: border-color 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
			outline: none;
			margin: 0;
			-webkit-appearance: none;
			-moz-appearance: none;
			appearance: none;
			background: none;
			width: 100%;
			height: 100%;
			appearance: none;
			resize: none;
		}
		.netdisk-match-paste-text:hover{
			--textarea-bd-color: #c0c4cc;
		}
		.netdisk-match-paste-text:focus{
			--textarea-bd-color: #3677f0;
		}
		`},workerMatchEndCallBack(t){t.data.length?f.success(`成功匹配${t.data.length}个，用时${Date.now()-t.startTime}ms`):f.error("未识别到链接");}},w={Alias:{uiLinkAlias:void 0,historyAlias:void 0,settingAlias:void 0},isMatchedNetDiskIconMap:new Set,defaultForbiddenScroll:!1,popsStyle:at,src:{icon:{},hasIcon(t){return Reflect.has(this.icon,t)},addIcon(t,s){return this.hasIcon(t)?(u.warn("图标字典中已存在该icon："+t),!1):Reflect.set(this.icon,t,s)}},suspension:ui,view:ie,staticView:hi,newAccessCodeView:pi,netDiskHistoryMatch:fi,accessCodeRule:mi,matchPasteText:gi,setGlobalRightClickMenu(t){w.view.registerContextMenu(t,void 0,[{text:"设置",callback(){u.info("打开-设置"),ye.show();}},{text:"历史匹配记录",callback(){u.info("打开-历史匹配记录"),w.netDiskHistoryMatch.show();}},{text:"访问码规则",callback(){u.info("打开-访问码规则"),w.accessCodeRule.show();}},{text:"自定义规则",callback(){u.info("打开-自定义规则"),H.showUI(!1);}},{text:"主动识别文本",callback(){u.info("打开-主动识别文本"),w.matchPasteText.show();}}]);},setRightClickMenu(t,s,i){w.view.registerContextMenu(t,s,[{text:"复制链接",callback:function(e,a){let n=a.target;const{netDiskName:o,netDiskIndex:r,shareCode:l,accessCode:c}=ie.praseElementAttributeRuleInfo(n);Q.copy(o,r,l,c);}},{text:"访问链接",callback:function(e,a){let n=a.target;const{netDiskName:o,netDiskIndex:r,shareCode:l,accessCode:c}=ie.praseElementAttributeRuleInfo(n);let h=I.getBlankUrl(o,r,l,c);Q.openBlank(h,o,r,l,c);}},{text:"修改访问码",callback:function(e,a){let n=a.target;const{netDiskName:o,netDiskIndex:r,shareCode:l,accessCode:c}=ie.praseElementAttributeRuleInfo(n);function h(m){let y=new Date().getTime(),v=R(w.netDiskHistoryMatch.storageKey),T=!1;v.forEach($=>{if($.netDiskName===o&&$.netDiskIndex===r&&$.shareCode===l&&$.accessCode===c){$=d.assign($,{accessCode:m,updateTime:y}),u.success(["成功找到项",$]),T=!0;return}}),T?(M(w.netDiskHistoryMatch.storageKey,v),n.closest("li").querySelector(".netdiskrecord-update-time").lastChild.textContent=d.formatTime(y),n.setAttribute("data-accesscode",m),f.success(`
                                <div style="text-align: left;">旧: ${c}</div>
                                <div style="text-align: left;">新: ${m}</div>`,{html:!0})):f.error("修改失败");}function p(m){e.target.setAttribute("data-accesscode",m);let y=_.linkDict.get(o);if(y.has(l)){let v=y.get(l);y.set(l,_.getLinkDickObj(m,r,!0,v.matchText)),f.success(`
                                <div style="text-align: left;">旧: ${c}</div>
                                <div style="text-align: left;">新: ${m}</div>`,{html:!0});}else f.error("该访问码不在已获取的字典中："+l);}w.newAccessCodeView(this.text,o,r,l,c,m=>{i?h(m):p(m);});}}]);}},Fe=function(t,s,i,e,a,n,o,r,l){return {text:t,type:"button",description:s,buttonIcon:e,buttonIsRightIcon:a,buttonIconIsLoading:n,buttonType:o,buttonText:i,callback(h){typeof r=="function"&&r(h);},afterAddToUListCallBack:l}},pe=function(t,s,i,e,a,n="default",o){let r=a,l=()=>o.getShowText(i,r),c=Fe(t,s,l,"keyboard",!1,!1,n,async h=>{var y;let m=(y=h.target.closest(".pops-panel-button"))==null?void 0:y.querySelector("span");if(o.isWaitPress){f.warning("请先执行当前的录入操作");return}if(o.hasOptionValue(i))o.emptyOption(i),f.success("清空快捷键");else {let v=f.loading("请按下快捷键...",{showClose:!0}),{status:T,option:$,key:N}=await o.enterShortcutKeys(i);v.close(),T?(u.success(["成功录入快捷键",$]),f.success("成功录入")):f.error(`快捷键 ${o.translateKeyboardValueToButtonText($)} 已被 ${N} 占用`);}m.innerHTML=l();});return c.attributes={},Reflect.set(c.attributes,Ue,()=>!1),c};class ki{constructor(s){z(this,"key","short-cut");z(this,"isWaitPress",!1);typeof s=="string"&&(this.key=s);}initConfig(s,i){this.hasOption(s)||this.setOption(s,i);}getStorageKey(){return this.key}getLocalAllOptions(){return R(this.key,[])}hasOption(s){return !!this.getLocalAllOptions().find(a=>a.key===s)}hasOptionValue(s){if(this.hasOption(s)){let i=this.getOption(s);return (i==null?void 0:i.value)!=null}else return !1}getOption(s,i){return this.getLocalAllOptions().find(n=>n.key===s)??i}setOption(s,i){let e=this.getLocalAllOptions(),a=e.findIndex(n=>n.key===s);a==-1?e.push({key:s,value:i}):Reflect.set(e[a],"value",i),M(this.key,e);}emptyOption(s){let i=!1,e=this.getLocalAllOptions(),a=e.findIndex(n=>n.key===s);return a!==-1&&(e[a].value=null,i=!0),M(this.key,e),i}deleteOption(s){let i=!1,e=this.getLocalAllOptions(),a=e.findIndex(n=>n.key===s);return a!==-1&&(e.splice(a,1),i=!0),M(this.key,e),i}translateKeyboardValueToButtonText(s){let i="";return s.ohterCodeList.forEach(e=>{i+=d.stringTitleToUpperCase(e,!0)+" + ";}),i+=d.stringTitleToUpperCase(s.keyName),i}getShowText(s,i){if(this.hasOption(s)){let e=this.getOption(s);return e.value==null?i:this.translateKeyboardValueToButtonText(e.value)}else return i}async enterShortcutKeys(s){return new Promise(i=>{this.isWaitPress=!0;let e=C.listenKeyboard(window,"keyup",(a,n,o)=>{const r={keyName:a,keyValue:n,ohterCodeList:o},l=JSON.stringify(r),c=this.getLocalAllOptions();for(let h=0;h<c.length;h++){let p=c[h];if(p.key===s)continue;const m=JSON.stringify(p.value);let y=!1;if(p.value!=null&&l===m&&(y=!0),y){this.isWaitPress=!1,e.removeListen(),i({status:!1,key:p.key,option:r});return}}this.setOption(s,r),this.isWaitPress=!1,e.removeListen(),i({status:!0,key:s,option:r});});})}initGlobalKeyboardListener(s){let i=this.getLocalAllOptions();if(!i.length){u.warn("没有设置快捷键");return}let e=this;function a(r,l){C.listenKeyboard(r,"keydown",(c,h,p)=>{if(e.isWaitPress)return;i=e.getLocalAllOptions();let m=i.findIndex(y=>{let v=y.value,T={keyName:c,keyValue:h,ohterCodeList:p};if(JSON.stringify(v)===JSON.stringify(T))return y});if(m!=-1){let y=i[m];u.info(["调用快捷键",y]),y.key in l&&l[y.key].callback();}});}let n={},o={};Object.keys(s).forEach(r=>{let l=s[r];(l.target==null||typeof l.target=="string"&&l.target==="")&&(l.target="window"),l.target==="window"?Reflect.set(n,r,l):Reflect.set(o,r,l);}),a(window,n),C.ready(()=>{Object.keys(o).forEach(async r=>{let l=o[r];if(typeof l.target=="string")d.waitNode(l.target,1e4).then(c=>{if(!c)return;let h={};Reflect.set(h,r,l),a(c,h);});else if(typeof l.target=="function"){let c=await l.target();if(c==null)return;let h={};Reflect.set(h,r,l),a(c,h);}else {let c={};Reflect.set(c,r,l),a(l.target,c);}});});}}const oe={shortCut:new ki("GM_shortcut"),init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"netdisk-keyboard-open-setting":{target:"window",callback:()=>{u.info("【打开】⚙ 设置"),ye.show();}},"netdisk-keyboard-open-history-matching-records":{target:"window",callback:()=>{u.info("【打开】⚙ 历史匹配记录"),w.netDiskHistoryMatch.show();}},"netdisk-keyboard-open-accesscode-rule":{target:"window",callback:()=>{u.info("【打开】⚙ 访问码规则"),w.accessCodeRule.show();}},"netdisk-keyboard-open-user-rule":{target:"window",callback:()=>{u.info("【打开】⚙ 用户自定义规则"),H.showUI(!1);}},"netdisk-keyboard-open-proactively-recognize-text":{target:"window",callback:()=>{u.info("【打开】⚙ 主动识别文本"),w.matchPasteText.show();}}}}},wi=function(t,s,i,e,a,n,o="请至少选择一个选项",r){let l=[];typeof e=="function"?l=e():l=e;let c={text:t,type:"select-multiple",description:n,placeholder:o,attributes:{},getValue(){return R(s,i)},selectConfirmDialogDetails:r,callback(h){let p=[];h.forEach(m=>{p.push(m.value);}),M(s,p),u.info(["多选-选择：",p]);},data:l};return c.attributes&&(c.attributes[se]=s,c.attributes[ne]=i),c},yi={id:"netdisk-panel-config-all-setting",title:"总设置",isDefault:!0,forms:[{type:"forms",text:"",forms:[{type:"deepMenu",text:"Toast",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-toast",forms:[ee("位置",k.toast.position.KEY,k.toast.position.default,[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],void 0,`Toast显示在九宫格的位置，默认: ${k.toast.position.default}`),ee("同时最多显示的数量",k.toast.maxnums.KEY,k.toast.maxnums.default,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,`默认: ${k.toast.showreverse.default}`),U("逆序弹出",k.toast.showreverse.KEY,k.toast.showreverse.value,void 0,"默认是自上往下显示Toast，逆序则是自下往上显示Toast")]}]},{type:"deepMenu",text:"弹窗",forms:[{className:"netdisk-panel-forms-pops",type:"forms",text:"",forms:[ee("动画",k.pops.popsAnimation.KEY,k.pops.popsAnimation.default,[{value:"",text:"无"},{value:"pops-anim-spread",text:"spread"},{value:"pops-anim-shake",text:"shake"},{value:"pops-anim-rolling-left",text:"rolling-left"},{value:"pops-anim-rolling-right",text:"rolling-right"},{value:"pops-anim-slide-top",text:"slide-top"},{value:"pops-anim-slide-bottom",text:"slide-bottom"},{value:"pops-anim-slide-left",text:"slide-left"},{value:"pops-anim-slide-right",text:"slide-right"},{value:"pops-anim-fadein",text:"fadein"},{value:"pops-anim-fadein-zoom",text:"fadein-zoom"},{value:"pops-anim-fadein-alert",text:"fadein-alert"},{value:"pops-anim-don",text:"don"},{value:"pops-anim-roll",text:"roll"},{value:"pops-anim-sandra",text:"sandra"},{value:"pops-anim-gather",text:"gather"}],void 0,`显示/关闭的动画效果，默认: ${k.pops.popsAnimation.default}`),U("点击弹窗遮罩层关闭弹窗",k.pops.clickMaskToCloseDialog.KEY,k.pops.clickMaskToCloseDialog.default,void 0,"点击遮罩层触发关闭弹窗事件"),U("窗口拖拽",k.pops.pcDrag.KEY,k.pops.pcDrag.default,void 0,"长按标题栏可拖拽移动弹窗"),U("限制拖拽距离",k.pops.pcDragLimit.KEY,k.pops.pcDragLimit.default,void 0,"只能在浏览器的可视窗口内拖动"),U("亚克力效果",k.pops.popsAcrylic.KEY,k.pops.popsAcrylic.default,void 0,"")]}]},{type:"deepMenu",text:"文件弹窗",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-pops-folder",forms:[ee("排序名",k.popsFolder["pops-folder-sort-name"].KEY,k.popsFolder["pops-folder-sort-name"].default,[{value:"fileName",text:"文件名"},{value:"latestTime",text:"修改时间"},{value:"fileSize",text:"大小"}],void 0,"当前的规则"),ee("排序规则",k.popsFolder["pops-folder-sort-is-desc"].KEY,k.popsFolder["pops-folder-sort-is-desc"].default,[{value:!1,text:"升序"},{value:!0,text:"降序"}],void 0,"当前的规则")]}]},{type:"deepMenu",text:"小图标导航",forms:[{type:"forms",text:"",forms:[U("点击定位分享码",k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode"].default,void 0,"自动滚动页面至包含分享码的元素"),U("选中分享码",k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-find-sharecode-with-select"].default,void 0,"使用光标选中分享码/元素"),U("循环定位",k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].KEY,k.smallIconNavgiator["pops-netdisk-icon-click-event-loop-find-sharecode"].default,void 0,"关闭则是每一个元素只定位一次")]}]},{type:"deepMenu",text:"悬浮按钮",forms:[{type:"forms",text:"",forms:[Y("大小",k.suspension.size.KEY,k.suspension.size.default,15,250,(t,s)=>{k.suspension.size.value=parseInt(s.toString()),w.suspension.isShow&&(C.css(w.suspension.suspensionNode,{width:k.suspension.size.value,height:k.suspension.size.value}),w.suspension.setSuspensionPosition());},t=>`${t}px`,"悬浮按钮的大小，默认: "+k.suspension.size.default),Y("透明度",k.suspension.opacity.KEY,k.suspension.opacity.default,.1,1,(t,s)=>{k.suspension.opacity.value=parseFloat(s.toString()),w.suspension.isShow&&C.css(w.suspension.suspensionNode,{opacity:k.suspension.opacity.value});},void 0,"值越小越透明，默认: "+k.suspension.opacity.default,.1),Y("背景轮播时间",k.suspension["randbg-time"].KEY,k.suspension["randbg-time"].default,0,1e4,void 0,t=>`${t}ms`,"淡入/淡出的时间，默认: "+k.suspension["randbg-time"].default+"ms",100),Y("背景显示时间",k.suspension["randbg-show-time"].KEY,k.suspension["randbg-show-time"].default,0,1e4,void 0,t=>`${t}ms`,"图标显示的持续时间，默认: 1200",100),U("吸附边缘",k.suspension["suspended-button-adsorption-edge"].KEY,k.suspension["suspended-button-adsorption-edge"].default,void 0,"移动悬浮按钮松开后自动吸附边缘")]}]},{type:"deepMenu",text:"小窗模式",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-small-window",forms:[Y("宽度",k.smallWindow["netdisk-ui-small-window-width"].KEY,k.smallWindow["netdisk-ui-small-window-width"].default,50,C.width(window),void 0,t=>`${t}px`,"设置小窗宽度(px)，默认: 250",1),Y("高度",k.smallWindow["netdisk-ui-small-window-max-height"].KEY,k.smallWindow["netdisk-ui-small-window-max-height"].default,50,C.height(window),void 0,t=>`${t}px`,"设置小窗最大高度(px)，默认: "+k.smallWindow["netdisk-ui-small-window-max-height"].default,1)]}]},{type:"deepMenu",text:"历史匹配记录",forms:[{type:"forms",text:"",className:"netdisk-panel-history-match",forms:[ee("排序规则",k.historyMatch["netdisk-history-match-ordering-rule"].KEY,k.historyMatch["netdisk-history-match-ordering-rule"].default,[{value:"按 记录时间 - 升序",text:"按 记录时间 - 升序"},{value:"按 记录时间 - 降序",text:"按 记录时间 - 降序"},{value:"按 更新时间 - 升序",text:"按 更新时间 - 升序"},{value:"按 更新时间 - 降序",text:"按 更新时间 - 降序"}]),Fe("修复存储记录","如果【匹配记录】弹窗打不开，可能是存储的数据缺失某些字段，可尝试点击此处进行修复","修复",void 0,void 0,!1,"primary",()=>{try{const{count:t,repairCount:s}=w.netDiskHistoryMatch.checkAndRepairLocalData();s===0?f.info("不存在需要修复的数据"):f.success(`共计: ${t} 条，修复${s}条`);}catch(t){f.error("修复异常："+t.toString());}}),U("保存匹配记录",k.historyMatch.saveMatchNetDisk.KEY,k.historyMatch.saveMatchNetDisk.default,void 0,"将匹配到的链接信息进行本地存储，可点击【油猴菜单-⚙ 历史匹配记录】进行查看")]}]},{type:"deepMenu",text:"匹配设置",forms:[{type:"forms",text:"文本匹配范围",forms:[wi("匹配规则类型",k.match.pageMatchRange.KEY,k.match.pageMatchRange.default,[{value:"innerText",text:"普通文本"},{value:"innerHTML",text:"超文本"}],void 0,"执行的文本匹配规则",void 0,{height:"auto"}),U("深入ShadowRoot获取匹配文本",k.match.depthQueryWithShadowRoot.KEY,k.match.depthQueryWithShadowRoot.default,void 0,"遍历ShadowRoot，获取匹配的内容"),U("匹配剪贴板",k.match.readClipboard.KEY,k.match.readClipboard.default,void 0,"Api兼容性查看：<a href='https://caniuse.com/mdn-api_permissions_permission_clipboard-read' target='_blank'>读取剪贴板权限申请</a>、<a href='https://caniuse.com/mdn-api_clipboard_readtext' target='_blank'>直接读取剪贴板</a>"),U("匹配当前URL",k.match.allowMatchLocationHref.KEY,k.match.allowMatchLocationHref.default,void 0,"提取window.location.href进行匹配"),U("匹配input标签的内容",k.match.toBeMatchedWithInputElementValue.KEY,k.match.toBeMatchedWithInputElementValue.default,void 0,"提取页面中的&lt;input&gt;的内容进行匹配"),U("匹配textarea标签的内容",k.match.toBeMatchedTextAreaElementValue.KEY,k.match.toBeMatchedTextAreaElementValue.default,void 0,"提取页面中的&lt;textarea&gt;的内容进行匹配")]},{type:"forms",text:"页面内容改变时的观察器",forms:[Y("匹配间隔",k.match.delaytime.KEY,k.match.delaytime.default,0,5,void 0,t=>`${t}s`,"匹配文本完毕后的延迟xxx秒允许下一次匹配",.1),U("添加元素时进行匹配",k.match.isAddedNodesToMatch.KEY,k.match.isAddedNodesToMatch.default,void 0,"当监听到页面添加元素时才进行匹配文本"),U("观察器：childList",k.match["mutationObserver-childList"].KEY,k.match["mutationObserver-childList"].default,void 0,"子节点的变动（新增、删除或者更改）"),U("观察器：characterData",k.match["mutationObserver-characterData"].KEY,k.match["mutationObserver-characterData"].default,void 0,"节点内容或节点文本的变动"),U("观察器：subtree",k.match["mutationObserver-subtree"].KEY,k.match["mutationObserver-subtree"].default,void 0,"是否将观察器应用于该节点的所有后代节点")]}]},{type:"deepMenu",text:"功能",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-function",forms:[ee("行为模式",k.function["netdisk-behavior-mode"].KEY,k.function["netdisk-behavior-mode"].default,[{text:"悬浮按钮+小窗",value:"suspension_smallwindow"},{text:"悬浮按钮+大窗",value:"suspension_window"},{text:"小窗",value:"smallwindow"}],void 0,"匹配到链接时触发的UI执行"),U("自动输入访问码",k.function.autoFillAccessCode.KEY,k.function.autoFillAccessCode.default,void 0,"通过主动点击链接跳转时，会自动输入网盘访问码"),U("获取重定向后的直链",k.function.getTheDirectLinkAfterRedirection.KEY,k.function.getTheDirectLinkAfterRedirection.default,void 0,"对获取的链接再进行一次重定向获取链接")]}]},{type:"deepMenu",text:"分享码相关",forms:[{type:"forms",text:"",className:"netdisk-panel-forms-share-code",forms:[U("排除分享码",k.aboutShareCode.excludeIdenticalSharedCodes.KEY,k.aboutShareCode.excludeIdenticalSharedCodes.default,void 0,"启用后会根据【相同系数】排除掉匹配到的分享码"),Y("相同系数",k.aboutShareCode.excludeIdenticalSharedCodesCoefficient.KEY,k.aboutShareCode.excludeIdenticalSharedCodesCoefficient.default,0,1,void 0,t=>t.toString(),"例如分享码: aaaaaaaabb，它的相同系数是0.8，设置相同系数≥0.8时会被排除",.01)]}]},{type:"deepMenu",text:"快捷键",forms:[{className:"netdisk-panel-forms-shortcut-keys",text:"",type:"forms",forms:[pe("【打开】⚙ 设置","","netdisk-keyboard-open-setting",void 0,"暂无快捷键","default",oe.shortCut),pe("【打开】⚙ 历史匹配记录","","netdisk-keyboard-open-history-matching-records",void 0,"暂无快捷键","default",oe.shortCut),pe("【打开】⚙ 访问码规则","","netdisk-keyboard-open-accesscode-rule",void 0,"暂无快捷键","default",oe.shortCut),pe("【打开】⚙ 用户自定义规则","","netdisk-keyboard-open-user-rule",void 0,"暂无快捷键","default",oe.shortCut),pe("【打开】⚙ 主动识别文本","","netdisk-keyboard-open-proactively-recognize-text",void 0,"暂无快捷键","default",oe.shortCut)]}]}]}]},B={$data:{__data:null,__oneSuccessExecMenu:null,__onceExec:null,__listenData:null,get data(){return B.$data.__data==null&&(B.$data.__data=new d.Dictionary),B.$data.__data},get oneSuccessExecMenu(){return B.$data.__oneSuccessExecMenu==null&&(B.$data.__oneSuccessExecMenu=new d.Dictionary),B.$data.__oneSuccessExecMenu},get onceExec(){return B.$data.__onceExec==null&&(B.$data.__onceExec=new d.Dictionary),B.$data.__onceExec},get scriptName(){return $e},key:te,attributeKeyName:se,attributeDefaultValueName:ne},$listener:{get listenData(){return B.$data.__listenData==null&&(B.$data.__listenData=new d.Dictionary),B.$data.__listenData}},init(){this.initPanelDefaultValue(this.getPanelContentConfig().concat(Ae.getRulePanelContent())),this.initExtensionsMenu();},isTopWindow(){return Z.top===Z.self},initExtensionsMenu(){this.isTopWindow()&&tt.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:!1,isStoreValue:!1,showText(t){return t},callback:()=>{ye.show();}},{key:"showNetDiskHistoryMatch",text:"⚙ 历史匹配记录",autoReload:!1,isStoreValue:!1,showText(t){return t},callback(){w.netDiskHistoryMatch.show();}},{key:"showAccessCodeRule",text:"⚙ 访问码规则",autoReload:!1,isStoreValue:!1,showText(t){return t},callback(){w.accessCodeRule.show();}},{key:"showUserRule",text:"⚙ 用户自定义规则",autoReload:!1,isStoreValue:!1,showText(t){return t},callback(){H.showUI(!1);}},{key:"showMatchPasteText",text:"⚙ 主动识别文本",autoReload:!1,isStoreValue:!1,showText(t){return t},callback(){w.matchPasteText.show();}}]);},initPanelDefaultValue(t){function s(e){if(!e.attributes)return;let a={},n=e.attributes[se];n!=null&&(a[n]=e.attributes[ne]);let o=e.attributes[Ue];if(typeof o=="function"){let c=o();if(typeof c=="boolean"&&!c)return}let r=e.attributes[it];r&&typeof r=="object"&&Object.assign(a,r);let l=Object.keys(a);if(!l.length){u.warn(["请先配置键",e]);return}l.forEach(c=>{let h=a[c];R(c)==null&&M(c,h);});}function i(e){for(let a=0;a<e.length;a++){let n=e[a];s(n);let o=n.forms;o&&Array.isArray(o)&&i(o);}}for(let e=0;e<t.length;e++){let a=t[e];if(!a.forms)continue;let n=a.forms;n&&Array.isArray(n)&&i(n);}},setValue(t,s){let i=R(te,{}),e=i[t];i[t]=s,M(te,i),this.$listener.listenData.has(t)&&this.$listener.listenData.get(t).callback(t,e,s);},getValue(t,s){let e=R(te,{})[t];return e??(this.$data.data.has(t)?this.$data.data.get(t):s)},deleteValue(t){let s=R(te,{}),i=s[t];Reflect.deleteProperty(s,t),M(te,s),this.$listener.listenData.has(t)&&this.$listener.listenData.get(t).callback(t,i,void 0);},addValueChangeListener(t,s,i){let e=Math.random();return this.$listener.listenData.set(t,{id:e,key:t,callback:s}),i&&i.immediate&&s(t,this.getValue(t),this.getValue(t)),e},removeValueChangeListener(t){let s=null;for(const[i,e]of this.$listener.listenData.entries())if(e.id===t){s=i;break}typeof s=="string"?this.$listener.listenData.delete(s):console.warn("没有找到对应的监听器");},triggerMenuValueChange(t,s,i){if(this.$listener.listenData.has(t)){let e=this.$listener.listenData.get(t);if(typeof e.callback=="function"){let a=this.getValue(t),n=a,o=a;typeof s<"u"&&arguments.length>1&&(n=s),typeof i<"u"&&arguments.length>2&&(o=i),e.callback(t,o,n);}}},hasKey(t){let s=R(te,{});return t in s},execMenu(t,s,i=!1){if(!(typeof t=="string"||typeof t=="object"&&Array.isArray(t)))throw new TypeError("key 必须是字符串或者字符串数组");let e=[];typeof t=="object"&&Array.isArray(t)?e=[...t]:e.push(t);let a;for(let n=0;n<e.length;n++){const o=e[n];if(!this.$data.data.has(o)){u.warn(`${t} 键不存在`);return}let r=B.getValue(o);if(i&&(r=!r),!r)break;a=r;}a&&s(a);},execMenuOnce(t,s,i,e){if(typeof t!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(t)){u.warn(`${t} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(t))return;this.$data.oneSuccessExecMenu.set(t,1);let a=()=>{let c=B.getValue(t);return typeof i=="function"?i(t,c):c},n=[],o=c=>{let h=a(),p=[];if(c instanceof HTMLStyleElement?p=[c]:Array.isArray(c)&&(p=[...c.filter(m=>m!=null&&m instanceof HTMLStyleElement)]),h)n=n.concat(p);else for(let m=0;m<p.length;m++)p[m].remove(),p.splice(m,1),m--;},r=c=>{let h=[];if(c){let p=s(c,o);p instanceof HTMLStyleElement?h=[p]:Array.isArray(p)&&(h=[...p.filter(m=>m!=null&&m instanceof HTMLStyleElement)]);}for(let p=0;p<n.length;p++)n[p].remove(),n.splice(p,1),p--;n=[...h];};this.addValueChangeListener(t,(c,h,p)=>{let m=p;typeof e=="function"&&(m=e(c,p,h)),r(m);});let l=a();l&&r(l);},execInheritMenuOnce(t,s,i,e){let a=this;const n=(o,r)=>{let l=a.getValue(o),c=a.getValue(r);if(typeof e=="function"){let h=e(l,c);if(h!==void 0)return h}return l};this.execMenuOnce(t,i,()=>n(t,s),()=>n(t,s)),this.execMenuOnce(s,()=>{},()=>!1,()=>(this.triggerMenuValueChange(t),!1));},onceExec(t,s){if(typeof t!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(t)||(s(),this.$data.onceExec.set(t,1));},getPanelContentConfig(){return [yi]}};Object.assign(w.src.icon,typeof RESOURCE_ICON>"u"?{}:RESOURCE_ICON);H.init();Ae.init();B.init();_.init();oe.init();C.ready(()=>{le.init(),_e.init(),S.init();});

})(Qmsg, DOMUtils, Utils, pops);