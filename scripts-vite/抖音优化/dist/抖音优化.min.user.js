// ==UserScript==
// @name         抖音优化
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2024.10.31
// @author       WhiteSevs
// @description  视频过滤，包括广告、直播或自定义规则，伪装登录、屏蔽登录弹窗、自定义清晰度选择、未登录解锁画质选择、禁止自动播放、自动进入全屏、双击进入全屏、屏蔽弹幕和礼物特效、手机模式、修复进度条拖拽、自定义视频和评论区背景色等
// @license      GPL-3.0-only
// @icon         data:image/png;base64,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
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*.douyin.com/*
// @match        *://*.iesdouyin.com/*
// @require      https://update.greasyfork.org/scripts/494167/1413255/CoverUMD.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.2.5/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.4.3/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.3.8/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@1.8.1/dist/index.umd.js
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (C, Ee, xe, Oe) {
	'use strict';

	var Ve=Object.defineProperty;var Be=(e,t,i)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var P=(e,t,i)=>Be(e,typeof t!="symbol"?t+"":t,i);var Te=typeof GM_deleteValue<"u"?GM_deleteValue:void 0,B=typeof GM_getValue<"u"?GM_getValue:void 0,Q=typeof GM_info<"u"?GM_info:void 0,Ae=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,T=typeof GM_setValue<"u"?GM_setValue:void 0,Re=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,De=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,S=typeof unsafeWindow<"u"?unsafeWindow:void 0,Pe=window;const R="GM_Panel",_e="data-init",Z="data-key",J="data-default-value",$e="data-init-more-value",E=function(e,t,i,n,a,r){let d=[];typeof n=="function"?d=n():d=n;let s={text:e,type:"select",description:r,attributes:{},getValue(){return c.getValue(t,i)},callback(l,h,f){c.setValue(t,h),typeof a=="function"&&a(l,h,f);},data:d};return s.attributes&&(s.attributes[Z]=t,s.attributes[J]=i),s},u=function(e,t,i,n,a){let r={text:e,type:"switch",description:a,attributes:{},getValue(){return !!c.getValue(t,i)},callback(d,s){o.success(`${s?"开启":"关闭"} ${e}`),c.setValue(t,!!s);},afterAddToUListCallBack:void 0};return r.attributes&&(r.attributes[Z]=t,r.attributes[J]=!!i),r},Ie={id:"panel-config-common",title:"通用",forms:[{text:"",type:"forms",forms:[{text:"Toast配置",type:"deepMenu",forms:[{text:"",type:"forms",forms:[E("Toast位置","qmsg-config-position","bottom",[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],(e,t,i)=>{o.info("设置当前Qmsg弹出位置"+i);},"Toast显示在页面九宫格的位置"),E("最多显示的数量","qmsg-config-maxnums",3,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,"限制Toast显示的数量"),u("逆序弹出","qmsg-config-showreverse",!1,void 0,"修改Toast弹出的顺序")]}]}]},{type:"forms",text:"",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("伪装登录","disguiseLogin",!1,void 0,"使用随机UID进行伪装"),u("initial-scale=1","dy-initialScale",!1,void 0,"可配合手机模式放大页面"),u("移除<meta> apple-itunes-app","dy-apple-removeMetaAppleItunesApp",!0,void 0,"Safari使用，移除顶部横幅【Open in the 抖音 app】")]}]},{text:"Url重定向",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("重定向/home","douyin-redirect-url-home-to-root",!1,void 0,"/home => /")]}]},{type:"deepMenu",text:"快捷键禁用",forms:[{type:"forms",text:`
								<a href="javascript:;" class="keyboard-oneClickOpen">一键开启</a>
								<br>
								<a href="javascript:;" class="keyboard-oneClickClose">一键关闭</a>
							`,afterAddToUListCallBack(e,t){const{target:i}=t;let n=i.querySelector(".keyboard-oneClickOpen"),a=i.querySelector(".keyboard-oneClickClose"),r=d=>{i==null||i.querySelectorAll(".pops-panel-switch").forEach(s=>{let l=s.querySelector(".pops-panel-switch__input"),h=s.querySelector(".pops-panel-switch__core");d?l.checked||h.click():l.checked&&h.click();});};g.on(n,"click",d=>{p.preventEvent(d),r(!0);}),g.on(a,"click",d=>{p.preventEvent(d),r(!1);});},forms:[u("赞|取消赞","dy-keyboard-hook-likeOrDislike",!1,void 0,"Z"),u("评论","dy-keyboard-hook-comment",!1,void 0,"X"),u("开启/关闭弹幕","dy-keyboard-hook-danmaku-enable",!1,void 0,"B"),u("收藏/取消收藏","dy-keyboard-hook-collect-enable",!1,void 0,"C"),u("复制分享口令","dy-keyboard-hook-copyShareLink",!1,void 0,"V"),u("清屏","dy-keyboard-hook-clearScreen",!1,void 0,"J"),u("自动连播","dy-keyboard-hook-automaticBroadcast",!1,void 0,"K"),u("视频信息","dy-keyboard-hook-videoInfo",!1,void 0,"I"),u("不感兴趣","dy-keyboard-hook-notInterested",!1,void 0,"R"),u("进入作者主页","dy-keyboard-hook-enterAuthorHomePage",!1,void 0,"F"),u("关注/取消关注","dy-keyboard-hook-follow",!1,void 0,"G"),u("抖音搜索","dy-keyboard-hook-search",!1,void 0,"Shift+F"),u("一键关闭当前页","dy-keyboard-hook-closeTheCurrentPageWithOneClick",!1,void 0,"Shift+Q"),u("上下翻页","dy-keyboard-hook-pageUpAndDown",!1,void 0,"↑↓"),u("快进快退","dy-keyboard-hook-fastForwardAndFastBack",!1,void 0,"← →"),u("暂停","dy-keyboard-hook-pause",!1,void 0,"空格"),u("网页内全屏","dy-keyboard-hook-fullScreenInsideThePage",!1,void 0,"Y"),u("全屏","dy-keyboard-hook-fullScreen",!1,void 0,"H"),u("稍后再看","dy-keyboard-hook-watchItOutLater",!1,void 0,"L"),u("音量调整","dy-keyboard-hook-volumeAdjustment",!1,void 0,"Shift + / Shift -"),u("呼出快捷键列表","dy-keyboard-hook-listOfCallShortcutKeys",!1,void 0,"?"),u("关闭快捷键列表","dy-keyboard-hook-closeTheShortcutKeyList",!1,void 0,"ESC"),u("相关推荐","dy-keyboard-hook-relevantRecommendation",!1,void 0,"N")]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-通用",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】登录弹窗","watchLoginDialogToClose",!0,void 0,"屏蔽元素且自动等待元素出现并关闭登录弹窗"),u("【屏蔽】底部？按钮","shieldBottomQuestionButton",!0,void 0,"屏蔽元素")]}]},{text:"屏蔽-左侧导航栏",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】左侧导航栏","shieldLeftNavigator",!1,void 0,"屏蔽元素"),u("【屏蔽】首页","shieldLeftNavigator-tab-home",!1,void 0,"屏蔽元素"),u("【屏蔽】推荐","shieldLeftNavigator-tab-recommend",!1,void 0,"屏蔽元素"),u("【屏蔽】关注","shieldLeftNavigator-tab-follow",!1,void 0,"屏蔽元素"),u("【屏蔽】朋友","shieldLeftNavigator-tab-friend",!1,void 0,"屏蔽元素"),u("【屏蔽】我的","shieldLeftNavigator-tab-user_self",!1,void 0,"屏蔽元素"),u("【屏蔽】喜欢","shieldLeftNavigator-tab-user_self_like",!1,void 0,"屏蔽元素"),u("【屏蔽】收藏","shieldLeftNavigator-tab-user_self_collection",!1,void 0,"屏蔽元素"),u("【屏蔽】观看历史","shieldLeftNavigator-tab-user_self_record",!1,void 0,"屏蔽元素"),u("【屏蔽】看奥运","shieldLeftNavigator-tab-olympics",!1,void 0,"屏蔽元素"),u("【屏蔽】直播","shieldLeftNavigator-tab-live",!1,void 0,"屏蔽元素"),u("【屏蔽】放映厅","shieldLeftNavigator-tab-vs",!1,void 0,"屏蔽元素"),u("【屏蔽】知识","shieldLeftNavigator-tab-channel_300203",!1,void 0,"屏蔽元素"),u("【屏蔽】游戏","shieldLeftNavigator-tab-channel_300205",!1,void 0,"屏蔽元素"),u("【屏蔽】二次元","shieldLeftNavigator-tab-channel_300206",!1,void 0,"屏蔽元素"),u("【屏蔽】音乐","shieldLeftNavigator-tab-channel_300209",!1,void 0,"屏蔽元素"),u("【屏蔽】美食","shieldLeftNavigator-tab-channel_300204",!1,void 0,"屏蔽元素")]}]},{text:"屏蔽-顶部导航栏",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】顶部导航栏","shieldTopNavigator",!1,void 0,"屏蔽元素"),u("【屏蔽】客户端提示","shieldClientTip",!0,void 0,"屏蔽元素"),u("【屏蔽】充钻石","shieldFillingBricksAndStones",!0,void 0,"屏蔽元素"),u("【屏蔽】客户端","shieldClient",!0,void 0,"屏蔽元素"),u("【屏蔽】快捷访问","shieldQuickAccess",!1,void 0,"屏蔽元素"),u("【屏蔽】通知","shieldNotifitation",!1,void 0,"屏蔽元素"),u("【屏蔽】私信","shieldPrivateMessage",!1,void 0,"屏蔽元素"),u("【屏蔽】投稿","shieldSubmission",!1,void 0,"屏蔽元素"),u("【屏蔽】壁纸","shieldWallpaper",!1,void 0,"屏蔽元素")]}]},{text:"屏蔽-搜索",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】搜索框","shieldSearch",!1,void 0,"屏蔽元素"),u("【屏蔽】搜索框的提示","shieldSearchPlaceholder",!1,void 0,"屏蔽元素"),u("【屏蔽】猜你想搜","shieldSearchGuessYouWantToSearch",!1,void 0,"屏蔽元素"),u("【屏蔽】抖音热点","shieldSearchTiktokHotspot",!1,void 0,"屏蔽元素")]}]}]}]},X={key:"douyin-live-danmu-rule",$data:{rule:[],isFilterAttrName:"data-is-filter"},init(){this.parseRule();},parseRule(){this.get().trim().split(`
`).forEach(i=>{if(i.trim()=="")return;i=i.trim();let n=new RegExp(i.trim());this.$data.rule.push(n);});},change(){var t,i,n,a,r,d,s;let e=Array.from(document.querySelectorAll("xg-danmu.xgplayer-danmu > div > div"));if(e.length)for(let l=0;l<e.length;l++){let h=e[l];if(h.hasAttribute(this.$data.isFilterAttrName))continue;let f=(a=(n=(i=(t=p.getReactObj(h))==null?void 0:t.reactFiber)==null?void 0:i.return)==null?void 0:n.memoizedProps)==null?void 0:a.message,y=((r=f==null?void 0:f.payload)==null?void 0:r.content)||((s=(d=f==null?void 0:f.payload)==null?void 0:d.common)==null?void 0:s.describe);for(let m=0;m<this.$data.rule.length;m++){const b=this.$data.rule[m];if(typeof y=="string"&&b.test(y)){o.info("过滤弹幕: "+y),h.setAttribute(this.$data.isFilterAttrName,"true"),g.hide(h);break}}}},set(e){T(this.key,e);},get(){return B(this.key,"")}},Ne={filterDanmu(){p.waitNode("xg-danmu.xgplayer-danmu",1e5).then(e=>{if(!e){o.error("xg-danmu.xgplayer-danmu获取失败");return}o.success("弹幕过滤"),X.init(),p.mutationObserver(e,{config:{childList:!0,subtree:!0},callback:()=>{X.change();}});});}},v={isVerticalScreen(){return !window.screen.orientation.type.includes("landscape")},addBlockCSS(...e){let t=[];if(e.length!==0&&!(e.length===1&&typeof e[0]=="string"&&e[0].trim()===""))return e.forEach(i=>{Array.isArray(i)?t=t.concat(i):t.push(i);}),p.addStyle(`${t.join(`,
`)}{display: none !important;}`)},getObjectPropertiesInDepth(e,t){if(e==null)return;let i=t(e);return typeof(i==null?void 0:i.isFind)=="boolean"&&i.isFind?i==null?void 0:i.data:this.getObjectPropertiesInDepth(i.data,t)}},Fe={async waitReactPropsToSet(e,t,i){function n(){let a=null;return typeof e=="string"?a=document.querySelector(e):typeof e=="function"?a=e():e instanceof HTMLElement&&(a=e),a}typeof e=="string"&&!await p.waitNode(e,1e4)||i.forEach(a=>{typeof a.msg=="string"&&o.info(a.msg);function r(){let d=n();if(d==null)return !1;let s=p.getReactObj(d);if(s==null)return !1;let l=s[t];return l==null?!1:!!a.check(l)}p.waitPropertyByInterval(()=>n(),r,250,1e4).then(()=>{let d=n();if(d==null)return;let s=p.getReactObj(d);if(s==null)return;let l=s[t];l!=null&&a.set(l);});});}},He={init(){c.execMenuOnce("live-shieldChatRoom",()=>this.shieldChatRoom()),c.execMenuOnce("live-shielChatRoomVipSeats",()=>this.shielChatRoomVipSeats()),c.execMenuOnce("dy-live-shieldUserLevelIcon",()=>this.shieldUserLevelIcon()),c.execMenuOnce("dy-live-shieldUserVIPIcon",()=>this.shieldUserVIPIcon()),c.execMenuOnce("dy-live-shieldUserFansIcon",()=>this.shieldUserFansIcon()),c.execMenuOnce("dy-live-shieldMessage",()=>this.shieldMessage());},shieldChatRoom(){return o.info("【屏蔽】评论区"),[v.addBlockCSS("#chatroom"),x(`
            div[data-e2e="living-container"],
            div[data-e2e="living-container"] > div{
                margin-bottom: 0px !important;
            }`)]},shielChatRoomVipSeats(){return o.info("【屏蔽】评论区的贵宾席"),[v.addBlockCSS("#chatroom > div > div:has(#audiencePanelScrollId)")]},shieldUserLevelIcon(){return o.info("【屏蔽】用户等级图标"),[v.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="level"])')]},shieldUserVIPIcon(){return o.info("【屏蔽】VIP图标"),[v.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="subscribe"])')]},shieldUserFansIcon(){return o.info("【屏蔽】粉丝牌"),[v.addBlockCSS('.webcast-chatroom___item span:has(>div[style*="fansclub"])')]},shieldMessage(){return o.info("【屏蔽】信息播报"),[v.addBlockCSS(".webcast-chatroom___bottom-message",'#chatroom >div>div>div:has(>div[elementtiming="element-timing"])')]}},Ke={init(){c.execMenuOnce("live-shieldDanmuku",()=>this.shieldDanmu());},shieldDanmu(){return o.info("屏蔽弹幕"),[v.addBlockCSS("xg-danmu.xgplayer-danmu")]}},Ue={init(){c.execMenuOnce("live-shieldGiftColumn",()=>this.shieldGiftColumn()),c.execMenuOnce("live-shieldTopToolBarInfo",()=>this.shieldTopToolBarInfo()),c.execMenuOnce("live-shieldGiftEffects",()=>this.shieldGiftEffects()),c.execMenuOnce("live-shielYellowCar",()=>this.shieldYellowCar()),He.init(),Ke.init();},shieldGiftColumn(){return o.info("屏蔽底部的礼物栏"),[v.addBlockCSS('div[data-e2e="living-container"] >div> :last-child','div[data-e2e="living-container"] xg-controls > div:has(div[data-e2e="gifts-container"])'),x(`
            /* 去除全屏状态下的礼物栏后，上面的工具栏bottom也去除 */
            div[data-e2e="living-container"] xg-controls xg-inner-controls:has(+div div[data-e2e="gifts-container"]){
                bottom: 0 !important;
            }`)]},shieldTopToolBarInfo(){return o.info("【屏蔽】顶栏信息"),[v.addBlockCSS('div[data-e2e="living-container"] > div > pace-island[id^="island_"]')]},shieldGiftEffects(){return o.info("【屏蔽】礼物特效"),[v.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"]  pace-island[id^="island_"]:has(>div>div:not([class*="video_layout_container"])>div)')]},shieldYellowCar(){return o.info("【屏蔽】小黄车"),[v.addBlockCSS('div[id^="living_room_player_container"] .basicPlayer  > div:has(div[data-e2e="yellowCart-container"])')]}},We={$data:{playerInstance:null},$el:{$playerIns:null},initMenu(){Me.add({key:"live-parsePlayerInstance",text:"⚙ PlayerInstance",autoReload:!1,showText(e,t){return e},callback:()=>{let e=document.querySelector('[id^="living_room_player_container"]');if(!e){o.error("获取playerInstance所在的元素失败"),C.error("获取playerInstance所在的元素失败");return}this.$el.$playerIns=e;let t=this.parseElementPlayerIns(this.$el.$playerIns);if(t==null){o.error("获取playerInstance失败"),o.error("获取playerInstance失败");return}this.$data.playerInstance=t,this.showParseDialog();}});},parseElementPlayerIns(e){var i,n,a,r;let t=p.getReactObj(e);return (r=(a=(n=(i=t==null?void 0:t.reactFiber)==null?void 0:i.child)==null?void 0:n.child)==null?void 0:a.memoizedProps)==null?void 0:r.playerInstance},showParseDialog(){var i,n,a,r;o.info(["解析的信息：",this.$data.playerInstance]);let e=((i=this.$data.playerInstance)==null?void 0:i.url)||((n=this.$data.playerInstance)==null?void 0:n.src),t=(a=this.$data.playerInstance)==null?void 0:a.config.url;j.alert({title:{text:"解析信息",position:"center"},content:{text:`
                <div class="live-dy-parse-container">
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">推流地址：</div>
                        <a class="live-dy-parse-item-value" href="${t}" target="_blank">${t}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">blob地址：</div>
                        <a class="live-dy-parse-item-value" href="${e}" target="_blank">${e}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">播放器版本：</div>
                        <div class="live-dy-parse-item-value">${(r=this.$data.playerInstance)==null?void 0:r.version}
                        </div>
                    </div>
                </div>
                `,html:!0},mask:{enable:!1},width:window.innerWidth>550?"550px":"88wv",height:window.innerHeight>550?"550px":"70vh",style:`
            .live-dy-parse-container{
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            .live-dy-parse-item{
                display: flex;
                flex-wrap: wrap;
                border: 1px solid #919191;
                border-left: 0px;
                border-right: 0px;
                width: 100%;
                background: #0af9ee;
                padding: 5px 5px;
            }
            `});}},I={auto:{label:"自动",sign:0},ld:{label:"标清",sign:1},sd:{label:"高清",sign:2},hd:{label:"超清",sign:3},uhd:{label:"蓝光",sign:4},origin:{label:"潮汐海灵",sign:5}},Ye={init(){Ue.init(),c.execMenu("live-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),c.execMenu("live-danmu-shield-rule-enable",()=>{Ne.filterDanmu();}),c.execMenu("live-chooseQuality",e=>{e!=="auto"&&this.chooseQuality(e);}),c.execMenu("live-unlockImageQuality",()=>{this.unlockImageQuality();}),c.execMenuOnce("live-waitToRemovePauseDialog",()=>{this.waitToRemovePauseDialog();}),c.execMenu("live-pauseVideo",()=>{this.pauseVideo();}),c.execMenu("live-bgColor-enable",()=>{c.execMenuOnce("live-changeBackgroundColor",e=>this.changeBackgroundColor(e));}),c.execMenuOnce("live-parsePlayerInstance",()=>{We.initMenu();});},autoEnterElementFullScreen(){o.info("自动进入网页全屏"),p.waitNode('xg-icon[classname] > div > div:has(path[d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(e=>{e.click();});},chooseQuality(e="origin"){Fe.waitReactPropsToSet('xg-inner-controls xg-right-grid >div:has([data-e2e="quality-selector"])',"reactProps",[{check(t){var i,n,a,r,d,s,l,h,f;return typeof((r=(a=(n=(i=t==null?void 0:t.children)==null?void 0:i.props)==null?void 0:n.children)==null?void 0:a.props)==null?void 0:r.qualityHandler)=="object"&&typeof((f=(h=(l=(s=(d=t==null?void 0:t.children)==null?void 0:d.props)==null?void 0:s.children)==null?void 0:l.props)==null?void 0:h.qualityHandler)==null?void 0:f.getCurrentQualityList)=="function"},set(t){let i=t.children.props.children.props.qualityHandler,n=i.getCurrentQualityList();if(n.includes(e))i.setCurrentQuality(e),o.success("成功设置画质为【"+e+"】");else {let a=e;C.error("当前直播没有【"+a+"】画质，自动选择最高画质"),n.sort((r,d)=>I[r]?I[d]?I[r].sign-I[d].sign:(o.error("画质【"+d+"】不存在"),0):(o.error("画质【"+r+"】不存在"),0)),a=n[n.length-1],i.setCurrentQuality(e),o.success("成功设置画质为【"+e+"】");}}}]);},unlockImageQuality(){o.info("解锁画质选择"),g.on(document,"click",'div[data-e2e="quality-selector"] > div',function(e){var i,n;p.preventEvent(e);let t=e.target;try{let a=p.getReactObj(t),r=(i=a==null?void 0:a.reactFiber)==null?void 0:i.key,d=t.closest("div[data-index]"),s=p.getReactObj(d),l=(n=s==null?void 0:s.reactProps)==null?void 0:n.children.ref.current;o.info("当前选择的画质: "+r),o.info(["所有的画质: ",l.getCurrentQualityList()]),l.setCurrentQuality(r);}catch(a){o.error(a),C.error("切换画质失败");}},{capture:!0});},waitToRemovePauseDialog(){o.info("监听【长时间无操作，已暂停播放】弹窗");function e(t,i){var a,r,d,s,l,h;let n=t.textContent||t.innerText;if(n.includes("长时间无操作")&&n.includes("暂停播放")){o.info(`检测${i}：出现【长时间无操作，已暂停播放】弹窗`),C.info(`检测${i}：出现【长时间无操作，已暂停播放】弹窗`);let f=p.getReactObj(t);if(typeof f.reactContainer=="object"){let y=v.getObjectPropertiesInDepth(f.reactContainer,m=>{var b,_;return typeof m.onClose=="function"?{isFind:!0,data:m.onClose}:typeof((b=m==null?void 0:m.memoizedProps)==null?void 0:b.onClose)=="function"?{isFind:!0,data:(_=m==null?void 0:m.memoizedProps)==null?void 0:_.onClose}:{isFind:!1,data:m.child}})||((h=(l=(s=(d=(r=(a=f==null?void 0:f.reactContainer)==null?void 0:a.memoizedState)==null?void 0:r.element)==null?void 0:d.props)==null?void 0:s.children)==null?void 0:l.props)==null?void 0:h.onClose);typeof y=="function"&&(o.success(`检测${i}：调用函数关闭弹窗`),C.success(`检测${i}：调用函数关闭弹窗`),y());}}}g.ready(()=>{p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){document.querySelectorAll("body > div[elementtiming='element-timing']").forEach(t=>{e(t,"1");}),document.querySelectorAll('body > div:not([id="root"])').forEach(t=>{e(t,"2");});}});});},pauseVideo(){o.info("禁止自动播放视频(直播)"),p.waitNode('.basicPlayer[data-e2e="basicPlayer"] video').then(e=>{g.on(e,"play",()=>{e.pause();},{capture:!0,once:!0}),e.autoplay=!1,e.pause();});},changeBackgroundColor(e){return o.info("修改视频背景颜色"),x(`
		div[id^="living_room_player_container"] > div,
		#chatroom > div{
			background: ${e};
		}	
		`)}},ze={id:"panel-config-live",title:"直播",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[E("清晰度","live-chooseQuality","auto",Object.keys(I).map(e=>{let t=I[e];return {value:e,text:t.label}}),void 0,"自行选择清晰度"),u("解锁画质选择","live-unlockImageQuality",!0,void 0,"未登录的情况下选择原画实际上是未登录的情况下最高选择的画质"),u("自动进入网页全屏","live-autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),u("监听并关闭【长时间无操作，已暂停播放】弹窗","live-waitToRemovePauseDialog",!0,void 0,"自动监听并检测弹窗"),u("禁止自动播放","live-pauseVideo",!1,void 0,"暂停直播播放"),u("解析直播信息","live-parsePlayerInstance",!1,void 0,"开启后将在油猴菜单中新增菜单【⚙ PlayerInstance】，可解析当前的直播信息"),u("禁用双击点赞","dy-live-disableDoubleClickLike",!1,void 0,"禁止直播视频区域双击点赞")]},{text:"视频区域背景色",type:"forms",forms:[u("启用","live-bgColor-enable",!1,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"live-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(e){let t=g.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),i=g.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");n.value=c.getValue("live-changeBackgroundColor");let a=g.createElement("style");return g.append(document.head,a),g.on(n,["input","propertychange"],r=>{o.info("选择颜色："+n.value),a.innerHTML=`
											div[id^="living_room_player_container"] > div,
											#chatroom > div{
												background: ${n.value};
											}
											`,c.setValue("live-changeBackgroundColor",n.value);}),e.appendChild(t),e.appendChild(i),e}}]}]},{text:"过滤-弹幕",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("启用","live-danmu-shield-rule-enable",!1,void 0,"启用自定义的弹幕过滤规则"),{type:"own",getLiElementCallBack(e){let t=g.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=t.querySelector("textarea");return i.value=X.get(),g.on(i,["input","propertychange"],p.debounce(function(){X.set(i.value);},200)),e.appendChild(t),e}}]}]},{type:"deepMenu",text:"快捷键禁用",forms:[{type:"forms",text:"",forms:[u("刷新","dy-live-refresh",!1,void 0,"E"),u("屏幕旋转","dy-live-screenRotation",!1,void 0,"D"),u("开启小窗模式","dy-live-enableSmallWindowMode",!1,void 0,"U")]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-视频区域内",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】顶栏信息","live-shieldTopToolBarInfo",!1,void 0,"屏蔽元素，包括直播作者、右侧的礼物展馆"),u("【屏蔽】底部的礼物栏","live-shieldGiftColumn",!1,void 0,"屏蔽元素"),u("【屏蔽】礼物特效","live-shieldGiftEffects",!1,void 0,"屏蔽元素"),u("【屏蔽】弹幕","live-shieldDanmuku",!1,void 0,"屏蔽元素"),u("【屏蔽】小黄车","live-shielYellowCar",!1,void 0,"屏蔽元素")]}]},{text:"屏蔽-聊天室",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】聊天室","live-shieldChatRoom",!1,void 0,"屏蔽元素"),u("【屏蔽】贵宾席","live-shielChatRoomVipSeats",!1,void 0,"屏蔽元素"),u("【屏蔽】用户等级图标","dy-live-shieldUserLevelIcon",!1,void 0,"屏蔽元素"),u("【屏蔽】VIP图标","dy-live-shieldUserVIPIcon",!1,void 0,"屏蔽元素"),u("【屏蔽】粉丝牌","dy-live-shieldUserFansIcon",!1,void 0,"屏蔽元素"),u("【屏蔽】信息播报","dy-live-shieldMessage",!1,void 0,"底部滚动播报的的xxx来了，xxx给主播点赞")]}]}]}]};class qe{constructor(t){P(this,"key","short-cut");P(this,"isWaitPress",!1);typeof t=="string"&&(this.key=t);}initConfig(t,i){this.hasOption(t)||this.setOption(t,i);}getStorageKey(){return this.key}getLocalAllOptions(){return B(this.key,[])}hasOption(t){return !!this.getLocalAllOptions().find(a=>a.key===t)}hasOptionValue(t){if(this.hasOption(t)){let i=this.getOption(t);return (i==null?void 0:i.value)!=null}else return !1}getOption(t,i){return this.getLocalAllOptions().find(r=>r.key===t)??i}setOption(t,i){let n=this.getLocalAllOptions(),a=n.findIndex(r=>r.key===t);a==-1?n.push({key:t,value:i}):Reflect.set(n[a],"value",i),T(this.key,n);}emptyOption(t){let i=!1,n=this.getLocalAllOptions(),a=n.findIndex(r=>r.key===t);return a!==-1&&(n[a].value=null,i=!0),T(this.key,n),i}deleteOption(t){let i=!1,n=this.getLocalAllOptions(),a=n.findIndex(r=>r.key===t);return a!==-1&&(n.splice(a,1),i=!0),T(this.key,n),i}translateKeyboardValueToButtonText(t){let i="";return t.ohterCodeList.forEach(n=>{i+=p.stringTitleToUpperCase(n,!0)+" + ";}),i+=p.stringTitleToUpperCase(t.keyName),i}getShowText(t,i){if(this.hasOption(t)){let n=this.getOption(t);return n.value==null?i:this.translateKeyboardValueToButtonText(n.value)}else return i}async enterShortcutKeys(t){return new Promise(i=>{this.isWaitPress=!0;let n=g.listenKeyboard(window,"keyup",(a,r,d)=>{const s={keyName:a,keyValue:r,ohterCodeList:d},l=JSON.stringify(s),h=this.getLocalAllOptions();for(let f=0;f<h.length;f++){let y=h[f];if(y.key===t)continue;const m=JSON.stringify(y.value);let b=!1;if(y.value!=null&&l===m&&(b=!0),b){this.isWaitPress=!1,n.removeListen(),i({status:!1,key:y.key,option:s});return}}this.setOption(t,s),this.isWaitPress=!1,n.removeListen(),i({status:!0,key:t,option:s});});})}initGlobalKeyboardListener(t){let i=this.getLocalAllOptions();if(!i.length){o.warn("没有设置快捷键");return}let n=this;function a(s,l){g.listenKeyboard(s,"keydown",(h,f,y)=>{if(n.isWaitPress)return;i=n.getLocalAllOptions();let m=i.findIndex(b=>{let _=b.value,w={keyName:h,keyValue:f,ohterCodeList:y};if(JSON.stringify(_)===JSON.stringify(w))return b});if(m!=-1){let b=i[m];o.info(["调用快捷键",b]),b.key in l&&l[b.key].callback();}});}let r={},d={};Object.keys(t).forEach(s=>{let l=t[s];(l.target==null||typeof l.target=="string"&&l.target==="")&&(l.target="window"),l.target==="window"?Reflect.set(r,s,l):Reflect.set(d,s,l);}),a(window,r),g.ready(()=>{Object.keys(d).forEach(async s=>{let l=d[s];if(typeof l.target=="string")p.waitNode(l.target,1e4).then(h=>{if(!h)return;let f={};Reflect.set(f,s,l),a(h,f);});else if(typeof l.target=="function"){let h=await l.target();if(h==null)return;let f={};Reflect.set(f,s,l),a(h,f);}else {let h={};Reflect.set(h,s,l),a(l.target,h);}});});}}const Ge=`/* 去除顶部的padding距离 */\r
#douyin-right-container {\r
	padding-top: 0;\r
}\r
/* 放大放大顶部的综合、视频、用户等header的宽度 */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) {\r
	width: 100vw;\r
}\r
/* 放大顶部的综合、视频、用户等header */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) > div {\r
	transform: scale(0.8);\r
}\r
/* 视频宽度 */\r
ul[data-e2e="scroll-list"] {\r
	padding: 0px 10px;\r
}\r
#sliderVideo {\r
	width: -webkit-fill-available;\r
}\r
/* 距离是顶部导航栏的高度 */\r
#search-content-area {\r
	margin-top: 65px;\r
}\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#sliderVideo {\r
		width: 100%;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#component-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: -webkit-fill-available;\r
		padding-right: 0;\r
	}\r
}\r
`,je={init(){c.execMenuOnce("douyin-search-shieldReleatedSearches",()=>this.shieldReleatedSearches());},shieldReleatedSearches(){return o.info("【屏蔽】相关搜索"),[v.addBlockCSS("#search-content-area > div > div:nth-child(2)"),x(`
			#search-content-area > div > div:nth-child(1) > div:nth-child(1){
				width: 100vw;
			}`)]}},ee={watchVideDataListChange(e){let t=null;g.ready(()=>{p.waitAnyNode(["#slidelist",'#search-content-area ul[data-e2e="scroll-list"]']).then(i=>{o.info("启用观察器观察加载的视频"),p.mutationObserver(i,{config:{childList:!0,subtree:!0},callback:(n,a)=>{if(t||(t=this.getOSElement()),!t){o.error("watchVideDataListChange：获取osElement失败");return}e(t,a);},immediate:!0});});});},getOSElement(){return document.querySelector("#root div[class*='-os']")||document.querySelector("#douyin-right-container")}};class le{constructor(t){P(this,"key");P(this,"$data",{__rule:null,get rule(){return this.__rule==null&&(this.__rule=new p.Dictionary),this.__rule},moreRule:[]});P(this,"$flag",{isBlockLiveVideo:!1,isBlockAdsVideo:!1});this.key=t.key,this.$flag.isBlockLiveVideo=!!t.isBlockLiveVideo,this.$flag.isBlockAdsVideo=!!t.isBlockAdsVideo,this.initLocalRule();}checkFilterWithRule(t){if(t.videoInfoValue==null||t.ruleValue==null)return !1;if(typeof t.videoInfoValue=="string"){if(t.videoInfoValue.match(t.ruleValue))return !0}else if(typeof t.videoInfoValue=="object"&&Array.isArray(t.videoInfoValue)){if(t.videoInfoValue.find(n=>!!n.match(t.ruleValue)))return !0}else if(typeof t.videoInfoValue=="number"&&typeof t.ruleValue=="string"){let i=t.ruleValue.match(/(\d+)/);if(!i)return o.warn(["过滤器-解析比较大小的数字失败: ",t]),!1;let n=Number(i[1]);if(t.ruleValue.startsWith(">")){if(t.ruleValue.startsWith(">=")&&t.videoInfoValue>=n)return !0;if(t.videoInfoValue>n)return !0}else if(t.ruleValue.startsWith("<")){if(t.ruleValue.startsWith("<=")&&t.videoInfoValue<=n)return !0;if(t.videoInfoValue<n)return !0}else if(t.ruleKey.startsWith("=")){if(t.videoInfoValue===n)return !0}else return o.warn(["过滤器-自定义屏蔽-未经允许的比较符号: ",t]),!1}return !1}checkAwemeInfoIsFilter(t){let i=this.getAwemeInfoDictData(t,!0),n=!1;if(n||this.$flag.isBlockLiveVideo&&i.isLive&&(o.success("过滤器-屏蔽直播"),n=!0),n||this.$flag.isBlockAdsVideo&&i.isAds&&(o.success("过滤器-屏蔽广告"),n=!0),!n)for(const[a,r]of this.$data.rule.entries()){if(!Reflect.has(i,a))continue;let d=a,s=i[d],l={videoInfoKey:d,videoInfoValue:s,ruleKey:a,ruleValue:r};if(this.checkFilterWithRule(l)){n=!0,o.success(["过滤器-自定义屏蔽: ",l]);break}}if(!n)for(const a of this.$data.moreRule){let r=!0;for(const[d,s]of Object.entries(a)){if(!Reflect.has(i,d)){r=!1;break}let l=d,h=i[l],f={videoInfoKey:l,videoInfoValue:h,ruleKey:d,ruleValue:s};if(!this.checkFilterWithRule(f)){r=!1;break}}if(r){n=!0,o.success(["多组过滤器-自定义屏蔽: ",a,this.getAwemeInfoDictData(t)]);break}}return n}getAwemeInfoDictData(t,i=!1){var _,w,L,A,N,F,H,K,U,W,Y,z,q,G;let n=(w=(_=t==null?void 0:t.authorInfo)==null?void 0:_.nickname)==null?void 0:w.toString(),a=(A=(L=t==null?void 0:t.authorInfo)==null?void 0:L.uid)==null?void 0:A.toString(),r=(N=t==null?void 0:t.desc)==null?void 0:N.toString(),d=(F=t==null?void 0:t.stats)==null?void 0:F.collectCount,s=(H=t==null?void 0:t.stats)==null?void 0:H.commentCount,l=(K=t==null?void 0:t.stats)==null?void 0:K.diggCount,h=(U=t==null?void 0:t.stats)==null?void 0:U.shareCount,f=[],y=!1,m=!1;typeof(t==null?void 0:t.textExtra)=="object"&&Array.isArray(t==null?void 0:t.textExtra)&&((W=t==null?void 0:t.textExtra)==null||W.forEach(D=>{f.push(D.hashtagName);}));let b=[];return typeof(t==null?void 0:t.videoTag)=="object"&&Array.isArray(t==null?void 0:t.videoTag)&&(t==null||t.videoTag.forEach(D=>{b.push(D.tagName);})),typeof t.cellRoom=="object"&&(y=!0,i&&o.success("直播间：cellRoom is not null")),t.isAds?(m=!0,i&&o.success("广告：isAds is true")):typeof t.rawAdData=="string"&&p.isNotNull(t.rawAdData)?(m=!0,i&&o.success("广告：rawAdData is not null")):(z=(Y=t.webRawData)==null?void 0:Y.brandAd)!=null&&z.is_ad?(m=!0,i&&o.success("广告：webRawData.brandAd.is_ad is true")):(G=(q=t.webRawData)==null?void 0:q.insertInfo)!=null&&G.is_ad&&(m=!0,i&&o.success("广告：webRawData.insertInfo.is_ad is true")),{nickname:n,uid:a,desc:r,textExtra:f,videoTag:b,collectCount:d,commentCount:s,diggCount:l,shareCount:h,isLive:y,isAds:m}}initLocalRule(){let i=this.get().trim().split(`
`);this.$data.rule.clear(),this.$data.moreRule=[],i.forEach(n=>{if(p.isNull(n))return;let r=n.trim().split("##");if(r.length<2)return;let d=r[0];if(r.shift(),d==="more"){let l=r.join("##").split("##"),h={};for(let f=0;f<l.length;f+=2){let y=l[f],m=l[f+1];try{if(m.match(/^>|<|=/g))Reflect.set(h,y,m.trim());else {let b=new RegExp(m,"g");Reflect.set(h,y,b);}}catch(b){o.error(["多组-自定义视频过滤规则-正则解析错误："+b]),o.error("多组-错误的规则："+n);}}this.$data.moreRule.push(h);}else {let s=r.join("");try{if(s.match(/^>|<|=/g))this.$data.rule.set(d,s.trim());else {let l=new RegExp(s,"g");this.$data.rule.set(d,l);}}catch(l){o.error(["自定义视频过滤规则-正则解析错误："+l]),o.error("错误的规则："+n);}}});}updateRule(t){if(t=t.trim(),t=="")return;let i=this.get().trim();i=i+`
`+t,this.set(i),this.initLocalRule();}set(t){T(this.key,t);}get(){return B(this.key,"")}clear(){this.set("");}destory(){Te(this.key);}}const ne={__videoFilter:null,get videoFilter(){if(this.__videoFilter==null){const e="douyin-search-shield-rule",t=c.getValue("search-shieldVideo-live"),i=c.getValue("search-shieldVideo-ads");this.__videoFilter=new le({key:e,isBlockLiveVideo:t,isBlockAdsVideo:i});}return this.__videoFilter},init(){ee.watchVideDataListChange(p.debounce(e=>{var i,n,a,r;let t=Array.from(document.querySelectorAll('#search-content-area ul[data-e2e="scroll-list"] li'));if(!t.length){o.error("未获取到搜索视频列表元素");return}for(let d=0;d<t.length;d++){const s=t[d];let l=(i=p.getReactObj(s))==null?void 0:i.reactProps;if(l==null){o.error(["元素上不存在reactProps属性",s]);return}let h=(r=(a=(n=l==null?void 0:l.children)==null?void 0:n.props)==null?void 0:a.data)==null?void 0:r.awemeInfo;if(h==null){o.error(["元素上不存在awemeInfo属性",s]);return}this.videoFilter.checkAwemeInfoIsFilter(h)&&(s.remove(),d--);}},50));},get(){return this.videoFilter.get()},set(e){this.videoFilter.set(e);}},Se={init(){je.init(),c.execMenuOnce("search-shieldVideo",()=>{ne.init();}),c.execMenuOnce("dy-search-disableClickToEnterFullScreen",()=>{this.disableClickToEnterFullScreen();}),c.execMenuOnce("live-setSearchResultFilterWithVideoStyle",e=>this.setSearchResultFilterWithVideoStyle(e));},mobileMode(){o.info("搜索-手机模式");let e=[];e.push(x(Ge)),e.push(x(`
			@media screen and (max-width: 550px){
				div#search-body-container {
					display: flex;
				}
				div#search-body-container #component-Navigation {
					flex: 0;
				}
				div#search-body-container #douyin-right-container {
					flex: 1 auto;
				}
				div#search-body-container #douyin-right-container #search-content-area > div {
					width: 100% !important;
				}
				div#search-body-container #douyin-right-container #search-content-area > div > div > div {
					width: 100% !important;
					margin-left: 0px;
					margin-right: 0px;
					padding-left: 0px;
					padding-right: 0px;
				}
				/* 上面的搜索结果筛选 */
				#search-content-area > div >div> div:first-child > div:first-child > div:last-child{
					overflow: auto;
					text-wrap: nowrap;
					height: auto;
				}
				/* 视频右侧的TA的作品↓ */
				#searchSideCard{
					width: unset !important;
				}
				#searchSideCard > div{
					padding: 0px !important;
				}
				#searchSideCard > div:has(>div+svg),
				#searchSideCard ul[data-e2e="scroll-list"]{
					padding: 0px 10px !important;
				}
				#searchSideCard ul[data-e2e="scroll-list"] .video-playing-item > div{
					width: auto;
				}
				/* 视频右侧的TA的作品↑ */
				/* 悬浮的筛选 */
				#douyin-right-container #douyin-header{
        			background-color: var(--color-bg-b0);
				}
				xg-right-grid{
					margin: auto !important;
				}
			}
		`)),p.waitNode("#relatedVideoCard").then(t=>{o.info("评论区展开的className："+t.className),e.push(x(`
					html[data-vertical-screen]
						#sliderVideo[data-e2e="feed-active-video"]
						#videoSideBar:has(#relatedVideoCard[class="${t.className}"]) {
							width: 100vw !important;
					}`));});},disableClickToEnterFullScreen(){o.info("搜索-禁止点击视频区域进入全屏"),g.on(document,"click",".focusPanel",e=>{var a;p.preventEvent(e);let n=((a=e.target.parentElement)==null?void 0:a.parentElement).querySelector("video");n?n.paused?(o.info(".focusPanel：播放视频"),n.play()):(o.info(".focusPanel：视频暂停"),n.pause()):(o.error(".focusPanel未找到<video>标签"),C.error(".focusPanel未找到<video>标签",{isHTML:!1}));},{capture:!0}),g.on(document,"click","xg-video-container",e=>{p.preventEvent(e);let i=e.target.querySelector("video");i?i.paused?(o.info("xg-video-container：播放视频"),i.play()):(o.info("xg-video-container：视频暂停"),i.pause()):(o.error("xg-video-container未找到<video>标签"),C.error("xg-video-container未找到<video>标签",{isHTML:!1}));},{capture:!0});},setSearchResultFilterWithVideoStyle(e="one"){if(o.info(`设置搜索结果-按视频过滤的显示样式：${e}`),e==="one")return x(`
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(100% - 21px);
				}
			}
			`);if(e==="double")return x(`	
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(50% - 21px);
				}
			}
			`)}},k={isLive(){return window.location.hostname==="live.douyin.com"},isVideo(){return window.location.hostname==="www.douyin.com"},isSearch(){return window.location.hostname==="www.douyin.com"&&window.location.pathname.startsWith("/search")}},Qe=`/* 右侧工具栏放大 */\r
.basePlayerContainer .positionBox {\r
	bottom: 80px !important;\r
	padding-right: 5px !important;\r
	scale: unset !important;\r
	transform: scale3d(1.12, 1.12, 1.12) !important;\r
}\r
/* 右侧工具栏的svg再放大 */\r
.basePlayerContainer .positionBox svg {\r
	transform: scale3d(1.12, 1.12, 1.12);\r
}\r
/* 重置关注按钮的scale */\r
.basePlayerContainer\r
	.positionBox\r
	.dy-tip-container\r
	div[data-e2e="feed-follow-icon"]\r
	svg {\r
	scale: unset !important;\r
}\r
/* 设备处于横向方向，即宽度大于高度。 */\r
@media screen and (orientation: landscape) {\r
	/* 右侧工具栏放大 */\r
	.basePlayerContainer .positionBox {\r
		/*transform: scale(0.95) !important;\r
		bottom: 42px !important;*/\r
		padding-right: 10px !important;\r
	}\r
}\r
/* 该设备是纵向的，即高度大于或等于宽度 */\r
@media screen and (orientation: portrait) {\r
	/* /video/xxx页面 */\r
	/* 点赞、评论、分享偏移 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.basePlayerContainer\r
		.positionBox {\r
		padding-right: 30px !important;\r
	}\r
	/* 底部工具栏右侧的按钮 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.xgplayer.xgplayer-pc\r
		.xg-right-grid {\r
		margin-right: 35px !important;\r
	}\r
	/* 评论区全屏 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]),\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]) {\r
		width: 100vw !important;\r
	}\r
}\r
\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#slidelist {\r
		width: 100vw;\r
		height: 100vh;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: 150px;\r
		padding-right: 0;\r
		max-width: unset;\r
	}\r
	/* 搜索框获取焦点时自动放大宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]:focus) {\r
		width: 100vw;\r
		width: 100dvw;\r
	}\r
	/* 去除设置min-width超出浏览器宽度的问题 */\r
	body {\r
		min-width: 100% !important;\r
	}\r
	/* 去除设置width导致顶部工具栏超出浏览器宽度的问题 */\r
	#douyin-right-container #douyin-header {\r
		width: 100%;\r
	}\r
	/* 去除设置 */\r
	#douyin-right-container #douyin-header > div[data-click="doubleClick"] {\r
		min-width: 100%;\r
	}\r
}\r
`,Ze={init(){c.execMenuOnce("dy-video-shieldUserCommentToolBar",()=>this.shieldUserCommentToolBar()),c.execMenuOnce("dy-video-shieldUserCommentEveryOneAllSearch",()=>this.shieldUserCommentEveryOneAllSearch());},shieldUserCommentToolBar(){return o.info("【屏蔽】评论工具栏"),[v.addBlockCSS(".comment-input-container")]},shieldUserCommentEveryOneAllSearch(){return o.info("【屏蔽】大家都在搜"),[v.addBlockCSS(".comment-header-with-search")]}},Je={init(){c.execMenuOnce("shieldBottomVideoToolBar",()=>this.shieldBottomVideoToolBar()),c.execMenuOnce("dy-video-bottom-shieldVideoInfoWrap",()=>this.shieldVideoInfoWrap()),c.execMenuOnce("shieldBottomVideoToolbarDanmuContainer",()=>this.shieldBottomVideoToolbarDanmuContainer());},shieldBottomVideoToolBar(){return o.info("【屏蔽】底部视频工具栏"),[v.addBlockCSS("xg-controls.xgplayer-controls"),x(`
			#sliderVideo[data-e2e="feed-active-video"] div:has( > div > #video-info-wrap),
			div:has( > div > pace-island > #video-info-wrap ),
			xg-video-container.xg-video-container{
				bottom: 0 !important;
			}`)]},shieldVideoInfoWrap(){return o.info("【屏蔽】视频信息"),[v.addBlockCSS("#video-info-wrap")]},shieldBottomVideoToolbarDanmuContainer(){return o.info("【屏蔽】底部视频工具栏的弹幕容器"),[v.addBlockCSS('xg-controls xg-inner-controls .danmakuContainer[data-e2e="danmaku-container"]')]}},Xe={init(){c.execMenuOnce("shieldPlaySwitchButton",()=>this.shieldPlaySwitchButton()),c.execMenuOnce("shieldAuthorAvatar",()=>this.shieldAuthorAvatar()),c.execMenuOnce("shieldLikeButton",()=>this.shieldLikeButton()),c.execMenuOnce("shieldCommentButton",()=>this.shieldCommentButton()),c.execMenuOnce("shieldCollectionButton",()=>this.shieldCollectionButton()),c.execMenuOnce("shieldSharenButton",()=>this.shieldSharenButton()),c.execMenuOnce("shieldRelatedRecommendationsButton",()=>this.shieldRelatedRecommendationsButton()),c.execMenuOnce("shieldMoreButton",()=>this.shieldMoreButton());},shieldPlaySwitchButton(){return o.info("【屏蔽】切换播放"),[v.addBlockCSS('.positionBox  .xgplayer-playswitch[data-state="normal"]',"div.xgplayer-playswitch",".xgplayer-playswitch"),x(`
			div[data-e2e="slideList"]{
				/* 修复屏蔽后的视频宽度占据 */
				padding: 0px !important;
			}
			`)]},shieldAuthorAvatar(){return o.info("【屏蔽】作者头像"),[v.addBlockCSS('div.dy-tip-container:has([data-e2e="video-avatar"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-avatar"])')]},shieldLikeButton(){return o.info("【屏蔽】点赞"),[v.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-digg"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-player-digg"])')]},shieldCommentButton(){return o.info("【屏蔽】评论"),[v.addBlockCSS('div.dy-tip-container:has([data-e2e="feed-comment-icon"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="feed-comment-icon"])')]},shieldCollectionButton(){return o.info("【屏蔽】收藏"),[v.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-collect"])','.basePlayerContainer div[data-e2e="video-player-collect"][data-e2e-state="video-player-no-collect"]')]},shieldSharenButton(){return o.info("【屏蔽】分享"),[v.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-share"])','.basePlayerContainer div:has(>div[data-e2e="video-player-share"])')]},shieldRelatedRecommendationsButton(){return o.info("【屏蔽】看相关"),[v.addBlockCSS('div.dy-tip-container:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','div.dy-tip-container:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 0 0-8 8v4a8 8 0 0 0 8 8h8a8 8 0 0 0 8-8v-4a8 8 0 0 0-8-8h-8zm8.5 10.866a1 1 0 0 0 0-1.732l-6-3.464a1 1 0 0 0-1.5.866v6.928a1 1 0 0 0 1.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])')]},shieldMoreButton(){return o.info("【屏蔽】更多"),v.addBlockCSS('div.dy-tip-container:has([data-e2e="video-play-more"])','.basePlayerContainer div[data-e2e="video-play-more"]')}},ge={init(){c.execMenuOnce("shieldRightExpandCommentButton",()=>this.shieldRightExpandCommentButton()),c.execMenuOnce("shieldSearchFloatingBar",()=>this.shieldSearchFloatingBar()),c.execMenuOnce("shieldCloseFullScreenButton",()=>this.shieldCloseFullScreenButton()),Je.init(),Xe.init(),Ze.init();},shieldRightExpandCommentButton(){return o.info("【屏蔽】右侧的展开评论按钮"),[v.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] > div > div > button[type="button"]','.playerContainer button[type=button] svg > g[filter] > path[d="M21.316 29.73a1.393 1.393 0 01-1.97 0l-5.056-5.055a1.393 1.393 0 010-1.97l.012-.011 5.044-5.045a1.393 1.393 0 011.97 1.97l-4.07 4.071 4.07 4.071a1.393 1.393 0 010 1.97z"]'),x(`
			.basePlayerContainer .positionBox{
				padding-right: 20px !important;
			}`)]},shieldSearchFloatingBar(){o.info("【屏蔽】搜索悬浮栏");let e=[];return e.push(v.addBlockCSS("#slideMode + div",'.playerContainer .slider-video>div>div:has([data-e2e="searchbar-button"])')),k.isSearch()&&e.push(v.addBlockCSS('#douyin-right-container> div>div>div> div:has( div> input[data-e2e="searchbar-input"])')),e},shieldCloseFullScreenButton(){o.info("【屏蔽】网页全屏关闭按钮");let e=[];return e.push(v.addBlockCSS('.playerContainer .slider-video>div>div:has(path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),k.isSearch()&&e.push(v.addBlockCSS('#douyin-right-container div>div:has(>svg>path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),e}},re={getCurrentActiveVideoInfo(){var n,a;let e=document.querySelector('#sliderVideo[data-e2e="feed-active-video"] .basePlayerContainer');if(!e){o.error("未获取到当前播放的视频信息");return}let{reactFiber:t}=p.getReactObj(e);return t==null||(a=(n=t==null?void 0:t.return)==null?void 0:n.memoizedProps)==null?void 0:a.awemeInfo},getAllVideoAwemeInfo(){var n;let e=document.querySelector('#slidelist div[data-e2e="slideList"]');if(e==null)return o.error("未获取到视频列表元素"),[];let t=(n=p.getReactObj(e))==null?void 0:n.reactFiber;return t==null?(o.error(["元素上不存在reactFiber属性",e]),[]):t==null?void 0:t.return.memoizedProps.data}},ae={__videoFilter:null,get videoFilter(){if(this.__videoFilter==null){const e="douyin-shield-rule",t=c.getValue("shieldVideo-live"),i=c.getValue("shieldVideo-ads");this.__videoFilter=new le({key:e,isBlockLiveVideo:t,isBlockAdsVideo:i});}return this.__videoFilter},init(){let e=0;ee.watchVideDataListChange(p.debounce((t,i)=>{let n=re.getAllVideoAwemeInfo();if(!n.length){e++,e>=50&&(i.disconnect(),o.error("未获取到视频列表元素次数超过50次, 停止监听")),o.error("未获取到视频列表元素");return}for(let a=0;a<n.length;a++){let r=n[a];if(this.videoFilter.checkAwemeInfoIsFilter(r)){if(n.length===1){o.warn("检测到视频列表只剩最后一个，删除的话无法触发更新，暂不删除");break}n.splice(a,1),a--;}}},50));},get(){return this.videoFilter.get()},set(e){return this.videoFilter.set(e)}},O={init(){ge.init(),M.init(),k.isSearch()||c.execMenuOnce("shieldVideo",()=>{ae.init();}),c.execMenuOnce("changeCommentToBottom",()=>{O.changeCommentToBottom();}),c.execMenuOnce("fullScreen",()=>this.fullScreen()),c.execMenuOnce("parseVideo",()=>{O.parseVideo();}),c.execInheritMenuOnce("autoEnterElementFullScreen","search-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();},(e,t)=>{if(k.isSearch()&&e){if(t==1)return !0;if(t==0)return !1}}),c.execMenuOnce("dy-video-doubleClickEnterElementFullScreen",()=>{this.doubleClickEnterElementFullScreen();}),c.execMenu("dy-video-bgColor-enable",()=>{c.execMenuOnce("dy-video-changeBackgroundColor",e=>this.changeBackgroundColor(e));}),c.execMenuOnce("repairProgressBar",()=>{c.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();});}),g.ready(()=>{O.chooseVideoDefinition(c.getValue("chooseVideoDefinition")),c.execMenuOnce("mobileMode",()=>{this.mobileMode(),k.isSearch()&&Se.mobileMode();});});},fullScreen(){o.info("全屏");let e=[];return e.push(v.addBlockCSS(".slider-video .positionBox","#video-info-wrap","xg-controls.xgplayer-controls")),e.push(ge.shieldSearchFloatingBar()),e.push(x(`
			/* 视频全屏 */
			xg-video-container.xg-video-container{
				bottom: 0px !important;
			}
        `)),e},autoEnterElementFullScreen(e=!1){if(e){let t=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Y",code:"KeyY",keyCode:89,which:89});document.dispatchEvent(t);}else p.waitNode('xg-icon[data-e2e="xgplayer-page-full-screen"] .xgplayer-icon:has([d="M9.75 8.5a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12.5a2 2 0 0 0 2-2v-11a2 2 0 0 0-2-2H9.75zM15 11.25h-3.75a1 1 0 0 0-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 0 1-1 1z"])').then(t=>{o.success("自动进入网页全屏"),t.click();});},doubleClickEnterElementFullScreen(){let e=!1;o.info("注册双击进入网页全屏事件"),[".newVideoPlayer","#sliderVideo"].forEach(i=>{g.on(document,"click",i,n=>{e?(e=!1,O.autoEnterElementFullScreen(!0)):(e=!0,setTimeout(()=>{e=!1;},250));});});},changeCommentToBottom(){o.info("评论区修改为底部");let e="data-vertical-screen";function t(){v.isVerticalScreen()?(o.success("自动判断: 竖屏"),document.documentElement.setAttribute(e,"true")):(o.success("自动判断: 横屏"),document.documentElement.removeAttribute(e));}t(),x(`
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideBar #relatedVideoCard,
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideCard #relatedVideoCard{
			display: none !important;
		}
		/* 左侧的视频宽度撑满 */
		html[${e}] #sliderVideo[data-e2e] .playerContainer,
		html[${e}] #slideMode[data-e2e] .playerContainer{
			width: 100% !important;
		}
		/* 右侧的评论区宽度撑满，position使用absolute */
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard){
			width: 100%;
			height: 75%;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.9);
			transition: height .15s linear !important;
			position: absolute;
		}
		`),c.execMenuOnce("douyin-video-autoCheckChangeCommentToBottom",()=>{g.on(window,"resize",t);});},chooseVideoDefinition(e=0){o.info("选择视频清晰度: "+e);let t="MANUAL_SWITCH",n=[{clarityReal:["normal_1080_0","normal_720_0","low_720_0","normal_540_0","low_540_0","adapt_low_540_0","lower_540_0"],done:1,gearClarity:"5",gearName:"高清",gearType:1,qualityType:1},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"4",gearName:"清晰",gearType:2,qualityType:15},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"3",gearName:"流畅",gearType:3,qualityType:28},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"2",gearName:"极速",gearType:4,qualityType:21},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"0",gearName:"智能",gearType:0}].find(r=>r.gearType===e);function a(r){S.sessionStorage.setItem(t,r);}if(n){let r=0,d=JSON.stringify(n),s=setInterval(()=>{a(d),r++,r>=20&&clearInterval(s);},500);o.success("设置当前视频的清晰度: "+e);}else o.error("该清晰度不存在: "+e);},chooseVideoRate(e="1"){let t="player_playbackratio";function i(n="1"){S.sessionStorage.setItem(t,n),document.querySelectorAll("xg-icon.xgplayer-playback-setting").forEach(a=>{var d,s,l,h;let r=p.getReactObj(a).reactContainer;(h=(l=(s=(d=r==null?void 0:r.memoizedState)==null?void 0:d.element)==null?void 0:s.props)==null?void 0:l.xgCase)==null||h.updatePlayBackRatio();});}i(e);},parseVideo(){o.info("让下载按钮变成解析视频");function e(t){let i="";t.forEach(n=>{i+=`
          		<div class="douyin-video-link-item"><a href="${n}" target="_blank">${n}</a></div>
            	`;}),i=`<div class="douyin-video-link-container">${i}</div>`,j.alert({title:{text:"视频解析",position:"center"},content:{text:i,html:!0},mask:{enable:!0,clickEvent:{toClose:!0}},width:window.innerWidth>550?"550px":"88vw",height:window.innerHeight>550?"550px":"80vh",drag:!0,dragLimit:!0,style:`
                .douyin-video-link-container{

                }
                .douyin-video-link-item{
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    margin: 10px;
                }
                .douyin-video-link-item a{

                }
                `});}g.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button + div',function(t){var a,r;let i=t.target,n=(a=p.getReactObj(i.parentElement))==null?void 0:a.reactFiber;if(!n){o.error("获取rectFiber属性失败"),C.error("获取rectFiber属性失败");return}try{let d=n.return.memoizedProps.awemeInfo;if(!d){o.error("获取awemeInfo属性失败"),C.error("获取awemeInfo属性失败");return}o.info(["解析的awemeInfo: ",d]);let s=[],l=d.video.playAddr;l!=null&&Array.isArray(l)&&(s=s.concat(l.map(_=>_.src)));let h=d.video.playAddrH265;h!=null&&Array.isArray(h)&&(s=s.concat(h.map(_=>_.src)));let f=d.video.playApi;typeof f=="string"&&s.push(f);let y=d.video.playApiH265;typeof y=="string"&&s.push(y);let m=(r=d==null?void 0:d.download)==null?void 0:r.urlList;if(m!=null&&Array.isArray(m)&&(s=s.concat(m)),!s.length){o.error("未获取到视频的有效链接信息"),C.error("未获取到视频的有效链接信息");return}let b=[...new Set(s)];b.length!=s.length&&(o.info("去重前视频链接数量: "+s.length),o.info("去重后视频链接数量: "+b.length)),b=b.map(_=>(_.startsWith("http:")&&(_=_.replace("http:","")),_)),e(b);}catch(d){o.error(["解析视频失败",d]),C.error("解析视频失败");}},{capture:!0});},mobileMode(){o.info("启用手机模式");let e=[];Le.initialScale(),e.push(v.addBlockCSS("img#douyin-temp-sidebar"),x(Qe)),c.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();});},repairVideoProgressBar(){o.info("修复进度条按钮"),x(`
		/* 禁止触发touch事件，因为会影响到按钮点击不到 */
		xg-outer,
		xg-inners {
			pointer-events: none;
		}
		`),g.on(document,"touchstart","xg-progress",e=>{let i=e.target.querySelector("xg-outer");i&&(i.style.height="6px");},{capture:!0}),g.on(document,"touchend","xg-progress",e=>{let i=e.target.querySelector("xg-outer");i&&(i.style.height="");},{capture:!0});},changeBackgroundColor(e){return o.info("修改视频背景颜色"),x(`
		#sliderVideo > div,
		/* 推荐的直播间背景 */
		xgmask,
		/* 用户主页的视频 */
		.basePlayerContainer .imgBackground{
			background: ${e}  !important;
		}
		`)}},M={shortCut:new qe("video-short-cut"),$data:{rateMap:["0.75","1","1.25","1.5","1.75","2","3"]},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-video-rate-low":{target:"window",callback(){o.info("快捷键 ==> 调用倍速：小");let e=S.sessionStorage.getItem("player_playbackratio")??"1",t=M.$data.rateMap.findIndex(n=>n===e);if(t===0){o.warn("快捷键 ==> 已是最小倍速: "+e);return}let i=M.$data.rateMap[t-1];o.info("快捷键 ==> 设置倍速: "+i),O.chooseVideoRate(i);}},"dy-video-rate-up":{target:"window",callback(){o.info("快捷键 ==> 调用倍速：大");let e=S.sessionStorage.getItem("player_playbackratio")??"1",t=M.$data.rateMap.findIndex(n=>n===e);if(t===M.$data.rateMap.length-1){o.warn("快捷键 ==> 已是最大倍速: "+e);return}let i=M.$data.rateMap[t+1];o.info("快捷键 ==> 设置倍速: "+i),O.chooseVideoRate(i);}},"dy-video-shortcut-immersionMode":{target:"window",callback(){o.info("快捷键 ==> 沉浸模式");let e=c.getValue("fullScreen");c.setValue("fullScreen",!e),c.execMenuOnce("fullScreen",()=>O.fullScreen());}}}}},we=function(e,t,i,n,a,r,d,s,l){return {text:e,type:"button",description:t,buttonIcon:n,buttonIsRightIcon:a,buttonIconIsLoading:r,buttonType:d,buttonText:i,callback(f){typeof s=="function"&&s(f);},afterAddToUListCallBack:l}},te=function(e,t,i,n,a,r="default",d){let s=a,l=()=>d.getShowText(i,s),h=we(e,t,l,"keyboard",!1,!1,r,async f=>{var b;let m=(b=f.target.closest(".pops-panel-button"))==null?void 0:b.querySelector("span");if(d.isWaitPress){C.warning("请先执行当前的录入操作");return}if(d.hasOptionValue(i))d.emptyOption(i),C.success("清空快捷键");else {let _=C.loading("请按下快捷键...",{showClose:!0}),{status:w,option:L,key:A}=await d.enterShortcutKeys(i);_.close(),w?(o.success(["成功录入快捷键",L]),C.success("成功录入")):C.error(`快捷键 ${d.translateKeyboardValueToButtonText(L)} 已被 ${A} 占用`);}m.innerHTML=l();});return h.attributes={},Reflect.set(h.attributes,_e,()=>!1),h},et={id:"panel-config-video",title:"视频",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[u("沉浸模式","fullScreen",!1,void 0,"移除右侧工具栏、底部信息栏等"),u("手机模式","mobileMode",!1,void 0,"放大文字和图标，及自动启用【initial-scale=1】和【修复进度条】功能"),u("修复进度条","repairProgressBar",!1,void 0,"修复移动端不能点击拖拽和定位进度的问题(移动端使用)"),u("禁用双击点赞","dy-video-disableDoubleClickLike",!1,void 0,"禁止视频区域双击点赞")]},{text:"视频区域背景色",type:"forms",forms:[u("启用","dy-video-bgColor-enable",!1,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"dy-video-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(e){let t=g.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),i=g.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");n.value=c.getValue("dy-video-changeBackgroundColor");let a=g.createElement("style");return g.append(document.head,a),g.on(n,["input","propertychange"],r=>{o.info("选择颜色："+n.value),a.innerHTML=`
												#sliderVideo > div{
													background: ${n.value};
												}
												`,c.setValue("dy-video-changeBackgroundColor",n.value);}),e.appendChild(t),e.appendChild(i),e}}]}]},{text:"播放器",type:"deepMenu",forms:[{text:"",type:"forms",forms:[E("清晰度","chooseVideoDefinition",1,[{text:"智能",value:0},{text:"极速",value:4},{text:"流畅",value:3},{text:"清晰",value:2},{text:"高清",value:1}],void 0,"自行选择清晰度"),u("视频解析","parseVideo",!0,void 0,"分享->下载(灰色的也可点击)"),u("评论区移到中间","changeCommentToBottom",!0,void 0,"修改评论区为中间弹出而非右侧区域"),u("↑自适应评论区位置","douyin-video-autoCheckChangeCommentToBottom",!0,void 0,"根据window.screen.orientation.type自动判断是否开启【评论区移到中间】"),u("自动进入网页全屏","autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),u("双击进入网页全屏","dy-video-doubleClickEnterElementFullScreen",!1,void 0,"双击视频自动进入网页全屏，检测间隔250ms")]}]},{text:"自定义快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[te("倍速 -> 小","视频倍速变小","dy-video-rate-low",void 0,"点击录入快捷键",void 0,M.shortCut),te("倍速 -> 大","视频倍速变大","dy-video-rate-up",void 0,"点击录入快捷键",void 0,M.shortCut),te("沉浸模式","移除右侧工具栏、底部信息栏等","dy-video-shortcut-immersionMode",void 0,"点击录入快捷键",void 0,M.shortCut)]}]},{type:"deepMenu",text:"快捷键禁用",forms:[{type:"forms",text:"",forms:[u("上翻页","dy-keyboard-hook-arrowUp-w",!1,void 0,"W"),u("下翻页","dy-keyboard-hook-arrowDown-s",!1,void 0,"S"),u("快退","dy-keyboard-hook-videoRewind",!1,void 0,"A"),u("快进","dy-keyboard-hook-videoFastForward",!1,void 0,"D")]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-视频区域内",type:"deepMenu",forms:[{text:"右侧",type:"forms",forms:[u("【屏蔽】切换播放","shieldPlaySwitchButton",!1,void 0,"屏蔽元素，在右侧作者头像上方"),u("【屏蔽】作者头像","shieldAuthorAvatar",!1,void 0,"屏蔽元素"),u("【屏蔽】点赞","shieldLikeButton",!1,void 0,"屏蔽元素"),u("【屏蔽】评论","shieldCommentButton",!1,void 0,"屏蔽元素"),u("【屏蔽】收藏","shieldCollectionButton",!1,void 0,"屏蔽元素"),u("【屏蔽】分享","shieldSharenButton",!1,void 0,"屏蔽元素"),u("【屏蔽】看相关","shieldRelatedRecommendationsButton",!1,void 0,"屏蔽元素"),u("【屏蔽】更多","shieldMoreButton",!1,void 0,"...按钮，屏蔽元素")]},{text:"底部",type:"forms",forms:[u("【屏蔽】底部视频工具栏","shieldBottomVideoToolBar",!1,void 0,"屏蔽元素"),u("【屏蔽】弹幕容器","shieldBottomVideoToolbarDanmuContainer",!1,void 0,"屏蔽元素（不包括屏蔽弹幕）"),u("【屏蔽】视频信息","dy-video-bottom-shieldVideoInfoWrap",!1,void 0,"屏蔽元素，可代替【清屏】功能")]},{text:"其它",type:"forms",forms:[u("【屏蔽】右侧的展开评论按钮","shieldRightExpandCommentButton",!0,void 0,"屏蔽元素"),u("【屏蔽】搜索悬浮栏","shieldSearchFloatingBar",!0,void 0,"屏蔽元素，一般出现在左上角"),u("【屏蔽】网页全屏关闭按钮","shieldCloseFullScreenButton",!0,void 0,"屏蔽元素，一般开启网页全屏后出现在左上角")]}]},{text:"屏蔽-评论区域内",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】评论工具栏","dy-video-shieldUserCommentToolBar",!1,void 0,"屏蔽元素"),u("【屏蔽】大家都在搜","dy-video-shieldUserCommentEveryOneAllSearch",!1,void 0,"在评论区的顶部出现")]}]}]}]},tt={id:"panel-config-search",title:"搜索",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("禁止点击视频区域进入全屏","dy-search-disableClickToEnterFullScreen",!1,void 0,"禁止点击视频区域时会触发自动进入全屏功能"),E("自动进入网页全屏","search-autoEnterElementFullScreen",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),E("搜索结果-视频-显示样式","live-setSearchResultFilterWithVideoStyle","",[{text:"默认",value:""},{text:"单列",value:"one"},{text:"双列",value:"double"}],void 0,"自定义搜索结果，按视频筛选的结果项的显示样式")]}]},{text:"过滤-搜索结果",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[u("启用","search-shieldVideo",!0,void 0,"开启后可启用下面的屏蔽功能"),u("【屏蔽】直播","search-shieldVideo-live",!0,void 0,"过滤掉直播"),u("【屏蔽】广告","search-shieldVideo-ads",!0,void 0,"过滤掉广告"),{type:"own",getLiElementCallBack(e){let t=g.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=t.querySelector("textarea");return i.value=ne.get(),g.on(i,["input","propertychange"],p.debounce(function(){ne.set(i.value);},200)),e.appendChild(t),e}}]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】相关搜索","douyin-search-shieldReleatedSearches",!1,void 0,"屏蔽右边的相关搜索")]}]},{text:"屏蔽-主框架",type:"deepMenu",forms:[{text:"",type:"forms",forms:[E("【屏蔽】左侧导航栏","search-shieldLeftNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,"屏蔽元素"),E("【屏蔽】顶部导航栏","search-shieldTopNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,"屏蔽元素")]}]}]}]},it={id:"m-panel-config-share-user",title:"主页",headerTitle:"/share/user<br />主页",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("视频合集","m-dy-share-user-coverPlayletList",!0,void 0,"正确跳转视频合集页面"),u("视频列表","m-dy-share-user-coverPostListContainer",!0,void 0,"正确跳转视频页面")]}]}]}]},ot={id:"m-panel-config-share-video",title:"视频",headerTitle:"/share/video<br />视频",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("全局点击","m-dy-share-video-coverGlobalClick",!0,void 0,"阻止跳转至下载页")]}]}]}]},nt={id:"m-panel-config-share-note",title:"笔记",headerTitle:"/share/note<br />笔记",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("精彩图文","m-dy-share-note-coverExcitingGraphicsAndText",!0,void 0,"正确跳转笔记页面"),u("用户","m-dy-share-note-coverUser",!0,void 0,"正确跳转用户主页"),u("话题","m-dy-share-note-coverHashTag",!0,void 0,"正确跳转相关话题"),u("音乐","m-dy-share-note-coverMusic",!0,void 0,"正确跳转相关音乐"),u("相关推荐","m-dy-share-note-coverRecommend",!0,void 0,"正确跳转笔记页面")]}]},{text:"屏蔽元素",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("【屏蔽】评论","m-dy-share-note-blockComment",!1,void 0,"屏蔽元素"),u("【屏蔽】相关推荐","m-dy-share-note-blockRecommend",!1,void 0,"屏蔽元素"),u("【屏蔽】底部工具栏","m-dy-share-note-blockFooterToobar",!1,void 0,"屏蔽元素")]}]}]}]},rt={id:"m-panel-config-share-challenge",title:"话题",headerTitle:"/share/challenge<br />话题",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("顶部区域","m-dy-share-challenge-coverTopJump",!0,void 0,"阻止跳转至下载页面"),u("视频卡片","m-dy-share-challenge-coverVideoCard",!0,void 0,"正确跳转视频页面")]}]}]}]},at={id:"m-panel-config-share-music",title:"音乐",headerTitle:"/share/music<br />音乐",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[u("视频卡片","m-dy-share-music-coverVideoCard",!0,void 0,"正确跳转视频页面")]}]}]}]},lt={init(){this.show();},show(){const e="temp-debug-recommend-video-filter-rule";let t=new le({key:e});t.clear();let i=window.prompt(`请输入需要执行的操作：
1. 获取当前视频的信息字典
2. 获取所有视频的信息字典
3. 调试自定义规则`,"1"),n;if(i==="1"||i==="3"){if(n=re.getCurrentActiveVideoInfo(),n==null){C.error("获取当前播放的视频信息失败，详情请看控制台");return}o.info(["当前视频awemeInfo信息：",n]);}if(i==="1"||i==="2"){let a="";if(i==="1")a=JSON.stringify(t.getAwemeInfoDictData(n),null,4);else if(i==="2"){let s=re.getAllVideoAwemeInfo(),l=[];s.forEach(h=>{l.push(t.getAwemeInfoDictData(h));}),o.info(["全部的awemeInfo信息↓",s]),o.info(["解析出全部的awemeInfo的字典信息↓",l]),a=JSON.stringify(l,null,4);}let r=j.confirm({title:{text:"视频信息",position:"center"},content:{text:`
                    <div class="video-info">
                        <p class="copy-video-info-tip">是否复制以下信息到剪贴板？</p>
                        <textarea class="video-info-json" disabled="true"></textarea>
                    </div>
                    `,html:!0},btn:{ok:{text:"复制",callback:function(){p.setClip(a);}}},mask:{enable:!0,clickEvent:{toClose:!0}},width:window.innerWidth>500?"50vw":"400px",height:window.innerHeight>500?"60vh":"400px",drag:!0,dragLimit:!0,style:`
                .video-info-json{
                    width: 100%;
                    height: ${window.innerHeight>500?"55vh":"300px"};
                }
                `});r.$shadowRoot.querySelector(".copy-video-info-tip");let d=r.$shadowRoot.querySelector(".video-info-json");d.value=a,d.readOnly=!0;}else if(i==="3"){let a=window.prompt("请输入要调试的规则(单条规则)");if(p.isNotNull(a))if(t.updateRule(a),o.info(["过滤器-视频信息tag字典：",t.getAwemeInfoDictData(n)]),t.checkAwemeInfoIsFilter(n)){let s=C.success(`
						<div class="dy-tip-text">当前视频符合该屏蔽规则，是否复制该规则？</div>
						<a class="dy-tip-copy" href="javascript:;">复制</a>
						`,{timeout:5e3,isHTML:!0,customClass:"dy-video-filter-debug-rule-tip",style:`
							.dy-video-filter-debug-rule-tip{
								display: flex;
							}
							`}).$Qmsg.querySelector(".dy-video-filter-debug-rule-tip .dy-tip-copy");g.on(s,"click",l=>{p.preventEvent(l),p.setClip(a);});}else C.error("当前视频不符合该屏蔽规则");}else o.error("输入有误："+i);t.destory();}},st={id:"panel-config-recommend-video",title:"推荐",forms:[{type:"forms",text:"",forms:[{text:"过滤-推荐视频",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[we("调试规则","测试自定义规则对当前正在播放的视频是否生效","调试",void 0,!1,!1,"primary",()=>{lt.init();}),u("启用","shieldVideo",!0,void 0,"开启后可启用下面的屏蔽功能"),u("【屏蔽】直播","shieldVideo-live",!0,void 0,"过滤掉直播"),u("【屏蔽】广告","shieldVideo-ads",!0,void 0,"过滤掉广告"),{type:"own",getLiElementCallBack(e){let t=g.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=t.querySelector("textarea");return i.value=ae.get(),g.on(i,["input","propertychange"],p.debounce(function(){ae.set(i.value);},200)),e.appendChild(t),e}}]}]}]}]},c={$data:{__data:null,__oneSuccessExecMenu:null,__onceExec:null,__listenData:null,get data(){return c.$data.__data==null&&(c.$data.__data=new p.Dictionary),c.$data.__data},get oneSuccessExecMenu(){return c.$data.__oneSuccessExecMenu==null&&(c.$data.__oneSuccessExecMenu=new p.Dictionary),c.$data.__oneSuccessExecMenu},get onceExec(){return c.$data.__onceExec==null&&(c.$data.__onceExec=new p.Dictionary),c.$data.__onceExec},get scriptName(){return ie},key:R,attributeKeyName:Z,attributeDefaultValueName:J},$listener:{get listenData(){return c.$data.__listenData==null&&(c.$data.__listenData=new p.Dictionary),c.$data.__listenData}},init(){this.initPanelDefaultValue(),this.initExtensionsMenu();},isTopWindow(){return S.top===S.self},initExtensionsMenu(){this.isTopWindow()&&Me.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:!1,isStoreValue:!1,showText(e){return e},callback:()=>{this.showPanel();}},{key:"show_pops_m_panel_setting",text:"⚙ 移动端设置",autoReload:!1,isStoreValue:!1,showText(e){return e},callback:()=>{this.showMPanel();}}]);},initPanelDefaultValue(){let e=this;function t(a){if(!a.attributes)return;let r={},d=a.attributes[Z];d!=null&&(r[d]=a.attributes[J]);let s=a.attributes[_e];if(typeof s=="function"){let f=s();if(typeof f=="boolean"&&!f)return}let l=a.attributes[$e];l&&typeof l=="object"&&Object.assign(r,l);let h=Object.keys(r);if(!h.length){o.warn(["请先配置键",a]);return}h.forEach(f=>{let y=r[f];e.$data.data.has(f)&&o.warn("请检查该key(已存在): "+f),e.$data.data.set(f,y);});}function i(a){for(let r=0;r<a.length;r++){let d=a[r];t(d);let s=d.forms;s&&Array.isArray(s)&&i(s);}}let n=this.getPanelContentConfig().concat(this.getMPanelContentConfig());for(let a=0;a<n.length;a++){let r=n[a];if(!r.forms)continue;let d=r.forms;d&&Array.isArray(d)&&i(d);}},setValue(e,t){let i=B(R,{}),n=i[e];i[e]=t,T(R,i),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,n,t);},getValue(e,t){let n=B(R,{})[e];return n??(this.$data.data.has(e)?this.$data.data.get(e):t)},deleteValue(e){let t=B(R,{}),i=t[e];Reflect.deleteProperty(t,e),T(R,t),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,i,void 0);},addValueChangeListener(e,t){let i=Math.random();return this.$listener.listenData.set(e,{id:i,key:e,callback:t}),i},removeValueChangeListener(e){let t=null;for(const[i,n]of this.$listener.listenData.entries())if(n.id===e){t=i;break}typeof t=="string"?this.$listener.listenData.delete(t):console.warn("没有找到对应的监听器");},triggerMenuValueChange(e,t,i){if(this.$listener.listenData.has(e)){let n=this.$listener.listenData.get(e);if(typeof n.callback=="function"){let a=this.getValue(e),r=a,d=a;typeof t<"u"&&arguments.length>1&&(r=t),typeof i<"u"&&arguments.length>2&&(d=i),n.callback(e,d,r);}}},hasKey(e){let t=B(R,{});return e in t},execMenu(e,t,i=!1){if(!(typeof e=="string"||typeof e=="object"&&Array.isArray(e)))throw new TypeError("key 必须是字符串或者字符串数组");let n=[];typeof e=="object"&&Array.isArray(e)?n=[...e]:n.push(e);let a;for(let r=0;r<n.length;r++){const d=n[r];if(!this.$data.data.has(d)){o.warn(`${e} 键不存在`);return}let s=c.getValue(d);if(i&&(s=!s),!s)break;a=s;}a&&t(a);},execMenuOnce(e,t,i,n){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){o.warn(`${e} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(e))return;this.$data.oneSuccessExecMenu.set(e,1);let a=()=>{let h=c.getValue(e);return typeof i=="function"?i(e,h):h},r=[],d=h=>{let f=a(),y=[];if(h instanceof HTMLStyleElement?y=[h]:Array.isArray(h)&&(y=[...h.filter(m=>m!=null&&m instanceof HTMLStyleElement)]),f)r=r.concat(y);else for(let m=0;m<y.length;m++)y[m].remove(),y.splice(m,1),m--;},s=h=>{let f=[];if(h){let y=t(h,d);y instanceof HTMLStyleElement?f=[y]:Array.isArray(y)&&(f=[...y.filter(m=>m!=null&&m instanceof HTMLStyleElement)]);}for(let y=0;y<r.length;y++)r[y].remove(),r.splice(y,1),y--;r=[...f];};this.addValueChangeListener(e,(h,f,y)=>{let m=y;typeof n=="function"&&(m=n(h,y,f)),s(m);});let l=a();l&&s(l);},execInheritMenuOnce(e,t,i,n){let a=this;const r=(d,s)=>{let l=a.getValue(d),h=a.getValue(s);if(typeof n=="function"){let f=n(l,h);if(f!==void 0)return f}return l};this.execMenuOnce(e,i,()=>r(e,t),()=>r(e,t)),this.execMenuOnce(t,()=>{},()=>!1,()=>(this.triggerMenuValueChange(e),!1));},onceExec(e,t){if(typeof e!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(e)||(t(),this.$data.onceExec.set(e,1));},showPanel(){j.panel({title:{text:`${ie}-设置`,position:"center",html:!1,style:""},content:this.getPanelContentConfig(),mask:{enable:!0,clickEvent:{toClose:!0,toHide:!1}},isMobile:!0,width:this.getWidth(),height:this.getHeight(),drag:!0,only:!0});},showMPanel(){j.panel({title:{text:`${ie}-设置`,position:"center",html:!1,style:""},content:this.getMPanelContentConfig(),mask:{enable:!0,clickEvent:{toClose:!0,toHide:!1}},isMobile:this.isMobile(),width:this.getWidth(),height:this.getHeight(),drag:!0,only:!0});},isMobile(){return window.innerWidth<550},getWidth(){return window.innerWidth<550?"92vw":"550px"},getHeight(){return window.innerHeight<450?"80vh":"450px"},getPanelContentConfig(){return [Ie,et,st,tt,ze]},getMPanelContentConfig(){return [it,nt,rt,ot,at]}},dt="抖音优化",p=Ee.noConflict();let g=xe.noConflict();const j=Oe,ct=S.console||Pe.console,o=new p.Log(Q,ct);var ke;let ie=((ke=Q==null?void 0:Q.script)==null?void 0:ke.name)||dt;o.config({debug:!1,logMaxCount:100,autoClearConsole:!0,tag:!0});C.config(Object.defineProperties({html:!0,autoClose:!0,showClose:!1,zIndex:1e7},{position:{get(){return c.getValue("qmsg-config-position","bottom")}},maxNums:{get(){return c.getValue("qmsg-config-maxnums",5)}},showReverse:{get(){return c.getValue("qmsg-config-showreverse",!0)}}}));const Me=new p.GM_Menu({GM_getValue:B,GM_setValue:T,GM_registerMenuCommand:Ae,GM_unregisterMenuCommand:Re}),ut=new p.Httpx(De);ut.interceptors.response.use(void 0,e=>(o.error(["拦截器-请求错误",e]),e.type==="onabort"?C.warning("请求取消"):e.type==="onerror"?C.error("请求异常"):e.type==="ontimeout"?C.error("请求超时"):C.error("其它错误"),e));const x=p.addStyle.bind(p),ht={init(){c.execInheritMenuOnce("shieldTopNavigator","search-shieldTopNavigator",()=>this.shieldTopNavigator(),(e,t)=>{if(k.isSearch()){if(t==1)return !0;if(t==0)return !1}}),c.execMenuOnce("shieldClientTip",()=>this.shieldClientTip()),c.execMenuOnce("shieldFillingBricksAndStones",()=>this.shieldFillingBricksAndStones()),c.execMenuOnce("shieldClient",()=>this.shieldClient()),c.execMenuOnce("shieldQuickAccess",()=>this.shieldQuickAccess()),c.execMenuOnce("shieldNotifitation",()=>this.shieldNotifitation()),c.execMenuOnce("shieldPrivateMessage",()=>this.shieldPrivateMessage()),c.execMenuOnce("shieldSubmission",()=>this.shieldSubmission()),c.execMenuOnce("shieldWallpaper",()=>this.shieldWallpaper()),c.execMenuOnce("shieldBottomQuestionButton",()=>this.shieldBottomQuestionButton());},shieldTopNavigator(){o.info("【屏蔽】顶部导航栏");let e=[];return e.push(v.addBlockCSS("#douyin-header")),e.push(x(`
			/* 修复视频的高度 */
			#douyin-right-container{
				padding-top: 0px !important;
			}
		`)),k.isSearch()&&e.push(x(`
				/* 把搜索顶部的工具栏置顶 */
				#search-content-area > div > div:nth-child(1) > div:nth-child(1){
					top: 0;
				}`)),e},shieldFillingBricksAndStones(){o.info("【屏蔽】充钻石");let e=[];const t='d="M5.60303 11.9999C5.60303 8.46713 8.46689 5.60327 11.9996 5.60327C14.2773 5.60327 16.2777 6.79321 17.412 8.5889C18.0354 9.57571 18.3962 10.7445 18.3962 11.9999C18.3962 15.5326 15.5324 18.3965 11.9996 18.3965C8.46689 18.3965 5.60303 15.5326 5.60303 11.9999ZM11.9996 4.10327C7.63846 4.10327 4.10303 7.6387 4.10303 11.9999C4.10303 16.3611 7.63846 19.8965 11.9996 19.8965C16.3608 19.8965 19.8962 16.3611 19.8962 11.9999C19.8962 10.4527 19.4505 9.0073 18.6802 7.78781C17.2826 5.57536 14.8133 4.10327 11.9996 4.10327ZM14.1261 7.62271V7.12561H12.6261V13.5879H12.6272C12.6272 14.442 11.9421 15.1238 11.11 15.1238C10.2778 15.1238 9.59277 14.442 9.59277 13.5879C9.59277 12.7338 10.2778 12.052 11.11 12.052V10.552C9.43784 10.552 8.09277 11.917 8.09277 13.5879C8.09277 15.2588 9.43784 16.6238 11.11 16.6238C12.7821 16.6238 14.1272 15.2588 14.1272 13.5879H14.1261V10.3601C14.6219 10.6754 15.2097 10.8582 15.8413 10.8582V9.35821C14.8998 9.35821 14.1261 8.58701 14.1261 7.62271Z"';return e.push(v.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${t}])`,'body .semi-portal .semi-portal-inner li.semi-dropdown-item:has(a[href*="douyin_recharge"])')),k.isSearch()?e.push(v.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${t}])`)):k.isLive()&&e.push(v.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])')),e},shieldClient(){o.info("【屏蔽】客户端");let e=[];return e.push(v.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[download^="douyin-downloader"])')),k.isSearch()?e.push(v.addBlockCSS('div:has(> div[data-e2e="something-button"] path[d="M18.404 19.018h-12v-1.5h12v1.5zM11.654 13.457v-8.19h1.5v8.19l3.22-3.22 1.06 1.061-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5 1.06-1.06 3.22 3.22z"])','div[id^="douyin-header-menu"] >  div > div > div:has(a[download^="douyin-downloader"])')):k.isLive()&&e.push(v.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container:has(a)','#douyin-header pace-island[id^="island"] > div[class] span:has(a[download][href*="client"])','.semi-portal-inner .semi-dropdown-content .semi-dropdown-item:has(a[download][href*="client"])')),e},shieldQuickAccess(){o.info("【屏蔽】快捷访问");let e=[];return e.push(v.addBlockCSS('header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(.quick-access-nav-icon)','div[id^="douyin-header-menu"] pace-island > div > div:has(.quick-access-nav-icon)')),k.isSearch()&&(e.push(v.addBlockCSS("div:has(>div>div>.quick-access-nav-icon)")),p.waitNode('li.semi-dropdown-item[role="menuitem"]',1e4).then(t=>{if(!t)return;let i=p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){let n=!1;document.querySelectorAll('li.semi-dropdown-item[role="menuitem"]').forEach(a=>{var r;(r=a.textContent)!=null&&r.includes("快捷访问")&&(n=!0,o.success("搜索-更多-快捷访问 移除元素"),a.remove());}),n&&i.disconnect();}});})),e},shieldNotifitation(){o.info("【屏蔽】通知");let e=[];return e.push(v.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),k.isSearch()?e.push(v.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > ul:has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')):k.isLive()&&e.push(v.addBlockCSS('div[id^="douyin-header-menu"] pace-island[id^="island"] > * > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),e},shieldPrivateMessage(){o.info("【屏蔽】私信");let e=[];return e.push(v.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])','#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])')),k.isSearch()&&(o.info("搜索-【屏蔽】私信"),e.push(v.addBlockCSS('ul:has( div>div[data-e2e="im-entry"] )','div[id^="douyin-header-menu"] >  div > div > ul:has([data-e2e="im-entry"])'))),e},shieldSubmission(){o.info("【屏蔽】投稿");let e=[];const t='d="M11.3487 4.90125H11.3164H11.3164C10.2479 4.90124 9.40104 4.90124 8.71799 4.95587C8.01959 5.01173 7.42807 5.12824 6.88626 5.39747C5.95866 5.8584 5.20716 6.60991 4.74622 7.53751C4.477 8.07932 4.36048 8.67084 4.30462 9.36923C4.24999 10.0523 4.24999 10.8991 4.25 11.9677V12V12.0322C4.24999 13.1008 4.24999 13.9477 4.30462 14.6307C4.36048 15.3291 4.477 15.9206 4.74622 16.4624C5.20716 17.39 5.95866 18.1415 6.88626 18.6025C7.42807 18.8717 8.01959 18.9882 8.71799 19.0441C9.40104 19.0987 10.2479 19.0987 11.3164 19.0987H11.3487H12.6513H12.6836C13.7521 19.0987 14.599 19.0987 15.282 19.0441C15.9804 18.9882 16.5719 18.8717 17.1137 18.6025C18.0413 18.1415 18.7928 17.39 19.2538 16.4624C19.523 15.9206 19.6395 15.3291 19.6954 14.6307C19.75 13.9477 19.75 13.1008 19.75 12.0322V12V11.9677C19.75 10.8991 19.75 10.0523 19.6954 9.36923C19.6395 8.67084 19.523 8.07932 19.2538 7.53751C18.7928 6.60991 18.0413 5.8584 17.1137 5.39747C16.5719 5.12824 15.9804 5.01173 15.282 4.95587C14.599 4.90124 13.7521 4.90124 12.6836 4.90125H12.6513H11.3487ZM7.55376 6.74077C7.8529 6.59212 8.22981 6.4997 8.83757 6.45109C9.45382 6.4018 10.2407 6.40125 11.3487 6.40125H12.6513C13.7593 6.40125 14.5462 6.4018 15.1624 6.45109C15.7702 6.4997 16.1471 6.59212 16.4462 6.74077C17.0809 7.05614 17.5951 7.57033 17.9105 8.205C18.0591 8.50414 18.1515 8.88105 18.2002 9.48882C18.2494 10.1051 18.25 10.8919 18.25 12C18.25 13.108 18.2494 13.8949 18.2002 14.5111C18.1515 15.1189 18.0591 15.4958 17.9105 15.7949C17.5951 16.4296 17.0809 16.9438 16.4462 17.2592C16.1471 17.4078 15.7702 17.5002 15.1624 17.5488C14.5462 17.5981 13.7593 17.5987 12.6513 17.5987H11.3487C10.2407 17.5987 9.45382 17.5981 8.83757 17.5488C8.22981 17.5002 7.8529 17.4078 7.55376 17.2592C6.91909 16.9438 6.4049 16.4296 6.08952 15.7949C5.94088 15.4958 5.84846 15.1189 5.79985 14.5111C5.75056 13.8949 5.75 13.108 5.75 12C5.75 10.8919 5.75056 10.1051 5.79985 9.48882C5.84846 8.88105 5.94088 8.50414 6.08952 8.205C6.4049 7.57033 6.91909 7.05614 7.55376 6.74077ZM11.25 15V12.75H9V11.25H11.25V8.99997H12.75V11.25H15V12.75H12.75V15H11.25Z"';return e.push(v.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${t}])`)),k.isSearch()?e.push(v.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${t}])`)):k.isLive()&&e.push(v.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])')),e},shieldClientTip(){o.info("【屏蔽】客户端提示");let e=[];return e.push(v.addBlockCSS('ul li div[data-e2e="something-button"] + div div:has(>a[download*="douyin-downloader"])','#douyin-header pace-island[id^="island_"] ul > div:has(>a[class][download])','#douyin-header pace-island[id^="island_"] ul[class] li div[data-e2e="im-entry"]  div>div div div:has(a[download][href])','#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container div:has(+ #wallpaper-modal)')),k.isSearch()&&e.push(v.addBlockCSS('div[id^="douyin-header-menu"] ul li div[data-e2e="im-entry"] div > div > div:has(>a[download*="douyin-downloader"])','div[id^="douyin-header-menu"] ul > div:has(>a[download*="douyin-downloader"])')),e},shieldWallpaper(){o.info("【屏蔽】壁纸");let e=[];return e.push(v.addBlockCSS('div[id^="douyin-header-menu"] pace-island > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')),k.isSearch()?e.push(v.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')):k.isLive()&&e.push(v.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container:has(span.semi-icon)','#douyin-header pace-island[id^="island"] > div[class] span:has(.semi-icon)')),e},shieldBottomQuestionButton(){return o.info("屏蔽底部问题按钮"),v.addBlockCSS(["#douyin-sidebar","#douyin-temp-sidebar"])}},ft={init(){c.execMenuOnce("shieldSearch",()=>this.shieldSearch()),c.execMenuOnce("shieldSearchPlaceholder",()=>this.shieldSearchPlaceholder()),c.execMenuOnce("shieldSearchGuessYouWantToSearch",()=>this.shieldSearchGuessYouWantToSearch()),c.execMenuOnce("shieldSearchTiktokHotspot",()=>this.shieldSearchTiktokHotspot());},shieldSearch(){return o.info("【屏蔽】搜索框"),v.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div:has(input[data-e2e="searchbar-input"])')},shieldSearchPlaceholder(){o.info("【屏蔽】搜索框的提示");let e=[];return e.push(v.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div div:has( + input[data-e2e="searchbar-input"])')),e.push(x(`
			#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div input[data-e2e="searchbar-input"]::placeholder{
				color: transparent;
			}`)),e},shieldSearchGuessYouWantToSearch(){return o.info("【屏蔽】搜索-猜你想搜"),v.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-guess-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-guess-container"]')},shieldSearchTiktokHotspot(){return o.info("【屏蔽】搜索-抖音热点"),v.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-hot-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-hot-container"]')}},be={$data:{document_addEventListener:[],element_addEventListener:[]},document_addEventListener(e){if(this.$data.document_addEventListener.push(e),o.info("document.addEventListener hook新增劫持判断回调"),this.$data.document_addEventListener.length>1)return;const t=this;let i=new WeakMap;const n=S.document.addEventListener,a=S.document.removeEventListener;S.document.addEventListener=function(...r){let d=this,s=r[0],l=r[1],h=r[2];for(let f=0;f<t.$data.document_addEventListener.length;f++){const y=t.$data.document_addEventListener[f],m=y(d,s,l,h);typeof m=="function"&&(r[1]=m,i.set(l,{eventName:s,fn:m,options:h}));}return Reflect.apply(n,this,r)},S.document.removeEventListener=function(...r){let d=r[0],s=r[1],l=r[2];if(i.has(s)){const{eventName:h,fn:f,options:y}=i.get(s);let m=!1;h===d&&(typeof l=="boolean"&&l===y||typeof l=="object"&&typeof y=="object"&&l.capture===y.capture)&&(m=!0),m&&(r[1]=f);}return a.apply(this,r)};},element_addEventListener(e){if(this.$data.element_addEventListener.push(e),o.info("Element.prototype.addEventListener hook新增劫持判断回调"),this.$data.element_addEventListener.length>1)return;const t=this;let i=new WeakMap;const n=S.Element.prototype.addEventListener,a=S.Element.prototype.removeEventListener;S.Element.prototype.addEventListener=function(...r){let d=this,s=r[0],l=r[1],h=r[2];for(let f=0;f<t.$data.element_addEventListener.length;f++){const y=t.$data.element_addEventListener[f],m=y(d,s,l,h);typeof m=="function"&&(r[1]=m,i.set(l,{eventName:s,fn:m,options:h}));}return Reflect.apply(n,this,r)},S.Element.prototype.removeEventListener=function(...r){let d=r[0],s=r[1],l=r[2];if(i.has(s)){const{eventName:h,fn:f,options:y}=i.get(s);let m=!1;h===d&&(typeof l=="boolean"&&l===y||typeof l=="object"&&typeof y=="object"&&l.capture===y.capture)&&(m=!0),m&&(r[1]=f);}return a.apply(this,r)};}},oe={$data:{hookElementAddEventListener:[]},removeEnvCheck(){o.info("移除环境检测");let e=S.setInterval;S.setInterval=function(t,i){let n=t.toString().trim();if(n.includes("debugger")){o.success(["拦截→",[n]]);return}if(n.includes("checkEXp")){o.success(["拦截→",[n]]);return}return e.call(this,t,i)};},disableShortCut(){be.document_addEventListener((e,t,i,n)=>{if(["keydown","keypress","keyup"].includes(t))return function(...a){let r=a[0];r.key;let d=r.code;r.charCode||r.keyCode||r.which;let s=[];r.ctrlKey&&s.push("ctrl"),r.altKey&&s.push("alt"),r.metaKey&&s.push("meta"),r.shiftKey&&s.push("shift");let l=[{enableKey:"dy-keyboard-hook-likeOrDislike",code:["KeyZ"]},{enableKey:"dy-keyboard-hook-comment",code:["KeyX"]},{enableKey:"dy-keyboard-hook-danmaku-enable",code:["KeyB"]},{enableKey:"dy-keyboard-hook-collect-enable",code:["KeyC"]},{enableKey:"dy-keyboard-hook-copyShareLink",code:["KeyV"]},{enableKey:"dy-keyboard-hook-clearScreen",code:["KeyJ"]},{enableKey:"dy-keyboard-hook-automaticBroadcast",code:["KeyK"]},{enableKey:"dy-keyboard-hook-videoInfo",code:["KeyI"]},{enableKey:"dy-keyboard-hook-notInterested",code:["KeyR"]},{enableKey:"dy-keyboard-hook-enterAuthorHomePage",code:["KeyF"]},{enableKey:"dy-keyboard-hook-follow",code:["KeyG"]},{enableKey:"dy-keyboard-hook-search",code:["KeyF"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheCurrentPageWithOneClick",code:["KeyQ"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-pageUpAndDown",code:["ArrowUp","ArrowDown"]},{enableKey:"dy-keyboard-hook-fastForwardAndFastBack",code:["ArrowLeft","ArrowRight"]},{enableKey:"dy-keyboard-hook-pause",code:["Space"]},{enableKey:"dy-keyboard-hook-fullScreenInsideThePage",code:["KeyY"]},{enableKey:"dy-keyboard-hook-fullScreen",code:["KeyH"]},{enableKey:"dy-keyboard-hook-watchItOutLater",code:["KeyL"]},{enableKey:"dy-keyboard-hook-volumeAdjustment",code:["Minus"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-listOfCallShortcutKeys",code:["Slash"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheShortcutKeyList",code:["Escape"]},{enableKey:"dy-keyboard-hook-relevantRecommendation",code:["KeyN"]}];k.isVideo()?l.push({enableKey:"dy-keyboard-hook-arrowUp-w",code:["KeyW"]},{enableKey:"dy-keyboard-hook-arrowDown-s",code:["KeyS"]},{enableKey:"dy-keyboard-hook-videoRewind",code:["KeyA"]},{enableKey:"dy-keyboard-hook-videoFastForward",code:["KeyD"]}):k.isLive()&&l.push({enableKey:"dy-live-refresh",code:["KeyE"]},{enableKey:"dy-live-screenRotation",code:["KeyD"]},{enableKey:"dy-live-enableSmallWindowMode",code:["KeyU"]});for(let h=0;h<l.length;h++){const f=l[h];if(f.code.includes(d)){if(Array.isArray(f.otherCodeList)&&f.otherCodeList.find(m=>!s.includes(m))||!c.getValue(f.enableKey))continue;return}}Reflect.apply(i,this,a);}});},disableDoubleClickLike(){let e=Date.now();be.element_addEventListener((t,i,n,a)=>{var d;const r=n.toString();if(i==="click"&&t instanceof HTMLElement&&((d=t==null?void 0:t.classList)!=null&&d.contains("xgplayer"))&&r.match(/video|innerContainer|video.__canvas|mouse/))return function(...s){let l=Date.now();if(l-e<=288){e=l,o.success("阻止触发双击点赞");return}e=l,Reflect.apply(n,this,s);}});}},Ce={disguiseLogin(){o.info("伪装登录");const e=2e4;let t=parseInt((Math.random()*1e6).toString()),i=Object.defineProperty({},"uid",{value:t,writable:!1});function n(r){var h,f,y,m,b,_,w,L,A,N,F,H,K,U,W,Y,z,q,G,D,se,de,ce,ue,he,fe,pe,ve,me,ye;let d=[],s=p.getReactObj(r),l=s==null?void 0:s.reactFiber;return s==null||s.reactProps,(y=(f=(h=l==null?void 0:l.alternate)==null?void 0:h.return)==null?void 0:f.memoizedProps)!=null&&y.userInfo&&d.push((_=(b=(m=l==null?void 0:l.alternate)==null?void 0:m.return)==null?void 0:b.memoizedProps)==null?void 0:_.userInfo),(N=(A=(L=(w=l==null?void 0:l.alternate)==null?void 0:w.return)==null?void 0:L.memoizedProps)==null?void 0:A.userInfo)!=null&&N.userInfo&&d.push((K=(H=(F=l==null?void 0:l.alternate)==null?void 0:F.return)==null?void 0:H.memoizedProps)==null?void 0:K.userInfo.userInfo),(z=(Y=(W=(U=l==null?void 0:l.alternate)==null?void 0:U.return)==null?void 0:W.return)==null?void 0:Y.memoizedProps)!=null&&z.userInfo&&d.push((se=(D=(G=(q=l==null?void 0:l.alternate)==null?void 0:q.return)==null?void 0:G.return)==null?void 0:D.memoizedProps)==null?void 0:se.userInfo),(fe=(he=(ue=(ce=(de=l==null?void 0:l.alternate)==null?void 0:de.return)==null?void 0:ce.return)==null?void 0:ue.memoizedProps)==null?void 0:he.userInfo)!=null&&fe.userInfo&&d.push((ye=(me=(ve=(pe=l==null?void 0:l.alternate)==null?void 0:pe.return)==null?void 0:ve.return)==null?void 0:me.memoizedProps)==null?void 0:ye.userInfo.userInfo),d}function a(r){n(r).forEach(d=>{Object.defineProperties(d,{info:{value:i,writable:!1},isLogin:{value:!0,writable:!1}});});}if(ee.watchVideDataListChange(r=>{a(r);}),p.waitNode("#root div[class*='-os']",e).then(()=>{p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:p.debounce(()=>{let r=ee.getOSElement();r&&a(r);},70)});}).catch(r=>{}),k.isLive())o.info("伪装登录：live"),p.waitNode("#douyin-header div:has(.dy-tip-container)",e).then(()=>{p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:p.debounce(()=>{a(document.querySelector("#douyin-header"));},70)});});else if(k.isSearch()){let r=function(d){var h,f,y,m,b,_,w;let s=p.getReactObj(d);s==null||s.reactFiber;let l=s==null?void 0:s.reactProps;typeof((m=(y=(f=(h=l==null?void 0:l.children)==null?void 0:h[1])==null?void 0:f.props)==null?void 0:y.userInfo)==null?void 0:m.isLogin)=="boolean"&&Reflect.set(l.children[1].props.userInfo,"isLogin",!0),typeof((w=(_=(b=l==null?void 0:l.children)==null?void 0:b[1])==null?void 0:_.props)==null?void 0:w.isClient)=="boolean"&&Reflect.set(l.children[1].props,"isClient",!0);};o.info("伪装登录：search"),p.waitNode("#root > div",e).then(d=>{if(!d){o.error("#root > div获取失败");return}p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:p.debounce((s,l)=>{r(d);},70)});});}},watchLoginDialogToClose(){o.info("监听登录弹窗并关闭"),v.addBlockCSS('div[id^="login-full-panel-"]'),p.waitNode("body").then(()=>{p.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){var t,i;let e=document.querySelector('body > div[id^="login-full-panel-"] .dy-account-close');e&&((i=(t=p.getReactObj(e))==null?void 0:t.reactProps)==null||i.onClick(new Event("click")));}});});}},pt={init(){c.execMenu("douyin-redirect-url-home-to-root",()=>{this.redirectUrlHomeToRoot();});},redirectUrlHomeToRoot(){window.location.pathname==="/home"&&(o.info("从首页跳转到根目录"),window.location.href=window.location.origin+"/?is_from_mobile_home=1&recommend=1");}},vt={init(){c.execInheritMenuOnce("shieldLeftNavigator","search-shieldLeftNavigator",()=>this.shieldLeftNavigator(),(e,t)=>{if(k.isSearch()){if(t==1)return !0;if(t==0)return !1}}),c.execMenuOnce("shieldLeftNavigator-tab-home",()=>this.block_tab_home()),c.execMenuOnce("shieldLeftNavigator-tab-recommend",()=>this.block_tab_recommend()),c.execMenuOnce("shieldLeftNavigator-tab-follow",()=>this.block_tab_follow()),c.execMenuOnce("shieldLeftNavigator-tab-friend",()=>this.block_tab_friend()),c.execMenuOnce("shieldLeftNavigator-tab-user_self",()=>this.block_tab_user_self()),c.execMenuOnce("shieldLeftNavigator-tab-user_self_like",()=>this.block_tab_user_self_like()),c.execMenuOnce("shieldLeftNavigator-tab-user_self_collection",()=>this.block_tab_user_self_collection()),c.execMenuOnce("shieldLeftNavigator-tab-user_self_record",()=>this.block_tab_user_self_record()),c.execMenuOnce("shieldLeftNavigator-tab-olympics",()=>this.block_tab_olympics()),c.execMenuOnce("shieldLeftNavigator-tab-live",()=>this.block_tab_live()),c.execMenuOnce("shieldLeftNavigator-tab-vs",()=>this.block_tab_vs()),c.execMenuOnce("shieldLeftNavigator-tab-channel_300203",()=>this.block_tab_channel_300203()),c.execMenuOnce("shieldLeftNavigator-tab-channel_300205",()=>this.block_tab_channel_300205()),c.execMenuOnce("shieldLeftNavigator-tab-channel_300206",()=>this.block_tab_channel_300206()),c.execMenuOnce("shieldLeftNavigator-tab-channel_300209",()=>this.block_tab_channel_300209()),c.execMenuOnce("shieldLeftNavigator-tab-channel_300204",()=>this.block_tab_channel_300204());},shieldLeftNavigator(){o.info("【屏蔽】左侧导航栏");let e=[];return e.push(v.addBlockCSS("#douyin-navigation")),e.push(x(`
			/* 修复顶部导航栏的宽度 */
			#douyin-header{
				width: 100%;
			}`)),e},block_tab_home(){return o.info("【屏蔽】首页"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-discover)')},block_tab_recommend(){return o.info("【屏蔽】推荐"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-recommend)')},block_tab_follow(){return o.info("【屏蔽】关注"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-follow)')},block_tab_friend(){return o.info("【屏蔽】朋友"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-friend)')},block_tab_user_self(){return o.info("【屏蔽】我的"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self)')},block_tab_user_self_like(){return o.info("【屏蔽】喜欢"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_like)')},block_tab_user_self_collection(){return o.info("【屏蔽】收藏"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_collection)')},block_tab_user_self_record(){return o.info("【屏蔽】观看历史"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_record)')},block_tab_olympics(){return o.info("【屏蔽】看奥运"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-olympics)')},block_tab_live(){return o.info("【屏蔽】直播"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-live)')},block_tab_vs(){return o.info("【屏蔽】放映厅"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-vs)')},block_tab_channel_300203(){return o.info("【屏蔽】知识"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300203)')},block_tab_channel_300205(){return o.info("【屏蔽】游戏"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300205)')},block_tab_channel_300206(){return o.info("【屏蔽】二次元"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300206)')},block_tab_channel_300209(){return o.info("【屏蔽】音乐"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300209)')},block_tab_channel_300204(){return o.info("【屏蔽】美食"),v.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300204)')}},Le={init(){c.onceExec("hookKeyboard",()=>{oe.disableShortCut();}),k.isVideo()?c.execMenuOnce("dy-video-disableDoubleClickLike",()=>{oe.disableDoubleClickLike();}):k.isLive()&&c.execMenuOnce("dy-live-disableDoubleClickLike",()=>{oe.disableDoubleClickLike();}),pt.init(),c.execMenuOnce("watchLoginDialogToClose",()=>{Ce.watchLoginDialogToClose();}),c.execMenuOnce("disguiseLogin",()=>{Ce.disguiseLogin();}),c.execMenuOnce("dy-initialScale",()=>{this.initialScale();}),c.execMenu("dy-apple-removeMetaAppleItunesApp",()=>{this.removeMetaAppleItunesApp();}),vt.init(),ht.init(),ft.init(),k.isLive()?(o.info("Router: 直播"),Ye.init()):k.isVideo()?(o.info("Router: 推荐视频"),O.init(),k.isSearch()&&(o.info("Router: 推荐视频-搜索"),Se.init())):o.error("未知router: "+window.location.hostname);},initialScale(){o.info("设置<meta>的viewport固定缩放倍率为1并移除页面原有的<meta>"),g.ready(()=>{let e=g.createElement("meta",{},{name:"viewport",content:"width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"});g.remove("meta[name='viewport']"),p.waitNode("head").then(()=>{document.head.appendChild(e);});});},removeMetaAppleItunesApp(){p.waitNodeList(['meta[name="apple-itunes-app"]'],1e4).then(e=>{e&&e.forEach(t=>{t.remove();});});}},$={isMDouYin(){return window.location.hostname==="m.douyin.com"||window.location.hostname==="www.iesdouyin.com"},isShareUser(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/user/")},isShareVideo(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/video/")},isShareNote(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/note/")},isShareMusic(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/music/")},isShareChallenge(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/challenge/")}},mt=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 上面屏蔽后的空白区域 */\r
.user-card .nav-bar-placeholder,\r
/* 视频区域底部的【打开抖音App看更多内容】 */\r
.select-list .img-button{\r
    display: none !important;\r
}`,V={getVideoUrl(e){return "https://www.douyin.com/video/"+e},getCollectionUrl(e){return "https://www.douyin.com/collection/"+e},getNoteUrl(e){return "https://www.douyin.com/note/"+e},getHashTagUrl(e){return "https://www.douyin.com/hashtag/"+e},getUserHomeUrl(e){return "https://www.douyin.com/user/"+e},getMusicUrl(e){return "https://www.douyin.com/music/"+e}},yt={init(){x(mt),c.execMenuOnce("m-dy-share-user-coverPlayletList",()=>{this.coverPlayletList();}),c.execMenuOnce("m-dy-share-user-coverPostListContainer",()=>{this.coverPostListContainer();});},coverPlayletList(){g.on(document,"click",".user-playlet-list .playlet-item",e=>{var l,h,f,y;p.preventEvent(e);let t=e.target,i=(l=p.getReactObj(t))==null?void 0:l.reactFiber;if((i==null?void 0:i.key)==null){C.error("获取视频合集key失败");return}let a=i==null?void 0:i.index;if(a==null){C.error("获取视频合集index失败");return}let r=(y=(f=(h=i==null?void 0:i.return)==null?void 0:h.return)==null?void 0:f.pendingProps)==null?void 0:y.playletList;if(r==null){C.error("获取视频合集playletList失败");return}let d=r[a],s=V.getCollectionUrl(d.mix_id);window.open(s,"_blank");},{capture:!0});},coverPostListContainer(){g.on(document,"click",".post-list-container .user-post-cover",e=>{var n,a,r,d,s;p.preventEvent(e);let t=e.target,i=(n=p.getReactObj(t))==null?void 0:n.reactFiber;if((r=(a=i==null?void 0:i.return)==null?void 0:a.memoizedProps)!=null&&r.productionUrl){let l=(s=(d=i==null?void 0:i.return)==null?void 0:d.memoizedProps)==null?void 0:s.productionUrl;window.open(l,"_blank");}else C.error("获取视频链接失败");},{capture:!0});}},gt=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 视频描述信息区域中的 打开抖音看精彩视频 */\r
.footer .img-button,\r
/* 登录页面 */\r
.login-page {\r
	display: none !important;\r
}\r
`,bt=`.video-container {\r
	height: 100% !important;\r
	margin-top: 0 !important;\r
}\r
.footer {\r
	bottom: 50px !important;\r
}\r
.mix-info {\r
	bottom: 0px !important;\r
}\r
`,Ct={init(){x(gt),x(bt),c.execMenuOnce("m-dy-share-video-coverGlobalClick",()=>{this.coverGlobalClick();});},coverGlobalClick(){[".right-con",".footer",".mix-info"].forEach(t=>{xe.on(document,"click",t,i=>p.preventEvent(i),{capture:!0});});}},kt=`/* 顶部 打开看看 登录 */\r
.container .adapt-login-header,\r
/* 底部中间的 App内打开 */\r
.container .float-button-con {\r
	display: none !important;\r
}\r
\r
.gallery-container {\r
	margin-top: 10px !important;\r
}\r
`,xt={init(){x(kt),c.execMenuOnce("m-dy-share-note-blockRecommend",()=>this.blockRecommend()),c.execMenuOnce("m-dy-share-note-blockComment",()=>this.blockComment()),c.execMenuOnce("m-dy-share-note-blockFooterToobar",()=>this.blockFooterToobar()),c.execMenuOnce("m-dy-share-note-coverUser",()=>{this.coverUser();}),c.execMenuOnce("m-dy-share-note-coverHashTag",()=>{this.coverHashTag();}),c.execMenuOnce("m-dy-share-note-coverMusic",()=>{this.coverMusic();}),c.execMenuOnce("m-dy-share-note-coverRecommend",()=>{this.coverRecommend();}),c.execMenuOnce("m-dy-share-note-coverExcitingGraphicsAndText",()=>{this.coverExcitingGraphicsAndText();});},blockRecommend(){return o.info("【屏蔽】相关推荐"),v.addBlockCSS(".recommend-con")},blockComment(){return o.info("【屏蔽】评论"),v.addBlockCSS(".comment-con")},blockFooterToobar(){return o.info("【屏蔽】底部工具栏"),v.addBlockCSS(".footer-con")},coverRecommend(){o.info("覆盖相关推荐的点击事件"),g.on(document,"click","#masonry .card",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.memoizedProps.awemeId,a=V.getNoteUrl(n);window.open(a,"_blank");},{capture:!0});},coverUser(){o.info("覆盖用户点击事件"),g.on(document,"click",".message-con__top",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.memoizedProps.video.authorInfo.sec_uid,a=V.getUserHomeUrl(n);window.open(a,"_blank");},{capture:!0});},coverHashTag(){o.info("覆盖话题点击事件"),g.on(document,"click",".message-con__content__body .message-con__content__body-text",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.index,d=i.return.return.return.return.memoizedProps.video.splitStrArr[n].hashtagId,s=V.getHashTagUrl(d);window.open(s,"_blank");},{capture:!0});},coverMusic(){o.info("覆盖音乐点击事件"),g.on(document,"click",".message-con__footer",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.memoizedProps.video.musicId,a=V.getMusicUrl(n);window.open(a,"_blank");},{capture:!0});},coverExcitingGraphicsAndText(){o.info("覆盖精彩图文点击事件"),g.on(document,"click",".container .related-list-con .related-note-item",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let a=i.return.memoizedProps.itemData.awemeId,r=V.getNoteUrl(a);window.open(r,"_blank");},{capture:!0}),g.on(document,"click",".related-title-con",e=>p.preventEvent(e),{capture:!0});}},_t=`/* 顶部 打开看看 登录 */\r
.page-reflow-challenge .header,\r
/* 底部的 打开抖音App看更多内容 */\r
.page-reflow-challenge .bottom-btn__con {\r
	display: none !important;\r
}\r
\r
.page-reflow-challenge {\r
	padding-top: 0 !important;\r
}\r
`,St={init(){x(_t),c.onceExec("m-dy-share-challenge-coverTopJump",()=>{this.coverTopJump();}),c.execMenuOnce("m-dy-share-challenge-coverVideoCard",()=>{this.coverVideoCard();});},coverTopJump(){o.info("阻止上面区域点击跳转至下载页面"),g.on(document,"click",".challenge-body",e=>{p.preventEvent(e);},{capture:!0});},coverVideoCard(){o.info("覆盖视频卡片点击事件"),g.on(document,"click","#pagelet-worklist li.item",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.return.memoizedProps.listData,a=i.index,r=n[a],d=V.getVideoUrl(r.aweme_id);window.open(d,"_blank");},{capture:!0});}},wt=`/* 顶部 打开App，发现更多内容 */\r
.page-reflow-music .header,\r
/* ↑屏蔽后的 顶部空白区域 */\r
.page-reflow-music .banner-placeholder ,\r
/* 底部 打开抖音App看更多内容 */\r
.page-reflow-music .bottom-btn__con {\r
	display: none !important;\r
}\r
`,Mt={init(){x(wt),c.execMenuOnce("m-dy-share-music-coverVideoCard",()=>{this.coverVideoCard();});},coverVideoCard(){o.info("覆盖视频卡片点击事件"),g.on(document,"click","#pagelet-worklist li.item",e=>{p.preventEvent(e);let t=e.target,i=p.getReactObj(t).reactFiber;if(!i){o.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.return.memoizedProps.listData,a=i.index,r=n[a],d=V.getVideoUrl(r.aweme_id);window.open(d,"_blank");},{capture:!0});}},Lt={init(){$.isShareUser()?(o.info("M-Router: 分享用户"),yt.init()):$.isShareVideo()?(o.info("M-Router: 分享视频"),Ct.init()):$.isShareNote()?(o.info("M-Router: 分享笔记"),xt.init()):$.isShareChallenge()?(o.info("M-Router: 分享话题"),St.init()):$.isShareMusic()?(o.info("M-Router: 分享音乐"),Mt.init()):o.error("未知M-router: "+window.location.hostname);}};c.init();$.isMDouYin()?Lt.init():Le.init();

})(Qmsg, Utils, DOMUtils, pops);