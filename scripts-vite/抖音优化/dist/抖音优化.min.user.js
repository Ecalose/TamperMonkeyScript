// ==UserScript==
// @name         抖音优化
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2025.1.26
// @author       WhiteSevs
// @description  视频过滤，包括广告、直播或自定义规则，伪装登录、屏蔽登录弹窗、自定义清晰度选择、未登录解锁画质选择、禁止自动播放、自动进入全屏、双击进入全屏、屏蔽弹幕和礼物特效、手机模式、修复进度条拖拽、自定义视频和评论区背景色等
// @license      GPL-3.0-only
// @icon         data:image/png;base64,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
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*.douyin.com/*
// @match        *://*.iesdouyin.com/*
// @require      https://update.greasyfork.org/scripts/494167/1413255/CoverUMD.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.5.8/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.4.8/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@1.9.7/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.2.8/dist/index.umd.js
// @connect      *
// @grant        GM_deleteValue
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (C, ot, ze, rt) {
	'use strict';

	var it=Object.defineProperty;var nt=(t,e,i)=>e in t?it(t,e,{enumerable:true,configurable:true,writable:true,value:i}):t[e]=i;var P=(t,e,i)=>nt(t,typeof e!="symbol"?e+"":e,i);var at=typeof GM_deleteValue<"u"?GM_deleteValue:undefined,Fe=typeof GM_getResourceText<"u"?GM_getResourceText:undefined,te=typeof GM_getValue<"u"?GM_getValue:undefined,ge=typeof GM_info<"u"?GM_info:undefined,lt=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:undefined,X=typeof GM_setValue<"u"?GM_setValue:undefined,st=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:undefined,dt=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:undefined,_=typeof unsafeWindow<"u"?unsafeWindow:undefined,ct=window;const ae="GM_Panel",je="data-init",Y="data-key",q="data-default-value",ut="data-init-more-value",L="data-storage-api",Z=function(t,e,i,n,o,r){let d=[];typeof n=="function"?d=n():d=n;let s={text:t,type:"select",description:r,attributes:{},props:{},getValue(){return this.props[L].get(e,i)},callback(l,c,f){let p=c;a.info(`选择：${f}`),this.props[L].set(e,p),typeof o=="function"&&o(l,p,f);},data:d};return Reflect.set(s.attributes,Y,e),Reflect.set(s.attributes,q,i),Reflect.set(s.props,L,{get(l,c){return u.getValue(l,c)},set(l,c){u.setValue(l,c);}}),s},h=function(t,e,i,n,o,r){let d={text:t,type:"switch",description:o,attributes:{},props:{},getValue(){return !!this.props[L].get(e,i)},callback(s,l){let c=!!l;a.success(`${c?"开启":"关闭"} ${t}`),this.props[L].set(e,c);},afterAddToUListCallBack:r};return Reflect.set(d.attributes,Y,e),Reflect.set(d.attributes,q,i),Reflect.set(d.props,L,{get(s,l){return u.getValue(s,l)},set(s,l){u.setValue(s,l);}}),d},ht=(t,e)=>{let i=e.sectionBodyContainer.querySelector(".keyboard-oneClickOpen"),n=e.sectionBodyContainer.querySelector(".keyboard-oneClickClose"),o=r=>{var d;(d=e.sectionBodyContainer)==null||d.querySelectorAll(".pops-panel-switch").forEach(s=>{let l=s.querySelector(".pops-panel-switch__input"),c=s.querySelector(".pops-panel-switch__core");r?l.checked||c.click():l.checked&&c.click();});};g.on(i,"click",r=>{m.preventEvent(r),o(true);}),g.on(n,"click",r=>{m.preventEvent(r),o(false);});},B={text:`
        <a href="javascript:;" class="keyboard-oneClickOpen">一键开启</a>
        <br>
        <a href="javascript:;" class="keyboard-oneClickClose">一键关闭</a>
    `,afterEnterDeepMenuCallBack:ht},ft={id:"panel-config-common",title:"通用",forms:[{text:"",type:"forms",forms:[{text:"Toast配置",type:"deepMenu",forms:[{text:"",type:"forms",forms:[Z("Toast位置","qmsg-config-position","bottom",[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],(t,e,i)=>{a.info("设置当前Qmsg弹出位置"+i);},"Toast显示在页面九宫格的位置"),Z("最多显示的数量","qmsg-config-maxnums",3,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],undefined,"限制Toast显示的数量"),h("逆序弹出","qmsg-config-showreverse",false,undefined,"修改Toast弹出的顺序")]}]}]},{type:"forms",text:"",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("伪装登录","disguiseLogin",false,undefined,"使用随机UID进行伪装"),h("initial-scale=1","dy-initialScale",false,undefined,"可配合手机模式放大页面"),h("移除<meta> apple-itunes-app","dy-apple-removeMetaAppleItunesApp",true,undefined,"Safari使用，移除顶部横幅【Open in the 抖音 app】"),h("监听Router改变","dy-common-listenRouterChange",true,undefined,"功能重载"),h("移除某些Cookie","dy-cookie-remove__ac__",false,undefined,"阻止触发验证弹窗（maybe）")]},{text:"Url重定向",type:"forms",forms:[h("重定向/home","douyin-redirect-url-home-to-root",false,undefined,"/home => /")]}]},{type:"deepMenu",text:"快捷键禁用",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text,forms:[h("赞|取消赞","dy-keyboard-hook-likeOrDislike",false,undefined,"Z"),h("评论","dy-keyboard-hook-comment",false,undefined,"X"),h("开启/关闭弹幕","dy-keyboard-hook-danmaku-enable",false,undefined,"B"),h("收藏/取消收藏","dy-keyboard-hook-collect-enable",false,undefined,"C"),h("复制分享口令","dy-keyboard-hook-copyShareLink",false,undefined,"V"),h("清屏","dy-keyboard-hook-clearScreen",false,undefined,"J"),h("自动连播","dy-keyboard-hook-automaticBroadcast",false,undefined,"K"),h("视频信息","dy-keyboard-hook-videoInfo",false,undefined,"I"),h("不感兴趣","dy-keyboard-hook-notInterested",false,undefined,"R"),h("进入作者主页","dy-keyboard-hook-enterAuthorHomePage",false,undefined,"F"),h("关注/取消关注","dy-keyboard-hook-follow",false,undefined,"G"),h("抖音搜索","dy-keyboard-hook-search",false,undefined,"Shift+F"),h("一键关闭当前页","dy-keyboard-hook-closeTheCurrentPageWithOneClick",false,undefined,"Shift+Q"),h("上下翻页","dy-keyboard-hook-pageUpAndDown",false,undefined,"↑↓"),h("快进快退","dy-keyboard-hook-fastForwardAndFastBack",false,undefined,"← →"),h("暂停","dy-keyboard-hook-pause",false,undefined,"空格"),h("网页内全屏","dy-keyboard-hook-fullScreenInsideThePage",false,undefined,"Y"),h("全屏","dy-keyboard-hook-fullScreen",false,undefined,"H"),h("稍后再看","dy-keyboard-hook-watchItOutLater",false,undefined,"L"),h("音量调整","dy-keyboard-hook-volumeAdjustment",false,undefined,"Shift + / Shift -"),h("呼出快捷键列表","dy-keyboard-hook-listOfCallShortcutKeys",false,undefined,"?"),h("关闭快捷键列表","dy-keyboard-hook-closeTheShortcutKeyList",false,undefined,"ESC"),h("相关推荐","dy-keyboard-hook-relevantRecommendation",false,undefined,"N")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-全局",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text,forms:[h("【屏蔽】登录弹窗","watchLoginDialogToClose",true,undefined,"屏蔽元素且自动等待元素出现并关闭登录弹窗"),h("【屏蔽】底部？按钮","shieldBottomQuestionButton",true,undefined,"屏蔽元素")]}]},{text:"布局屏蔽-左侧导航栏",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text,forms:[h("【屏蔽】左侧导航栏","shieldLeftNavigator",false,undefined,"屏蔽元素"),h("【屏蔽】首页","shieldLeftNavigator-tab-home",false,undefined,"屏蔽元素"),h("【屏蔽】推荐","shieldLeftNavigator-tab-recommend",false,undefined,"屏蔽元素"),h("【屏蔽】关注","shieldLeftNavigator-tab-follow",false,undefined,"屏蔽元素"),h("【屏蔽】朋友","shieldLeftNavigator-tab-friend",false,undefined,"屏蔽元素"),h("【屏蔽】我的","shieldLeftNavigator-tab-user_self",false,undefined,"屏蔽元素"),h("【屏蔽】喜欢","shieldLeftNavigator-tab-user_self_like",false,undefined,"屏蔽元素"),h("【屏蔽】收藏","shieldLeftNavigator-tab-user_self_collection",false,undefined,"屏蔽元素"),h("【屏蔽】观看历史","shieldLeftNavigator-tab-user_self_record",false,undefined,"屏蔽元素"),h("【屏蔽】看奥运","shieldLeftNavigator-tab-olympics",false,undefined,"屏蔽元素"),h("【屏蔽】直播","shieldLeftNavigator-tab-live",false,undefined,"屏蔽元素"),h("【屏蔽】放映厅","shieldLeftNavigator-tab-vs",false,undefined,"屏蔽元素"),h("【屏蔽】短剧","shieldLeftNavigator-tab-series",false,undefined,"屏蔽元素"),h("【屏蔽】知识","shieldLeftNavigator-tab-channel_300203",false,undefined,"屏蔽元素"),h("【屏蔽】游戏","shieldLeftNavigator-tab-channel_300205",false,undefined,"屏蔽元素"),h("【屏蔽】二次元","shieldLeftNavigator-tab-channel_300206",false,undefined,"屏蔽元素"),h("【屏蔽】音乐","shieldLeftNavigator-tab-channel_300209",false,undefined,"屏蔽元素"),h("【屏蔽】美食","shieldLeftNavigator-tab-channel_300204",false,undefined,"屏蔽元素"),h("【屏蔽】美好跨年季","shieldLeftNavigator-tab-activity_2644292",false,undefined,"屏蔽元素"),h("【屏蔽】2025新春环游记","shieldLeftNavigator-tab-activity_2643710",false,undefined,"屏蔽元素")]}]},{text:"布局屏蔽-顶部导航栏",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】顶部导航栏","shieldTopNavigator",false,undefined,"屏蔽元素"),h("【屏蔽】右侧菜单栏","shield-topNav-rightMenu",false,undefined,"屏蔽元素"),h("【屏蔽】客户端提示","shieldClientTip",true,undefined,"屏蔽元素"),h("【屏蔽】充钻石","shieldFillingBricksAndStones",true,undefined,"屏蔽元素"),h("【屏蔽】客户端","shieldClient",true,undefined,"屏蔽元素"),h("【屏蔽】快捷访问","shieldQuickAccess",false,undefined,"屏蔽元素"),h("【屏蔽】通知","shieldNotifitation",false,undefined,"屏蔽元素"),h("【屏蔽】私信","shieldPrivateMessage",false,undefined,"屏蔽元素"),h("【屏蔽】投稿","shieldSubmission",false,undefined,"屏蔽元素"),h("【屏蔽】壁纸","shieldWallpaper",false,undefined,"屏蔽元素"),h("【屏蔽】更多","shield-topNav-rightMenu-more",false,undefined,"屏蔽元素"),h("【屏蔽】登录头像","shield-topNav-rightMenu-loginAvatar",false,undefined,"屏蔽元素")]}]},{text:"布局屏蔽-搜索",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】搜索框","shieldSearch",false,undefined,"屏蔽元素"),h("【屏蔽】搜索框的提示","shieldSearchPlaceholder",false,undefined,"屏蔽元素"),h("【屏蔽】猜你想搜","shieldSearchGuessYouWantToSearch",false,undefined,"屏蔽元素"),h("【屏蔽】抖音热点","shieldSearchTiktokHotspot",false,undefined,"屏蔽元素")]}]},{type:"deepMenu",text:"布局屏蔽-鼠标悬浮提示",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text+"<br>视频区域-右侧工具栏",forms:[h("进入作者主页","dy-video-mouseHoverTip-rightToolBar-enterUserHome",false),h("关注","dy-video-mouseHoverTip-rightToolBar-follow",false),h("点赞","dy-video-mouseHoverTip-rightToolBar-addLike",false),h("评论","dy-video-mouseHoverTip-rightToolBar-comment",false),h("收藏","dy-video-mouseHoverTip-rightToolBar-collect",false),h("分享","dy-video-mouseHoverTip-rightToolBar-share",false),h("看相关","dy-video-mouseHoverTip-rightToolBar-seeCorrelation",false)]},{type:"forms",text:"视频区域-底部工具栏",forms:[h("自动连播","dy-video-mouseHoverTip-bottomToolBar-automaticBroadcast",false),h("清屏","dy-video-mouseHoverTip-bottomToolBar-clearScreen",false),h("稍后再看","dy-video-mouseHoverTip-bottomToolBar-watchLater",false),h("网页全屏","dy-video-mouseHoverTip-bottomToolBar-pageFullScreen",false),h("全屏","dy-video-mouseHoverTip-bottomToolBar-fullScreen",false)]}]}]}]},ve={key:"douyin-live-danmu-rule",$data:{rule:[]},init(){this.resetRule(),this.initRule();},initRule(){this.get().trim().split(`
`).forEach(i=>{if(i.trim()=="")return;i=i.trim();let n=new RegExp(i.trim());this.$data.rule.push(n);});},resetRule(){this.$data.rule=[];},change(){var e,i,n,o,r,d,s,l;let t=Array.from(ne("xg-danmu.xgplayer-danmu > div > div:not([data-is-filter])"));for(let c=0;c<t.length;c++){let f=t[c],p=(o=(n=(i=(e=m.getReactObj(f))==null?undefined:e.reactFiber)==null?undefined:i.return)==null?undefined:n.memoizedProps)==null?undefined:o.message,v=((r=p==null?undefined:p.payload)==null?undefined:r.content)||((s=(d=p==null?undefined:p.payload)==null?undefined:d.common)==null?undefined:s.describe),b=p.method,k=(l=p==null?undefined:p.payload)==null?undefined:l.chat_by,x=false;x||(b==="WebcastGiftMessage"&&u.getValue("live-danmu-shield-gift")?x=true:b==="WebcastChatMessage"&&(k==="0"||k==="9"&&u.getValue("live-danmu-shield-lucky-bag")&&(x=true))),x||(x=x&&!!this.$data.rule.find(M=>{if(typeof v=="string"&&v.match(M))return a.info("过滤弹幕: "+v),true})),x&&(f.setAttribute("data-is-filter","true"),g.hide(f));}},set(t){X(this.key,t);},get(){return te(this.key,"")}},pt={filterDanmu(){m.waitNode("xg-danmu.xgplayer-danmu",1e5).then(t=>{if(!t){a.error("xg-danmu.xgplayer-danmu获取失败");return}a.success("弹幕过滤"),ve.init(),m.mutationObserver(t,{config:{childList:true,subtree:true},immediate:true,callback:()=>{ve.change();}});});}},Qe={async waitReactPropsToSet(t,e,i){function n(){let o=null;return typeof t=="string"?o=document.querySelector(t):typeof t=="function"?o=t():t instanceof HTMLElement&&(o=t),o}typeof t=="string"&&!await m.waitNode(t,1e4)||(Array.isArray(i)||(i=[i]),i.forEach(o=>{typeof o.msg=="string"&&a.info(o.msg);function r(){let d=n();if(d==null)return  false;let s=m.getReactObj(d);if(s==null)return  false;let l=s[e];return l==null?false:!!o.check(l)}m.waitPropertyByInterval(()=>n(),r,250,1e4).then(()=>{let d=n();if(d==null)return;let s=m.getReactObj(d);if(s==null)return;let l=s[e];l!=null&&o.set(l,d);});}));}},y={addBlockCSS(...t){let e=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(i=>{Array.isArray(i)?e=e.concat(i):e.push(i);}),w(`${e.join(`,
`)}{display: none !important;}`)},setGMResourceCSS(t){let e=typeof Fe=="function"?Fe(t.keyName):"";typeof e=="string"&&e?w(e):y.loadStyleLink(t.url);},async loadStyleLink(t){let e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,g.ready(()=>{document.head.appendChild(e);});},async loadScript(t){let e=document.createElement("script");return e.src=t,new Promise(i=>{e.onload=()=>{i(null);},(document.head||document.documentElement).appendChild(e);})},fixUrl(t){return t=t.trim(),t.match(/^http(s|):\/\//i)||(t.startsWith("/")||(t+="/"),t=window.location.origin+t),t},fixHttps(t){if(t.startsWith("https://")||!t.startsWith("http://"))return t;let e=new URL(t);return e.protocol="https:",e.toString()}},mt={init(){u.execMenuOnce("live-shieldGiftColumn",()=>this.shieldGiftColumn()),u.execMenuOnce("live-shieldTopToolBarInfo",()=>this.shieldTopToolBarInfo()),u.execMenuOnce("live-shieldGiftEffects",()=>this.shieldGiftEffects()),u.execMenuOnce("live-shieldLucky",()=>this.shieldLucky()),u.execMenuOnce("live-shielYellowCar",()=>this.shieldYellowCar()),u.execMenuOnce("live-shieldDanmuku",()=>this.shieldDanmu()),vt.init(),yt.init();},shieldDanmu(){return a.info("屏蔽弹幕"),[y.addBlockCSS("xg-danmu.xgplayer-danmu")]},shieldTopToolBarInfo(){return a.info("【屏蔽】顶栏信息"),[y.addBlockCSS('div[data-e2e="living-container"] div[id*="living_room_player_container"] > pace-island[id^="island_"]','div[data-e2e="living-container"] div[id*="living_room_player_container"] >div>div>pace-island[id^="island_"]:has(.__isFullPlayer)','div[data-e2e="living-container"] xg-bar.xg-top-bar')]},shieldGiftEffects(){a.info("【屏蔽】礼物特效");let t=[y.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"] > pace-island[id^="island_"]:not(:has(.ShortTouchContainer)):has(>div > div:not([class*="video_layout_container"]) > div)')];return g.ready(()=>{m.waitNode(()=>g.selector("xg-icon.pluginContainer > div:contains('屏蔽礼物特效')"),1e4).then(e=>{var o,r,d,s;if(!e){a.error("屏蔽礼物特效按钮不存在，获取超时");return}let{reactFiber:i}=m.getReactObj(e),n=(s=(d=(r=(o=i==null?undefined:i.memoizedProps)==null?undefined:o.children)==null?undefined:r[1])==null?undefined:d.props)==null?undefined:s.onClick;typeof n=="function"?(a.info("调用屏蔽礼物特效按钮的onClick函数"),n()):a.error("调用屏蔽礼物特效按钮的onClick函数失败，未获取到");});}),t},shieldLucky(){return a.info("【屏蔽】福袋"),[y.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"] > pace-island[id^="island_"]:has(.ShortTouchContainer):has(>div > div:not([class*="video_layout_container"]) > div)')]},shieldYellowCar(){return a.info("【屏蔽】小黄车"),[y.addBlockCSS('div[id^="living_room_player_container"] .basicPlayer  > div:has(div[data-e2e="yellowCart-container"])')]},shieldGiftColumn(){return a.info("【屏蔽】底部的礼物栏"),[y.addBlockCSS('div[data-e2e="living-container"] >div> div:not(:has(video)):not(:has([id^="living_player_container"])):has(pace-island >.gitBarOptimizeEnabled [data-e2e="gifts-container"])','div[data-e2e="living-container"] > [id^="living_room_player_container"] > :last-child:has(>.gitBarOptimizeEnabled )','div[data-e2e="living-container"] >div> div:has(>pace-island >.gitBarOptimizeEnabled)','div[data-e2e="living-container"] xg-controls > div:has(div[data-e2e="gifts-container"]):not(:has(video))'),w(`
            /* 去除全屏状态下的礼物栏后，上面的工具栏bottom也去除 */
            div[data-e2e="living-container"] xg-controls xg-inner-controls:has(+div div[data-e2e="gifts-container"]){
                bottom: 0 !important;
            }`)]}},vt={init(){u.execMenuOnce("live-shieldChatRoom",()=>this.shieldChatRoom()),u.execMenuOnce("live-shielChatRoomVipSeats",()=>this.shielChatRoomVipSeats()),u.execMenuOnce("dy-live-shieldUserLevelIcon",()=>this.shieldUserLevelIcon()),u.execMenuOnce("dy-live-shieldUserVIPIcon",()=>this.shieldUserVIPIcon()),u.execMenuOnce("dy-live-shieldUserFansIcon",()=>this.shieldUserFansIcon()),u.execMenuOnce("dy-live-shieldMessage",()=>this.shieldMessage());},shieldChatRoom(){return a.info("【屏蔽】评论区（聊天室）"),[y.addBlockCSS("#chatroom"),w(`
            div[data-e2e="living-container"],
            div[data-e2e="living-container"] > div{
                margin-bottom: 0px !important;
            }`)]},shielChatRoomVipSeats(){return a.info("【屏蔽】评论区的贵宾席"),[y.addBlockCSS("#chatroom > div > div:has(#audiencePanelScrollId)","#chatroom > pace-island > div > div:has(#audiencePanelScrollId)")]},shieldUserLevelIcon(){return a.info("【屏蔽】用户等级图标"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>img[src*="level"])')]},shieldUserVIPIcon(){return a.info("【屏蔽】VIP图标"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>img[src*="subscribe"])')]},shieldUserFansIcon(){return a.info("【屏蔽】粉丝牌"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>div[style*="fansclub"])','#chatroom .webcast-chatroom___item span:has(>img[src*="fansclub"])')]},shieldMessage(){return a.info("【屏蔽】信息播报"),[y.addBlockCSS("#chatroom .webcast-chatroom___bottom-message","#chatroom >div:nth-child(2)>div>div:nth-child(3)","#chatroom >pace-island>div>div:first-child>div:nth-child(3)")]}},yt={init(){u.execMenuOnce("dy-live-blockVideoRightMenu-downloadClient",()=>this.blockDownloadClient());},blockDownloadClient(){return a.info("【屏蔽】右键菜单-下载客户端"),[y.addBlockCSS('.__menu_container_className:has(>a[href*="douyin-pc-web"])')]}},gt={$data:{playerInstance:null},$el:{$playerIns:null},initMenu(){Xe.add({key:"live-parsePlayerInstance",text:"⚙ PlayerInstance",autoReload:false,showText(t,e){return t},callback:()=>{let t=I('[id^="living_room_player_container"]');if(!t){a.error("获取playerInstance所在的元素失败"),C.error("获取playerInstance所在的元素失败");return}this.$el.$playerIns=t;let e=this.parseElementPlayerIns(this.$el.$playerIns);if(e==null){a.error("获取playerInstance失败"),a.error("获取playerInstance失败");return}this.$data.playerInstance=e,this.showParseDialog();}});},parseElementPlayerIns(t){var i,n,o,r;let e=m.getReactObj(t);return (r=(o=(n=(i=e==null?undefined:e.reactFiber)==null?undefined:i.child)==null?undefined:n.child)==null?undefined:o.memoizedProps)==null?undefined:r.playerInstance},showParseDialog(){var i,n,o,r;a.info(["解析的信息：",this.$data.playerInstance]);let t=((i=this.$data.playerInstance)==null?undefined:i.url)||((n=this.$data.playerInstance)==null?undefined:n.src),e=(o=this.$data.playerInstance)==null?undefined:o.config.url;A.alert({title:{text:"解析信息",position:"center"},content:{text:`
                <div class="live-dy-parse-container">
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">推流地址：</div>
                        <a class="live-dy-parse-item-value" href="${e}" target="_blank">${e}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">blob地址：</div>
                        <a class="live-dy-parse-item-value" href="${t}" target="_blank">${t}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">播放器版本：</div>
                        <div class="live-dy-parse-item-value">${(r=this.$data.playerInstance)==null?undefined:r.version}
                        </div>
                    </div>
                </div>
                `,html:true},mask:{enable:false},width:window.innerWidth>550?"550px":"88wv",height:window.innerHeight>550?"550px":"70vh",style:`
            .live-dy-parse-container{
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            .live-dy-parse-item{
                display: flex;
                flex-wrap: wrap;
                border: 1px solid #919191;
                border-left: 0px;
                border-right: 0px;
                width: 100%;
                background: #0af9ee;
                padding: 5px 5px;
            }
            `});}};class Je{constructor(e){P(this,"key","short-cut");P(this,"$data");P(this,"isWaitPress",false);P(this,"currentWaitEnterPressInstanceHandler",null);typeof e=="string"&&(this.key=e),this.$data={otherShortCutOptions:[]};}initConfig(e,i){this.hasOption(e)||this.setOption(e,i);}getStorageKey(){return this.key}getLocalAllOptions(){return te(this.key,[])}hasOption(e){return !!this.getLocalAllOptions().find(o=>o.key===e)}hasOptionValue(e){if(this.hasOption(e)){let i=this.getOption(e);return (i==null?undefined:i.value)!=null}else return  false}getOption(e,i){return this.getLocalAllOptions().find(r=>r.key===e)??i}setOption(e,i){let n=this.getLocalAllOptions(),o=n.findIndex(r=>r.key===e);o==-1?n.push({key:e,value:i}):Reflect.set(n[o],"value",i),X(this.key,n);}emptyOption(e){let i=false,n=this.getLocalAllOptions(),o=n.findIndex(r=>r.key===e);return o!==-1&&(n[o].value=null,i=true),X(this.key,n),i}deleteOption(e){let i=false,n=this.getLocalAllOptions(),o=n.findIndex(r=>r.key===e);return o!==-1&&(n.splice(o,1),i=true),X(this.key,n),i}translateKeyboardValueToButtonText(e){let i="";return e.ohterCodeList.forEach(n=>{i+=m.stringTitleToUpperCase(n,true)+" + ";}),i+=m.stringTitleToUpperCase(e.keyName),i}getShowText(e,i){if(this.hasOption(e)){let n=this.getOption(e);return n.value==null?i:this.translateKeyboardValueToButtonText(n.value)}else return i}async enterShortcutKeys(e){const i=this;return new Promise(n=>{this.isWaitPress=true;let o=g.listenKeyboard(window,"keyup",(r,d,s)=>{const l={keyName:r,keyValue:d,ohterCodeList:s};let c={};try{const f=JSON.stringify(l),p=this.getLocalAllOptions();Array.isArray(this.$data.otherShortCutOptions)&&p.push(...this.$data.otherShortCutOptions);for(let v=0;v<p.length;v++){let b=p[v];if(b.key===e)continue;const k=JSON.stringify(b.value);let x=!1;if(b.value!=null&&f===k&&(x=!0),x){c={status:!1,key:b.key,option:l};return}}this.setOption(e,l),c={status:!0,key:e,option:l};}catch(f){console.log(f),c={status:false,key:e,option:l};}finally{i.isWaitPress=false,o.removeListen(),i.currentWaitEnterPressInstanceHandler=null,n(c);}});i.currentWaitEnterPressInstanceHandler=null,i.currentWaitEnterPressInstanceHandler=()=>{i.isWaitPress=false,o.removeListen();};})}cancelEnterShortcutKeys(){typeof this.currentWaitEnterPressInstanceHandler=="function"&&this.currentWaitEnterPressInstanceHandler();}initGlobalKeyboardListener(e,i){let n=this.getLocalAllOptions();if(!n.length){a.warn("没有设置快捷键");return}const o=this;function r(l,c){g.listenKeyboard(l,"keydown",(f,p,v,b)=>{if(o.isWaitPress)return;i!=null&&i.isPrevent&&m.preventEvent(b),n=o.getLocalAllOptions();let k=n.findIndex(x=>{let M=x.value,T={keyName:f,keyValue:p,ohterCodeList:v};if(JSON.stringify(M)===JSON.stringify(T))return x});if(k!=-1){let x=n[k];x.key in c&&(a.info(["调用快捷键",x]),c[x.key].callback());}},{capture:!!(i!=null&&i.capture)});}let d={},s={};Object.keys(e).forEach(l=>{let c=e[l];(c.target==null||typeof c.target=="string"&&c.target==="")&&(c.target="window"),c.target==="window"?Reflect.set(d,l,c):Reflect.set(s,l,c);}),r(window,d),g.ready(()=>{Object.keys(s).forEach(async l=>{let c=s[l];if(typeof c.target=="string")m.waitNode(c.target,1e4).then(f=>{if(!f)return;let p={};Reflect.set(p,l,c),r(f,p);});else if(typeof c.target=="function"){let f=await c.target();if(f==null)return;let p={};Reflect.set(p,l,c),r(f,p);}else {let f={};Reflect.set(f,l,c),r(c.target,f);}});});}}const be={shortCut:new Je("live-short-cut"),$data:{blockChatRoom:false},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-live-block-chatroom":{target:"window",callback(){a.info("快捷键 ==> 【屏蔽】聊天室");let t=u.getValue("live-shieldChatRoom");u.setValue("live-shieldChatRoom",!t);}},"dy-live-shieldGiftEffects":{target:"window",callback:()=>{a.info("快捷键 ==> 【屏蔽】礼物特效");let t=u.getValue("live-shieldGiftEffects");u.setValue("live-shieldGiftEffects",!t);}},"dy-live-shortcut-changeVideoMuted":{target:"window",callback(){a.info("触发快捷键 ==> 切换静音状态"),ne("video").forEach(t=>{let e=!t.muted;a.success(`切换video标签的静音状态为 ${e}`),t.muted=e;});}}}}},de={auto:{label:"自动",sign:0},origin:{label:"潮汐海灵",sign:5},uhd:{label:"蓝光",sign:4},hd:{label:"超清",sign:3},sd:{label:"高清",sign:2},ld:{label:"标清",sign:1}},bt={init(){mt.init(),be.init(),u.execMenu("live-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),u.execMenu("live-danmu-shield-rule-enable",()=>{pt.filterDanmu();}),u.execMenu("live-chooseQuality",t=>{t!=="auto"&&this.chooseQuality(t);}),u.execMenu("live-unlockImageQuality",()=>{this.unlockImageQuality();}),u.execMenuOnce("live-waitToRemovePauseDialog",()=>{this.waitToRemovePauseDialog();}),u.execMenu("live-pauseVideo",()=>{this.pauseVideo();}),u.execMenu("live-bgColor-enable",()=>{u.execMenuOnce("live-changeBackgroundColor",t=>this.changeBackgroundColor(t));}),u.execMenuOnce("live-parsePlayerInstance",()=>{gt.initMenu();});},autoEnterElementFullScreen(){a.info("自动进入网页全屏"),m.waitNode('xg-icon[classname] > div > div:has(path[d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(t=>{t.click();});},chooseQuality(t="origin"){Qe.waitReactPropsToSet('xg-inner-controls xg-right-grid >div:has([data-e2e="quality-selector"])',"reactProps",{check(e){var i,n,o,r,d,s,l,c,f;return typeof((r=(o=(n=(i=e==null?undefined:e.children)==null?undefined:i.props)==null?undefined:n.children)==null?undefined:o.props)==null?undefined:r.qualityHandler)=="object"&&typeof((f=(c=(l=(s=(d=e==null?undefined:e.children)==null?undefined:d.props)==null?undefined:s.children)==null?undefined:l.props)==null?undefined:c.qualityHandler)==null?undefined:f.getCurrentQualityList)=="function"},set(e){let i=e.children.props.children.props.qualityHandler,n=i.getCurrentQualityList();if(n.includes(t))i.setCurrentQuality(t),a.success("成功设置画质为【"+t+"】");else {let o=t;C.error("当前直播没有【"+o+"】画质，自动选择最高画质"),n.sort((r,d)=>de[r]?de[d]?de[r].sign-de[d].sign:(a.error("画质【"+d+"】不存在"),0):(a.error("画质【"+r+"】不存在"),0)),o=n[n.length-1],i.setCurrentQuality(t),a.success("成功设置画质为【"+t+"】");}}});},unlockImageQuality(){a.info("解锁画质选择"),g.on(document,"click",'div[data-e2e="quality-selector"] > div',function(t){var i,n;m.preventEvent(t);let e=t.target;try{let o=m.getReactObj(e),r=(i=o==null?void 0:o.reactFiber)==null?void 0:i.key,d=e.closest("div[data-index]"),s=m.getReactObj(d),l=(n=s==null?void 0:s.reactProps)==null?void 0:n.children.ref.current;a.info("当前选择的画质: "+r),a.info(["所有的画质: ",l.getCurrentQualityList()]),l.setCurrentQuality(r);}catch(o){a.error(o),C.error("切换画质失败");}},{capture:true});},waitToRemovePauseDialog(){a.info("监听【长时间无操作，已暂停播放】弹窗");let t=(e,i)=>{var o,r,d,s,l,c;let n=g.text(e);if(n.includes("长时间无操作")&&n.includes("暂停播放")){C.info(`检测${i}：出现【长时间无操作，已暂停播放】弹窗`,{consoleLogContent:true});let f=m.getReactObj(e);if(typeof f.reactContainer=="object"){let p=m.queryProperty(f.reactContainer,v=>{var b,k;return typeof v.onClose=="function"?{isFind:true,data:v.onClose}:typeof((b=v==null?undefined:v.memoizedProps)==null?undefined:b.onClose)=="function"?{isFind:true,data:(k=v==null?undefined:v.memoizedProps)==null?undefined:k.onClose}:{isFind:false,data:v.child}})||((c=(l=(s=(d=(r=(o=f==null?undefined:f.reactContainer)==null?undefined:o.memoizedState)==null?undefined:r.element)==null?undefined:d.props)==null?undefined:s.children)==null?undefined:l.props)==null?undefined:c.onClose);typeof p=="function"&&(C.success(`检测${i}：调用函数关闭弹窗`,{consoleLogContent:true}),p());}}};g.ready(()=>{m.mutationObserver(document.body,{config:{subtree:true,childList:true},callback(){ne("body > div[elementtiming='element-timing']").forEach(e=>{t(e,"1");}),ne('body > div:not([id="root"])').forEach(e=>{t(e,"2");});}});});},pauseVideo(){a.info("禁止自动播放视频(直播)"),m.waitNode('.basicPlayer[data-e2e="basicPlayer"] video').then(t=>{g.on(t,"play",()=>{t.pause();},{capture:true,once:true}),t.autoplay=false,t.pause();});},changeBackgroundColor(t){return a.info("修改视频背景颜色"),w(`
		div[id^="living_room_player_container"] > div,
		#chatroom > div{
			background: ${t};
		}	
		`)}},ye=function(t,e,i,n,o,r,d,s,l){return {text:t,type:"button",description:e,buttonIcon:n,buttonIsRightIcon:o,buttonIconIsLoading:r,buttonType:d,buttonText:i,callback(f){typeof s=="function"&&s(f);},afterAddToUListCallBack:l}},le=function(t,e,i,n,o,r="default",d){let s=o,l=()=>d.getShowText(i,s),c=ye(t,e,l,"keyboard",false,false,r,async f=>{var b;let v=(b=f.target.closest(".pops-panel-button"))==null?undefined:b.querySelector("span");if(d.isWaitPress){C.warning("请先执行当前的录入操作");return}if(d.hasOptionValue(i))d.emptyOption(i),C.success("清空快捷键");else {let k=C.loading("请按下快捷键...",{showClose:true,onClose(){d.cancelEnterShortcutKeys();}}),{status:x,option:M,key:T}=await d.enterShortcutKeys(i);k.close(),x?(a.success(["成功录入快捷键",M]),C.success("成功录入")):C.error(`快捷键 ${d.translateKeyboardValueToButtonText(M)} 已被 ${T} 占用`);}v.innerHTML=l();});return c.attributes={},Reflect.set(c.attributes,je,()=>false),c},kt={id:"panel-config-live",title:"直播",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[Z("清晰度","live-chooseQuality","origin",Object.keys(de).map(t=>{let e=de[t];return {value:t,text:e.label}}),undefined,"自行选择清晰度"),h("解锁画质选择","live-unlockImageQuality",true,undefined,"未登录的情况下选择原画实际上是未登录的情况下最高选择的画质"),h("自动进入网页全屏","live-autoEnterElementFullScreen",false,undefined,"网页加载完毕后自动点击网页全屏按钮进入全屏"),h("监听并关闭【长时间无操作，已暂停播放】弹窗","live-waitToRemovePauseDialog",true,undefined,"自动监听并检测弹窗"),h("禁止自动播放","live-pauseVideo",false,undefined,"暂停直播播放"),h("解析直播信息","live-parsePlayerInstance",true,undefined,"开启后将在油猴菜单中新增菜单【⚙ PlayerInstance】，可解析当前的直播信息"),h("禁用双击点赞","dy-live-disableDoubleClickLike",false,undefined,"禁止直播视频区域双击点赞")]},{text:"视频区域背景色",type:"forms",forms:[h("启用","live-bgColor-enable",false,undefined,"自定义视频背景色"),{type:"own",attributes:{"data-key":"live-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(t){let e=g.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),i=g.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");n.value=u.getValue("live-changeBackgroundColor");let o=g.createElement("style");return g.append(document.head,o),g.on(n,["input","propertychange"],r=>{a.info("选择颜色："+n.value),o.innerHTML=`
											div[id^="living_room_player_container"] > div,
											#chatroom > div{
												background: ${n.value};
											}
											`,u.setValue("live-changeBackgroundColor",n.value);}),t.appendChild(e),t.appendChild(i),t}}]}]},{text:"弹幕过滤器",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("启用","live-danmu-shield-rule-enable",false,undefined,"启用自定义的弹幕过滤规则"),h("【屏蔽】送礼信息","live-danmu-shield-gift",false,undefined,""),h("【屏蔽】福袋口令","live-danmu-shield-lucky-bag",false,undefined,""),ye("初始化规则","解析并重置规则","重置",undefined,false,false,"primary",()=>{ve.init(),C.success("更新完毕");}),{type:"own",getLiElementCallBack(t){let e=g.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=e.querySelector("textarea");return i.value=ve.get(),g.on(i,["input","propertychange"],m.debounce(function(){ve.set(i.value);},1e3)),t.appendChild(e),t}}]}]},{text:"自定义快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[le("【屏蔽】聊天室","","dy-live-block-chatroom",undefined,"点击录入快捷键",undefined,be.shortCut),le("【屏蔽】礼物特效","","dy-live-shieldGiftEffects",undefined,"点击录入快捷键",undefined,be.shortCut),le("切换静音状态","切换video标签的muted属性","dy-live-shortcut-changeVideoMuted",undefined,"点击录入快捷键",undefined,be.shortCut)]}]},{type:"deepMenu",text:"快捷键禁用",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text,forms:[h("刷新","dy-live-refresh",false,undefined,"E"),h("屏幕旋转","dy-live-screenRotation",false,undefined,"D"),h("开启小窗模式","dy-live-enableSmallWindowMode",false,undefined,"U")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-视频区域内",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】顶栏信息","live-shieldTopToolBarInfo",false,undefined,"屏蔽元素，包括直播作者、右侧的礼物展馆"),h("【屏蔽】底部的礼物栏","live-shieldGiftColumn",false,undefined,"屏蔽元素"),h("【屏蔽】礼物特效","live-shieldGiftEffects",false,undefined,"屏蔽元素"),h("【屏蔽】福袋","live-shieldLucky",false,undefined,"屏蔽元素"),h("【屏蔽】弹幕","live-shieldDanmuku",false,undefined,"屏蔽元素"),h("【屏蔽】小黄车","live-shielYellowCar",false,undefined,"屏蔽元素")]},{type:"forms",text:"右键菜单",forms:[h("【屏蔽】下载客户端","dy-live-blockVideoRightMenu-downloadClient",true,undefined,"屏蔽右键菜单项")]}]},{text:"布局屏蔽-聊天室",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】聊天室","live-shieldChatRoom",false,undefined,"屏蔽元素"),h("【屏蔽】贵宾席","live-shielChatRoomVipSeats",false,undefined,"屏蔽元素"),h("【屏蔽】用户等级图标","dy-live-shieldUserLevelIcon",false,undefined,"屏蔽元素"),h("【屏蔽】VIP图标","dy-live-shieldUserVIPIcon",false,undefined,"屏蔽元素"),h("【屏蔽】粉丝牌","dy-live-shieldUserFansIcon",false,undefined,"屏蔽元素"),h("【屏蔽】信息播报","dy-live-shieldMessage",false,undefined,"底部滚动播报的的xxx来了，xxx给主播点赞")]}]}]}]},Ct={isVerticalScreen(){return !window.screen.orientation.type.includes("landscape")}},S={isLive(){return window.location.hostname==="live.douyin.com"||this.isFollowLive()||this.isRootLive()},isFollowLive(){return this.isIndex()&&window.location.pathname.startsWith("/follow/live/")},isRootLive(){return this.isIndex()&&window.location.pathname.startsWith("/root/live/")},isIndex(){return window.location.hostname==="www.douyin.com"},isRecommend(){let t=new URLSearchParams(window.location.search);return this.isIndex()&&t.has("recommend")},isSearch(){return this.isIndex()&&(window.location.pathname.startsWith("/search/")||this.isRootSearch())},isRootSearch(){return this.isIndex()&&window.location.pathname.startsWith("/root/search/")},isChannel(){return this.isIndex()&&window.location.pathname.startsWith("/channel/")},isDiscover(){return this.isIndex()&&window.location.pathname.startsWith("/discover/")},isUser(){return this.isIndex()&&window.location.pathname.startsWith("/user/")},isVideo(){return this.isIndex()&&window.location.pathname.startsWith("/video/")},isNote(){return this.isIndex()&&window.location.pathname.startsWith("/note/")}},xt=`/* 右侧工具栏放大 */\r
.basePlayerContainer .positionBox {\r
	bottom: 80px !important;\r
	padding-right: 5px !important;\r
	scale: unset !important;\r
	transform: scale3d(1.12, 1.12, 1.12) !important;\r
}\r
/* 右侧工具栏的svg再放大 */\r
.basePlayerContainer .positionBox svg {\r
	transform: scale3d(1.12, 1.12, 1.12);\r
}\r
/* 重置关注按钮的scale */\r
.basePlayerContainer\r
	.positionBox\r
	.dy-tip-container\r
	div[data-e2e="feed-follow-icon"]\r
	svg {\r
	scale: unset !important;\r
}\r
/* 设备处于横向方向，即宽度大于高度。 */\r
@media screen and (orientation: landscape) {\r
	/* 右侧工具栏放大 */\r
	.basePlayerContainer .positionBox {\r
		/*transform: scale(0.95) !important;\r
		bottom: 42px !important;*/\r
		padding-right: 10px !important;\r
	}\r
}\r
/* 该设备是纵向的，即高度大于或等于宽度 */\r
@media screen and (orientation: portrait) {\r
	/* /video/xxx页面 */\r
	/* 点赞、评论、分享偏移 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.basePlayerContainer\r
		.positionBox {\r
		padding-right: 30px !important;\r
	}\r
	/* 底部工具栏右侧的按钮 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.xgplayer.xgplayer-pc\r
		.xg-right-grid {\r
		margin-right: 35px !important;\r
	}\r
	/* 评论区全屏 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]),\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]) {\r
		width: 100vw !important;\r
	}\r
}\r
\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#slidelist {\r
		width: 100vw;\r
		height: 100vh;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: 150px;\r
		padding-right: 0;\r
		max-width: unset;\r
		flex: 1;\r
	}\r
	/* 搜索框获取焦点时自动放大宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]:focus) {\r
		width: 100vw;\r
		width: 100dvw;\r
	}\r
	/* 去除设置min-width超出浏览器宽度的问题 */\r
	body {\r
		min-width: 100% !important;\r
	}\r
	/* 去除设置width导致顶部工具栏超出浏览器宽度的问题 */\r
	#douyin-right-container #douyin-header {\r
		width: 100%;\r
	}\r
	/* 去除设置 */\r
	#douyin-right-container #douyin-header > div[data-click="doubleClick"] {\r
		min-width: 100%;\r
	}\r
}\r
`,wt={init(){u.execMenuOnce("dy-video-shieldUserCommentToolBar",()=>this.shieldUserCommentToolBar()),u.execMenuOnce("dy-video-shieldUserCommentEveryOneAllSearch",()=>this.shieldUserCommentEveryOneAllSearch());},shieldUserCommentToolBar(){return a.info("【屏蔽】评论工具栏"),[y.addBlockCSS(".comment-input-container")]},shieldUserCommentEveryOneAllSearch(){return a.info("【屏蔽】大家都在搜"),[y.addBlockCSS(".comment-header-with-search")]}},St={init(){u.execMenuOnce("shieldBottomVideoToolBar",()=>this.shieldBottomVideoToolBar()),u.execMenuOnce("dy-video-bottom-shieldVideoInfoWrap",()=>this.shieldVideoInfoWrap()),u.execMenuOnce("shieldBottomVideoToolbarDanmuContainer",()=>this.shieldBottomVideoToolbarDanmuContainer());},shieldBottomVideoToolBar(){return a.info("【屏蔽】底部视频工具栏"),[y.addBlockCSS("xg-controls.xgplayer-controls"),w(`
			#sliderVideo[data-e2e="feed-active-video"] div:has( > div > #video-info-wrap),
			div:has( > div > pace-island > #video-info-wrap ),
			xg-video-container.xg-video-container,
			div:has(> #video-info-wrap){
				bottom: 0 !important;
			}`)]},shieldVideoInfoWrap(){return a.info("【屏蔽】视频信息"),[y.addBlockCSS("#video-info-wrap")]},shieldBottomVideoToolbarDanmuContainer(){return a.info("【屏蔽】底部视频工具栏的弹幕容器"),[y.addBlockCSS('xg-controls xg-inner-controls .danmakuContainer[data-e2e="danmaku-container"]')]}},_t={init(){u.execMenuOnce("shieldPlaySwitchButton",()=>this.shieldPlaySwitchButton()),u.execMenuOnce("shieldAuthorAvatar",()=>this.shieldAuthorAvatar()),u.execMenuOnce("shieldLikeButton",()=>this.shieldLikeButton()),u.execMenuOnce("shieldCommentButton",()=>this.shieldCommentButton()),u.execMenuOnce("shieldCollectionButton",()=>this.shieldCollectionButton()),u.execMenuOnce("shieldSharenButton",()=>this.shieldSharenButton()),u.execMenuOnce("shieldRelatedRecommendationsButton",()=>this.shieldRelatedRecommendationsButton()),u.execMenuOnce("shieldMoreButton",()=>this.shieldMoreButton());},shieldPlaySwitchButton(){return a.info("【屏蔽】切换播放"),[y.addBlockCSS('.positionBox  .xgplayer-playswitch[data-state="normal"]',"div.xgplayer-playswitch",".xgplayer-playswitch"),w(`
			div[data-e2e="slideList"]{
				/* 修复屏蔽后的视频宽度占据 */
				padding: 0px !important;
			}
			`)]},shieldAuthorAvatar(){return a.info("【屏蔽】作者头像"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-avatar"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-avatar"])')]},shieldLikeButton(){return a.info("【屏蔽】点赞"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-digg"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-player-digg"])')]},shieldCommentButton(){return a.info("【屏蔽】评论"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="feed-comment-icon"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="feed-comment-icon"])')]},shieldCollectionButton(){return a.info("【屏蔽】收藏"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-collect"])','.basePlayerContainer div[data-e2e="video-player-collect"][data-e2e-state="video-player-no-collect"]')]},shieldSharenButton(){return a.info("【屏蔽】分享"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-share"])','.basePlayerContainer div:has(>div[data-e2e="video-player-share"])')]},shieldRelatedRecommendationsButton(){return a.info("【屏蔽】看相关"),[y.addBlockCSS('div.dy-tip-container:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','div.dy-tip-container:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 0 0-8 8v4a8 8 0 0 0 8 8h8a8 8 0 0 0 8-8v-4a8 8 0 0 0-8-8h-8zm8.5 10.866a1 1 0 0 0 0-1.732l-6-3.464a1 1 0 0 0-1.5.866v6.928a1 1 0 0 0 1.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])'),w(`
				/* 修复分享的悬浮框距离底部的高度 */
				[data-e2e="video-player-share"]+div[data-e2e="video-share-container"] > div:first-child{
					bottom: 0px !important;
				}
			`)]},shieldMoreButton(){return a.info("【屏蔽】更多"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-play-more"])','.basePlayerContainer div[data-e2e="video-play-more"]'),w(`
				/* 修复分享的悬浮框距离底部的高度 */
				[data-e2e="video-player-share"]+div[data-e2e="video-share-container"] > div:first-child{
					bottom: 0px !important;
				}
			`)]}},Ie={init(){u.execMenuOnce("shieldRightExpandCommentButton",()=>this.shieldRightExpandCommentButton()),u.execMenuOnce("shieldSearchFloatingBar",()=>this.shieldSearchFloatingBar()),u.execMenuOnce("shieldCloseFullScreenButton",()=>this.shieldCloseFullScreenButton()),u.execMenuOnce("dy-video-blockShopInfo",()=>this.blockShopInfo()),St.init(),_t.init(),wt.init();},shieldRightExpandCommentButton(){return a.info("【屏蔽】右侧的展开评论按钮"),[y.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] > div > div > button[type="button"]','.playerContainer button[type=button] svg > g[filter] > path[d="M21.316 29.73a1.393 1.393 0 01-1.97 0l-5.056-5.055a1.393 1.393 0 010-1.97l.012-.011 5.044-5.045a1.393 1.393 0 011.97 1.97l-4.07 4.071 4.07 4.071a1.393 1.393 0 010 1.97z"]'),w(`
			.basePlayerContainer .positionBox{
				padding-right: 20px !important;
			}`)]},shieldSearchFloatingBar(){a.info("【屏蔽】搜索悬浮栏");let t=[];return t.push(y.addBlockCSS("#slideMode + div",'.playerContainer .slider-video>div>div:has([data-e2e="searchbar-button"])')),(S.isSearch()||S.isDiscover())&&t.push(y.addBlockCSS('#douyin-right-container> div>div>div> div:has( div> input[data-e2e="searchbar-input"])')),t},shieldCloseFullScreenButton(){a.info("【屏蔽】网页全屏关闭按钮");let t=[];return t.push(y.addBlockCSS('.playerContainer .slider-video>div>div:has(path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),(S.isSearch()||S.isDiscover())&&t.push(y.addBlockCSS('#douyin-right-container div>div:has(>svg>path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),t},blockShopInfo(){return a.info("【屏蔽】购物信息"),y.addBlockCSS(".xgplayer-shop-anchor")}};class Mt{constructor(e){P(this,"isBacking",false);P(this,"config");this.config=e,this.enterGestureBackMode=this.enterGestureBackMode.bind(this),this.quitGestureBackMode=this.quitGestureBackMode.bind(this),this.popStateEvent=this.popStateEvent.bind(this),(typeof this.config.backDelayTime!="number"||isNaN(this.config.backDelayTime))&&(this.config.backDelayTime=150),this.config.win==null&&(this.config.win=self);}popStateEvent(e){m.preventEvent(e),!this.isBacking&&this.quitGestureBackMode(true);}enterGestureBackMode(){a.success("进入手势模式");let e=this.config.hash;e.startsWith("#")||(e.startsWith("/")||(e="/"+e),e="#"+e),this.config.useUrl&&(e=this.config.win.location.origin+this.config.win.location.pathname+this.config.win.location.search+e),this.config.win.history.pushState({},"",e),a.success("监听popstate事件"),g.on(this.config.win,"popstate",this.popStateEvent,{capture:true});}async quitGestureBackMode(e=false){this.isBacking=true,a.success("退出手势模式"),typeof this.config.beforeHistoryBackCallBack=="function"&&this.config.beforeHistoryBackCallBack(e);let i=Date.now()+1e3*5;for(;;){if(Date.now()>i){a.error("未知情况，history.back()失败，无法退出手势模式");break}if(this.config.win.location.hash.endsWith(this.config.hash))a.info("history.back()"),this.config.win.history.back(),await m.sleep(this.config.backDelayTime||150);else break}a.success("移除popstate事件"),g.off(this.config.win,"popstate",this.popStateEvent,{capture:true}),this.isBacking=false,typeof this.config.afterHistoryBackCallBack=="function"&&this.config.afterHistoryBackCallBack(e);}}const Ze={videoCommentDrawer:"videoCommentDrawer"},Bt=()=>{let t=Object.values(Ze).find(e=>globalThis.location.hash.endsWith(e));t&&(globalThis.location.hash="",a.success("发现残留的手势返回hash，已清理 ==> "+t));},Lt={init(){Tt.init(),Et.init();}},Tt={init(){u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-enterUserHome",()=>this.blockEnterUserHomeMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-follow",()=>this.blockFollowMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-addLike",()=>this.blockAddLikeMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-comment",()=>this.blockCommentMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-collect",()=>this.blockCollectMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-share",()=>this.blockShareMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-seeCorrelation",()=>this.blockSeeCorrelationMouseHoverTip());},blockEnterUserHomeMouseHoverTip(){return a.info("禁用进入作者主页按钮的悬浮提示"),y.addBlockCSS(' div > div:has( >a[data-e2e="video-avatar"]) + .semi-portal')},blockFollowMouseHoverTip(){return a.info("禁用关注按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="feed-follow-icon"]  .semi-portal')},blockAddLikeMouseHoverTip(){return a.info("禁用点赞按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-digg"] + .semi-portal')},blockCommentMouseHoverTip(){return a.info("禁用评论按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="feed-comment-icon"] + .semi-portal')},blockCollectMouseHoverTip(){return a.info("禁用收藏按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-collect"] + .semi-always-dark')},blockShareMouseHoverTip(){return a.info("禁用分享按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-share-container"]')},blockSeeCorrelationMouseHoverTip(){return a.info("禁用看相关推荐按钮的悬浮提示"),y.addBlockCSS('div:has(+[data-e2e="video-play-more"]) .semi-portal')}},Et={init(){u.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-automaticBroadcast",()=>this.blockAutomaticBroadcast()),u.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-clearScreen",()=>this.blockClearScreenMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-watchLater",()=>this.blockWatchLaterMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-pageFullScreen",()=>this.blockPageFullScreenMouseHoverTip()),u.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-fullScreen",()=>this.blockFullScreenMouseHoverTip());},blockAutomaticBroadcast(){return a.info("禁用自动连播按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-auto-play"] + .xgTips')},blockClearScreenMouseHoverTip(){return a.info("禁用清屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-immersive-switch-setting .xgTips")},blockWatchLaterMouseHoverTip(){return a.info("禁用稍后再看按钮的悬浮提示"),y.addBlockCSS(".xgplayer-watch-later .xgTips",".xgplayer-watch-later-item + .xgTips")},blockPageFullScreenMouseHoverTip(){return a.info("禁用网页全屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-page-full-screen .xgTips")},blockFullScreenMouseHoverTip(){return a.info("禁用全屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-fullscreen .xg-tips")}},ie={init(){Ie.init(),u.onceExec("dy-short-cut",()=>{G.init();}),Lt.init(),u.execMenuOnce("changeCommentToBottom",()=>{ie.changeCommentToBottom();}),u.execMenuOnce("fullScreen",()=>this.fullScreen()),u.execMenuOnce("parseVideo",()=>{ie.parseVideo();}),u.execInheritMenuOnce("autoEnterElementFullScreen","search-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();},(t,e)=>{if(S.isSearch()&&t){if(e==1)return  true;if(e==0)return  false}}),u.execMenuOnce("dy-video-doubleClickEnterElementFullScreen",()=>{this.doubleClickEnterElementFullScreen();}),u.execMenu("dy-video-bgColor-enable",()=>{u.execMenuOnce("dy-video-changeBackgroundColor",t=>this.changeBackgroundColor(t));}),u.execMenuOnce("repairProgressBar",()=>{u.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();});}),u.execMenuOnce("dy-video-gestureBackCloseComment",()=>{this.gestureBackCloseComment();}),u.execMenuOnce("dy-video-waitToRemovePauseDialog",()=>{this.waitToRemovePauseDialog();}),g.ready(()=>{ie.chooseQuality(u.getValue("chooseVideoDefinition")),u.execMenuOnce("mobileMode",()=>this.mobileMode()),u.execMenuOnce("dy-video-titleInfoAutoHide",()=>{this.titleInfoAutoHide();}),u.execMenuOnce("dy-video-videoControlsAutoHide",()=>{this.videoControlsAutoHide();}),u.execMenuOnce("dy-video-rightToolBarAutoHide",()=>{this.rightToolBarAutoHide();});});},fullScreen(){a.info("全屏");let t=[];return t.push(y.addBlockCSS(".slider-video .positionBox","#video-info-wrap","xg-controls.xgplayer-controls")),t.push(Ie.shieldSearchFloatingBar()),t.push(w(`
			/* 视频全屏 */
			xg-video-container.xg-video-container{
				bottom: 0px !important;
			}
        `)),t},autoEnterElementFullScreen(t=false){if(t){let e=new KeyboardEvent("keydown",{bubbles:true,cancelable:true,key:"Y",code:"KeyY",keyCode:89,which:89});document.dispatchEvent(e);}else m.waitNode('xg-icon[data-e2e="xgplayer-page-full-screen"] .xgplayer-icon').then(e=>{a.success("自动进入网页全屏"),e.click();});},doubleClickEnterElementFullScreen(){let t=false;a.info("注册双击进入网页全屏事件"),[".newVideoPlayer","#sliderVideo"].forEach(i=>{g.on(document,"click",i,n=>{t?(t=false,ie.autoEnterElementFullScreen(true)):(t=true,setTimeout(()=>{t=false;},250));});});},changeCommentToBottom(){a.info("评论区修改为底部");let t="data-vertical-screen";function e(){Ct.isVerticalScreen()?(a.success("自动判断: 竖屏"),document.documentElement.setAttribute(t,"true")):(a.success("自动判断: 横屏"),document.documentElement.removeAttribute(t));}e(),w(`
		html[${t}] #sliderVideo[data-e2e="feed-video"] #videoSideBar #relatedVideoCard,
		html[${t}] #sliderVideo[data-e2e="feed-video"] #videoSideCard #relatedVideoCard{
			display: none !important;
		}
		/* 左侧的视频宽度撑满 */
		html[${t}] #sliderVideo[data-e2e] .playerContainer,
		html[${t}] #slideMode[data-e2e] .playerContainer{
			width: 100% !important;
		}
		/* 右侧的评论区宽度撑满，position使用absolute */
		html[${t}] #sliderVideo[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${t}] #slideMode[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${t}] #sliderVideo[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard),
		html[${t}] #slideMode[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard){
			width: 100%;
			height: 75%;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.9);
			transition: height .15s linear !important;
			position: absolute;
		}
		`),u.execMenuOnce("douyin-video-autoCheckChangeCommentToBottom",()=>{g.on(window,"resize",e);});},chooseQuality(t=0){a.info("选择视频清晰度: "+t);let e="MANUAL_SWITCH",i=["adapt_lowest_4_1","adapt_lowest_1440_1","normal_1080_0","normal_540_0","low_720_0","normal_720_0","low_540_0","lower_540_0","adapt_low_540_0","adapt_lowest_1080_1","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],o=[{clarityReal:i,done:1,gearClarity:"20",gearName:"超清 4K",gearType:-2,qualityType:72},{clarityReal:i,done:1,gearClarity:"10",gearName:"超清 2K",gearType:-1,qualityType:7},{clarityReal:i,done:1,gearClarity:"5",gearName:"高清 1080P",gearType:1,qualityType:2},{clarityReal:i,done:1,gearClarity:"4",gearName:"高清 720P",gearType:2,qualityType:15},{clarityReal:i,done:1,gearClarity:"3",gearName:"标清 540P",gearType:3,qualityType:21},{clarityReal:i,done:1,gearClarity:"2",gearName:"极速",gearType:4,qualityType:21},{clarityReal:i,done:1,gearClarity:"0",gearName:"智能",gearType:0}].find(d=>d.gearType===t);function r(d){_.sessionStorage.setItem(e,d);}if(o){let d=JSON.stringify(o),s=setInterval(()=>{r(d);},250);setTimeout(()=>{clearInterval(s);},10*1e3),a.success("设置当前视频的清晰度: "+t);}else a.error("该清晰度不存在: "+t);},chooseVideoRate(t="1"){let e="player_playbackratio";function i(n="1"){_.sessionStorage.setItem(e,n),ne("xg-icon.xgplayer-playback-setting").forEach(o=>{var d,s,l,c;let r=m.getReactObj(o).reactContainer;(c=(l=(s=(d=r==null?undefined:r.memoizedState)==null?undefined:d.element)==null?undefined:s.props)==null?undefined:l.xgCase)==null||c.updatePlayBackRatio();});}i(t);},parseVideo(){a.info("让下载按钮变成解析视频");function t(e){let i="";e.forEach(n=>{i+=`
          		<div class="douyin-video-link-item"><a href="${n}" target="_blank">${n}</a></div>
            	`;}),i=`<div class="douyin-video-link-container">${i}</div>`,A.alert({title:{text:"视频解析",position:"center"},content:{text:i,html:true},mask:{enable:true,clickEvent:{toClose:true}},width:window.innerWidth>550?"550px":"88vw",height:window.innerHeight>550?"550px":"80vh",drag:true,dragLimit:true,style:`
                .douyin-video-link-container{

                }
                .douyin-video-link-item{
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    margin: 10px;
                }
                .douyin-video-link-item a{

                }
                `});}g.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button + div',function(e){var o,r;let i=e.target,n=(o=m.getReactObj(i.parentElement))==null?undefined:o.reactFiber;if(!n){a.error("获取rectFiber属性失败"),C.error("获取rectFiber属性失败");return}try{let d=n.return.memoizedProps.awemeInfo;if(!d){a.error("获取awemeInfo属性失败"),C.error("获取awemeInfo属性失败");return}a.info(["解析的awemeInfo: ",d]);let s=[],l=d.video.playAddr;l!=null&&Array.isArray(l)&&(s=s.concat(l.map(k=>k.src)));let c=d.video.playAddrH265;c!=null&&Array.isArray(c)&&(s=s.concat(c.map(k=>k.src)));let f=d.video.playApi;typeof f=="string"&&s.push(f);let p=d.video.playApiH265;typeof p=="string"&&s.push(p);let v=(r=d==null?void 0:d.download)==null?void 0:r.urlList;if(v!=null&&Array.isArray(v)&&(s=s.concat(v)),!s.length){a.error("未获取到视频的有效链接信息"),C.error("未获取到视频的有效链接信息");return}let b=[...new Set(s)];b.length!=s.length&&(a.info("去重前视频链接数量: "+s.length),a.info("去重后视频链接数量: "+b.length)),b=b.map(k=>(k.startsWith("http:")&&(k=k.replace("http:","")),k)),t(b);}catch(d){a.error(["解析视频失败",d]),C.error("解析视频失败");}},{capture:true});},mobileMode(){a.info("启用手机模式");let t=[];return tt.initialScale(),t.push(y.addBlockCSS("img#douyin-temp-sidebar"),w(xt)),u.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();}),t},repairVideoProgressBar(){a.info("修复进度条按钮"),w(`
		/* 禁止触发touch事件，因为会影响到按钮点击不到 */
		xg-outer,
		xg-inners {
			pointer-events: none;
		}
		`),g.on(document,"touchstart","xg-progress",t=>{let i=t.target.querySelector("xg-outer");i&&(i.style.height="6px");},{capture:true}),g.on(document,"touchend","xg-progress",t=>{let i=t.target.querySelector("xg-outer");i&&(i.style.height="");},{capture:true});},changeBackgroundColor(t){return a.info("修改视频背景颜色"),w(`
		#sliderVideo > div,
		/* 推荐的直播间背景 */
		xgmask,
		/* 用户主页的视频 */
		.basePlayerContainer .imgBackground{
			background: ${t}  !important;
		}
		`)},titleInfoAutoHide(){a.info("自动隐藏视频标题");let t=new m.LockFunction(()=>{let e=[];e.push(I('#sliderVideo[data-e2e="feed-active-video"] #video-info-wrap:not([data-is-inject-mouse-hide])')),e.push(I('#slideMode[data-e2e="feed-active-video"] #video-info-wrap:not([data-is-inject-mouse-hide])')),e.length&&e.forEach(i=>{if(!i)return;i.setAttribute("data-is-inject-mouse-hide","");let n=setTimeout(()=>{g.trigger(i,"mouseleave");},u.getValue("dy-video-titleInfoAutoHide-delayTime"));g.on(i,["mouseenter","touchstart"],o=>{clearTimeout(n),g.css(i,"opacity","");}),g.on(i,["mouseleave","touchend"],o=>{g.css(i,"opacity",0);});});});m.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});},videoControlsAutoHide(){a.info("自动隐藏视频控件");let t=new m.LockFunction(()=>{let e=[];e.push(I('#sliderVideo[data-e2e="feed-active-video"] xg-controls.xgplayer-controls:not([data-is-inject-mouse-hide])'),I('#slideMode[data-e2e="feed-active-video"] xg-controls.xgplayer-controls:not([data-is-inject-mouse-hide])')),e.length&&e.forEach(i=>{if(!i)return;i.setAttribute("data-is-inject-mouse-hide","");let n=setTimeout(()=>{g.trigger(i,"mouseleave");},u.getValue("dy-video-videoControlsAutoHide-delayTime"));g.on(i,["mouseenter","touchstart"],o=>{clearTimeout(n),g.css(i,"opacity","");}),g.on(i,["mouseleave","touchend"],o=>{g.css(i,"opacity",0);});});});m.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});},rightToolBarAutoHide(){a.info("自动隐藏右侧工具栏"),w(`
			.positionBox{
				transition: opacity 0.5s;
			}
		`);let t=new m.LockFunction(()=>{let e=[];e.push(I('#sliderVideo[data-e2e="feed-active-video"] .positionBox:not([data-is-inject-mouse-hide])')),e.push(I('#slideMode[data-e2e="feed-active-video"] .positionBox:not([data-is-inject-mouse-hide])')),e.length&&e.forEach(i=>{if(!i)return;i.setAttribute("data-is-inject-mouse-hide","");let n=setTimeout(()=>{g.trigger(i,"mouseleave");},u.getValue("dy-video-titleInfoAutoHide-delayTime"));g.on(i,["mouseenter","touchstart"],o=>{clearTimeout(n),g.css(i,"opacity","");}),g.on(i,["mouseleave","touchend"],o=>{g.css(i,"opacity",0);});});});m.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});},gestureBackCloseComment(){a.info("手势返回关闭评论区");let t=new Mt({hash:Ze.videoCommentDrawer,useUrl:true,beforeHistoryBackCallBack(n){n&&i();}});const e='#relatedVideoCard .semi-tabs + div svg:has(path[d="M22.133 23.776a1.342 1.342 0 1 0 1.898-1.898l-4.112-4.113 4.112-4.112a1.342 1.342 0 0 0-1.898-1.898l-4.112 4.112-4.113-4.112a1.342 1.342 0 1 0-1.898 1.898l4.113 4.112-4.113 4.113a1.342 1.342 0 0 0 1.898 1.898l4.113-4.113 4.112 4.113z"])';function i(){var o;let n=I(e);if(n){let r=m.getReactObj(n);if(r){let d=(o=r.reactProps)==null?undefined:o.onClick;typeof d=="function"?d():C.error("调用关闭评论区按钮的onClick函数失败");}else C.error("获取关闭评论区按钮react信息失败");}else C.error("未找到关闭评论区的按钮");}g.on(document,"click",'.xgplayer div[data-e2e="feed-comment-icon"]',n=>{a.info("手势 => 打开评论区"),m.waitNode(e,1e4).then(o=>{o&&(a.info("手势 => 评论区出现"),t.enterGestureBackMode());});},{capture:true}),g.on(document,"click",e,n=>{a.info("手势 => 关闭评论区"),t.quitGestureBackMode();},{capture:true});},waitToRemovePauseDialog(){a.info("监听信息区域【长时间无操作，已暂停播放】弹窗");let t=e=>{let i=g.text(e);if(i.includes("长时间无操作")&&i.includes("暂停播放")){C.info("出现【长时间无操作，已暂停播放】弹窗",{consoleLogContent:true});let n=m.getReactObj(e);if(typeof n.reactProps=="object"){let o=m.queryProperty(n.reactProps,r=>{var d,s;if(typeof((d=r==null?undefined:r.props)==null?undefined:d.onClose)=="function")return {isFind:true,data:r.props.onClose};{let l=((s=r==null?undefined:r.props)==null?undefined:s.children)??(r==null?undefined:r.children);return {isFind:false,data:Array.isArray(l)?l[0]:l}}});typeof o=="function"&&(C.success("调用函数关闭弹窗",{consoleLogContent:true}),o());}}};g.ready(()=>{m.mutationObserver(document.body,{config:{subtree:true,childList:true},callback(){ne(".basePlayerContainer xg-bar.xg-right-bar + div").forEach(e=>{t(e);});}});});}},G={shortCut:new Je("video-short-cut"),$data:{rateMap:["0.75","1","1.25","1.5","1.75","2","3"]},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-video-rate-low":{target:"window",callback(){a.info("触发快捷键 ==> 调用倍速：小");let t=_.sessionStorage.getItem("player_playbackratio")??"1",e=G.$data.rateMap.findIndex(n=>n===t);if(e===0){a.warn("触发快捷键 ==> 已是最小倍速: "+t);return}let i=G.$data.rateMap[e-1];a.info("触发快捷键 ==> 设置倍速: "+i),ie.chooseVideoRate(i);}},"dy-video-rate-up":{target:"window",callback(){a.info("触发快捷键 ==> 调用倍速：大");let t=_.sessionStorage.getItem("player_playbackratio")??"1",e=G.$data.rateMap.findIndex(n=>n===t);if(e===G.$data.rateMap.length-1){a.warn("触发快捷键 ==> 已是最大倍速: "+t);return}let i=G.$data.rateMap[e+1];a.info("触发快捷键 ==> 设置倍速: "+i),ie.chooseVideoRate(i);}},"dy-video-shortcut-immersionMode":{target:"window",callback(){a.info("触发快捷键 ==> 沉浸模式");let t=u.getValue("fullScreen");u.setValue("fullScreen",!t),u.execMenuOnce("fullScreen",()=>ie.fullScreen());}},"dy-video-shortcut-changeVideoMuted":{target:"window",callback(){a.info("触发快捷键 ==> 切换静音状态"),ne("video").forEach(t=>{let e=!t.muted;a.success(`切换video标签的静音状态为 ${e}`),t.muted=e;});}}}}},Se=function(t,e,i,n,o,r,d,s,l){let c={text:t,type:"slider",description:s,attributes:{},props:{},getValue(){return this.props[L].get(e,i)},getToolTipContent(f){return typeof d=="function"?d(f):`${f}`},callback(f,p){this.props[L].set(e,p);},min:n,max:o,step:l};return Reflect.set(c.attributes,Y,e),Reflect.set(c.attributes,q,i),Reflect.set(c.props,L,{get(f,p){return u.getValue(f,p)},set(f,p){u.setValue(f,p);}}),c},Vt=function(t,e,i,n,o,r="",d,s){let l={text:t,type:"input",isNumber:false,isPassword:false,props:{},attributes:{},description:n,getValue(){return this.props[L].get(e,i)},callback(c,f){this.props[L].set(e,f);},placeholder:r};return Reflect.set(l.attributes,Y,e),Reflect.set(l.attributes,q,i),Reflect.set(l.props,L,{get(c,f){return u.getValue(c,f)},set(c,f){u.setValue(c,f);}}),l},Rt=function(t,e,i,n,o,r,d="请至少选择一个选项",s){let l=[];typeof n=="function"?l=n():l=n;let c={text:t,type:"select-multiple",description:r,placeholder:d,attributes:{},props:{},getValue(){return this.props[L].get(e,i)},selectConfirmDialogDetails:s,callback(f){let p=[];f.forEach(v=>{p.push(v.value);}),this.props[L].set(e,p),a.info("多选-选择：",p);},data:l};return Reflect.set(c.attributes,Y,e),Reflect.set(c.attributes,q,i),Reflect.set(c.props,L,{get(f,p){return u.getValue(f,p)},set(f,p){u.setValue(f,p);}}),c};class Dt{constructor(e){P(this,"option");this.option=e;}async showView(){var d;let e=A.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <form class="rule-form-container" onsubmit="return false">
                        <ul class="rule-form-ulist">
                            
                        </ul>
                        <input type="submit" style="display: none;" />
                    </form>
                    `,html:true},btn:m.assign({ok:{callback:async()=>{await r();}}},this.option.btn||{},true),mask:{enable:true},style:`
                ${A.config.cssText.panelCSS}
                
                .rule-form-container {
                    
                }
                .rule-form-container li{
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    padding: 5px 20px;
                    gap: 10px;
                }
                .pops-panel-item-left-main-text{
                    max-width: 150px;
                }
                .pops-panel-item-right-text{
                    padding-left: 30px;
                }
                .pops-panel-item-right-text,
                .pops-panel-item-right-main-text{
                    text-overflow: ellipsis;
                    overflow: hidden;
                    white-space: nowrap;
                }

                ${((d=this.option)==null?undefined:d.style)??""}
            `,width:typeof this.option.width=="function"?this.option.width():window.innerWidth>500?"500px":"88vw",height:typeof this.option.height=="function"?this.option.height():window.innerHeight>500?"500px":"80vh"}),i=e.$shadowRoot.querySelector(".rule-form-container");e.$shadowRoot.querySelector("input[type=submit]");let n=e.$shadowRoot.querySelector(".rule-form-ulist"),o=await this.option.getView(await this.option.data());n.appendChild(o);const r=async()=>{(await this.option.onsubmit(i,await this.option.data())).success&&(e.close(),await this.option.dialogCloseCallBack(true));};}}class Ot{constructor(e){P(this,"option");this.option=e;}showView(){let e=A.alert({title:{text:this.option.title,position:"center"},content:{text:`
                <div class="filter-container"></div>
                `},btn:{ok:{text:"关闭",type:"default"}},mask:{enable:true},width:window.innerWidth>500?"350px":"80vw",height:window.innerHeight>500?"300px":"70vh",style:`
            .filter-container{
                height: 100%;
                display: flex;
                flex-direction: column;
                gap: 20px;
            }
            .filter-container button{
                text-wrap: wrap;
                padding: 8px;
                height: auto;
                text-align: left;
            }
            `}),i=e.$shadowRoot.querySelector(".filter-container"),n=document.createDocumentFragment();this.option.filterOption.forEach(o=>{let r=document.createElement("button");r.innerText=o.name;let d=async()=>{(await this.option.getAllRuleInfo()).forEach(async l=>{await o.filterCallBack(l.data)?g.show(l.$el,false):g.hide(l.$el,false);}),typeof this.option.execFilterCallBack=="function"&&await this.option.execFilterCallBack(),e.close();};g.on(r,"click",async s=>{m.preventEvent(s),!(typeof o.callback=="function"&&!await o.callback(s,d))&&await d();}),n.appendChild(r);}),i.appendChild(n);}}class At{constructor(e){P(this,"option");this.option=e;}async showView(){var n,o,r,d,s,l,c,f,p;let e=A.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <div class="rule-view-container">
                    </div>
                    `,html:true},btn:{merge:true,reverse:false,position:"space-between",ok:{enable:((r=(o=(n=this.option)==null?undefined:n.bottomControls)==null?undefined:o.add)==null?undefined:r.enable)||true,type:"primary",text:"添加",callback:async v=>{this.showEditView(false,await this.option.getAddData(),e.$shadowRoot);}},close:{enable:true,callback(v){e.close();}},cancel:{enable:((l=(s=(d=this.option)==null?undefined:d.bottomControls)==null?undefined:s.filter)==null?undefined:l.enable)||false,type:"default",text:"过滤",callback:(v,b)=>{var M,T,R,K,z,N,V;typeof((R=(T=(M=this.option)==null?undefined:M.bottomControls)==null?undefined:T.filter)==null?undefined:R.callback)=="function"&&this.option.bottomControls.filter.callback();let k=()=>Array.from(e.$shadowRoot.querySelectorAll(".rule-view-container .rule-item")),x=b.target.closest(".pops-confirm-btn").querySelector(".pops-confirm-btn-cancel span");g.text(x).includes("取消")?(k().forEach(O=>{g.show(O,false);}),g.text(x,"过滤")):new Ot({title:((z=(K=this.option.bottomControls)==null?undefined:K.filter)==null?undefined:z.title)??"过滤规则",filterOption:((V=(N=this.option.bottomControls)==null?undefined:N.filter)==null?undefined:V.option)||[],execFilterCallBack(){g.text(x,"取消过滤");},getAllRuleInfo:()=>k().map(H=>({data:this.parseRuleItemElement(H).data,$el:H}))}).showView();}},other:{enable:((p=(f=(c=this.option)==null?undefined:c.bottomControls)==null?undefined:f.clear)==null?undefined:p.enable)||true,type:"xiaomi-primary",text:`清空所有(${(await this.option.data()).length})`,callback:v=>{let b=A.confirm({title:{text:"提示",position:"center"},content:{text:"确定清空所有的数据？",html:false},btn:{ok:{enable:true,callback:async k=>{var M,T,R;if(a.success("清空所有"),typeof((R=(T=(M=this.option)==null?undefined:M.bottomControls)==null?undefined:T.clear)==null?undefined:R.callback)=="function"&&this.option.bottomControls.clear.callback(),(await this.option.data()).length){C.error("清理失败");return}else C.success("清理成功");await this.updateDeleteAllBtnText(e.$shadowRoot),this.clearContent(e.$shadowRoot),b.close();}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}}},mask:{enable:true},width:window.innerWidth>500?"500px":"88vw",height:window.innerHeight>500?"500px":"80vh",style:`
            ${A.config.cssText.panelCSS}
            
            .rule-item{
                display: flex;
                align-items: center;
                line-height: normal;
                font-size: 16px;
                padding: 4px 4px;
                gap: 6px;
            }
            .rule-name{
                flex: 1;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            .rule-controls{
                display: flex;
                align-items: center;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
                gap: 8px;
                padding: 0px 4px;
            }
            .rule-controls-enable{
                
            }
            .rule-controls-edit{
                
            }
            .rule-controls-delete{
                
            }
            .rule-controls-edit,
            .rule-controls-delete{
                width: 16px;
                height: 16px;
                cursor: pointer;
            }
            `}),i=await this.option.data();for(let v=0;v<i.length;v++)await this.appendRuleItemElement(e.$shadowRoot,i[v]);}parseViewElement(e){let i=e.querySelector(".rule-view-container"),n=e.querySelector(".pops-confirm-btn button.pops-confirm-btn-other");return {$container:i,$deleteBtn:n}}parseRuleItemElement(e){let i=e.querySelector(".rule-controls-enable"),n=i.querySelector(".pops-panel-switch"),o=i.querySelector(".pops-panel-switch__input"),r=i.querySelector(".pops-panel-switch__core"),d=e.querySelector(".rule-controls-edit"),s=e.querySelector(".rule-controls-delete");return {$enable:i,$enableSwitch:n,$enableSwitchInput:o,$enableSwitchCore:r,$edit:d,$delete:s,data:Reflect.get(e,"data-rule")}}async createRuleItemElement(e,i){let n=await this.option.getDataItemName(e),o=g.createElement("div",{className:"rule-item",innerHTML:`
			<div class="rule-name">${n}</div>
			<div class="rule-controls">
				<div class="rule-controls-enable">
					<div class="pops-panel-switch">
						<input class="pops-panel-switch__input" type="checkbox">
						<span class="pops-panel-switch__core">
							<div class="pops-panel-switch__action">
							</div>
						</span>
					</div>
				</div>
				<div class="rule-controls-edit">
					${A.config.iconSVG.edit}
				</div>
				<div class="rule-controls-delete">
					${A.config.iconSVG.delete}
				</div>
			</div>
			`});Reflect.set(o,"data-rule",e);let r="pops-panel-switch-is-checked";const{$enable:d,$enableSwitch:s,$enableSwitchCore:l,$enableSwitchInput:c,$delete:f,$edit:p}=this.parseRuleItemElement(o);return this.option.itemControls.enable.enable?(g.on(l,"click",async v=>{let b=false;s.classList.contains(r)?(s.classList.remove(r),b=false):(s.classList.add(r),b=true),c.checked=b,await this.option.itemControls.enable.callback(e,b);}),await this.option.itemControls.enable.getEnable(e)&&s.classList.add(r)):d.remove(),this.option.itemControls.edit.enable?g.on(p,"click",v=>{m.preventEvent(v),this.showEditView(true,e,i,o,b=>{e=null,e=b;});}):p.remove(),this.option.itemControls.delete.enable?g.on(f,"click",v=>{m.preventEvent(v);let b=A.confirm({title:{text:"提示",position:"center"},content:{text:"确定删除该条数据？",html:false},btn:{ok:{enable:true,callback:async k=>{a.success("删除数据"),await this.option.itemControls.delete.deleteCallBack(e)?(C.success("成功删除该数据"),o.remove(),await this.updateDeleteAllBtnText(i),b.close()):C.error("删除该数据失败");}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}):f.remove(),o}async appendRuleItemElement(e,i){const{$container:n}=this.parseViewElement(e);if(Array.isArray(i))for(let o=0;o<i.length;o++){const r=i[o];n.appendChild(await this.createRuleItemElement(r,e));}else n.appendChild(await this.createRuleItemElement(i,e));await this.updateDeleteAllBtnText(e);}async updateRuleContaienrElement(e){this.clearContent(e),this.parseViewElement(e);let i=await this.option.data();await this.appendRuleItemElement(e,i),await this.updateDeleteAllBtnText(e);}async updateRuleItemElement(e,i,n){let o=await this.createRuleItemElement(e,n);i.after(o),i.remove();}clearContent(e){const{$container:i}=this.parseViewElement(e);g.html(i,"");}setDeleteBtnText(e,i,n=false){const{$deleteBtn:o}=this.parseViewElement(e);n?g.html(o,i):g.text(o,i);}async updateDeleteAllBtnText(e){let i=await this.option.data();this.setDeleteBtnText(e,`清空所有(${i.length})`);}showEditView(e,i,n,o,r){let d=async l=>{if(!l){if(e||await this.option.deleteData(i),typeof r=="function"){let c=await this.option.getData(i);r(c);}}};new Dt({title:e?"编辑":"添加",data:()=>i,dialogCloseCallBack:d,getView:async l=>await this.option.itemControls.edit.getView(l,e),btn:{ok:{enable:true,text:e?"修改":"添加"},cancel:{callback:async(l,c)=>{l.close(),await d(false);}},close:{callback:async(l,c)=>{l.close(),await d(false);}}},onsubmit:async(l,c)=>{let f=await this.option.itemControls.edit.onsubmit(l,e,c);return f.success?e?(C.success("修改成功"),n&&await this.updateRuleItemElement(f.data,o,n)):n&&await this.appendRuleItemElement(n,f.data):e&&C.error("修改失败"),f},style:this.option.itemControls.edit.style,width:this.option.itemControls.edit.width,height:this.option.itemControls.edit.height}).showView();}}class Pt{constructor(e=1,i=300){P(this,"queue");P(this,"runningCount");P(this,"concurrency");P(this,"intervalTime");this.queue=[],this.concurrency=e,this.intervalTime=i,this.runningCount=0;}enqueue(e){this.queue.push(e),this.runNext();}async runNext(){for(;this.runningCount<this.concurrency&&this.queue.length>0;){this.runningCount++;const e=this.queue.shift();try{await e(),this.intervalTime>0&&await new Promise(i=>setTimeout(i,this.intervalTime));}catch(i){console.error(i);}finally{this.runningCount--,this.runNext();}}}}class Ue{constructor(){P(this,"$data",{dislike_request_queue:[]});P(this,"concurrencyAsyncQueue");this.concurrencyAsyncQueue=new Pt(1);}parseAwemeInfoDictData(e,i=false){var ce,ue,he,fe,pe,me,_e,Me,Be,Le,Te,Ee,Ve,Re,De,Oe,Ae,Pe,$e,Ne,He;let n=(e==null?undefined:e.authorInfo)||(e==null?undefined:e.author),o=(ce=n==null?undefined:n.nickname)==null?undefined:ce.toString(),r=(ue=n==null?undefined:n.uid)==null?undefined:ue.toString(),d=(he=e==null?undefined:e.desc)==null?undefined:he.toString(),s=(fe=e==null?undefined:e.music)==null?undefined:fe.album,l=(pe=e==null?undefined:e.music)==null?undefined:pe.author,c=(me=e==null?undefined:e.music)==null?undefined:me.title,f=((_e=e==null?undefined:e.stats)==null?undefined:_e.collectCount)||((Me=e==null?undefined:e.statistics)==null?undefined:Me.collect_count),p=((Be=e==null?undefined:e.stats)==null?undefined:Be.commentCount)||((Le=e==null?undefined:e.statistics)==null?undefined:Le.comment_count),v=((Te=e==null?undefined:e.stats)==null?undefined:Te.diggCount)||((Ee=e==null?undefined:e.statistics)==null?undefined:Ee.digg_count),b=((Ve=e==null?undefined:e.stats)==null?undefined:Ve.shareCount)||((Re=e==null?undefined:e.statistics)==null?undefined:Re.share_count),k=(De=e==null?undefined:e.video)==null?undefined:De.duration,x=(e==null?undefined:e.textExtra)||(e==null?undefined:e.text_extra),M=[],T=false,R=false,K=false,z=false,N=((Oe=e==null?undefined:e.riskInfos)==null?undefined:Oe.content)||((Ae=e==null?undefined:e.risk_infos)==null?undefined:Ae.content),V,O=[],H=(e==null?undefined:e.aweme_type)===68;typeof x=="object"&&Array.isArray(x)&&(x==null||x.forEach(E=>{let re=(E==null?undefined:E.hashtagName)||(E==null?undefined:E.hashtag_name);typeof re=="string"&&M.push(re);}));let F,j,U=(e==null?undefined:e.videoTag)||(e==null?undefined:e.video_tag),Q=[],W=[],oe=(e==null?undefined:e.aweme_id)||(e==null?undefined:e.awemeId);typeof U=="object"&&Array.isArray(U)&&U.forEach(E=>{let re=(E==null?undefined:E.tagName)||(E==null?undefined:E.tag_name),we=(E==null?undefined:E.tagId)||(E==null?undefined:E.tag_id);typeof re=="string"&&Q.push(re),(typeof we=="number"||typeof we=="string")&&W.push(we.toString());}),(typeof e.cellRoom=="object"||typeof e.cell_room=="object")&&(T=true,i&&a.success("直播间：cellRoom is not null")),e.isAds||e.is_ads?(R=true,i&&a.success("广告：isAds is true")):typeof e.rawAdData=="string"&&m.isNotNull(e.rawAdData)||typeof e.raw_ad_data=="string"&&m.isNotNull(e.raw_ad_data)?(R=true,i&&a.success("广告：rawAdData is not null")):e.webRawData?($e=(Pe=e.webRawData)==null?undefined:Pe.brandAd)!=null&&$e.is_ad?(R=true,i&&a.success("广告：webRawData.brandAd.is_ad is true")):(He=(Ne=e.webRawData)==null?undefined:Ne.insertInfo)!=null&&He.is_ad&&(R=true,i&&a.success("广告：webRawData.insertInfo.is_ad is true")):e.web_raw_data&&e.web_raw_data,(typeof N=="string"&&N.trim()===""||typeof N!="string")&&(N=undefined);let D=(e==null?undefined:e.seriesInfo)||(e==null?undefined:e.series_info);if(typeof D=="object"&&D!=null){K=true,V=(D==null?undefined:D.seriesName)||(D==null?undefined:D.series_name);let E=(D==null?undefined:D.seriesContentTypes)||(D==null?undefined:D.series_content_types);Array.isArray(E)&&E.forEach(re=>{O.push(re.name);});}let $=(e==null?undefined:e.mixInfo)||(e==null?undefined:e.mix_info);return typeof $=="object"&&m.isNotNull($)&&(F=($==null?undefined:$.mixName)||($==null?undefined:$.mix_name),j=$==null?undefined:$.desc),H&&(k=undefined),{awemeId:oe,nickname:o,uid:r,desc:d,textExtra:M,videoTag:Q,videoTagId:W,musicAlbum:s,musicAuthor:l,musicTitle:c,riskInfoContent:N,seriesInfoName:V,seriesInfoContentTypes:O,mixInfoName:F,mixInfoDesc:j,collectCount:f,commentCount:p,diggCount:v,shareCount:b,duration:k,isLive:T,isAds:R,isSeriesInfo:K,isMixInfo:z,isPicture:H}}checkFilterWithRule(e){if(e.videoInfoValue==null||e.ruleValue==null)return  false;if(typeof e.videoInfoValue=="string"){if(e.videoInfoValue.match(e.ruleValue))return  true}else if(typeof e.videoInfoValue=="object"){if(Array.isArray(e.videoInfoValue)&&e.videoInfoValue.find(n=>typeof n=="string"&&e.ruleValue!=null?!!n.match(e.ruleValue):false))return  true}else if(typeof e.videoInfoValue=="number"){if(typeof e.ruleValue=="string"){let i=e.ruleValue.trim(),n=i.match(/(\d+)/);if(!n)return a.warn("过滤器-解析比较大小的数字失败: ",e),false;let o=Number(n[1]);if(i.startsWith(">")){if(i.startsWith(">=")){if(e.videoInfoValue>=o)return  true}else if(e.videoInfoValue>o)return  true}else if(i.startsWith("<")){if(i.startsWith("<=")){if(e.videoInfoValue<=o)return  true}else if(e.videoInfoValue<o)return  true}else if(i.startsWith("=")){if(e.videoInfoValue===o)return  true}else return a.warn("视频过滤器-未经允许的比较符号: ",e),false}}else if(typeof e.videoInfoValue=="boolean"&&typeof e.ruleValue=="string"){let i=e.ruleValue.trim();return e.videoInfoValue.toString()===i}return  false}checkAwemeInfoIsFilter(e,i){let n=this.parseAwemeInfoDictData(i),o=false,r=null;for(let s=0;s<e.length;s++){const l=e[s];if(!Reflect.has(n,l.data.ruleName))continue;let c=l.data.ruleName,f=n[c],p={videoInfoKey:c,videoInfoValue:f,ruleKey:l.data.ruleName,ruleValue:l.data.ruleValue};if(o=this.checkFilterWithRule(p),o)if(Array.isArray(l.dynamicData)&&l.dynamicData.length){let v=[];for(let b=0;b<l.dynamicData.length;b++){const k=l.dynamicData[b];let x=k.ruleName,M=n[x],T={videoInfoKey:x,videoInfoValue:M,ruleKey:k.ruleName,ruleValue:k.ruleValue};v.push(T);let R=this.checkFilterWithRule(T);if(o=o&&R,!o)break}o&&a.success([`视频过滤器-多组 ==> ${l.name}`,n,p,v,i]);}else a.success([`视频过滤器 ==> ${l.name}`,n,p,i]);if(o){r=l;break}}return u.getValue("shieldVideo-only-show-filtered-video")&&(o=!o),{isFilter:o,matchedFilterOption:r}}async sendDislikeVideo(e,i){}removeAweme(...e){if(e.length===1){let i=e[0];i!=null&&i instanceof HTMLElement&&i.remove();}else if(e.length===2){let i=e[0],n=e[1];if(typeof n=="number"){let o=i[n];o!=null&&o instanceof Element&&(o==null||o.remove()),i.splice(n,1);}}}}const $t={get ajaxHooker(){return this.__ajaxHooker==null&&(this.__ajaxHooker=new m.ajaxHooker),this.__ajaxHooker},init(){},commentReply(){this.ajaxHooker.hook(t=>{let e=y.fixUrl(t.url),i=new URL(e);i.pathname.startsWith("/aweme/v1/web/comment/list/reply")&&(i.searchParams.delete("whale_cut_token"),i.searchParams.append("whale_cut_token",""),t.url=i.toString());});}},J={setting:{get width(){return window.innerWidth<550?"88vw":window.innerWidth<700?"550px":"700px"},get height(){return window.innerHeight<450?"70vh":window.innerHeight<550?"450px":"550px"}},settingBig:{get width(){return window.innerWidth<800?"92vw":"800px"},get height(){return window.innerHeight<600?"80vh":"600px"}},info:{get width(){return "350px"},get height(){return "250px"}}},Ke=function(t,e,i,n,o,r="",d){let s={text:t,type:"textarea",attributes:{},props:{},description:n,placeholder:r,disabled:d,getValue(){return this.props[L].get(e,i)},callback(l,c){this.props[L].set(e,c);}};return Reflect.set(s.attributes,Y,e),Reflect.set(s.attributes,q,i),Reflect.set(s.props,L,{get(l,c){return u.getValue(l,c)},set(l,c){u.setValue(l,c);}}),s},ke={$key:{STORAGE_KEY:"dy-video-filter-rule",ENABLE_KEY:"shieldVideo-exec-network-enable"},init(){this.execFilter(),u.execMenuOnce("shieldVideo-add-parseVideoInfoButton",()=>{this.addParseButton();});},execFilter(){const t=this;u.execMenuOnce(this.$key.ENABLE_KEY,async()=>{a.info("执行视频过滤器");let e=new Ue,i=n=>{if(!u.getValue(t.$key.ENABLE_KEY))return [];let o=t.getData();if(!o.length)return [];let r=Array.isArray(n)?n:[n];return o.filter(s=>s.enable&&(s.data.scope.includes("all")||Array.from(r).findIndex(l=>s.data.scope.includes(l))!==-1))};$t.ajaxHooker.hook(n=>{let o=y.fixUrl(n.url),r=new URL(o);r.pathname.startsWith("/aweme/v1/web/tab/feed")||r.pathname.startsWith("/aweme/v1/web/aweme/post/")||r.pathname.startsWith("/aweme/v1/web/mix/aweme/")?n.response=d=>{let s=i(["xhr-tab","xhr-userHome","xhr-mix"]);if(!s.length)return;let l=m.toJSON(d.responseText),c=l.aweme_list;if(Array.isArray(c)){for(let f=0;f<c.length;f++){let p=c[f]||{},v=e.checkAwemeInfoIsFilter(s,p);v.isFilter&&(e.sendDislikeVideo(v.matchedFilterOption,p),e.removeAweme(c,f--));}d.responseText=JSON.stringify(l);}}:r.pathname.startsWith("/aweme/v1/web/follow/feed")||r.pathname.startsWith("/aweme/v1/web/familiar/feed")?n.response=d=>{let s=i(["xhr-follow","xhr-familiar"]);if(!s.length)return;let l=m.toJSON(d.responseText),c=l.data;if(Array.isArray(c)){for(let f=0;f<c.length;f++){let p=c[f],v=p.aweme||{};typeof(p==null?undefined:p.cell_room)=="object"&&(p==null?undefined:p.cell_room)!=null&&(v.cell_room=p==null?undefined:p.cell_room);let b=e.checkAwemeInfoIsFilter(s,v);b.isFilter&&(e.sendDislikeVideo(b.matchedFilterOption,v),e.removeAweme(c,f--));}d.responseText=JSON.stringify(l);}}:r.pathname.startsWith("/aweme/v1/web/module/feed")?n.response=d=>{let s=i("xhr-module");if(!s.length)return;let l=m.toJSON(d.responseText),c=l.cards;if(Array.isArray(c)){for(let f=0;f<c.length;f++){let p=c[f],v=m.toJSON((p==null?undefined:p.aweme)||"{}"),b=e.checkAwemeInfoIsFilter(s,v);b.isFilter&&(e.sendDislikeVideo(b.matchedFilterOption,v),e.removeAweme(c,f--));}d.responseText=JSON.stringify(l);}}:(r.pathname.startsWith("/aweme/v1/web/general/search/single/")||r.pathname.startsWith("/aweme/v1/web/search/item/"))&&(n.response=d=>{let s=i(["xhr-search"]);if(!s.length)return;let l=m.toJSON(d.responseText),c=l.data;if(Array.isArray(c)){for(let f=0;f<c.length;f++){let p=c[f],v=p.aweme_info||{},b=p==null?undefined:p.aweme_mix_info;if(v==null&&b!=null){let k=b==null?undefined:b.mix_items;if(Array.isArray(k)){for(let x=0;x<k.length;x++){let M=k[x],T=e.checkAwemeInfoIsFilter(s,M);T.isFilter&&(e.sendDislikeVideo(T.matchedFilterOption,M),e.removeAweme(k,x--));}k.length===0&&e.removeAweme(c,f--);}}else {let k=e.checkAwemeInfoIsFilter(s,v);k.isFilter&&(e.sendDislikeVideo(k.matchedFilterOption,v),e.removeAweme(c,f--));}}d.responseText=JSON.stringify(l);}});});});},addParseButton(){w(`
			.basePlayerContainer .gm-video-filter-parse-btn{
				height: auto !important;
				line-height: 1 !important;
			}
		`);let t=new Ue,e=n=>{var s,l,c,f;let o=this,r=(f=(c=(l=(s=m.getReactObj(n))==null?undefined:s.reactFiber)==null?undefined:l.return)==null?undefined:c.memoizedProps)==null?undefined:f.awemeInfo;if(r==null){C.error("未获取到awemeInfo信息",{consoleLogContent:true});return}if(typeof r!="object"){C.error("获取到的awemeInfo信息不是对象",{consoleLogContent:true});return}let d=t.parseAwemeInfoDictData(r,false);a.info(["视频awemeInfo：",r,d]),A.confirm({title:{text:"视频awemeInfo",position:"center"},content:{text:JSON.stringify(d,null,4).trim(),html:false},drag:true,btn:{ok:{enable:true,text:"添加过滤规则",callback(p,v){o.getRuleViewInstance().showEditView(false,o.getTemplateData());}},cancel:{enable:true,text:"规则管理器",callback(p,v){o.showView();}}},mask:{enable:true,clickEvent:{toClose:true}},width:J.setting.width,height:J.setting.height,style:`
				.pops-confirm-content p{
					white-space: break-spaces;
				}
			`});},i=new m.LockFunction(()=>{ne(".basePlayerContainer xg-right-grid:not(:has(.gm-video-filter-parse-btn))").forEach(n=>{let o=g.createElement("xg-icon",{className:"gm-video-filter-parse-btn",innerText:"过滤器-解析信息"});g.on(o,"click",r=>{m.preventEvent(r);let d=n.closest(".basePlayerContainer");e(d);}),n.appendChild(o);});});m.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{i.run();}});},getRuleViewInstance(){let t=A.config.panelHandleContentUtils();function e(n){return {get(o,r){return n[o]??r},set(o,r){n[o]=r;}}}return new At({title:"视频过滤器",data:()=>this.getData(),getAddData:()=>this.getTemplateData(),getDataItemName:n=>n.name,updateData:n=>this.updateData(n),deleteData:n=>this.deleteData(n),getData:n=>this.getData().find(d=>d.uuid===n.uuid)??n,itemControls:{enable:{enable:true,getEnable(n){return n.enable},callback:(n,o)=>{n.enable=o,this.updateData(n);}},edit:{enable:true,getView:(n,o)=>{let r=document.createDocumentFragment();o||(n=this.getTemplateData());let d=h("启用","enable",true);Reflect.set(d.props,L,e(n));let s=t.createSectionContainerItem_switch(d),l=Vt("规则名称","name","","",undefined,"必填");Reflect.set(l.props,L,e(n));let c=t.createSectionContainerItem_input(l),f=Rt("作用域","scope",[],[{text:"所有",value:"all"},{text:"精选",value:"xhr-module"},{text:"推荐",value:"xhr-tab"},{text:"关注",value:"xhr-follow"},{text:"朋友",value:"xhr-familiar"},{text:"搜索",value:"xhr-search"},{text:"用户主页",value:"xhr-userHome"},{text:"混合信息",value:"xhr-mix"}],undefined,"选择需要在xxx上生效的作用域");Reflect.set(f.props,L,e(n.data));let p=t.createSectionContainerItem_select_multiple_new(f),v=["isLive","isAds","isSeriesInfo","isMixInfo","isPicture","awemeId","nickname","uid","desc","textExtra","videoTag","videoTagId","musicAlbum","musicAuthor","musicTitle","riskInfoContent","seriesInfoName","seriesInfoContentTypes","mixInfoName","mixInfoDesc","collectCount","commentCount","diggCount","shareCount","duration"],b="nickname",k=V=>{let O=Z("属性名","ruleName",b,v.map(W=>({text:W,value:W})),undefined,"选择需要的属性名 ");Reflect.set(O.props,L,e(V));let H=t.createSectionContainerItem_select(O),F=Ke("属性值","ruleValue","","如果是字符串，可正则，注意转义");Reflect.set(F.props,L,e(V));let j=t.createSectionContainerItem_textarea(F),U=Ke("备注","remarks","","");Reflect.set(U.props,L,e(V));let Q=t.createSectionContainerItem_textarea(U);return {$ruleName:H,$ruleValue:j,$remarks:Q}},x=g.createElement("div",{className:"rule-form-ulist-dynamic",innerHTML:`
							<div class="rule-form-ulist-dynamic__inner">

							</div>
							<div class="pops-panel-button pops-panel-button-no-icon">
								<button class="pops-panel-button_inner" type="default">
									<i class="pops-bottom-icon" is-loading="false"></i>
									<span class="pops-panel-button-text">添加额外属性</span>
								</button>
							</div>
							`}),M=x.querySelector(".rule-form-ulist-dynamic__inner"),T=x.querySelector(".pops-panel-button"),R=(V={ruleName:b,ruleValue:"",remarks:""})=>{let O=g.createElement("div",{className:"rule-form-ulist-dynamic__inner-container",innerHTML:`
									<div class="dynamic-control-delete">
										<div class="pops-panel-button pops-panel-button-no-icon">
											<button class="pops-panel-button_inner" type="danger">
												<i class="pops-bottom-icon" is-loading="false"></i>
												<span class="pops-panel-button-text">×</span>
											</button>
										</div>
									</div>
									<ul class="dynamic-forms">

									</ul>
								`}),H=O.querySelector(".dynamic-control-delete");g.on(H,"click",W=>{if(m.preventEvent(W),O.remove(),Array.isArray(n.dynamicData)){let oe=n.dynamicData.findIndex(D=>D==V);oe!==-1&&n.dynamicData.splice(oe,1);}});let F=O.querySelector(".dynamic-forms"),{$ruleName:j,$ruleValue:U,$remarks:Q}=k(V);F.appendChild(j),F.appendChild(U),F.appendChild(Q),M.appendChild(O);};if(g.on(T,"click",V=>{m.preventEvent(V),R();}),Array.isArray(n.dynamicData))for(let V=0;V<n.dynamicData.length;V++){const O=n.dynamicData[V];R(O);}let{$ruleName:K,$ruleValue:z,$remarks:N}=k(n.data);return r.append(s,c,p,K,z,N,x),r},onsubmit:(n,o,r)=>{let d=n.querySelectorAll(".rule-form-ulist > li"),s=this.getTemplateData();return o&&(s.uuid=r.uuid),d.forEach(l=>{let c=Reflect.get(l,"__formConfig__");if(!c)return;let f=Reflect.get(c,"attributes");if(!f)return;let p=Reflect.get(l,L),v=Reflect.get(f,Y),b=Reflect.get(f,q),k=p.get(v,b);Reflect.has(s,v)?Reflect.set(s,v,k):Reflect.has(s.data,v)?Reflect.set(s.data,v,k):a.error(`${v}不在数据中`);}),n.querySelectorAll(".rule-form-ulist-dynamic__inner-container").forEach(l=>{let c={};l.querySelectorAll(".dynamic-forms > li").forEach(f=>{let p=Reflect.get(f,"__formConfig__");if(!p)return;let v=Reflect.get(p,"attributes");if(!v)return;let b=Reflect.get(f,L),k=Reflect.get(v,Y),x=Reflect.get(v,q),M=b.get(k,x);Reflect.set(c,k,M);}),s.dynamicData.push(c);}),s.name.trim()===""?(C.error("规则名称不能为空"),{success:false,data:s}):s.data.scope.length===0?(C.error("作用域不能为空"),{success:false,data:s}):s.data.ruleName.trim()===""?(C.error("请选择属性名"),{success:false,data:s}):s.data.ruleValue.trim()===""?(C.error("属性值不能为空"),{success:false,data:s}):o?{success:this.updateData(s),data:s}:{success:this.addData(s),data:s}},style:`
                    .pops-panel-textarea textarea{
                        height: 150px;
                    }
					.pops-panel-item-left-desc-text{
						line-height: normal;
						margin-top: 6px;
						font-size: 0.8em;
						color: rgb(108, 108, 108);
					}
					.rule-form-ulist-dynamic{
						--button-margin-top: 0px;
						--button-margin-right: 0px;
						--button-margin-bottom: 0px;
						--button-margin-left: 0px;
						display: flex;
						flex-direction: column;
						align-items: flex-start;
						padding: 5px 20px;
					}
					.rule-form-ulist-dynamic__inner{
						width: 100%;
					}
					.rule-form-ulist-dynamic__inner-container{
						display: flex;
						align-items: center;
					}
					.dynamic-forms{
						width: 100%;
					}
					.pops-panel-textarea textarea{
						height: 60px;
						min-height: 60px;
						width: 250px;
						max-width: 400px;
						min-width: 250px;
						resize: auto;
						transition: unset;
					}
                    `,width:()=>window.innerWidth>700?"700px":"88vw"},delete:{enable:true,deleteCallBack:n=>this.deleteData(n)}},bottomControls:{filter:{enable:true,option:[{name:"过滤已启用",filterCallBack(n){return n.enable}},{name:"过滤未启用",filterCallBack(n){return !n.enable}}]}}})},showView(){this.getRuleViewInstance().showView();},getTemplateData(){return {uuid:m.generateUUID(),enable:true,name:"",data:{scope:[],ruleName:"nickname",ruleValue:"",remarks:""},dynamicData:[]}},getData(){return te(this.$key.STORAGE_KEY,[])},setData(t){X(this.$key.STORAGE_KEY,t);},addData(t){let e=this.getData();return e.findIndex(n=>n.uuid==t.uuid)===-1?(e.push(t),X(this.$key.STORAGE_KEY,e),true):false},updateData(t){let e=this.getData(),i=e.findIndex(o=>o.uuid==t.uuid),n=false;return i!==-1&&(n=true,e[i]=t),this.setData(e),n},deleteData(t){let e=this.getData(),i=e.findIndex(o=>o.uuid==t.uuid),n=false;return i!==-1&&(n=true,e.splice(i,1)),this.setData(e),n},clearData(){at(this.$key.STORAGE_KEY);},exportRule(t="rule.json"){let e=this.getData(),i=new Blob([JSON.stringify(e,null,4)]),n=window.URL.createObjectURL(i),o=document.createElement("a");o.href=n,o.download=t,o.click(),setTimeout(()=>{window.URL.revokeObjectURL(n);},1500);},importRule(){let t=A.alert({title:{text:"请选择导入方式",position:"center"},content:{text:`
                    <div class="import-mode" data-mode="local">本地导入</div>
                    <div class="import-mode" data-mode="network">网络导入</div>
                `,html:true},width:J.info.width,height:J.info.height,style:`
                .import-mode{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
            `}),e=t.$shadowRoot.querySelector(".import-mode[data-mode='local']"),i=t.$shadowRoot.querySelector(".import-mode[data-mode='network']");g.on(e,"click",n=>{m.preventEvent(n),t.close();let o=g.createElement("input",{type:"file",accept:".json"});g.on(o,["propertychange","input"],r=>{var l;if(!((l=o.files)!=null&&l.length))return;let d=o.files[0],s=new FileReader;s.onload=()=>{let c=m.toJSON(s.result);if(!Array.isArray(c)){a.error("不是正确的规则文件",c),C.error("不是正确的规则文件");return}this.setData(c),C.success(`成功导入 ${c.length}条规则`);},s.readAsText(d,"UTF-8");}),o.click();}),g.on(i,"click",n=>{m.preventEvent(n),t.close(),A.prompt({title:{text:"网络导入",position:"center"},content:{text:"",placeholder:"url",focus:true},btn:{ok:{callback:async(o,r)=>{let d=o.text;if(m.isNull(d)){C.error("请填入完整的url");return}let s=await et.get(d);if(!s.status)return;let l=m.toJSON(s.data.responseText);if(!Array.isArray(l)){a.error("不是正确的规则文件",s,l),C.error("不是正确的规则文件");return}this.setData(l),o.close(),C.success(`成功导入 ${l.length}条规则`);}}},width:J.info.width,height:"auto"});});}},Nt={id:"panel-config-video",title:"视频",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[Z("清晰度","chooseVideoDefinition",-2,[{text:"超清 4K",value:-2},{text:"超清 2K",value:-1},{text:"高清 1080P",value:1},{text:"高清 720P",value:2},{text:"标清 540P",value:3},{text:"极速",value:4},{text:"智能",value:0}],undefined,"自行选择清晰度"),h("沉浸模式","fullScreen",false,undefined,"移除右侧工具栏、底部信息栏等"),h("手机模式","mobileMode",false,undefined,"放大文字和图标，自动启用【initial-scale=1】和【修复进度条】功能"),h("修复进度条","repairProgressBar",false,undefined,"修复移动端不能点击拖拽和定位进度的问题（仅移动端使用）"),h("禁用双击点赞","dy-video-disableDoubleClickLike",false,undefined,"禁止视频区域双击点赞"),h("手势返回关闭评论区","dy-video-gestureBackCloseComment",false,undefined,"浏览器手势返回时关闭评论区"),h("监听并关闭【长时间无操作，已暂停播放】弹窗","dy-video-waitToRemovePauseDialog",true,undefined,"自动监听并检测弹窗"),h("视频解析","parseVideo",true,undefined,"分享->下载(灰色的也可点击)"),h("评论区移到中间","changeCommentToBottom",true,undefined,"修改评论区为中间弹出而非右侧区域"),h("↑自适应评论区位置","douyin-video-autoCheckChangeCommentToBottom",true,undefined,"根据window.screen.orientation.type自动判断是否开启【评论区移到中间】"),h("自动进入网页全屏","autoEnterElementFullScreen",false,undefined,"网页加载完毕后自动点击网页全屏按钮进入全屏"),h("双击进入网页全屏","dy-video-doubleClickEnterElementFullScreen",false,undefined,"双击视频自动进入网页全屏，检测间隔250ms")]},{text:"视频区域背景色",type:"forms",forms:[h("启用","dy-video-bgColor-enable",false,undefined,"自定义视频背景色"),{type:"own",attributes:{"data-key":"dy-video-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(t){let e=g.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),i=g.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");n.value=u.getValue("dy-video-changeBackgroundColor");let o=g.createElement("style");return g.append(document.head,o),g.on(n,["input","propertychange"],r=>{a.info("选择颜色："+n.value),o.innerHTML=`
												#sliderVideo > div{
													background: ${n.value};
												}
												`,u.setValue("dy-video-changeBackgroundColor",n.value);}),t.appendChild(e),t.appendChild(i),t}}]},{type:"forms",text:"视频标题",forms:[h("自动隐藏视频标题","dy-video-titleInfoAutoHide",false,undefined,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Se("延迟自动隐藏的时间","dy-video-titleInfoAutoHide-delayTime",3e3,0,8e3,undefined,t=>`${t}ms`,"设置延迟自动隐藏视频标题的时间，单位（ms）",100)]},{type:"forms",text:"底部的视频控件",forms:[h("自动隐藏视频控件","dy-video-videoControlsAutoHide",false,undefined,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Se("延迟自动隐藏的时间","dy-video-videoControlsAutoHide-delayTime",3e3,0,8e3,undefined,t=>`${t}ms`,"设置延迟自动隐藏视频标题的时间，单位（ms）",100)]},{type:"forms",text:"右侧工具栏",forms:[h("自动隐藏右侧工具栏","dy-video-rightToolBarAutoHide",false,undefined,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Se("延迟自动隐藏的时间","dy-video-rightToolBarAutoHide-delayTime",3e3,0,8e3,undefined,t=>`${t}ms`,"设置延迟自动隐藏视频标题的时间，单位（ms）",100)]}]},{text:"自定义快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[le("倍速 -> 小","视频倍速变小","dy-video-rate-low",undefined,"点击录入快捷键",undefined,G.shortCut),le("倍速 -> 大","视频倍速变大","dy-video-rate-up",undefined,"点击录入快捷键",undefined,G.shortCut),le("沉浸模式","移除右侧工具栏、底部信息栏等","dy-video-shortcut-immersionMode",undefined,"点击录入快捷键",undefined,G.shortCut),le("切换静音状态","切换video标签的muted属性","dy-video-shortcut-changeVideoMuted",undefined,"点击录入快捷键",undefined,G.shortCut)]}]},{type:"deepMenu",text:"快捷键禁用",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:B.text,forms:[h("上翻页","dy-keyboard-hook-arrowUp-w",false,undefined,"W"),h("下翻页","dy-keyboard-hook-arrowDown-s",false,undefined,"S"),h("快退","dy-keyboard-hook-videoRewind",false,undefined,"A"),h("快进","dy-keyboard-hook-videoFastForward",false,undefined,"D")]}]},{text:"过滤器",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[h("启用","shieldVideo-exec-network-enable",true,undefined,"开启后以下功能才会生效"),h("仅显示被过滤的视频","shieldVideo-only-show-filtered-video",false,undefined,"只会显示过滤规则命中的视频"),h("新增【过滤器-解析信息】按钮","shieldVideo-add-parseVideoInfoButton",false,undefined,"在视频的底部的工具栏中显示【过滤器】按钮，用于查看视频信息以便于进行添加过滤规则"),ye("视频过滤规则","可过滤视频","自定义",undefined,false,false,"primary",()=>{ke.showView();})]},{type:"forms",text:"",forms:[ye("数据导入","导入自定义规则数据","导入",undefined,false,false,"primary",()=>{ke.importRule();}),ye("数据导出","导出自定义规则数据","导出",undefined,false,false,"primary",()=>{ke.exportRule(Ce+"-视频过滤规则.json");})]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-视频区域内",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text+"<br>右侧工具栏",type:"forms",forms:[h("【屏蔽】切换播放","shieldPlaySwitchButton",false,undefined,"屏蔽元素，在右侧作者头像上方或者是在右侧区域"),h("【屏蔽】作者头像","shieldAuthorAvatar",false,undefined,"屏蔽元素"),h("【屏蔽】点赞","shieldLikeButton",false,undefined,"屏蔽元素"),h("【屏蔽】评论","shieldCommentButton",false,undefined,"屏蔽元素"),h("【屏蔽】收藏","shieldCollectionButton",false,undefined,"屏蔽元素"),h("【屏蔽】分享","shieldSharenButton",false,undefined,"屏蔽元素"),h("【屏蔽】看相关","shieldRelatedRecommendationsButton",false,undefined,"屏蔽元素"),h("【屏蔽】更多","shieldMoreButton",false,undefined,"...按钮，屏蔽元素")]},{text:"底部工具栏",type:"forms",forms:[h("【屏蔽】底部视频工具栏","shieldBottomVideoToolBar",false,undefined,"屏蔽元素"),h("【屏蔽】弹幕容器","shieldBottomVideoToolbarDanmuContainer",false,undefined,"屏蔽元素（不包括屏蔽弹幕）"),h("【屏蔽】视频信息","dy-video-bottom-shieldVideoInfoWrap",false,undefined,"屏蔽元素，可代替【清屏】功能")]},{text:"其它",type:"forms",forms:[h("【屏蔽】右侧的展开评论按钮","shieldRightExpandCommentButton",true,undefined,"屏蔽元素"),h("【屏蔽】搜索悬浮栏","shieldSearchFloatingBar",true,undefined,"屏蔽元素，一般出现在左上角"),h("【屏蔽】网页全屏关闭按钮","shieldCloseFullScreenButton",true,undefined,"屏蔽元素，一般开启网页全屏后出现在左上角"),h("【屏蔽】购物信息","dy-video-blockShopInfo",true,undefined,"屏蔽元素，该元素出现在视频底部的用户名、标题信息的上面")]}]},{text:"布局屏蔽-评论区域内",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】评论工具栏","dy-video-shieldUserCommentToolBar",false,undefined,"屏蔽元素"),h("【屏蔽】大家都在搜","dy-video-shieldUserCommentEveryOneAllSearch",false,undefined,"在评论区的顶部出现")]}]}]}]},Ht={id:"panel-config-search",title:"搜索",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("禁止点击视频区域进入全屏","dy-search-disableClickToEnterFullScreen",false,undefined,"禁止点击视频区域时会触发自动进入全屏功能"),Z("自动进入网页全屏","search-autoEnterElementFullScreen",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],undefined,"网页加载完毕后自动点击网页全屏按钮进入全屏"),Z("搜索结果-视频-显示样式","live-setSearchResultFilterWithVideoStyle","",[{text:"默认",value:""},{text:"单列",value:"one"},{text:"双列",value:"double"}],undefined,"自定义搜索结果，按视频筛选的结果项的显示样式")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽",type:"deepMenu",afterEnterDeepMenuCallBack:B.afterEnterDeepMenuCallBack,forms:[{text:B.text,type:"forms",forms:[h("【屏蔽】相关搜索","douyin-search-shieldReleatedSearches",false,undefined,"屏蔽右边的相关搜索")]}]},{text:"布局屏蔽-主框架",type:"deepMenu",forms:[{text:"",type:"forms",forms:[Z("【屏蔽】左侧导航栏","search-shieldLeftNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],undefined,"屏蔽元素"),Z("【屏蔽】顶部导航栏","search-shieldTopNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],undefined,"屏蔽元素")]}]}]}]},Ft={id:"m-panel-config-share-user",title:"主页",headerTitle:"/share/user<br />主页",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("视频合集","m-dy-share-user-coverPlayletList",true,undefined,"正确跳转视频合集页面"),h("视频列表","m-dy-share-user-coverPostListContainer",true,undefined,"正确跳转视频页面")]}]}]}]},It={id:"m-panel-config-share-video",title:"视频",headerTitle:"/share/video<br />视频",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("全局点击","m-dy-share-video-coverGlobalClick",true,undefined,"阻止跳转至下载页")]}]}]}]},Ut={id:"m-panel-config-share-note",title:"笔记",headerTitle:"/share/note<br />笔记",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("精彩图文","m-dy-share-note-coverExcitingGraphicsAndText",true,undefined,"正确跳转笔记页面"),h("用户","m-dy-share-note-coverUser",true,undefined,"正确跳转用户主页"),h("话题","m-dy-share-note-coverHashTag",true,undefined,"正确跳转相关话题"),h("音乐","m-dy-share-note-coverMusic",true,undefined,"正确跳转相关音乐"),h("相关推荐","m-dy-share-note-coverRecommend",true,undefined,"正确跳转笔记页面")]}]},{text:"屏蔽元素",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】评论","m-dy-share-note-blockComment",false,undefined,"屏蔽元素"),h("【屏蔽】相关推荐","m-dy-share-note-blockRecommend",false,undefined,"屏蔽元素"),h("【屏蔽】底部工具栏","m-dy-share-note-blockFooterToobar",false,undefined,"屏蔽元素")]}]}]}]},Kt={id:"m-panel-config-share-challenge",title:"话题",headerTitle:"/share/challenge<br />话题",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("顶部区域","m-dy-share-challenge-coverTopJump",true,undefined,"阻止跳转至下载页面"),h("视频卡片","m-dy-share-challenge-coverVideoCard",true,undefined,"正确跳转视频页面")]}]}]}]},Wt={id:"m-panel-config-share-music",title:"音乐",headerTitle:"/share/music<br />音乐",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("视频卡片","m-dy-share-music-coverVideoCard",true,undefined,"正确跳转视频页面")]}]}]}]},Gt={id:"panel-config-user",title:"用户",forms:[{text:"功能",type:"forms",forms:[h("显示UID","dy-user-addShowUserUID",true,undefined,"在用户信息区域下方显示当前用户的uid")]}]},u={$data:{__data:null,__oneSuccessExecMenu:null,__onceExec:null,__listenData:null,get data(){return u.$data.__data==null&&(u.$data.__data=new m.Dictionary),u.$data.__data},get oneSuccessExecMenu(){return u.$data.__oneSuccessExecMenu==null&&(u.$data.__oneSuccessExecMenu=new m.Dictionary),u.$data.__oneSuccessExecMenu},get onceExec(){return u.$data.__onceExec==null&&(u.$data.__onceExec=new m.Dictionary),u.$data.__onceExec},get scriptName(){return Ce},key:ae,attributeKeyName:Y,attributeDefaultValueName:q},$listener:{get listenData(){return u.$data.__listenData==null&&(u.$data.__listenData=new m.Dictionary),u.$data.__listenData}},init(){this.initPanelDefaultValue(),this.initExtensionsMenu();},isTopWindow(){return _.top===_.self},initExtensionsMenu(){this.isTopWindow()&&Xe.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{this.showPanel();}},{key:"show_pops_m_panel_setting",text:"⚙ 移动端设置",autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{this.showMPanel();}}]);},initPanelDefaultValue(){let t=this;function e(o){if(!o.attributes)return;let r={},d=o.attributes[Y];d!=null&&(r[d]=o.attributes[q]);let s=o.attributes[je];if(typeof s=="function"){let f=s();if(typeof f=="boolean"&&!f)return}let l=o.attributes[ut];l&&typeof l=="object"&&Object.assign(r,l);let c=Object.keys(r);if(!c.length){a.warn(["请先配置键",o]);return}c.forEach(f=>{let p=r[f];t.$data.data.has(f)&&a.warn("请检查该key(已存在): "+f),t.$data.data.set(f,p);});}function i(o){for(let r=0;r<o.length;r++){let d=o[r];e(d);let s=d.forms;s&&Array.isArray(s)&&i(s);}}let n=this.getPanelContentConfig().concat(this.getMPanelContentConfig());for(let o=0;o<n.length;o++){let r=n[o];if(!r.forms)continue;let d=r.forms;d&&Array.isArray(d)&&i(d);}},setValue(t,e){let i=te(ae,{}),n=i[t];i[t]=e,X(ae,i),this.$listener.listenData.has(t)&&this.$listener.listenData.get(t).callback(t,n,e);},getValue(t,e){let n=te(ae,{})[t];return n??(this.$data.data.has(t)?this.$data.data.get(t):e)},deleteValue(t){let e=te(ae,{}),i=e[t];Reflect.deleteProperty(e,t),X(ae,e),this.$listener.listenData.has(t)&&this.$listener.listenData.get(t).callback(t,i,undefined);},addValueChangeListener(t,e){let i=Math.random();return this.$listener.listenData.set(t,{id:i,key:t,callback:e}),i},removeValueChangeListener(t){let e=null;for(const[i,n]of this.$listener.listenData.entries())if(n.id===t){e=i;break}typeof e=="string"?this.$listener.listenData.delete(e):console.warn("没有找到对应的监听器");},triggerMenuValueChange(t,e,i){if(this.$listener.listenData.has(t)){let n=this.$listener.listenData.get(t);if(typeof n.callback=="function"){let o=this.getValue(t),r=o,d=o;typeof e<"u"&&arguments.length>1&&(r=e),typeof i<"u"&&arguments.length>2&&(d=i),n.callback(t,d,r);}}},hasKey(t){let e=te(ae,{});return t in e},execMenu(t,e,i=false){if(!(typeof t=="string"||typeof t=="object"&&Array.isArray(t)))throw new TypeError("key 必须是字符串或者字符串数组");let n=[];typeof t=="object"&&Array.isArray(t)?n=[...t]:n.push(t);let o;for(let r=0;r<n.length;r++){const d=n[r];if(!this.$data.data.has(d)){a.warn(`${t} 键不存在`);return}let s=u.getValue(d);if(i&&(s=!s),!s)break;o=s;}o&&e(o);},execMenuOnce(t,e,i,n){if(typeof t!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(t)){a.warn(`${t} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(t))return;this.$data.oneSuccessExecMenu.set(t,1);let o=()=>{let c=u.getValue(t);return typeof i=="function"?i(t,c):c},r=[],d=c=>{let f=o(),p=[];if(c instanceof HTMLStyleElement?p=[c]:Array.isArray(c)&&(p=[...c.filter(v=>v!=null&&v instanceof HTMLStyleElement)]),f)r=r.concat(p);else for(let v=0;v<p.length;v++)p[v].remove(),p.splice(v,1),v--;},s=c=>{let f=[];if(c){let p=e(c,d);p instanceof HTMLStyleElement?f=[p]:Array.isArray(p)&&(f=[...p.filter(v=>v!=null&&v instanceof HTMLStyleElement)]);}for(let p=0;p<r.length;p++)r[p].remove(),r.splice(p,1),p--;r=[...f];};this.addValueChangeListener(t,(c,f,p)=>{let v=p;typeof n=="function"&&(v=n(c,p,f)),s(v);});let l=o();l&&s(l);},execInheritMenuOnce(t,e,i,n){let o=this;const r=(d,s)=>{let l=o.getValue(d),c=o.getValue(s);if(typeof n=="function"){let f=n(l,c);if(f!==undefined)return f}return l};this.execMenuOnce(t,i,()=>r(t,e),()=>r(t,e)),this.execMenuOnce(e,()=>{},()=>false,()=>(this.triggerMenuValueChange(t),false));},onceExec(t,e){if(typeof t!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(t)||(e(),this.$data.onceExec.set(t,1));},showPanel(){A.panel({title:{text:`${Ce}-设置`,position:"center",html:false,style:""},content:this.getPanelContentConfig(),mask:{enable:true,clickEvent:{toClose:true,toHide:false}},width:J.setting.width,height:J.setting.height,drag:true,only:true});},showMPanel(){A.panel({title:{text:`${Ce}-设置`,position:"center",html:false,style:""},content:this.getMPanelContentConfig(),mask:{enable:true,clickEvent:{toClose:true,toHide:false}},width:J.setting.width,height:J.setting.height,drag:true,only:true});},getPanelContentConfig(){return [ft,Nt,Ht,kt,Gt]},getMPanelContentConfig(){return [Ft,Ut,Kt,It,Wt]}},Yt="抖音优化",m=ot.noConflict();let g=ze.noConflict();const A=rt,qt=_.console||ct.console,a=new m.Log(ge,qt);var qe;let Ce=((qe=ge==null?undefined:ge.script)==null?undefined:qe.name)||Yt;a.config({debug:false,logMaxCount:100,autoClearConsole:true,tag:true});C.config(Object.defineProperties({html:true,autoClose:true,showClose:false,zIndex:1e7},{position:{get(){return u.getValue("qmsg-config-position","bottom")}},maxNums:{get(){return u.getValue("qmsg-config-maxnums",5)}},showReverse:{get(){return u.getValue("qmsg-config-showreverse",true)}}}));const Xe=new m.GM_Menu({GM_getValue:te,GM_setValue:X,GM_registerMenuCommand:lt,GM_unregisterMenuCommand:st}),et=new m.Httpx(dt);et.interceptors.response.use(undefined,t=>(a.error(["拦截器-请求错误",t]),t.type==="onabort"?C.warning("请求取消"):t.type==="onerror"?C.error("请求异常"):t.type==="ontimeout"?C.error("请求超时"):C.error("其它错误"),t));const w=m.addStyle.bind(m),I=document.querySelector.bind(document),ne=document.querySelectorAll.bind(document);new m.GM_Cookie;const zt={init(){u.execInheritMenuOnce("shieldTopNavigator","search-shieldTopNavigator",()=>this.shieldTopNavigator(),(t,e)=>{if(S.isSearch()){if(e==1)return  true;if(e==0)return  false}}),u.execMenuOnce("shieldClientTip",()=>this.shieldClientTip()),u.execMenuOnce("shieldFillingBricksAndStones",()=>this.shieldFillingBricksAndStones()),u.execMenuOnce("shieldClient",()=>this.shieldClient()),u.execMenuOnce("shieldQuickAccess",()=>this.shieldQuickAccess()),u.execMenuOnce("shieldNotifitation",()=>this.shieldNotifitation()),u.execMenuOnce("shieldPrivateMessage",()=>this.shieldPrivateMessage()),u.execMenuOnce("shieldSubmission",()=>this.shieldSubmission()),u.execMenuOnce("shieldWallpaper",()=>this.shieldWallpaper()),u.execMenuOnce("shieldBottomQuestionButton",()=>this.shieldBottomQuestionButton()),u.execMenuOnce("shield-topNav-rightMenu",()=>this.shieldRightMenu()),u.execMenuOnce("shield-topNav-rightMenu-more",()=>this.shieldRightMenuMore()),u.execMenuOnce("shield-topNav-rightMenu-loginAvatar",()=>this.shieldRightMenuLoginAvatar());},shieldTopNavigator(){a.info("【屏蔽】顶部导航栏");let t=[];return t.push(y.addBlockCSS("#douyin-header")),t.push(w(`
			/* 修复视频的高度 */
			#douyin-right-container{
				padding-top: 0px !important;
			}
		`)),S.isSearch()&&t.push(w(`
				/* 把搜索顶部的工具栏置顶 */
				#search-content-area > div > div:nth-child(1) > div:nth-child(1){
					top: 0;
				}`)),t},shieldFillingBricksAndStones(){a.info("【屏蔽】充钻石");let t=[];const e='d="M5.60303 11.9999C5.60303 8.46713 8.46689 5.60327 11.9996 5.60327C14.2773 5.60327 16.2777 6.79321 17.412 8.5889C18.0354 9.57571 18.3962 10.7445 18.3962 11.9999C18.3962 15.5326 15.5324 18.3965 11.9996 18.3965C8.46689 18.3965 5.60303 15.5326 5.60303 11.9999ZM11.9996 4.10327C7.63846 4.10327 4.10303 7.6387 4.10303 11.9999C4.10303 16.3611 7.63846 19.8965 11.9996 19.8965C16.3608 19.8965 19.8962 16.3611 19.8962 11.9999C19.8962 10.4527 19.4505 9.0073 18.6802 7.78781C17.2826 5.57536 14.8133 4.10327 11.9996 4.10327ZM14.1261 7.62271V7.12561H12.6261V13.5879H12.6272C12.6272 14.442 11.9421 15.1238 11.11 15.1238C10.2778 15.1238 9.59277 14.442 9.59277 13.5879C9.59277 12.7338 10.2778 12.052 11.11 12.052V10.552C9.43784 10.552 8.09277 11.917 8.09277 13.5879C8.09277 15.2588 9.43784 16.6238 11.11 16.6238C12.7821 16.6238 14.1272 15.2588 14.1272 13.5879H14.1261V10.3601C14.6219 10.6754 15.2097 10.8582 15.8413 10.8582V9.35821C14.8998 9.35821 14.1261 8.58701 14.1261 7.62271Z"';return t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${e}])`,'body .semi-portal .semi-portal-inner li.semi-dropdown-item:has(a[href*="douyin_recharge"])')),S.isSearch()?t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${e}])`)):S.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])')),t},shieldClient(){a.info("【屏蔽】客户端");let t=[];return t.push(y.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[download^="douyin-downloader"])','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[href*="/douyin-pc-web/"])')),S.isSearch()?t.push(y.addBlockCSS('div:has(> div[data-e2e="something-button"] path[d="M18.404 19.018h-12v-1.5h12v1.5zM11.654 13.457v-8.19h1.5v8.19l3.22-3.22 1.06 1.061-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5 1.06-1.06 3.22 3.22z"])','div[id^="douyin-header-menu"] >  div > div > div:has(a[download^="douyin-downloader"])')):S.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container:has(a)','#douyin-header pace-island[id^="island"] > div[class] span:has(a[download][href*="client"])','.semi-portal-inner .semi-dropdown-content .semi-dropdown-item:has(a[download][href*="client"])')),t},shieldQuickAccess(){a.info("【屏蔽】快捷访问");let t=[];return t.push(y.addBlockCSS('header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(.quick-access-nav-icon)','div[id^="douyin-header-menu"] pace-island > div > div:has(.quick-access-nav-icon)')),S.isSearch()?(t.push(y.addBlockCSS("div:has(>div>div>.quick-access-nav-icon)")),m.waitNode('li.semi-dropdown-item[role="menuitem"]',1e4).then(e=>{if(!e)return;let i=m.mutationObserver(document.body,{config:{subtree:true,childList:true},callback(){let n=false;document.querySelectorAll('li.semi-dropdown-item[role="menuitem"]').forEach(o=>{var r;(r=o.textContent)!=null&&r.includes("快捷访问")&&(n=true,a.success("搜索-更多-快捷访问 移除元素"),o.remove());}),n&&i.disconnect();}});})):S.isLive(),t},shieldNotifitation(){a.info("【屏蔽】通知");let t=[];return t.push(y.addBlockCSS('#douyin-right-container #douyin-header-menuCt pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),S.isSearch()?t.push(y.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > ul:has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')):S.isLive()&&t.push(y.addBlockCSS('div[id^="douyin-header-menu"] pace-island[id^="island"] > * > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),t},shieldPrivateMessage(){a.info("【屏蔽】私信");let t=[];return t.push(y.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])','#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])')),S.isSearch()&&(a.info("搜索-【屏蔽】私信"),t.push(y.addBlockCSS('ul:has( div>div[data-e2e="im-entry"] )','div[id^="douyin-header-menu"] >  div > div > ul:has([data-e2e="im-entry"])'))),t},shieldSubmission(){a.info("【屏蔽】投稿");let t=[];const e='d="M11.3487 4.90125H11.3164H11.3164C10.2479 4.90124 9.40104 4.90124 8.71799 4.95587C8.01959 5.01173 7.42807 5.12824 6.88626 5.39747C5.95866 5.8584 5.20716 6.60991 4.74622 7.53751C4.477 8.07932 4.36048 8.67084 4.30462 9.36923C4.24999 10.0523 4.24999 10.8991 4.25 11.9677V12V12.0322C4.24999 13.1008 4.24999 13.9477 4.30462 14.6307C4.36048 15.3291 4.477 15.9206 4.74622 16.4624C5.20716 17.39 5.95866 18.1415 6.88626 18.6025C7.42807 18.8717 8.01959 18.9882 8.71799 19.0441C9.40104 19.0987 10.2479 19.0987 11.3164 19.0987H11.3487H12.6513H12.6836C13.7521 19.0987 14.599 19.0987 15.282 19.0441C15.9804 18.9882 16.5719 18.8717 17.1137 18.6025C18.0413 18.1415 18.7928 17.39 19.2538 16.4624C19.523 15.9206 19.6395 15.3291 19.6954 14.6307C19.75 13.9477 19.75 13.1008 19.75 12.0322V12V11.9677C19.75 10.8991 19.75 10.0523 19.6954 9.36923C19.6395 8.67084 19.523 8.07932 19.2538 7.53751C18.7928 6.60991 18.0413 5.8584 17.1137 5.39747C16.5719 5.12824 15.9804 5.01173 15.282 4.95587C14.599 4.90124 13.7521 4.90124 12.6836 4.90125H12.6513H11.3487ZM7.55376 6.74077C7.8529 6.59212 8.22981 6.4997 8.83757 6.45109C9.45382 6.4018 10.2407 6.40125 11.3487 6.40125H12.6513C13.7593 6.40125 14.5462 6.4018 15.1624 6.45109C15.7702 6.4997 16.1471 6.59212 16.4462 6.74077C17.0809 7.05614 17.5951 7.57033 17.9105 8.205C18.0591 8.50414 18.1515 8.88105 18.2002 9.48882C18.2494 10.1051 18.25 10.8919 18.25 12C18.25 13.108 18.2494 13.8949 18.2002 14.5111C18.1515 15.1189 18.0591 15.4958 17.9105 15.7949C17.5951 16.4296 17.0809 16.9438 16.4462 17.2592C16.1471 17.4078 15.7702 17.5002 15.1624 17.5488C14.5462 17.5981 13.7593 17.5987 12.6513 17.5987H11.3487C10.2407 17.5987 9.45382 17.5981 8.83757 17.5488C8.22981 17.5002 7.8529 17.4078 7.55376 17.2592C6.91909 16.9438 6.4049 16.4296 6.08952 15.7949C5.94088 15.4958 5.84846 15.1189 5.79985 14.5111C5.75056 13.8949 5.75 13.108 5.75 12C5.75 10.8919 5.75056 10.1051 5.79985 9.48882C5.84846 8.88105 5.94088 8.50414 6.08952 8.205C6.4049 7.57033 6.91909 7.05614 7.55376 6.74077ZM11.25 15V12.75H9V11.25H11.25V8.99997H12.75V11.25H15V12.75H12.75V15H11.25Z"';return t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${e}])`)),S.isSearch()?t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${e}])`)):S.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])')),t},shieldClientTip(){a.info("【屏蔽】客户端提示");let t=[];return t.push(y.addBlockCSS('ul li div[data-e2e="something-button"] + div div:has(>a[download*="douyin-downloader"])','#douyin-header pace-island[id^="island_"] ul > div:has(>a[class][download])','#douyin-header pace-island[id^="island_"] ul[class] li div[data-e2e="im-entry"]  div>div div div:has(a[download][href])','#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container div:has(+ #wallpaper-modal)')),S.isSearch()&&t.push(y.addBlockCSS('div[id^="douyin-header-menu"] ul li div[data-e2e="im-entry"] div > div > div:has(>a[download*="douyin-downloader"])','div[id^="douyin-header-menu"] ul > div:has(>a[download*="douyin-downloader"])')),t},shieldWallpaper(){a.info("【屏蔽】壁纸");let t=[];return t.push(y.addBlockCSS('div[id^="douyin-header-menu"] pace-island > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')),S.isSearch()?t.push(y.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')):S.isLive()&&t.push(y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container:has(span.semi-icon)','#douyin-header pace-island[id^="island"] > div[class] span:has(.semi-icon)')),t},shieldBottomQuestionButton(){return a.info("屏蔽底部问题按钮"),y.addBlockCSS(["#douyin-sidebar","#douyin-temp-sidebar"])},shieldRightMenu(){return a.info("【屏蔽】右侧菜单栏"),y.addBlockCSS('div[id^="douyin-header-menu"]')},shieldRightMenuMore(){return a.info("【屏蔽】更多"),y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M17 8.75H7V7.25H17V8.75ZM17 12.75H7V11.25H17V12.75ZM7 16.75H17V15.25H7V16.75Z"])')},shieldRightMenuLoginAvatar(){return a.info("【屏蔽】登录头像"),y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M6.484 43.177c4.765-5.408 11.743-8.821 19.517-8.821 7.775 0 14.753 3.413 19.517 8.821C40.754 48.587 33.776 52 26.001 52c-7.774 0-14.752-3.413-19.517-8.822zM35.287 21.356a9.286 9.286 0 1 1-18.571 0 9.286 9.286 0 0 1 18.571 0z"])','#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has([data-e2e="live-avatar"])')}},jt={init(){u.execMenuOnce("shieldSearch",()=>this.shieldSearch()),u.execMenuOnce("shieldSearchPlaceholder",()=>this.shieldSearchPlaceholder()),u.execMenuOnce("shieldSearchGuessYouWantToSearch",()=>this.shieldSearchGuessYouWantToSearch()),u.execMenuOnce("shieldSearchTiktokHotspot",()=>this.shieldSearchTiktokHotspot());},shieldSearch(){return a.info("【屏蔽】搜索框"),y.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div:has(input[data-e2e="searchbar-input"])')},shieldSearchPlaceholder(){a.info("【屏蔽】搜索框的提示");let t=[];return t.push(y.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div div:has( + input[data-e2e="searchbar-input"])')),t.push(w(`
			#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div input[data-e2e="searchbar-input"]::placeholder{
				color: transparent;
			}`)),t},shieldSearchGuessYouWantToSearch(){return a.info("【屏蔽】搜索-猜你想搜"),y.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-guess-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-guess-container"]')},shieldSearchTiktokHotspot(){return a.info("【屏蔽】搜索-抖音热点"),y.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-hot-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-hot-container"]')}},We={$data:{document_addEventListener:[],element_addEventListener:[],setTimeout:[],setInterval:[],function_apply:[],function_call:[],defineProperty:[]},document_addEventListener(t){if(this.$data.document_addEventListener.push(t),a.info("document.addEventListener hook新增劫持判断回调"),this.$data.document_addEventListener.length>1)return;const e=this;let i=new WeakMap;const n=_.document.addEventListener,o=_.document.removeEventListener;_.document.addEventListener=function(...r){let d=this,s=r[0],l=r[1],c=r[2];for(let f=0;f<e.$data.document_addEventListener.length;f++){const p=e.$data.document_addEventListener[f],v=Reflect.apply(p,this,[d,s,l,c]);if(typeof v=="function"){r[1]=v,i.set(l,{eventName:s,fn:v,options:c});break}else if(typeof v=="boolean"&&!v)return}return Reflect.apply(n,this,r)},_.document.removeEventListener=function(...r){let d=r[0],s=r[1],l=r[2];if(i.has(s)){const{eventName:c,fn:f,options:p}=i.get(s);let v=false;d===c&&(typeof l=="boolean"&&l===p||typeof l=="object"&&typeof p=="object"&&l.capture===p.capture||l==l)&&(v=true),v&&(r[1]=f);}return Reflect.apply(o,this,r)};},element_addEventListener(t){if(this.$data.element_addEventListener.push(t),a.info("Element.prototype.addEventListener hook新增劫持判断回调"),this.$data.element_addEventListener.length>1)return;const e=this;let i=new WeakMap;const n=_.Element.prototype.addEventListener,o=_.Element.prototype.removeEventListener;_.Element.prototype.addEventListener=function(...r){let d=this,s=r[0],l=r[1],c=r[2];for(let f=0;f<e.$data.element_addEventListener.length;f++){const p=e.$data.element_addEventListener[f],v=Reflect.apply(p,this,[d,s,l,c]);if(typeof v=="function"){r[1]=v,i.set(l,{eventName:s,fn:v,options:c});break}else if(typeof v=="boolean"&&!v)return}return Reflect.apply(n,this,r)},_.Element.prototype.removeEventListener=function(...r){let d=r[0],s=r[1],l=r[2];if(i.has(s)){const{eventName:c,fn:f,options:p}=i.get(s);let v=false;c===d&&(typeof l=="boolean"&&l===p||typeof l=="object"&&typeof p=="object"&&l.capture===p.capture||l==p)&&(v=true),v&&(r[1]=f);}return Reflect.apply(o,this,r)};},setTimeout(t){if(this.$data.setTimeout.push(t),a.info("window.setTimeout hook新增劫持"),this.$data.setTimeout.length>1)return;const e=this;let i=_.setTimeout;_.setTimeout=function(...n){let o=n[0],r=n[1];for(let d=0;d<e.$data.setTimeout.length;d++){const s=e.$data.setTimeout[d],l=s(o,r);if(typeof l=="boolean"&&!l)return}return Reflect.apply(i,this,n)};},setInterval(t){if(this.$data.setInterval.push(t),a.info("window.setInterval hook新增劫持"),this.$data.setInterval.length>1)return;const e=this;let i=_.setInterval;_.setInterval=function(...n){let o=n[0],r=n[1];for(let d=0;d<e.$data.setInterval.length;d++){const s=e.$data.setInterval[d],l=s(o,r);if(typeof l=="boolean"&&!l)return}return Reflect.apply(i,this,n)};},function_apply(t){if(this.$data.function_apply.push(t),a.info("Function.prototype.apply hook新增劫持"),this.$data.function_apply.length>1)return;const e=this;let i=_.Function.prototype.apply;_.Function.prototype.apply=function(...n){let o=n[0],r=n[1],d=this;for(let s=0;s<e.$data.function_apply.length;s++){const l=e.$data.function_apply[s],c=l(d,o,r);if(c!=null){n[0]=c.thisArg,n[1]=c.argArray,d=c.context;break}}return Reflect.apply(i,d,n)};},function_call(t){if(this.$data.function_call.push(t),a.info("Function.prototype.call hook新增劫持"),this.$data.function_call.length>1)return;const e=this;let i=_.Function.prototype.call;_.Function.prototype.call=function(...n){let o=n[0],r=n.slice(1),d=this;for(let s=0;s<e.$data.function_call.length;s++){const l=e.$data.function_call[s],c=l(d,o,r);if(c!=null){n[0]=c.thisArg,n.splice(1,r.length,...c.argArray),d=c.context;break}}return Reflect.apply(i,d,n)};},defineProperty(t){if(this.$data.defineProperty.push(t),a.info("Object.defineProperty hook新增劫持"),this.$data.defineProperty.length>1)return;const e=this;let i=_.Object.defineProperty;_.Object.defineProperty=function(...n){let o=n[0],r=n[1],d=n[2];for(let s=0;s<e.$data.defineProperty.length;s++){const l=e.$data.defineProperty[s],c=l(o,r,d);if(c!=null){n[0]=c.target,n[1]=c.key,n[2]=c.attributes;break}}return Reflect.apply(i,this,n)};},window_webpack(t="webpackJsonp",e,i){let n;_.Object.defineProperty(_,t,{get(){return n},set(o){a.success("成功劫持webpack，当前webpack名："+t),n=o;const r=n.push;n.push=function(...d){let s=d[0][0];return (e==s||Array.isArray(e)&&Array.isArray(s)&&JSON.stringify(e)===JSON.stringify(s))&&Object.keys(d[0][1]).forEach(l=>{let c=d[0][1][l];d[0][1][l]=function(...f){let p=c.call(this,...f);return f[0]=i(f[0]),p};}),Reflect.apply(r,this,d)};}});}},xe={$data:{hookElementAddEventListener:[]},init(){u.onceExec("hookKeyboard",()=>{xe.disableShortCut();}),u.execMenu("dy-cookie-remove__ac__",()=>{this.removeCookie();}),S.isIndex()?u.execMenuOnce("dy-video-disableDoubleClickLike",()=>{xe.disableDoubleClickLike();}):S.isLive()&&u.execMenuOnce("dy-live-disableDoubleClickLike",()=>{xe.disableDoubleClickLike();});},removeEnvCheck(){a.info("移除环境检测");let t=_.setInterval;_.setInterval=function(e,i){let n=e.toString().trim();if(n.includes("debugger")){a.success(["拦截→",[n]]);return}if(n.includes("checkEXp")){a.success(["拦截→",[n]]);return}return t.call(this,e,i)};},removeCookie(){let t=new m.GM_Cookie;["__ac_signature","__ac_referer","__ac_nonce"].forEach(i=>{t.delete({name:i,firstPartyDomain:""},n=>{n?a.error(`移除Cookie失败 ==> ${i}`,n):a.success(`移除Cookie成功 ==> ${i}`);});});},disableShortCut(){We.document_addEventListener((t,e,i,n)=>{if(["keydown","keypress","keyup"].includes(e)&&typeof i=="function")return function(...o){let r=o[0];r.key;let d=r.code;r.charCode||r.keyCode||r.which;let s=[];r.ctrlKey&&s.push("ctrl"),r.altKey&&s.push("alt"),r.metaKey&&s.push("meta"),r.shiftKey&&s.push("shift");let l=[{enableKey:"dy-keyboard-hook-likeOrDislike",code:["KeyZ"]},{enableKey:"dy-keyboard-hook-comment",code:["KeyX"]},{enableKey:"dy-keyboard-hook-danmaku-enable",code:["KeyB"]},{enableKey:"dy-keyboard-hook-collect-enable",code:["KeyC"]},{enableKey:"dy-keyboard-hook-copyShareLink",code:["KeyV"]},{enableKey:"dy-keyboard-hook-clearScreen",code:["KeyJ"]},{enableKey:"dy-keyboard-hook-automaticBroadcast",code:["KeyK"]},{enableKey:"dy-keyboard-hook-videoInfo",code:["KeyI"]},{enableKey:"dy-keyboard-hook-notInterested",code:["KeyR"]},{enableKey:"dy-keyboard-hook-enterAuthorHomePage",code:["KeyF"]},{enableKey:"dy-keyboard-hook-follow",code:["KeyG"]},{enableKey:"dy-keyboard-hook-search",code:["KeyF"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheCurrentPageWithOneClick",code:["KeyQ"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-pageUpAndDown",code:["ArrowUp","ArrowDown"]},{enableKey:"dy-keyboard-hook-fastForwardAndFastBack",code:["ArrowLeft","ArrowRight"]},{enableKey:"dy-keyboard-hook-pause",code:["Space"]},{enableKey:"dy-keyboard-hook-fullScreenInsideThePage",code:["KeyY"]},{enableKey:"dy-keyboard-hook-fullScreen",code:["KeyH"]},{enableKey:"dy-keyboard-hook-watchItOutLater",code:["KeyL"]},{enableKey:"dy-keyboard-hook-volumeAdjustment",code:["Minus"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-listOfCallShortcutKeys",code:["Slash"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheShortcutKeyList",code:["Escape"]},{enableKey:"dy-keyboard-hook-relevantRecommendation",code:["KeyN"]}];S.isIndex()?l.push({enableKey:"dy-keyboard-hook-arrowUp-w",code:["KeyW"]},{enableKey:"dy-keyboard-hook-arrowDown-s",code:["KeyS"]},{enableKey:"dy-keyboard-hook-videoRewind",code:["KeyA"]},{enableKey:"dy-keyboard-hook-videoFastForward",code:["KeyD"]}):S.isLive()&&l.push({enableKey:"dy-live-refresh",code:["KeyE"]},{enableKey:"dy-live-screenRotation",code:["KeyD"]},{enableKey:"dy-live-enableSmallWindowMode",code:["KeyU"]});for(let c=0;c<l.length;c++){const f=l[c];if(f.code.includes(d)){if(Array.isArray(f.otherCodeList)&&f.otherCodeList.find(v=>!s.includes(v))||!u.getValue(f.enableKey))continue;return}}return Reflect.apply(i,this,o)}});},disableDoubleClickLike(){let t=Date.now();We.element_addEventListener((e,i,n,o)=>{var d;const r=n.toString();if(i==="click"&&e instanceof HTMLElement&&((d=e==null?undefined:e.classList)!=null&&d.contains("xgplayer"))&&r.match(/video|innerContainer|video.__canvas|mouse/))return function(...s){let l=Date.now();if(l-t<=288){t=l,a.success("阻止触发双击点赞");return}t=l,Reflect.apply(n,this,s);}});}},Ge={watchFeedVideoListChange(t){let e=null;g.ready(()=>{m.waitAnyNode(["#slidelist",'#search-content-area ul[data-e2e="scroll-list"]']).then(i=>{a.info("启用观察器观察加载的视频");let n=new m.LockFunction(o=>{if(e=e||this.getOSElement(),!e){a.error("watchVideDataListChange：获取osElement失败");return}t(e,o);},50);m.mutationObserver(document.body,{config:{childList:true,subtree:true},immediate:true,callback:(o,r)=>{n.run(r);}});});});},getOSElement(){return I("#root div[class*='-os']")||I("#douyin-right-container")}},Ye={disguiseLogin(){a.info("伪装登录");const t=2e4;let i=Object.defineProperty({},"uid",{value:996996,writable:false});function n(r){var c,f,p,v,b,k,x,M,T,R,K,z,N,V,O,H,F,j,U,Q,W,oe,D,$,ce,ue,he,fe,pe,me;let d=[],s=m.getReactObj(r),l=s==null?undefined:s.reactFiber;return s==null||s.reactProps,(p=(f=(c=l==null?undefined:l.alternate)==null?undefined:c.return)==null?undefined:f.memoizedProps)!=null&&p.userInfo&&d.push((k=(b=(v=l==null?undefined:l.alternate)==null?undefined:v.return)==null?undefined:b.memoizedProps)==null?undefined:k.userInfo),(R=(T=(M=(x=l==null?undefined:l.alternate)==null?undefined:x.return)==null?undefined:M.memoizedProps)==null?undefined:T.userInfo)!=null&&R.userInfo&&d.push((N=(z=(K=l==null?undefined:l.alternate)==null?undefined:K.return)==null?undefined:z.memoizedProps)==null?undefined:N.userInfo.userInfo),(F=(H=(O=(V=l==null?undefined:l.alternate)==null?undefined:V.return)==null?undefined:O.return)==null?undefined:H.memoizedProps)!=null&&F.userInfo&&d.push((W=(Q=(U=(j=l==null?undefined:l.alternate)==null?undefined:j.return)==null?undefined:U.return)==null?undefined:Q.memoizedProps)==null?undefined:W.userInfo),(ue=(ce=($=(D=(oe=l==null?undefined:l.alternate)==null?undefined:oe.return)==null?undefined:D.return)==null?undefined:$.memoizedProps)==null?undefined:ce.userInfo)!=null&&ue.userInfo&&d.push((me=(pe=(fe=(he=l==null?undefined:l.alternate)==null?undefined:he.return)==null?undefined:fe.return)==null?undefined:pe.memoizedProps)==null?undefined:me.userInfo.userInfo),d}function o(r){n(r).forEach(d=>{Object.defineProperties(d,{info:{value:i,writable:false},isLogin:{value:true,writable:false}});});}if(Ge.watchFeedVideoListChange(r=>{o(r);}),m.waitNode("#root div[class*='-os']",t).then(()=>{let r=new m.LockFunction(()=>{let d=Ge.getOSElement();d&&o(d);},70);m.mutationObserver(document.body,{config:{subtree:true,childList:true},immediate:true,callback:()=>{r.run();}});}).catch(r=>{}),S.isLive())a.info("伪装登录：live"),m.waitNode("#douyin-header div:has(.dy-tip-container)",t).then(()=>{let r=new m.LockFunction(()=>{o(I("#douyin-header"));},70);m.mutationObserver(document.body,{config:{subtree:true,childList:true},callback:()=>{r.run();}});});else if(S.isSearch()){let r=function(d){var c,f,p,v,b,k,x;let s=m.getReactObj(d);s==null||s.reactFiber;let l=s==null?undefined:s.reactProps;typeof((v=(p=(f=(c=l==null?undefined:l.children)==null?undefined:c[1])==null?undefined:f.props)==null?undefined:p.userInfo)==null?undefined:v.isLogin)=="boolean"&&Reflect.set(l.children[1].props.userInfo,"isLogin",true),typeof((x=(k=(b=l==null?undefined:l.children)==null?undefined:b[1])==null?undefined:k.props)==null?undefined:x.isClient)=="boolean"&&Reflect.set(l.children[1].props,"isClient",true);};a.info("伪装登录：search"),m.waitNode("#root > div",t).then(d=>{if(!d){a.error("#root > div获取失败");return}let s=new m.LockFunction(()=>{r(d);},70);m.mutationObserver(document,{config:{subtree:true,childList:true},callback:()=>{s.run();}});});}},watchLoginDialogToClose(){a.info("监听登录弹窗并关闭");let t=[y.addBlockCSS('div[id^="login-full-panel-"]')];return m.waitNode("body").then(()=>{m.mutationObserver(document.body,{config:{subtree:true,childList:true},callback(){var i,n;if(!u.getValue("watchLoginDialogToClose"))return;let e=I('body > div[id^="login-full-panel-"] .dy-account-close');e&&((n=(i=m.getReactObj(e))==null?undefined:i.reactProps)==null||n.onClick(new Event("click")));}});}),t}},Qt={init(){u.execMenu("douyin-redirect-url-home-to-root",()=>{this.redirectUrlHomeToRoot();});},redirectUrlHomeToRoot(){window.location.pathname==="/home"&&(a.info("从首页跳转到根目录"),window.location.href=window.location.origin+"/?is_from_mobile_home=1&recommend=1");}},Jt=`/* 去除顶部的padding距离 */\r
#douyin-right-container {\r
	padding-top: 0;\r
}\r
/* 放大放大顶部的综合、视频、用户等header的宽度 */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) {\r
	width: 100vw;\r
}\r
/* 放大顶部的综合、视频、用户等header */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) > div {\r
	transform: scale(0.8);\r
}\r
/* 视频宽度 */\r
ul[data-e2e="scroll-list"] {\r
	padding: 0px 10px;\r
}\r
#sliderVideo {\r
	width: -webkit-fill-available;\r
}\r
/* 距离是顶部导航栏的高度 */\r
#search-content-area {\r
	margin-top: 65px;\r
}\r
/* 从其它页面进入搜索页面，例如路径是/root/search，会出现返回按钮 */\r
#douyin-header header{\r
	flex-direction: row-reverse !important;\r
}\r
#douyin-header header > div:nth-child(2) {\r
	position: unset !important;\r
}\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#sliderVideo {\r
		width: 100%;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#component-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: -webkit-fill-available;\r
		padding-right: 0;\r
	}\r
}\r
`,Zt={init(){u.execMenuOnce("douyin-search-shieldReleatedSearches",()=>this.shieldReleatedSearches());},shieldReleatedSearches(){return a.info("【屏蔽】相关搜索"),[y.addBlockCSS("#search-content-area > div > div:nth-child(2)"),w(`
			#search-content-area > div > div:nth-child(1) > div:nth-child(1){
				width: 100vw;
			}`)]}},Xt={init(){Zt.init(),u.execMenuOnce("mobileMode",()=>this.mobileMode()),u.execMenuOnce("dy-search-disableClickToEnterFullScreen",()=>{this.disableClickToEnterFullScreen();}),u.execMenuOnce("live-setSearchResultFilterWithVideoStyle",t=>this.setSearchResultFilterWithVideoStyle(t));},mobileMode(){a.info("搜索-手机模式");let t=[];return t.push(w(Jt)),t.push(w(`
			@media screen and (max-width: 550px){
				div#search-body-container {
					display: flex;
				}
				div#search-body-container #component-Navigation {
					flex: 0;
				}
				div#search-body-container #douyin-right-container {
					flex: 1 auto;
				}
				div#search-body-container #douyin-right-container #search-content-area > div {
					width: 100% !important;
				}
				div#search-body-container #douyin-right-container #search-content-area > div > div > div {
					width: 100% !important;
					margin-left: 0px;
					margin-right: 0px;
					padding-left: 0px;
					padding-right: 0px;
				}
				/* 上面的搜索结果筛选 */
				#search-content-area > div >div> div:first-child > div:first-child > div:last-child{
					overflow: auto;
					text-wrap: nowrap;
					height: auto;
				}
				/* 视频右侧的TA的作品↓ */
				#searchSideCard{
					width: unset !important;
				}
				#searchSideCard > div{
					padding: 0px !important;
				}
				#searchSideCard > div:has(>div+svg),
				#searchSideCard ul[data-e2e="scroll-list"]{
					padding: 0px 10px !important;
				}
				#searchSideCard ul[data-e2e="scroll-list"] .video-playing-item > div{
					width: auto;
				}
				/* 视频右侧的TA的作品↑ */
				/* 悬浮的筛选 */
				#douyin-right-container #douyin-header{
        			background-color: var(--color-bg-b0);
				}
				xg-right-grid{
					margin: auto !important;
				}
			}
		`)),m.waitNode("#relatedVideoCard").then(e=>{a.info("评论区展开的className："+e.className),t.push(w(`
					html[data-vertical-screen]
						#sliderVideo[data-e2e="feed-active-video"]
						#videoSideBar:has(#relatedVideoCard[class="${e.className}"]) {
							width: 100vw !important;
					}`));}),t},disableClickToEnterFullScreen(){a.info("搜索-禁止点击视频区域进入全屏"),g.on(document,"click",".focusPanel",t=>{var o;m.preventEvent(t);let n=((o=t.target.parentElement)==null?undefined:o.parentElement).querySelector("video");n?n.paused?(a.info(".focusPanel：播放视频"),n.play()):(a.info(".focusPanel：视频暂停"),n.pause()):(a.error(".focusPanel未找到<video>标签"),C.error(".focusPanel未找到<video>标签",{isHTML:false}));},{capture:true}),g.on(document,"click","xg-video-container",t=>{m.preventEvent(t);let i=t.target.querySelector("video");i?i.paused?(a.info("xg-video-container：播放视频"),i.play()):(a.info("xg-video-container：视频暂停"),i.pause()):(a.error("xg-video-container未找到<video>标签"),C.error("xg-video-container未找到<video>标签",{isHTML:false}));},{capture:true});},setSearchResultFilterWithVideoStyle(t="one"){if(a.info(`设置搜索结果-按视频过滤的显示样式：${t}`),t==="one")return w(`
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(100% - 21px);
				}
			}
			`);if(t==="double")return w(`	
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(50% - 21px);
				}
			}
			`)}},ei={init(){u.execInheritMenuOnce("shieldLeftNavigator","search-shieldLeftNavigator",()=>this.shieldLeftNavigator(),(t,e)=>{if(S.isSearch()){if(e==1)return  true;if(e==0)return  false}}),u.execMenuOnce("shieldLeftNavigator-tab-home",()=>this.block_tab_home()),u.execMenuOnce("shieldLeftNavigator-tab-recommend",()=>this.block_tab_recommend()),u.execMenuOnce("shieldLeftNavigator-tab-follow",()=>this.block_tab_follow()),u.execMenuOnce("shieldLeftNavigator-tab-friend",()=>this.block_tab_friend()),u.execMenuOnce("shieldLeftNavigator-tab-user_self",()=>this.block_tab_user_self()),u.execMenuOnce("shieldLeftNavigator-tab-user_self_like",()=>this.block_tab_user_self_like()),u.execMenuOnce("shieldLeftNavigator-tab-user_self_collection",()=>this.block_tab_user_self_collection()),u.execMenuOnce("shieldLeftNavigator-tab-user_self_record",()=>this.block_tab_user_self_record()),u.execMenuOnce("shieldLeftNavigator-tab-olympics",()=>this.block_tab_olympics()),u.execMenuOnce("shieldLeftNavigator-tab-live",()=>this.block_tab_live()),u.execMenuOnce("shieldLeftNavigator-tab-vs",()=>this.block_tab_vs()),u.execMenuOnce("shieldLeftNavigator-tab-series",()=>this.block_tab_series()),u.execMenuOnce("shieldLeftNavigator-tab-channel_300203",()=>this.block_tab_channel_300203()),u.execMenuOnce("shieldLeftNavigator-tab-channel_300205",()=>this.block_tab_channel_300205()),u.execMenuOnce("shieldLeftNavigator-tab-channel_300206",()=>this.block_tab_channel_300206()),u.execMenuOnce("shieldLeftNavigator-tab-channel_300209",()=>this.block_tab_channel_300209()),u.execMenuOnce("shieldLeftNavigator-tab-channel_300204",()=>this.block_tab_channel_300204()),u.execMenuOnce("shieldLeftNavigator-tab-activity_2644292",()=>this.block_tab_activity_2644292()),u.execMenuOnce("shieldLeftNavigator-tab-activity_2643710",()=>this.block_tab_activity_2643710());},shieldLeftNavigator(){a.info("【屏蔽】左侧导航栏");let t=[];return t.push(y.addBlockCSS("#douyin-navigation")),t.push(w(`
			/* 修复顶部导航栏的宽度 */
			#douyin-header{
				width: 100%;
			}`)),t},block_tab_home(){return a.info("【屏蔽】首页"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-discover)')},block_tab_recommend(){return a.info("【屏蔽】推荐"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-recommend)')},block_tab_follow(){return a.info("【屏蔽】关注"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-follow)')},block_tab_friend(){return a.info("【屏蔽】朋友"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-friend)')},block_tab_user_self(){return a.info("【屏蔽】我的"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self)')},block_tab_user_self_like(){return a.info("【屏蔽】喜欢"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_like)')},block_tab_user_self_collection(){return a.info("【屏蔽】收藏"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_collection)')},block_tab_user_self_record(){return a.info("【屏蔽】观看历史"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_record)')},block_tab_olympics(){return a.info("【屏蔽】看奥运"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-olympics)')},block_tab_live(){return a.info("【屏蔽】直播"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-live)')},block_tab_vs(){return a.info("【屏蔽】放映厅"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-vs)')},block_tab_series(){return a.info("短剧"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-series)')},block_tab_channel_300203(){return a.info("【屏蔽】知识"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300203)')},block_tab_channel_300205(){return a.info("【屏蔽】游戏"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300205)')},block_tab_channel_300206(){return a.info("【屏蔽】二次元"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300206)')},block_tab_channel_300209(){return a.info("【屏蔽】音乐"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300209)')},block_tab_channel_300204(){return a.info("【屏蔽】美食"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300204)')},block_tab_activity_2644292(){return a.info("【屏蔽】美好跨年季"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has([class^="tab-activity_"] img[alt="抖音美好跨年季"])')},block_tab_activity_2643710(){return a.info("【屏蔽】2025新春环游记"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has([class^="tab-activity_"] img[alt="2025新春环游记"])')}},ti=`/* 从顶部往下弹出的下载抖音电脑版的drawer提示 */\r
#douyin-web-download-guide-container\r
/* 视频信息区域的 及时接收作品更新提醒 下载电脑客户端 */\r
/* 但是这个CSS又会屏蔽右键菜单 */\r
/*.basePlayerContainer xg-bar.xg-right-bar + div:not(:has(>svg))*/ ,\r
/* 下载客户端，使用壁纸 */\r
div:has(+#wallpaper-modal),\r
/* 下载客户端，实时接收消息通知 */\r
/* 下载客户端，实时接收好友消息 */\r
div:has(> a[download*="douyin-downloade"]):has(+.popShadowAnimation),\r
div:has(> a[download*="douyin-downloade"]):has(+div>[data-e2e="listDlgTest-container"]),\r
/* 客户端登录访问更便捷 */\r
div:has(> a[download*="douyin-downloade"]):has(+.userMenuPanelShadowAnimation),\r
/* 前往电脑客户端，即享下载视频 */\r
[data-e2e="video-share-container"] div:has(>div>div> a[download*="douyin-downloader"]):first-child {\r
	display: none !important;\r
}\r
`,ii=`/* 资料右边的 下载桌面客户端，桌面快捷访问 */\r
div[data-e2e="user-detail"] div:has(> div > a[href*="douyin-pc"]) {\r
	display: none !important;\r
}\r
`,ni={init(){w(ii),g.ready(()=>{u.execMenu("dy-user-addShowUserUID",()=>{this.addShowUserUID();});});},addShowUserUID(){Qe.waitReactPropsToSet('[data-e2e="user-detail"] [data-e2e="user-info"]',"reactFiber",{msg:"显示UID",check(t){var e,i,n;return typeof((n=(i=(e=t==null?undefined:t.return)==null?undefined:e.memoizedProps)==null?undefined:i.userInfo)==null?undefined:n.uid)=="string"},set(t,e){var o,r,d;let i=(d=(r=(o=t==null?undefined:t.return)==null?undefined:o.memoizedProps)==null?undefined:r.userInfo)==null?undefined:d.uid;g.remove(e.querySelectorAll(".gm-user-uid"));let n=g.createElement("p",{className:"gm-user-uid",innerHTML:`
							<span>UID：${i}</span>
						`},{style:"color: var(--color-text-t3);margin-right: 20px;font-size: 12px;line-height: 20px;cursor: pointer;"});g.on(n,"click",s=>{m.preventEvent(s),m.setClip(i),C.success("复制成功");}),e.appendChild(n);}});}},oi=`/* 单个视频页面右侧的 下载客户端，桌面快捷访问 */\r
div[data-e2e="video-detail"]\r
	div\r
	> :has(> div:last-child > a[href*="douyin-pc-web"]) {\r
	display: none !important;\r
}\r
`,ri={init(){w(oi);}},ai=`/* 右侧视频信息里的 下载客户端，桌面快捷访问 */\r
[data-e2e="note-detail"]\r
	div:has(> [data-e2e="user-info"])\r
	> div:has(a[download*="douyin-downloader"]) {\r
	display: none !important;\r
}\r
`,li={init(){w(ai);}},tt={init(){u.onceExec("dy-global-block-css",()=>{w(ti);}),Bt(),xe.init(),ke.init(),Qt.init(),u.execMenuOnce("watchLoginDialogToClose",()=>{Ye.watchLoginDialogToClose();}),u.execMenuOnce("disguiseLogin",()=>{Ye.disguiseLogin();}),u.execMenuOnce("dy-initialScale",()=>{this.initialScale();}),u.execMenu("dy-apple-removeMetaAppleItunesApp",()=>{this.removeMetaAppleItunesApp();}),ei.init(),zt.init(),jt.init(),u.execMenuOnce("dy-common-listenRouterChange",()=>{this.listenRouterChange();}),S.isLive()?(a.info("Router: 直播"),bt.init()):S.isIndex()?(ie.init(),S.isSearch()?(a.info("Router: 搜索"),Xt.init()):S.isUser()?(a.info("Router: 用户页面"),ni.init()):S.isVideo()?(a.info("Router: 单个视频页面"),ri.init()):S.isChannel()?a.info("Router: Channel页面"):S.isNote()?(a.info("Router:  笔记页面"),li.init()):a.error("未适配router: "+window.location.pathname)):a.error("未适配router: "+window.location.href);},initialScale(){a.info("设置<meta>的viewport固定缩放倍率为1并移除页面原有的<meta>"),g.ready(()=>{let t=g.createElement("meta",{},{name:"viewport",content:"width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"});g.remove("meta[name='viewport']"),m.waitNode("head").then(()=>{document.head.appendChild(t);});});},removeMetaAppleItunesApp(){m.waitNodeList(['meta[name="apple-itunes-app"]'],1e4).then(t=>{t&&t.forEach(e=>{e.remove();});});},listenRouterChange(){a.info("监听Router重载"),g.on(window,"wb_url_change",t=>{a.info("Router Change"),this.init();});}},se={isMDouYin(){return window.location.hostname==="m.douyin.com"||window.location.hostname==="www.iesdouyin.com"},isShareUser(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/user/")},isShareVideo(){return this.isMDouYin()&&(window.location.pathname.startsWith("/share/video/")||window.location.pathname.startsWith("/shipin/"))},isShareNote(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/note/")},isShareMusic(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/music/")},isShareChallenge(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/challenge/")}},si=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 上面屏蔽后的空白区域 */\r
.user-card .nav-bar-placeholder,\r
/* 视频区域底部的【打开抖音App看更多内容】 */\r
.select-list .img-button{\r
    display: none !important;\r
}`,ee={getVideoUrl(t){return "https://www.douyin.com/video/"+t},getCollectionUrl(t){return "https://www.douyin.com/collection/"+t},getNoteUrl(t){return "https://www.douyin.com/note/"+t},getHashTagUrl(t){return "https://www.douyin.com/hashtag/"+t},getUserHomeUrl(t){return "https://www.douyin.com/user/"+t},getMusicUrl(t){return "https://www.douyin.com/music/"+t}},di={init(){w(si),u.execMenuOnce("m-dy-share-user-coverPlayletList",()=>{this.coverPlayletList();}),u.execMenuOnce("m-dy-share-user-coverPostListContainer",()=>{this.coverPostListContainer();});},coverPlayletList(){g.on(document,"click",".user-playlet-list .playlet-item",t=>{var l,c,f,p;m.preventEvent(t);let e=t.target,i=(l=m.getReactObj(e))==null?undefined:l.reactFiber;if((i==null?undefined:i.key)==null){C.error("获取视频合集key失败");return}let o=i==null?undefined:i.index;if(o==null){C.error("获取视频合集index失败");return}let r=(p=(f=(c=i==null?undefined:i.return)==null?undefined:c.return)==null?undefined:f.pendingProps)==null?undefined:p.playletList;if(r==null){C.error("获取视频合集playletList失败");return}let d=r[o],s=ee.getCollectionUrl(d.mix_id);window.open(s,"_blank");},{capture:true});},coverPostListContainer(){g.on(document,"click",".post-list-container .user-post-cover",t=>{var n,o,r,d,s;m.preventEvent(t);let e=t.target,i=(n=m.getReactObj(e))==null?undefined:n.reactFiber;if((r=(o=i==null?undefined:i.return)==null?undefined:o.memoizedProps)!=null&&r.productionUrl){let l=(s=(d=i==null?undefined:i.return)==null?undefined:d.memoizedProps)==null?undefined:s.productionUrl;window.open(l,"_blank");}else C.error("获取视频链接失败");},{capture:true});}},ci=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 视频描述信息区域中的 打开抖音看精彩视频 */\r
.footer .img-button,\r
/* 登录页面 */\r
.login-page ,\r
/* 底部左下角 打开抖音看精彩视频 */\r
.footer .bottom-btn-con-new,\r
/* 合集 打开抖音看精彩视频 */\r
.container .end-page-info-button {\r
	display: none !important;\r
}\r
`,ui=`.video-container {\r
	height: 100% !important;\r
	margin-top: 0 !important;\r
}\r
.footer {\r
	bottom: 50px !important;\r
}\r
.mix-info {\r
	bottom: 0px !important;\r
}\r
`,hi={init(){w(ci),w(ui),u.execMenuOnce("m-dy-share-video-coverGlobalClick",()=>{this.coverGlobalClick();});},coverGlobalClick(){[".right-con",".footer",".mix-info"].forEach(e=>{ze.on(document,"click",e,i=>m.preventEvent(i),{capture:true});});}},fi=`/* 顶部 打开看看 登录 */\r
.container .adapt-login-header,\r
/* 底部中间的 App内打开 */\r
.container .float-button-con {\r
	display: none !important;\r
}\r
\r
.gallery-container {\r
	margin-top: 10px !important;\r
}\r
`,pi={init(){w(fi),u.execMenuOnce("m-dy-share-note-blockRecommend",()=>this.blockRecommend()),u.execMenuOnce("m-dy-share-note-blockComment",()=>this.blockComment()),u.execMenuOnce("m-dy-share-note-blockFooterToobar",()=>this.blockFooterToobar()),u.execMenuOnce("m-dy-share-note-coverUser",()=>{this.coverUser();}),u.execMenuOnce("m-dy-share-note-coverHashTag",()=>{this.coverHashTag();}),u.execMenuOnce("m-dy-share-note-coverMusic",()=>{this.coverMusic();}),u.execMenuOnce("m-dy-share-note-coverRecommend",()=>{this.coverRecommend();}),u.execMenuOnce("m-dy-share-note-coverExcitingGraphicsAndText",()=>{this.coverExcitingGraphicsAndText();});},blockRecommend(){return a.info("【屏蔽】相关推荐"),y.addBlockCSS(".recommend-con")},blockComment(){return a.info("【屏蔽】评论"),y.addBlockCSS(".comment-con")},blockFooterToobar(){return a.info("【屏蔽】底部工具栏"),y.addBlockCSS(".footer-con")},coverRecommend(){a.info("覆盖相关推荐的点击事件"),g.on(document,"click","#masonry .card",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.memoizedProps.awemeId,o=ee.getNoteUrl(n);window.open(o,"_blank");},{capture:true});},coverUser(){a.info("覆盖用户点击事件"),g.on(document,"click",".message-con__top",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.memoizedProps.video.authorInfo.sec_uid,o=ee.getUserHomeUrl(n);window.open(o,"_blank");},{capture:true});},coverHashTag(){a.info("覆盖话题点击事件"),g.on(document,"click",".message-con__content__body .message-con__content__body-text",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.index,d=i.return.return.return.return.memoizedProps.video.splitStrArr[n].hashtagId,s=ee.getHashTagUrl(d);window.open(s,"_blank");},{capture:true});},coverMusic(){a.info("覆盖音乐点击事件"),g.on(document,"click",".message-con__footer",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.memoizedProps.video.musicId,o=ee.getMusicUrl(n);window.open(o,"_blank");},{capture:true});},coverExcitingGraphicsAndText(){a.info("覆盖精彩图文点击事件"),g.on(document,"click",".container .related-list-con .related-note-item",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let o=i.return.memoizedProps.itemData.awemeId,r=ee.getNoteUrl(o);window.open(r,"_blank");},{capture:true}),g.on(document,"click",".related-title-con",t=>m.preventEvent(t),{capture:true});}},mi=`/* 顶部 打开看看 登录 */\r
.page-reflow-challenge .header,\r
/* 底部的 打开抖音App看更多内容 */\r
.page-reflow-challenge .bottom-btn__con {\r
	display: none !important;\r
}\r
\r
.page-reflow-challenge {\r
	padding-top: 0 !important;\r
}\r
`,vi={init(){w(mi),u.onceExec("m-dy-share-challenge-coverTopJump",()=>{this.coverTopJump();}),u.execMenuOnce("m-dy-share-challenge-coverVideoCard",()=>{this.coverVideoCard();});},coverTopJump(){a.info("阻止上面区域点击跳转至下载页面"),g.on(document,"click",".challenge-body",t=>{m.preventEvent(t);},{capture:true});},coverVideoCard(){a.info("覆盖视频卡片点击事件"),g.on(document,"click","#pagelet-worklist li.item",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.return.memoizedProps.listData,o=i.index,r=n[o],d=ee.getVideoUrl(r.aweme_id);window.open(d,"_blank");},{capture:true});}},yi=`/* 顶部 打开App，发现更多内容 */\r
.page-reflow-music .header,\r
/* ↑屏蔽后的 顶部空白区域 */\r
.page-reflow-music .banner-placeholder ,\r
/* 底部 打开抖音App看更多内容 */\r
.page-reflow-music .bottom-btn__con {\r
	display: none !important;\r
}\r
`,gi={init(){w(yi),u.execMenuOnce("m-dy-share-music-coverVideoCard",()=>{this.coverVideoCard();});},coverVideoCard(){a.info("覆盖视频卡片点击事件"),g.on(document,"click","#pagelet-worklist li.item",t=>{m.preventEvent(t);let e=t.target,i=m.getReactObj(e).reactFiber;if(!i){a.error("获取reactFiber失败"),C.error("获取reactFiber失败");return}let n=i.return.return.return.memoizedProps.listData,o=i.index,r=n[o],d=ee.getVideoUrl(r.aweme_id);window.open(d,"_blank");},{capture:true});}},bi={init(){se.isShareUser()?(a.info("M-Router: 分享用户"),di.init()):se.isShareVideo()?(a.info("M-Router: 分享视频"),hi.init()):se.isShareNote()?(a.info("M-Router: 分享笔记"),pi.init()):se.isShareChallenge()?(a.info("M-Router: 分享话题"),vi.init()):se.isShareMusic()?(a.info("M-Router: 分享音乐"),gi.init()):a.error("未知M-router: "+window.location.hostname);}};u.init();se.isMDouYin()?bi.init():tt.init();

})(Qmsg, Utils, DOMUtils, pops);