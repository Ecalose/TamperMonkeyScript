// ==UserScript==
// @name         抖音优化
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2024.7.31
// @author       WhiteSevs
// @description  视频过滤，包括广告、直播或自定义规则，伪装登录、屏蔽登录弹窗、自定义清晰度选择、未登录解锁画质选择、禁止自动播放、自动进入全屏、双击进入全屏、屏蔽弹幕和礼物特效、手机模式、修复进度条拖拽、自定义视频和评论区背景色等
// @license      GPL-3.0-only
// @icon         data:image/png;base64,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
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*.douyin.com/*
// @match        *://*.iesdouyin.com/*
// @require      https://update.greasyfork.org/scripts/494167/1413255/CoverUMD.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.2.1/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.1.0/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.3.0/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@1.5.0/dist/index.umd.js
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (y, Ve, Me, Ee) {
	'use strict';

	var xe=e=>{throw TypeError(e)};var be=(e,i,t)=>i.has(e)||xe("Cannot "+t);var T=(e,i,t)=>(be(e,i,"read from private field"),t?t.call(e):i.get(e)),j=(e,i,t)=>i.has(e)?xe("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t),H=(e,i,t,o)=>(be(e,i,"write to private field"),i.set(e,t),t);var k=typeof GM_getValue<"u"?GM_getValue:void 0,U=typeof GM_info<"u"?GM_info:void 0,Te=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,E=typeof GM_setValue<"u"?GM_setValue:void 0,Le=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,Re=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,B=typeof unsafeWindow<"u"?unsafeWindow:void 0,Ae=window;const L="GM_Panel",F="data-key",Y="data-default-value",$=function(e,i,t,o,n,a){let l=[];typeof o=="function"?l=o():l=o;let d={text:e,type:"select",description:a,attributes:{},getValue(){return s.getValue(i,t)},callback(c,m,f){s.setValue(i,m),typeof n=="function"&&n(c,m,f);},data:l};return d.attributes&&(d.attributes[F]=i,d.attributes[Y]=t),d},h=function(e,i,t,o,n){let a={text:e,type:"switch",description:n,attributes:{},getValue(){return !!s.getValue(i,t)},callback(l,d){r.success(`${d?"开启":"关闭"} ${e}`),s.setValue(i,!!d);},afterAddToUListCallBack:void 0};return a.attributes&&(a.attributes[F]=i,a.attributes[Y]=!!t),a},Pe={id:"panel-config-common",title:"通用",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("debug模式","debug",!0,void 0,"移除抖音的开发者模式检测"),h("伪装登录","disguiseLogin",!1,void 0,"使用随机UID进行伪装"),h("initial-scale=1","dy-initialScale",!1,void 0,"可配合手机模式放大页面"),h("移除<meta> apple-itunes-app","dy-apple-removeMetaAppleItunesApp",!0,void 0,"Safari使用，移除顶部横幅【Open in the 抖音 app】")]}]},{text:"Url重定向",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("重定向/home","douyin-redirect-url-home-to-root",!1,void 0,"/home => /")]}]},{text:"Toast配置",type:"deepMenu",forms:[{text:"",type:"forms",forms:[$("Toast位置","qmsg-config-position","bottom",[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],(e,i,t)=>{r.info("设置当前Qmsg弹出位置"+t);},"Toast显示在页面九宫格的位置"),$("最多显示的数量","qmsg-config-maxnums",3,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,"限制Toast显示的数量"),h("逆序弹出","qmsg-config-showreverse",!1,void 0,"修改Toast弹出的顺序")]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-通用",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】登录弹窗","watchLoginDialogToClose",!0,void 0,"屏蔽元素且自动等待元素出现并关闭登录弹窗"),h("【屏蔽】底部？按钮","shieldBottomQuestionButton",!0,void 0,"屏蔽元素")]}]},{text:"屏蔽-主框架",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】客户端提示","shieldClientTip",!0,void 0,"屏蔽元素"),h("【屏蔽】充钻石","shieldFillingBricksAndStones",!0,void 0,"屏蔽元素"),h("【屏蔽】客户端","shieldClient",!0,void 0,"屏蔽元素"),h("【屏蔽】快捷访问","shieldQuickAccess",!1,void 0,"屏蔽元素"),h("【屏蔽】通知","shieldNotifitation",!1,void 0,"屏蔽元素"),h("【屏蔽】私信","shieldPrivateMessage",!1,void 0,"屏蔽元素"),h("【屏蔽】投稿","shieldSubmission",!1,void 0,"屏蔽元素"),h("【屏蔽】壁纸","shieldWallpaper",!1,void 0,"屏蔽元素"),h("【屏蔽】左侧导航栏","shieldLeftNavigator",!1,void 0,"屏蔽元素"),h("【屏蔽】顶部导航栏","shieldTopNavigator",!1,void 0,"屏蔽元素")]}]},{text:"屏蔽-搜索",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】搜索框","shieldSearch",!1,void 0,"屏蔽元素"),h("【屏蔽】搜索框的提示","shieldSearchPlaceholder",!1,void 0,"屏蔽元素"),h("【屏蔽】猜你想搜","shieldSearchGuessYouWantToSearch",!1,void 0,"屏蔽元素"),h("【屏蔽】抖音热点","shieldSearchTiktokHotspot",!1,void 0,"屏蔽元素")]}]}]}]},G={key:"douyin-live-danmu-rule",$data:{rule:[],isFilterAttrName:"data-is-filter"},init(){this.parseRule();},parseRule(){this.get().trim().split(`
`).forEach(t=>{if(t.trim()=="")return;t=t.trim();let o=new RegExp(t.trim());this.$data.rule.push(o);});},change(){var i,t,o,n,a,l,d;let e=Array.from(document.querySelectorAll("xg-danmu.xgplayer-danmu > div > div"));if(e.length)for(let c=0;c<e.length;c++){let m=e[c];if(m.hasAttribute(this.$data.isFilterAttrName))continue;let f=(n=(o=(t=(i=u.getReactObj(m))==null?void 0:i.reactFiber)==null?void 0:t.return)==null?void 0:o.memoizedProps)==null?void 0:n.message,g=((a=f==null?void 0:f.payload)==null?void 0:a.content)||((d=(l=f==null?void 0:f.payload)==null?void 0:l.common)==null?void 0:d.describe);for(let b=0;b<this.$data.rule.length;b++){const w=this.$data.rule[b];if(typeof g=="string"&&w.test(g)){r.info("过滤弹幕: "+g),m.setAttribute(this.$data.isFilterAttrName,"true"),v.hide(m);break}}}},set(e){E(this.key,e);},get(){return k(this.key,"")}},De={filterDanmu(){u.waitNode("xg-danmu.xgplayer-danmu",1e5).then(e=>{if(!e){r.error("xg-danmu.xgplayer-danmu获取失败");return}r.success("弹幕过滤"),G.init(),u.mutationObserver(e,{config:{childList:!0,subtree:!0},callback:()=>{G.change();}});});}},Ie={async waitReactPropsToSet(e,i,t){function o(){let n=null;return typeof e=="string"?n=document.querySelector(e):typeof e=="function"?n=e():e instanceof HTMLElement&&(n=e),n}typeof e=="string"&&!await u.waitNode(e,1e4)||t.forEach(n=>{typeof n.msg=="string"&&r.info(n.msg);function a(){let l=o();if(l==null)return !1;let d=u.getReactObj(l);if(d==null)return !1;let c=d[i];return c==null?!1:!!n.check(c)}u.waitPropertyByInterval(()=>o(),a,250,1e4).then(()=>{let l=o();if(l==null)return;let d=u.getReactObj(l);if(d==null)return;let c=d[i];c!=null&&n.set(c);});});}},p={isVerticalScreen(){return !window.screen.orientation.type.includes("landscape")},addBlockCSS(...e){let i=[];if(e.length!==0&&!(e.length===1&&typeof e[0]=="string"&&e[0].trim()===""))return e.forEach(t=>{Array.isArray(t)?i=i.concat(t):i.push(t);}),u.addStyle(`${i.join(`,
`)}{display: none !important;}`)}},Oe={init(){s.execMenuOnce("live-shieldChatRoom",()=>this.shieldChatRoom()),s.execMenuOnce("live-shielChatRoomVipSeats",()=>this.shielChatRoomVipSeats()),s.execMenuOnce("dy-live-shieldUserLevelIcon",()=>this.shieldUserLevelIcon()),s.execMenuOnce("dy-live-shieldUserVIPIcon",()=>this.shieldUserVIPIcon()),s.execMenuOnce("dy-live-shieldUserFansIcon",()=>this.shieldUserFansIcon()),s.execMenuOnce("dy-live-shieldMessage",()=>this.shieldMessage());},shieldChatRoom(){return r.info("【屏蔽】评论区"),[p.addBlockCSS("#chatroom"),x(`
            div[data-e2e="living-container"],
            div[data-e2e="living-container"] > div{
                margin-bottom: 0px !important;
            }`)]},shielChatRoomVipSeats(){return r.info("【屏蔽】评论区的贵宾席"),[p.addBlockCSS("#chatroom > div > div:has(#audiencePanelScrollId)")]},shieldUserLevelIcon(){return r.info("【屏蔽】用户等级图标"),[p.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="level"])')]},shieldUserVIPIcon(){return r.info("【屏蔽】VIP图标"),[p.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="subscribe"])')]},shieldUserFansIcon(){return r.info("【屏蔽】粉丝牌"),[p.addBlockCSS('.webcast-chatroom___item span:has(>div[style*="fansclub"])')]},shieldMessage(){return r.info("【屏蔽】信息播报"),[p.addBlockCSS(".webcast-chatroom___bottom-message",'#chatroom >div>div>div:has(>div[elementtiming="element-timing"])')]}},$e={init(){s.execMenuOnce("live-shieldDanmuku",()=>this.shieldDanmu());},shieldDanmu(){return r.info("屏蔽弹幕"),[p.addBlockCSS("xg-danmu.xgplayer-danmu")]}},Ne={init(){s.execMenuOnce("live-shieldGiftColumn",()=>this.shieldGiftColumn()),s.execMenuOnce("live-shieldTopToolBarInfo",()=>this.shieldTopToolBarInfo()),s.execMenuOnce("live-shieldGiftEffects",()=>this.shieldGiftEffects()),s.execMenuOnce("live-shielYellowCar",()=>this.shieldYellowCar()),Oe.init(),$e.init();},shieldGiftColumn(){return r.info("屏蔽底部的礼物栏"),[p.addBlockCSS('div[data-e2e="living-container"] >div> :last-child','div[data-e2e="living-container"] xg-controls > div:has(div[data-e2e="gifts-container"])'),x(`
            /* 去除全屏状态下的礼物栏后，上面的工具栏bottom也去除 */
            div[data-e2e="living-container"] xg-controls xg-inner-controls:has(+div div[data-e2e="gifts-container"]){
                bottom: 0 !important;
            }`)]},shieldTopToolBarInfo(){return r.info("【屏蔽】顶栏信息"),[p.addBlockCSS('div[data-e2e="living-container"] > div > pace-island[id^="island_"]')]},shieldGiftEffects(){return r.info("【屏蔽】礼物特效"),[p.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"]  pace-island[id^="island_"]:has(>div>div:not([class*="video_layout_container"])>div)')]},shieldYellowCar(){return r.info("【屏蔽】小黄车"),[p.addBlockCSS('#living_room_player_container .basicPlayer  > div:has(div[data-e2e="yellowCart-container"])')]}},D={auto:{label:"自动",sign:0},ld:{label:"标清",sign:1},sd:{label:"高清",sign:2},hd:{label:"超清",sign:3},uhd:{label:"蓝光",sign:4},origin:{label:"潮汐海灵",sign:5}},ze={init(){Ne.init(),s.execMenu("live-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),s.execMenu("live-danmu-shield-rule-enable",()=>{De.filterDanmu();}),s.execMenu("live-chooseQuality",e=>{e!=="auto"&&this.chooseQuality(e);}),s.execMenu("live-unlockImageQuality",()=>{this.unlockImageQuality();}),s.execMenuOnce("live-waitToRemovePauseDialog",()=>{this.waitToRemovePauseDialog();}),s.execMenu("live-pauseVideo",()=>{this.pauseVideo();}),s.execMenu("live-bgColor-enable",()=>{s.execMenuOnce("live-changeBackgroundColor",e=>{this.changeBackgroundColor(e);});});},autoEnterElementFullScreen(){r.info("自动进入网页全屏"),u.waitNode('xg-icon[classname] > div > div:has(path[d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(e=>{e.click();});},chooseQuality(e="origin"){Ie.waitReactPropsToSet('xg-inner-controls xg-right-grid >div:has([data-e2e="quality-selector"])',"reactProps",[{check(i){var t,o,n,a;return typeof((a=(n=(o=(t=i==null?void 0:i.children)==null?void 0:t.props)==null?void 0:o.children)==null?void 0:n.props)==null?void 0:a.qualityHandler)=="object"},set(i){let t=i.children.props.children.props.qualityHandler,o=t.getCurrentQualityList();if(o.includes(e))t.setCurrentQuality(e),r.success("成功设置画质为【"+e+"】");else {let n=e;y.error("当前直播没有【"+n+"】画质，自动选择最高画质"),o.sort((a,l)=>D[a]?D[l]?D[a].sign-D[l].sign:(r.error("画质【"+l+"】不存在"),0):(r.error("画质【"+a+"】不存在"),0)),n=o[o.length-1],t.setCurrentQuality(e),r.success("成功设置画质为【"+e+"】");}}}]);},unlockImageQuality(){r.info("解锁画质选择"),v.on(document,"click",'div[data-e2e="quality-selector"] > div',function(e){var t,o;u.preventEvent(e);let i=e.target;try{let n=u.getReactObj(i),a=(t=n==null?void 0:n.reactFiber)==null?void 0:t.key,l=i.closest("div[data-index]"),d=u.getReactObj(l),c=(o=d==null?void 0:d.reactProps)==null?void 0:o.children.ref.current;r.info("当前选择的画质: "+a),r.info(["所有的画质: ",c.getCurrentQualityList()]),c.setCurrentQuality(a);}catch(n){r.error(n),y.error("切换画质失败");}},{capture:!0});},waitToRemovePauseDialog(){r.info("监听【长时间无操作，已暂停播放】弹窗");function e(t,o,n){let a=t[o];if(typeof a=="object")return typeof a[n]=="function"?a[n]:e(a,o,n)}function i(t,o){var n,a,l,d,c,m;if(t.innerText.includes("长时间无操作")&&t.innerText.includes("暂停播放")){r.info(`检测${o}：出现【长时间无操作，已暂停播放】弹窗`),y.info(`检测${o}：出现【长时间无操作，已暂停播放】弹窗`);let f=u.getReactObj(t);if(typeof f.reactContainer=="object"){let g=e(f.reactContainer,"child","onClose")||((m=(c=(d=(l=(a=(n=f==null?void 0:f.reactContainer)==null?void 0:n.memoizedState)==null?void 0:a.element)==null?void 0:l.props)==null?void 0:d.children)==null?void 0:c.props)==null?void 0:m.onClose);typeof g=="function"&&(r.success(`检测${o}：调用onClose关闭弹窗`),y.success("调用onClose关闭弹窗"),g());}}}v.ready(()=>{u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){document.querySelectorAll("body > div[elementtiming='element-timing']").forEach(t=>{i(t,"1");}),document.querySelectorAll('body > div:not([id="root"])').forEach(t=>{i(t,"2");});}});});},pauseVideo(){r.info("禁止自动播放视频(直播)"),u.waitNode('.basicPlayer[data-e2e="basicPlayer"] video').then(e=>{v.on(e,"play",()=>{e.pause();},{capture:!0,once:!0}),e.autoplay=!1,e.pause();});},changeBackgroundColor(e){r.info("修改视频背景颜色"),x(`
		#living_room_player_container > div,
		#chatroom > div{
			background: ${e};
		}	
		`);}},He={id:"panel-config-live",title:"直播",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[$("清晰度","live-chooseQuality","auto",Object.keys(D).map(e=>{let i=D[e];return {value:e,text:i.label}}),void 0,"自行选择清晰度"),h("解锁画质选择","live-unlockImageQuality",!0,void 0,"未登录的情况下选择原画实际上是未登录的情况下最高选择的画质"),h("自动进入网页全屏","live-autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),h("监听并关闭【长时间无操作，已暂停播放】弹窗","live-waitToRemovePauseDialog",!0,void 0,"自动监听并检测弹窗"),h("禁止自动播放","live-pauseVideo",!1,void 0,"暂停直播播放")]},{text:"视频区域背景色",type:"forms",forms:[h("启用","live-bgColor-enable",!1,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"live-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(e){let i=v.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),t=v.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),o=t.querySelector(".pops-color-choose");o.value=s.getValue("live-changeBackgroundColor");let n=v.createElement("style");return v.append(document.head,n),v.on(o,["input","propertychange"],a=>{r.info("选择颜色："+o.value),n.innerHTML=`
											#living_room_player_container > div,
											#chatroom > div{
												background: ${o.value};
											}
											`,s.setValue("live-changeBackgroundColor",o.value);}),e.appendChild(i),e.appendChild(t),e}}]}]},{text:"过滤-弹幕",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("启用","live-danmu-shield-rule-enable",!1,void 0,"启用自定义的弹幕过滤规则"),{type:"own",getLiElementCallBack(e){let i=v.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),t=i.querySelector("textarea");return t.value=G.get(),v.on(t,["input","propertychange"],u.debounce(function(){G.set(t.value);},200)),e.appendChild(i),e}}]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-视频区域内",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】顶栏信息","live-shieldTopToolBarInfo",!1,void 0,"屏蔽元素，包括直播作者、右侧的礼物展馆"),h("【屏蔽】底部的礼物栏","live-shieldGiftColumn",!1,void 0,"屏蔽元素"),h("【屏蔽】礼物特效","live-shieldGiftEffects",!1,void 0,"屏蔽元素"),h("【屏蔽】弹幕","live-shieldDanmuku",!1,void 0,"屏蔽元素"),h("【屏蔽】小黄车","live-shielYellowCar",!1,void 0,"屏蔽元素")]}]},{text:"屏蔽-聊天室",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】聊天室","live-shieldChatRoom",!1,void 0,"屏蔽元素"),h("【屏蔽】贵宾席","live-shielChatRoomVipSeats",!1,void 0,"屏蔽元素"),h("【屏蔽】用户等级图标","dy-live-shieldUserLevelIcon",!1,void 0,"屏蔽元素"),h("【屏蔽】VIP图标","dy-live-shieldUserVIPIcon",!1,void 0,"屏蔽元素"),h("【屏蔽】粉丝牌","dy-live-shieldUserFansIcon",!1,void 0,"屏蔽元素"),h("【屏蔽】信息播报","dy-live-shieldMessage",!1,void 0,"底部滚动播报的的xxx来了，xxx给主播点赞")]}]}]}]},q={watchVideDataListChange(e){let i=null;v.ready(()=>{u.waitAnyNode(["#slidelist",'#search-content-area ul[data-e2e="scroll-list"]']).then(t=>{u.mutationObserver(t,{config:{childList:!0,subtree:!0},callback:()=>{if(i||(i=this.getOSElement()),!i){r.error("watchVideDataListChange：获取osElement失败");return}e(i);}});});});},getOSElement(){return document.querySelector("#root div[class*='-os']")||document.querySelector("#douyin-right-container")}},I={key:"douyin-shield-rule",$data:{__rule:null,get rule(){return I.$data.__rule==null&&(I.$data.__rule=new u.Dictionary),I.$data.__rule},isFirstLoad:!0},init(){this.parseRule(),r.info(["当前自定义视频拦截规则: ",this.$data.rule.getItems()]);let e=null;q.watchVideDataListChange(u.debounce(i=>{var a;let t=document.querySelector('#slidelist div[data-e2e="slideList"]');if(!t){r.error("未获取到视频列表元素");return}let o=(a=u.getReactObj(t))==null?void 0:a.reactFiber;if(o==null){r.error(["元素上不存在reactFiber属性",t]);return}let n=o==null?void 0:o.return.memoizedProps.data;if(n.length){if(this.$data.isFirstLoad){let l=n[n.length-1];if(e==null&&(e=l.awemeId),e===l.awemeId)return;this.$data.isFirstLoad=!1;}for(let l=0;l<n.length;l++){let d=n[l];this.checkAwemeInfo(d)&&(n.splice(l,1),l--);}}},50));},checkAwemeInfo(e){var a,l,d,c;let i=this.getVideoInfoTagMap(e),t=s.getValue("shieldVideo-live"),o=s.getValue("shieldVideo-ads"),n=!1;if(n||typeof e.cellRoom=="object"&&t&&(r.success("过滤器-屏蔽直播: because cellRoom is not null"),n=!0),n||o&&(e.isAds?(n=!0,r.success("过滤器-屏蔽广告: because isAds is true")):typeof e.rawAdData=="string"&&u.isNotNull(e.rawAdData)?(n=!0,r.success("过滤器-屏蔽广告: because rawAdData is not null")):(l=(a=e.webRawData)==null?void 0:a.brandAd)!=null&&l.is_ad?(n=!0,r.success("过滤器-屏蔽广告: because webRawData.brandAd.is_ad is true")):(c=(d=e.webRawData)==null?void 0:d.insertInfo)!=null&&c.is_ad&&(n=!0,r.success("过滤器-屏蔽广告: because webRawData.insertInfo.is_ad is true"))),!n)for(const[m,f]of this.$data.rule.entries()){if(!(m in i))continue;let g=i[m];if(g!=null){if(typeof g=="string"){if(n=!!g.match(f),n){r.success(["过滤器-自定义屏蔽: "+m+"  "+f,i]);break}}else if(typeof g=="object"&&Array.isArray(g)&&g.find(w=>!!w.match(f))){n=!0,r.success(["过滤器-自定义屏蔽: "+m+"  "+f,i]);break}}}return n},getVideoInfoTagMap(e){var l,d,c,m,f,g;let i=(d=(l=e==null?void 0:e.authorInfo)==null?void 0:l.nickname)==null?void 0:d.toString(),t=(m=(c=e==null?void 0:e.authorInfo)==null?void 0:c.uid)==null?void 0:m.toString(),o=(f=e==null?void 0:e.desc)==null?void 0:f.toString(),n=[];typeof(e==null?void 0:e.textExtra)=="object"&&Array.isArray(e==null?void 0:e.textExtra)&&((g=e==null?void 0:e.textExtra)==null||g.forEach(b=>{n.push(b.hashtagName);}));let a=[];return typeof(e==null?void 0:e.videoTag)=="object"&&Array.isArray(e==null?void 0:e.videoTag)&&(e==null||e.videoTag.forEach(b=>{a.push(b.tagName);})),{nickname:i,uid:t,desc:o,textExtra:n,videoTag:a}},parseRule(){this.get().trim().split(`
`).forEach(t=>{if(u.isNull(t))return;let n=t.trim().split("##");if(n.length<2)return;let a=n[0];n.shift();let l=n.join("");try{let d=new RegExp(l,"g");this.$data.rule.set(a,d);}catch(d){r.error(["自定义视频过滤规则-正则解析错误："+d]),r.error("错误的规则："+t);}});},set(e){E(this.key,e);},get(){return k(this.key,"")}},Ce=function(e,i,t,o,n,a,l,d){return {text:e,type:"button",description:i,buttonIcon:o,buttonIsRightIcon:n,buttonIconIsLoading:a,buttonType:l,buttonText:t,callback(m){typeof d=="function"&&d(m);},afterAddToUListCallBack:void 0}};var _,A;class Ue{constructor(i){j(this,_,"short-cut");j(this,A,!1);typeof i=="string"&&H(this,_,i);}getValue(i,t){let o=k(T(this,_),[]);return i?o.find(a=>a.key===i)??t:o}setValue(i,t,o,n){let a=k(T(this,_),[]);a.push({key:i,value:{keyName:t,keyValue:o,ohterCodeList:n}}),E(T(this,_),a);}deleteValue(i){let t=!1,o=k(T(this,_),[]),n=o.findIndex(a=>a.key===i);return n!==-1&&(o.splice(n,1),t=!0),E(T(this,_),o),t}getShowText(i,t){let o=this.getValue(i);if(o){let n="";return o.value.ohterCodeList.forEach(a=>{o.key===i&&(n+=u.stringTitleToUpperCase(a,!0)+" + ");}),n+=o.value.keyName,n}else return t}inputShortCut(i,t,o){if((this.getValue(i)??t)===t){let a=y.loading("请按下快捷键...",{showClose:!0,onClose(){l.removeListen();}});H(this,A,!0);let l=u.listenKeyboard(window,"keyup",(d,c,m)=>{let f=JSON.stringify({keyName:d,keyValue:c,ohterCodeList:m}),g=this.getValue();for(let b=0;b<g.length;b++)if(f===JSON.stringify(g[b].value)){y.error(`快捷键 ${this.getShowText(g[b].key,d)} 已被占用`),H(this,A,!1),a.close();return}this.setValue(i,d,c,m),typeof o=="function"&&o(this.getShowText(i,t)),H(this,A,!1),a.close();});}else this.deleteValue(i);typeof o=="function"&&o(this.getShowText(i,t));}initGlobalKeyboardListener(i){let t=this.getValue();t.length&&u.listenKeyboard(window,"keydown",(o,n,a)=>{if(T(this,A))return;t=this.getValue();let l=t.findIndex(d=>{let c=d.value,m={keyName:o,keyValue:n,ohterCodeList:a};if(JSON.stringify(c)===JSON.stringify(m))return d});if(l!=-1){let d=t[l];r.info(["调用快捷键",d]),d.key in i&&i[d.key].callback();}});}}_=new WeakMap,A=new WeakMap;const Fe=`/* 去除顶部的padding距离 */\r
#douyin-right-container {\r
	padding-top: 0;\r
}\r
/* 放大放大顶部的综合、视频、用户等header的宽度 */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) {\r
	width: 100vw;\r
}\r
/* 放大顶部的综合、视频、用户等header */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) > div {\r
	transform: scale(0.8);\r
}\r
/* 视频宽度 */\r
ul[data-e2e="scroll-list"] {\r
	padding: 0px 10px;\r
}\r
#sliderVideo {\r
	width: -webkit-fill-available;\r
}\r
/* 距离是顶部导航栏的高度 */\r
#search-content-area {\r
	margin-top: 65px;\r
}\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#sliderVideo {\r
		width: 100%;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#component-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: -webkit-fill-available;\r
		padding-right: 0;\r
	}\r
}\r
`,Ye={init(){s.execMenuOnce("douyin-search-shieldReleatedSearches",()=>this.shieldReleatedSearches());},shieldReleatedSearches(){return r.info("【屏蔽】相关搜索"),[p.addBlockCSS("#search-content-area > div > div:nth-child(2)"),x(`
			#search-content-area > div > div:nth-child(1) > div:nth-child(1){
				width: 100vw;
			}`)]}},O={key:"douyin-search-shield-rule",$data:{__rule:null,get rule(){return O.$data.__rule==null&&(O.$data.__rule=new u.Dictionary),O.$data.__rule}},init(){this.parseRule(),r.info(["当前自定义视频拦截规则: ",this.$data.rule.getItems()]),q.watchVideDataListChange(u.debounce(e=>{var t,o,n,a;let i=Array.from(document.querySelectorAll('#search-content-area ul[data-e2e="scroll-list"] li'));if(!i.length){r.error("未获取到视频列表元素");return}for(let l=0;l<i.length;l++){const d=i[l];let c=(t=u.getReactObj(d))==null?void 0:t.reactProps;if(c==null){r.error(["元素上不存在reactProps属性",d]);return}let m=(a=(n=(o=c==null?void 0:c.children)==null?void 0:o.props)==null?void 0:n.data)==null?void 0:a.awemeInfo;if(m==null){r.error(["元素上不存在awemeInfo属性",d]);return}this.checkAwemeInfo(m)&&(d.remove(),l--);}},50));},checkAwemeInfo(e){var a,l,d,c;let i=this.getVideoInfoTagMap(e),t=s.getValue("search-shieldVideo-live"),o=s.getValue("search-shieldVideo-ads"),n=!1;if(n||typeof e.cellRoom=="object"&&t&&(r.success("过滤器-屏蔽直播: because cellRoom is not null"),n=!0),n||o&&(e.isAds?(n=!0,r.success("过滤器-屏蔽广告: because isAds is true")):typeof e.rawAdData=="string"&&u.isNotNull(e.rawAdData)?(n=!0,r.success("过滤器-屏蔽广告: because rawAdData is not null")):(l=(a=e.webRawData)==null?void 0:a.brandAd)!=null&&l.is_ad?(n=!0,r.success("过滤器-屏蔽广告: because webRawData.brandAd.is_ad is true")):(c=(d=e.webRawData)==null?void 0:d.insertInfo)!=null&&c.is_ad&&(n=!0,r.success("过滤器-屏蔽广告: because webRawData.insertInfo.is_ad is true"))),!n)for(const[m,f]of this.$data.rule.entries()){if(!(m in i))continue;let g=i[m];if(g!=null){if(typeof g=="string"){if(n=!!g.match(f),n){r.success(["过滤器-自定义屏蔽: "+m+"  "+f,i]);break}}else if(typeof g=="object"&&Array.isArray(g)&&g.find(w=>!!w.match(f))){n=!0,r.success(["过滤器-自定义屏蔽: "+m+"  "+f,i]);break}}}return n},getVideoInfoTagMap(e){var l,d,c,m,f,g;let i=(d=(l=e==null?void 0:e.authorInfo)==null?void 0:l.nickname)==null?void 0:d.toString(),t=(m=(c=e==null?void 0:e.authorInfo)==null?void 0:c.uid)==null?void 0:m.toString(),o=(f=e==null?void 0:e.desc)==null?void 0:f.toString(),n=[];typeof(e==null?void 0:e.textExtra)=="object"&&Array.isArray(e==null?void 0:e.textExtra)&&((g=e==null?void 0:e.textExtra)==null||g.forEach(b=>{n.push(b.hashtagName);}));let a=[];return typeof(e==null?void 0:e.videoTag)=="object"&&Array.isArray(e==null?void 0:e.videoTag)&&(e==null||e.videoTag.forEach(b=>{a.push(b.tagName);})),{nickname:i,uid:t,desc:o,textExtra:n,videoTag:a}},parseRule(){this.get().trim().split(`
`).forEach(t=>{if(u.isNull(t))return;let n=t.trim().split("##");if(n.length<2)return;let a=n[0];n.shift();let l=n.join("");try{let d=new RegExp(l,"g");this.$data.rule.set(a,d);}catch(d){r.error(["自定义视频过滤规则-正则解析错误："+d]),r.error("错误的规则："+t);}});},set(e){E(this.key,e);},get(){return k(this.key,"")}},_e={init(){Ye.init(),s.execMenuOnce("search-shieldVideo",()=>{O.init();}),s.execMenuOnce("dy-search-disableClickToEnterFullScreen",()=>{this.disableClickToEnterFullScreen();});},mobileMode(){r.info("搜索-手机模式");let e=[];e.push(x(Fe)),e.push(x(`
			@media screen and (max-width: 550px){
				div#search-body-container {
					display: flex;
				}
				div#search-body-container #component-Navigation {
					flex: 0;
				}
				div#search-body-container #douyin-right-container {
					flex: 1 auto;
				}
				div#search-body-container #douyin-right-container #search-content-area > div {
					width: 100% !important;
				}
				div#search-body-container #douyin-right-container #search-content-area > div > div > div {
					width: 100% !important;
					margin-left: 0px;
					margin-right: 0px;
					padding-left: 0px;
					padding-right: 0px;
				}
				/* 上面的搜索结果筛选 */
				#search-content-area > div >div> div:first-child > div:first-child > div:last-child{
					overflow: auto;
					text-wrap: nowrap;
					height: auto;
				}
				/* 视频右侧的TA的作品↓ */
				#searchSideCard{
					width: unset !important;
				}
				#searchSideCard > div{
					padding: 0px !important;
				}
				#searchSideCard > div:has(>div+svg),
				#searchSideCard ul[data-e2e="scroll-list"]{
					padding: 0px 10px !important;
				}
				#searchSideCard ul[data-e2e="scroll-list"] .video-playing-item > div{
					width: auto;
				}
				/* 视频右侧的TA的作品↑ */
			}
		`)),u.waitNode("#relatedVideoCard").then(i=>{r.info("评论区展开的className："+i.className),e.push(x(`
					html[data-vertical-screen]
						#sliderVideo[data-e2e="feed-active-video"]
						#videoSideBar:has(#relatedVideoCard[class="${i.className}"]) {
							width: 100vw !important;
					}`));});},disableClickToEnterFullScreen(){r.info("搜索-禁止点击视频区域进入全屏"),v.on(document,"click",".focusPanel",e=>{var n;u.preventEvent(e);let o=((n=e.target.parentElement)==null?void 0:n.parentElement).querySelector("video");o?o.paused?(r.info(".focusPanel：播放视频"),o.play()):(r.info(".focusPanel：视频暂停"),o.pause()):(r.error(".focusPanel未找到<video>标签"),y.error(".focusPanel未找到<video>标签",{isHTML:!1}));},{capture:!0}),v.on(document,"click","xg-video-container",e=>{u.preventEvent(e);let t=e.target.querySelector("video");t?t.paused?(r.info("xg-video-container：播放视频"),t.play()):(r.info("xg-video-container：视频暂停"),t.pause()):(r.error("xg-video-container未找到<video>标签"),y.error("xg-video-container未找到<video>标签",{isHTML:!1}));},{capture:!0});}},C={isLive(){return window.location.hostname==="live.douyin.com"},isVideo(){return window.location.hostname==="www.douyin.com"},isSearch(){return window.location.hostname==="www.douyin.com"&&window.location.pathname.startsWith("/search")}},Ge=`/* 右侧工具栏放大 */\r
.basePlayerContainer .positionBox {\r
	bottom: 80px !important;\r
	padding-right: 5px !important;\r
	scale: unset !important;\r
	transform: scale3d(1.12, 1.12, 1.12) !important;\r
}\r
/* 右侧工具栏的svg再放大 */\r
.basePlayerContainer .positionBox svg {\r
	transform: scale3d(1.12, 1.12, 1.12);\r
}\r
/* 重置关注按钮的scale */\r
.basePlayerContainer\r
	.positionBox\r
	.dy-tip-container\r
	div[data-e2e="feed-follow-icon"]\r
	svg {\r
	scale: unset !important;\r
}\r
/* 设备处于横向方向，即宽度大于高度。 */\r
@media screen and (orientation: landscape) {\r
	/* 右侧工具栏放大 */\r
	.basePlayerContainer .positionBox {\r
		/*transform: scale(0.95) !important;\r
		bottom: 42px !important;*/\r
		padding-right: 10px !important;\r
	}\r
}\r
/* 该设备是纵向的，即高度大于或等于宽度 */\r
@media screen and (orientation: portrait) {\r
	/* /video/xxx页面 */\r
	/* 点赞、评论、分享偏移 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.basePlayerContainer\r
		.positionBox {\r
		padding-right: 30px !important;\r
	}\r
	/* 底部工具栏右侧的按钮 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		.xgplayer.xgplayer-pc\r
		.xg-right-grid {\r
		margin-right: 35px !important;\r
	}\r
	/* 评论区全屏 */\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]),\r
	div[data-e2e="video-detail"]\r
		.leftContainer\r
		> div\r
		> div:has(.comment-mainContent[data-e2e="comment-list"]) {\r
		width: 100vw !important;\r
	}\r
}\r
\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#slidelist {\r
		width: 100vw;\r
		height: 100vh;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: 150px;\r
		padding-right: 0;\r
		max-width: unset;\r
	}\r
	/* 搜索框获取焦点时自动放大宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]:focus) {\r
		width: 100vw;\r
		width: 100dvw;\r
	}\r
	/* 去除设置min-width超出浏览器宽度的问题 */\r
	body {\r
		min-width: 100% !important;\r
	}\r
	/* 去除设置width导致顶部工具栏超出浏览器宽度的问题 */\r
	#douyin-right-container #douyin-header {\r
		width: 100%;\r
	}\r
	/* 去除设置 */\r
	#douyin-right-container #douyin-header > div[data-click="doubleClick"] {\r
		min-width: 100%;\r
	}\r
}\r
`,qe={init(){s.execMenuOnce("dy-video-shieldUserCommentToolBar",()=>this.shieldUserCommentToolBar()),s.execMenuOnce("dy-video-shieldUserCommentEveryOneAllSearch",()=>this.shieldUserCommentEveryOneAllSearch());},shieldUserCommentToolBar(){return r.info("【屏蔽】评论工具栏"),[p.addBlockCSS(".comment-input-container")]},shieldUserCommentEveryOneAllSearch(){return r.info("【屏蔽】大家都在搜"),[p.addBlockCSS(".comment-header-with-search")]}},je={init(){s.execMenuOnce("shieldBottomVideoToolBar",()=>this.shieldBottomVideoToolBar()),s.execMenuOnce("dy-video-bottom-shieldVideoInfoWrap",()=>this.shieldVideoInfoWrap()),s.execMenuOnce("shieldBottomVideoToolbarDanmuContainer",()=>this.shieldBottomVideoToolbarDanmuContainer());},shieldBottomVideoToolBar(){return r.info("【屏蔽】底部视频工具栏"),[p.addBlockCSS("xg-controls.xgplayer-controls"),x(`
			#sliderVideo[data-e2e="feed-active-video"] div:has( > div > #video-info-wrap),
			div:has( > div > pace-island > #video-info-wrap ),
			xg-video-container.xg-video-container{
				bottom: 0 !important;
			}`)]},shieldVideoInfoWrap(){return r.info("【屏蔽】视频信息"),[p.addBlockCSS("#video-info-wrap")]},shieldBottomVideoToolbarDanmuContainer(){return r.info("【屏蔽】底部视频工具栏的弹幕容器"),[p.addBlockCSS('xg-controls xg-inner-controls .danmakuContainer[data-e2e="danmaku-container"]')]}},We={init(){s.execMenuOnce("shieldPlaySwitchButton",()=>this.shieldPlaySwitchButton()),s.execMenuOnce("shieldAuthorAvatar",()=>this.shieldAuthorAvatar()),s.execMenuOnce("shieldLikeButton",()=>this.shieldLikeButton()),s.execMenuOnce("shieldCommentButton",()=>this.shieldCommentButton()),s.execMenuOnce("shieldCollectionButton",()=>this.shieldCollectionButton()),s.execMenuOnce("shieldSharenButton",()=>this.shieldSharenButton()),s.execMenuOnce("shieldRelatedRecommendationsButton",()=>this.shieldRelatedRecommendationsButton()),s.execMenuOnce("shieldMoreButton",()=>this.shieldMoreButton());},shieldPlaySwitchButton(){return r.info("【屏蔽】切换播放"),[p.addBlockCSS('.positionBox  .xgplayer-playswitch[data-state="normal"]',"div.xgplayer-playswitch",".xgplayer-playswitch"),x(`
			div[data-e2e="slideList"]{
				/* 修复屏蔽后的视频宽度占据 */
				padding: 0px !important;
			}
			`)]},shieldAuthorAvatar(){return r.info("【屏蔽】作者头像"),[p.addBlockCSS('div.dy-tip-container:has([data-e2e="video-avatar"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-avatar"])')]},shieldLikeButton(){return r.info("【屏蔽】点赞"),[p.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-digg"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-player-digg"])')]},shieldCommentButton(){return r.info("【屏蔽】评论"),[p.addBlockCSS('div.dy-tip-container:has([data-e2e="feed-comment-icon"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="feed-comment-icon"])')]},shieldCollectionButton(){return r.info("【屏蔽】收藏"),[p.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-collect"])','.basePlayerContainer div[data-e2e="video-player-collect"][data-e2e-state="video-player-no-collect"]')]},shieldSharenButton(){return r.info("【屏蔽】分享"),[p.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-share"])','.basePlayerContainer div:has(>div[data-e2e="video-player-share"])')]},shieldRelatedRecommendationsButton(){return r.info("【屏蔽】看相关"),[p.addBlockCSS('div.dy-tip-container:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','div.dy-tip-container:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 0 0-8 8v4a8 8 0 0 0 8 8h8a8 8 0 0 0 8-8v-4a8 8 0 0 0-8-8h-8zm8.5 10.866a1 1 0 0 0 0-1.732l-6-3.464a1 1 0 0 0-1.5.866v6.928a1 1 0 0 0 1.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])')]},shieldMoreButton(){return r.info("【屏蔽】更多"),p.addBlockCSS('div.dy-tip-container:has([data-e2e="video-play-more"])','.basePlayerContainer div[data-e2e="video-play-more"]')}},Se={init(){s.execMenuOnce("shieldRightExpandCommentButton",()=>this.shieldRightExpandCommentButton()),s.execMenuOnce("shieldSearchFloatingBar",()=>this.shieldSearchFloatingBar()),s.execMenuOnce("shieldCloseFullScreenButton",()=>this.shieldCloseFullScreenButton()),je.init(),We.init(),qe.init();},shieldRightExpandCommentButton(){return r.info("【屏蔽】右侧的展开评论按钮"),[p.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] > div > div > button[type="button"]','.playerContainer button[type=button] svg > g[filter] > path[d="M21.316 29.73a1.393 1.393 0 01-1.97 0l-5.056-5.055a1.393 1.393 0 010-1.97l.012-.011 5.044-5.045a1.393 1.393 0 011.97 1.97l-4.07 4.071 4.07 4.071a1.393 1.393 0 010 1.97z"]'),x(`
			.basePlayerContainer .positionBox{
				padding-right: 20px !important;
			}`)]},shieldSearchFloatingBar(){r.info("【屏蔽】搜索悬浮栏");let e=[];return e.push(p.addBlockCSS("#slideMode + div",'.playerContainer .slider-video>div>div:has([data-e2e="searchbar-button"])')),C.isSearch()&&e.push(p.addBlockCSS('#douyin-right-container> div>div>div> div:has( div> input[data-e2e="searchbar-input"])')),e},shieldCloseFullScreenButton(){r.info("【屏蔽】网页全屏关闭按钮");let e=[];return e.push(p.addBlockCSS('.playerContainer .slider-video>div>div:has(path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),C.isSearch()&&e.push(p.addBlockCSS('#douyin-right-container div>div:has(>svg>path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),e}},R={init(){Se.init(),M.init(),s.execMenuOnce("shieldVideo",()=>{I.init();}),s.execMenuOnce("changeCommentToBottom",()=>{R.changeCommentToBottom();}),s.execMenuOnce("fullScreen",()=>this.fullScreen()),s.execMenuOnce("parseVideo",()=>{R.parseVideo();}),C.isSearch()||s.execMenu("autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),s.execMenuOnce("dy-video-doubleClickEnterElementFullScreen",()=>{this.doubleClickEnterElementFullScreen();}),s.execMenu("dy-video-bgColor-enable",()=>{s.execMenuOnce("dy-video-changeBackgroundColor",e=>this.changeBackgroundColor(e));}),s.execMenuOnce("repairProgressBar",()=>{s.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();});}),v.ready(()=>{R.chooseVideoDefinition(s.getValue("chooseVideoDefinition")),s.execMenuOnce("mobileMode",()=>{this.mobileMode(),C.isSearch()&&_e.mobileMode();});});},fullScreen(){r.info("全屏");let e=[];return e.push(p.addBlockCSS(".slider-video .positionBox","#video-info-wrap","xg-controls.xgplayer-controls")),e.push(Se.shieldSearchFloatingBar()),e.push(x(`
			/* 视频全屏 */
			xg-video-container.xg-video-container{
				bottom: 0px !important;
			}
        `)),e},autoEnterElementFullScreen(e=!1){if(e){let i=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Y",code:"KeyY",keyCode:89,which:89});document.dispatchEvent(i);}else u.waitNode('xg-icon[data-e2e="xgplayer-page-full-screen"] .xgplayer-icon:has([d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(i=>{r.success("自动进入网页全屏"),i.click();});},doubleClickEnterElementFullScreen(){let e=!1;r.info("注册双击进入网页全屏事件"),[".newVideoPlayer","#sliderVideo"].forEach(t=>{v.on(document,"click",t,o=>{e?(e=!1,R.autoEnterElementFullScreen(!0)):(e=!0,setTimeout(()=>{e=!1;},250));});});},changeCommentToBottom(){r.info("评论区修改为底部");let e="data-vertical-screen";function i(){p.isVerticalScreen()?(r.success("自动判断: 竖屏"),document.documentElement.setAttribute(e,"true")):(r.success("自动判断: 横屏"),document.documentElement.removeAttribute(e));}i(),x(`
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideBar #relatedVideoCard,
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideCard #relatedVideoCard{
			display: none !important;
		}
		/* 左侧的视频宽度撑满 */
		html[${e}] #sliderVideo[data-e2e] .playerContainer,
		html[${e}] #slideMode[data-e2e] .playerContainer{
			width: 100% !important;
		}
		/* 右侧的评论区宽度撑满，position使用absolute */
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard){
			width: 100%;
			height: 75%;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.9);
			transition: height .15s linear !important;
			position: absolute;
		}
		`),s.execMenuOnce("douyin-video-autoCheckChangeCommentToBottom",()=>{v.on(window,"resize",i);});},chooseVideoDefinition(e=0){r.info("选择视频清晰度: "+e);let i="MANUAL_SWITCH",o=[{clarityReal:["normal_1080_0","normal_720_0","low_720_0","normal_540_0","low_540_0","adapt_low_540_0","lower_540_0"],done:1,gearClarity:"5",gearName:"高清",gearType:1,qualityType:1},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"4",gearName:"清晰",gearType:2,qualityType:15},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"3",gearName:"流畅",gearType:3,qualityType:28},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"2",gearName:"极速",gearType:4,qualityType:21},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"0",gearName:"智能",gearType:0}].find(a=>a.gearType===e);function n(a){B.sessionStorage.setItem(i,a);}if(o){let a=0,l=JSON.stringify(o),d=setInterval(()=>{n(l),a++,a>=20&&clearInterval(d);},500);r.success("设置当前视频的清晰度: "+e);}else r.error("该清晰度不存在: "+e);},chooseVideoRate(e="1"){let i="player_playbackratio";function t(o="1"){B.sessionStorage.setItem(i,o),document.querySelectorAll("xg-icon.xgplayer-playback-setting").forEach(n=>{var l,d,c,m;let a=u.getReactObj(n).reactContainer;(m=(c=(d=(l=a==null?void 0:a.memoizedState)==null?void 0:l.element)==null?void 0:d.props)==null?void 0:c.xgCase)==null||m.updatePlayBackRatio();});}t(e);},parseVideo(){r.info("让下载按钮变成解析视频");function e(i){let t="";i.forEach(o=>{t+=`
          		<div class="douyin-video-link-item"><a href="${o}" target="_blank">${o}</a></div>
            	`;}),t=`<div class="douyin-video-link-container">${t}</div>`,Q.alert({title:{text:"视频解析",position:"center"},content:{text:t,html:!0},mask:{enable:!0,clickEvent:{toClose:!0}},width:window.innerWidth>550?"550px":"88vw",height:window.innerHeight>550?"550px":"80vh",drag:!0,dragLimit:!0,style:`
                .douyin-video-link-container{

                }
                .douyin-video-link-item{
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    margin: 10px;
                }
                .douyin-video-link-item a{

                }
                `});}v.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button + div',function(i){var n;let t=i.target,o=(n=u.getReactObj(t.parentElement))==null?void 0:n.reactFiber;if(!o){y.error("获取rectFiber属性失败");return}try{let a=[],l=o.return.memoizedProps.awemeInfo.video.playAddr,d=o.return.memoizedProps.awemeInfo.video.playAddrH265;if(l!=null&&Array.isArray(l)&&(a=a.concat(l)),d!=null&&Array.isArray(d)&&(a=a.concat(d)),!a.length){y.error("未获取到视频的有效链接信息");return}let c=a.map(m=>m.src);e(c);}catch{y.error("解析视频失败");}},{capture:!0});},mobileMode(){r.info("启用手机模式");let e=[];Be.initialScale(),e.push(p.addBlockCSS("img#douyin-temp-sidebar"),x(Ge)),s.onceExec("repairProgressBar",()=>{this.repairVideoProgressBar();});},repairVideoProgressBar(){r.info("修复进度条按钮"),x(`
		/* 禁止触发touch事件，因为会影响到按钮点击不到 */
		xg-outer,
		xg-inners {
			pointer-events: none;
		}
		`),v.on(document,"touchstart","xg-progress",e=>{let t=e.target.querySelector("xg-outer");t&&(t.style.height="6px");},{capture:!0}),v.on(document,"touchend","xg-progress",e=>{let t=e.target.querySelector("xg-outer");t&&(t.style.height="");},{capture:!0});},changeBackgroundColor(e){return r.info("修改视频背景颜色"),x(`
		#sliderVideo > div,
		/* 推荐的直播间背景 */
		xgmask,
		/* 用户主页的视频 */
		.basePlayerContainer .imgBackground{
			background: ${e}  !important;
		}
		`)}},M={shortCut:new Ue("video-short-cut"),$data:{rateMap:["0.75","1","1.25","1.5","1.75","2","3"]},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-video-rate-low":{callback(){r.info("调用倍速 => 小");let e=B.sessionStorage.getItem("player_playbackratio")??"1",i=M.$data.rateMap.findIndex(o=>o===e);if(i===0){r.warn("已是最小倍速: "+e);return}let t=M.$data.rateMap[i-1];r.info("设置倍速: "+t),R.chooseVideoRate(t);}},"dy-video-rate-up":{callback(){r.info("调用倍速 => 大");let e=B.sessionStorage.getItem("player_playbackratio")??"1",i=M.$data.rateMap.findIndex(o=>o===e);if(i===M.$data.rateMap.length-1){r.warn("已是最大倍速: "+e);return}let t=M.$data.rateMap[i+1];r.info("设置倍速: "+t),R.chooseVideoRate(t);}}}}},Qe={id:"panel-config-video",title:"视频",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[h("沉浸模式","fullScreen",!1,void 0,"移除右侧工具栏、底部信息栏等"),h("手机模式","mobileMode",!1,void 0,"放大文字和图标，及自动启用【initial-scale=1】和【修复进度条】功能"),h("修复进度条","repairProgressBar",!1,void 0,"修复移动端不能点击拖拽和定位进度的问题(移动端使用)")]},{text:"视频区域背景色",type:"forms",forms:[h("启用","dy-video-bgColor-enable",!1,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"dy-video-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(e){let i=v.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),t=v.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),o=t.querySelector(".pops-color-choose");o.value=s.getValue("dy-video-changeBackgroundColor");let n=v.createElement("style");return v.append(document.head,n),v.on(o,["input","propertychange"],a=>{r.info("选择颜色："+o.value),n.innerHTML=`
												#sliderVideo > div{
													background: ${o.value};
												}
												`,s.setValue("dy-video-changeBackgroundColor",o.value);}),e.appendChild(i),e.appendChild(t),e}}]}]},{text:"视频",type:"deepMenu",forms:[{text:"",type:"forms",forms:[$("清晰度","chooseVideoDefinition",1,[{text:"智能",value:0},{text:"极速",value:4},{text:"流畅",value:3},{text:"清晰",value:2},{text:"高清",value:1}],void 0,"自行选择清晰度"),h("视频解析","parseVideo",!0,void 0,"分享->下载(灰色的也可点击)"),h("评论区移到中间","changeCommentToBottom",!0,void 0,"修改评论区为中间弹出而非右侧区域"),h("↑自适应评论区位置","douyin-video-autoCheckChangeCommentToBottom",!0,void 0,"根据window.screen.orientation.type自动判断是否开启【评论区移到中间】"),h("自动进入网页全屏","autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),h("双击进入网页全屏","dy-video-doubleClickEnterElementFullScreen",!1,void 0,"双击视频自动进入网页全屏，检测间隔250ms")]}]},{text:"快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[Ce("倍速 -> 小","视频倍速变小",()=>M.shortCut.getShowText("dy-video-rate-low","点击录入快捷键"),"keyboard",!1,!1,"default",e=>{var o;let t=(o=e.target.closest(".pops-panel-button"))==null?void 0:o.querySelector("span");M.shortCut.inputShortCut("dy-video-rate-low","点击录入快捷键",n=>{t.innerHTML=n;});}),Ce("倍速 -> 大","视频倍速变大",()=>M.shortCut.getShowText("dy-video-rate-up","点击录入快捷键"),"keyboard",!1,!1,"default",e=>{var o;let t=(o=e.target.closest(".pops-panel-button"))==null?void 0:o.querySelector("span");M.shortCut.inputShortCut("dy-video-rate-up","点击录入快捷键",n=>{t.innerHTML=n;});})]}]},{text:"过滤-视频",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[h("启用","shieldVideo",!0,void 0,"开启后可启用下面的屏蔽功能"),h("【屏蔽】直播","shieldVideo-live",!0,void 0,"过滤掉直播"),h("【屏蔽】广告","shieldVideo-ads",!0,void 0,"过滤掉广告"),{type:"own",getLiElementCallBack(e){let i=v.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),t=i.querySelector("textarea");return t.value=I.get(),v.on(t,["input","propertychange"],u.debounce(function(){I.set(t.value);},200)),e.appendChild(i),e}}]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽-视频区域内",type:"deepMenu",forms:[{text:"右侧",type:"forms",forms:[h("【屏蔽】切换播放","shieldPlaySwitchButton",!1,void 0,"屏蔽元素，在右侧作者头像上方"),h("【屏蔽】作者头像","shieldAuthorAvatar",!1,void 0,"屏蔽元素"),h("【屏蔽】点赞","shieldLikeButton",!1,void 0,"屏蔽元素"),h("【屏蔽】评论","shieldCommentButton",!1,void 0,"屏蔽元素"),h("【屏蔽】收藏","shieldCollectionButton",!1,void 0,"屏蔽元素"),h("【屏蔽】分享","shieldSharenButton",!1,void 0,"屏蔽元素"),h("【屏蔽】看相关","shieldRelatedRecommendationsButton",!1,void 0,"屏蔽元素"),h("【屏蔽】更多","shieldMoreButton",!1,void 0,"...按钮，屏蔽元素")]},{text:"底部",type:"forms",forms:[h("【屏蔽】底部视频工具栏","shieldBottomVideoToolBar",!1,void 0,"屏蔽元素"),h("【屏蔽】弹幕容器","shieldBottomVideoToolbarDanmuContainer",!1,void 0,"屏蔽元素（不包括屏蔽弹幕）"),h("【屏蔽】视频信息","dy-video-bottom-shieldVideoInfoWrap",!1,void 0,"屏蔽元素，可代替【清屏】功能")]},{text:"其它",type:"forms",forms:[h("【屏蔽】右侧的展开评论按钮","shieldRightExpandCommentButton",!0,void 0,"屏蔽元素"),h("【屏蔽】搜索悬浮栏","shieldSearchFloatingBar",!0,void 0,"屏蔽元素，一般出现在左上角"),h("【屏蔽】网页全屏关闭按钮","shieldCloseFullScreenButton",!0,void 0,"屏蔽元素，一般开启网页全屏后出现在左上角")]}]},{text:"屏蔽-评论区域内",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】评论工具栏","dy-video-shieldUserCommentToolBar",!1,void 0,"屏蔽元素"),h("【屏蔽】大家都在搜","dy-video-shieldUserCommentEveryOneAllSearch",!1,void 0,"在评论区的顶部出现")]}]}]}]},Ke={id:"panel-config-search",title:"搜索",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("禁止点击视频区域进入全屏","dy-search-disableClickToEnterFullScreen",!1,void 0,"禁止点击视频区域时会触发自动进入全屏功能")]}]},{text:"过滤-搜索结果",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[h("启用","search-shieldVideo",!0,void 0,"开启后可启用下面的屏蔽功能"),h("【屏蔽】直播","search-shieldVideo-live",!0,void 0,"过滤掉直播"),h("【屏蔽】广告","search-shieldVideo-ads",!0,void 0,"过滤掉广告"),{type:"own",getLiElementCallBack(e){let i=v.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),t=i.querySelector("textarea");return t.value=O.get(),v.on(t,["input","propertychange"],u.debounce(function(){O.set(t.value);},200)),e.appendChild(i),e}}]}]}]},{text:"",type:"forms",forms:[{text:"屏蔽",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】相关搜索","douyin-search-shieldReleatedSearches",!1,void 0,"屏蔽右边的相关搜索")]}]},{text:"屏蔽-主框架",type:"deepMenu",forms:[{text:"",type:"forms",forms:[$("【屏蔽】左侧导航栏","search-shieldLeftNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,"屏蔽元素"),$("【屏蔽】顶部导航栏","search-shieldTopNavigator",-1,[{text:"跟随主设置",value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,"屏蔽元素")]}]}]}]},Je={id:"m-panel-config-share-user",title:"主页",headerTitle:"/share/user<br />主页",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("视频合集","m-dy-share-user-coverPlayletList",!0,void 0,"正确跳转视频合集页面"),h("视频列表","m-dy-share-user-coverPostListContainer",!0,void 0,"正确跳转视频页面")]}]}]}]},Xe={id:"m-panel-config-share-video",title:"视频",headerTitle:"/share/video<br />视频",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("全局点击","m-dy-share-video-coverGlobalClick",!0,void 0,"阻止跳转至下载页")]}]}]}]},Ze={id:"m-panel-config-share-note",title:"笔记",headerTitle:"/share/note<br />笔记",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("精彩图文","m-dy-share-note-coverExcitingGraphicsAndText",!0,void 0,"正确跳转笔记页面"),h("用户","m-dy-share-note-coverUser",!0,void 0,"正确跳转用户主页"),h("话题","m-dy-share-note-coverHashTag",!0,void 0,"正确跳转相关话题"),h("音乐","m-dy-share-note-coverMusic",!0,void 0,"正确跳转相关音乐"),h("相关推荐","m-dy-share-note-coverRecommend",!0,void 0,"正确跳转笔记页面")]}]},{text:"屏蔽元素",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("【屏蔽】评论","m-dy-share-note-blockComment",!1,void 0,"屏蔽元素"),h("【屏蔽】相关推荐","m-dy-share-note-blockRecommend",!1,void 0,"屏蔽元素"),h("【屏蔽】底部工具栏","m-dy-share-note-blockFooterToobar",!1,void 0,"屏蔽元素")]}]}]}]},et={id:"m-panel-config-share-challenge",title:"话题",headerTitle:"/share/challenge<br />话题",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("顶部区域","m-dy-share-challenge-coverTopJump",!0,void 0,"阻止跳转至下载页面"),h("视频卡片","m-dy-share-challenge-coverVideoCard",!0,void 0,"正确跳转视频页面")]}]}]}]},tt={id:"m-panel-config-share-music",title:"音乐",headerTitle:"/share/music<br />音乐",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[h("视频卡片","m-dy-share-music-coverVideoCard",!0,void 0,"正确跳转视频页面")]}]}]}]},S={data:null,oneSuccessExecMenu:null,onceExec:null,listenData:null},s={$data:{get data(){return S.data==null&&(S.data=new u.Dictionary),S.data},get oneSuccessExecMenu(){return S.oneSuccessExecMenu==null&&(S.oneSuccessExecMenu=new u.Dictionary),S.oneSuccessExecMenu},get onceExec(){return S.onceExec==null&&(S.onceExec=new u.Dictionary),S.onceExec},get scriptName(){return W},key:L,attributeKeyName:F,attributeDefaultValueName:Y},$listener:{get listenData(){return S.listenData==null&&(S.listenData=new u.Dictionary),S.listenData}},init(){this.initPanelDefaultValue(),this.initExtensionsMenu();},initExtensionsMenu(){B.top===B.self&&rt.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:!1,isStoreValue:!1,showText(e){return e},callback:()=>{this.showPanel();}},{key:"show_pops_m_panel_setting",text:"⚙ 移动端设置",autoReload:!1,isStoreValue:!1,showText(e){return e},callback:()=>{this.showMPanel();}}]);},initPanelDefaultValue(){let e=this;function i(n){if(!n.attributes)return;let a=n.attributes[F],l=n.attributes[Y];if(a==null){console.warn("请先配置键",n);return}e.$data.data.has(a)&&console.warn("请检查该key(已存在): "+a),e.$data.data.set(a,l);}function t(n){for(let a=0;a<n.length;a++){let l=n[a];i(l);let d=l.forms;d&&Array.isArray(d)&&t(d);}}let o=this.getPanelContentConfig().concat(this.getMPanelContentConfig());for(let n=0;n<o.length;n++){let a=o[n];if(!a.forms)continue;let l=a.forms;l&&Array.isArray(l)&&t(l);}},setValue(e,i){let t=k(L,{}),o=t[e];t[e]=i,E(L,t),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,o,i);},getValue(e,i){let o=k(L,{})[e];return o??(this.$data.data.has(e)?this.$data.data.get(e):i)},deleteValue(e){let i=k(L,{}),t=i[e];Reflect.deleteProperty(i,e),E(L,i),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,t,void 0);},addValueChangeListener(e,i){let t=Math.random();return this.$listener.listenData.set(e,{id:t,key:e,callback:i}),t},removeValueChangeListener(e){let i=null;for(const[t,o]of this.$listener.listenData.entries())if(o.id===e){i=t;break}typeof i=="string"?this.$listener.listenData.delete(i):console.warn("没有找到对应的监听器");},hasKey(e){let i=k(L,{});return e in i},execMenu(e,i){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){r.warn(`${e} 键不存在`);return}let t=s.getValue(e);t&&i(t);},execMenuOnce(e,i){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){r.warn(`${e} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(e))return;this.$data.oneSuccessExecMenu.set(e,1);let t=[],o=l=>{let d=s.getValue(e),c=[];if(l instanceof HTMLStyleElement?c=[l]:Array.isArray(l)&&(c=[...l.filter(m=>m!=null&&m instanceof HTMLStyleElement)]),d)t=t.concat(c);else for(let m=0;m<c.length;m++)c[m].remove(),c.splice(m,1),m--;},n=l=>{let d=[];if(l){let c=i(l,o);c instanceof HTMLStyleElement?d=[c]:Array.isArray(c)&&(d=[...c.filter(m=>m!=null&&m instanceof HTMLStyleElement)]);}for(let c=0;c<t.length;c++)t[c].remove(),t.splice(c,1),c--;t=[...d];};this.addValueChangeListener(e,(l,d,c)=>{n(c);});let a=s.getValue(e);a&&n(a);},onceExec(e,i){if(typeof e!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(e)||(i(),this.$data.onceExec.set(e,1));},showPanel(){Q.panel({title:{text:`${W}-设置`,position:"center",html:!1,style:""},content:this.getPanelContentConfig(),mask:{enable:!0,clickEvent:{toClose:!0,toHide:!1}},isMobile:!0,width:this.getWidth(),height:this.getHeight(),drag:!0,only:!0});},showMPanel(){Q.panel({title:{text:`${W}-设置`,position:"center",html:!1,style:""},content:this.getMPanelContentConfig(),mask:{enable:!0,clickEvent:{toClose:!0,toHide:!1}},isMobile:!0,width:this.getWidth(),height:this.getHeight(),drag:!0,only:!0});},getWidth(){return window.outerWidth<550?"92vw":"550px"},getHeight(){return window.outerHeight<450?"80vh":"450px"},getPanelContentConfig(){return [Pe,Qe,Ke,He]},getMPanelContentConfig(){return [Je,Ze,et,Xe,tt]}},it="抖音优化",u=Ve.noConflict();let v=Me.noConflict();const Q=Ee,nt=B.console||Ae.console,r=new u.Log(U,nt);var ke;let W=((ke=U==null?void 0:U.script)==null?void 0:ke.name)||it;r.config({debug:!1,logMaxCount:100,autoClearConsole:!0,tag:!0});y.config(Object.defineProperties({html:!0,autoClose:!0,showClose:!1,zIndex:1e7},{position:{get(){return s.getValue("qmsg-config-position","bottom")}},maxNums:{get(){return s.getValue("qmsg-config-maxnums",5)}},showReverse:{get(){return s.getValue("qmsg-config-showreverse",!0)}}}));const rt=new u.GM_Menu({GM_getValue:k,GM_setValue:E,GM_registerMenuCommand:Te,GM_unregisterMenuCommand:Le}),ot=new u.Httpx(Re);ot.interceptors.response.use(void 0,e=>(r.error(["拦截器-请求错误",e]),e.type==="onabort"?y.warning("请求取消"):e.type==="onerror"?y.error("请求异常"):e.type==="ontimeout"?y.error("请求超时"):y.error("其它错误"),e));const x=u.addStyle.bind(u),at={init(){s.execMenuOnce("shieldClientTip",()=>this.shieldClientTip()),s.execMenuOnce("shieldFillingBricksAndStones",()=>this.shieldFillingBricksAndStones()),s.execMenuOnce("shieldClient",()=>this.shieldClient()),s.execMenuOnce("shieldQuickAccess",()=>this.shieldQuickAccess()),s.execMenuOnce("shieldNotifitation",()=>this.shieldNotifitation()),s.execMenuOnce("shieldPrivateMessage",()=>this.shieldPrivateMessage()),s.execMenuOnce("shieldSubmission",()=>this.shieldSubmission()),s.execMenuOnce("shieldWallpaper",()=>this.shieldWallpaper()),s.execMenuOnce("shieldBottomQuestionButton",()=>this.shieldBottomQuestionButton());let e=s.getValue("shieldLeftNavigator"),i=s.getValue("shieldTopNavigator");if(C.isSearch()){let t=s.getValue("search-shieldLeftNavigator");t==1?e=!0:t==0&&(e=!1);let o=s.getValue("search-shieldTopNavigator");o==1?i=!0:o==0&&(i=!1);}e&&s.onceExec("shieldLeftNavigator",()=>this.shieldLeftNavigator()),i&&s.onceExec("shieldTopNavigator",()=>this.shieldTopNavigator());},shieldFillingBricksAndStones(){r.info("【屏蔽】充钻石");let e=[];return e.push(p.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])','div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M5.757 12.268a6.397 6.397 0 1 1 12.793 0 6.397 6.397 0 0 1-12.793 0zm6.396-7.897a7.897 7.897 0 1 0 0 15.793 7.897 7.897 0 0 0 0-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 0 1-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 0 0 1.715.498v-1.5a1.725 1.725 0 0 1-1.715-1.735z"])','body .semi-portal .semi-portal-inner li.semi-dropdown-item:has(a[href*="douyin_recharge"])')),C.isSearch()?e.push(p.addBlockCSS('div:has(>div>div>div>div[data-e2e="something-button"] path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])','div[id^="douyin-header-menu"] >  div > div > div:has(path[d="M5.757 12.268a6.397 6.397 0 1 1 12.793 0 6.397 6.397 0 0 1-12.793 0zm6.396-7.897a7.897 7.897 0 1 0 0 15.793 7.897 7.897 0 0 0 0-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 0 1-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 0 0 1.715.498v-1.5a1.725 1.725 0 0 1-1.715-1.735z"])')):C.isLive()&&e.push(p.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])')),e},shieldClient(){r.info("【屏蔽】客户端");let e=[];return e.push(p.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[download^="douyin-downloader"])')),C.isSearch()?e.push(p.addBlockCSS('div:has(> div[data-e2e="something-button"] path[d="M18.404 19.018h-12v-1.5h12v1.5zM11.654 13.457v-8.19h1.5v8.19l3.22-3.22 1.06 1.061-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5 1.06-1.06 3.22 3.22z"])','div[id^="douyin-header-menu"] >  div > div > div:has(a[download^="douyin-downloader"])')):C.isLive()&&e.push(p.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container:has(a)','#douyin-header pace-island[id^="island"] > div[class] span:has(a[download][href*="client"])','.semi-portal-inner .semi-dropdown-content .semi-dropdown-item:has(a[download][href*="client"])')),e},shieldQuickAccess(){r.info("【屏蔽】快捷访问");let e=[];return e.push(p.addBlockCSS('header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(.quick-access-nav-icon)','div[id^="douyin-header-menu"] pace-island > div > div:has(.quick-access-nav-icon)')),C.isSearch()&&(e.push(p.addBlockCSS("div:has(>div>div>.quick-access-nav-icon)")),u.waitNode('li.semi-dropdown-item[role="menuitem"]',1e4).then(i=>{if(!i)return;let t=u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){let o=!1;document.querySelectorAll('li.semi-dropdown-item[role="menuitem"]').forEach(n=>{var a;(a=n.textContent)!=null&&a.includes("快捷访问")&&(o=!0,r.success("搜索-更多-快捷访问 移除元素"),n.remove());}),o&&t.disconnect();}});})),e},shieldNotifitation(){r.info("【屏蔽】通知");let e=[];return e.push(p.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M9.905 19.407h4.5v-1.5h-4.5v1.5z"])')),C.isSearch()?e.push(p.addBlockCSS('ul:has( div>div[data-e2e="notice-entry"] )','div[id^="douyin-header-menu"] >  div > div > ul:has(path[d="M12.154 4.768a5.656 5.656 0 0 0-5.644 5.285l-.407 6.172h12.102l-.407-6.172a5.657 5.657 0 0 0-5.644-5.285zm-4.148 5.383a4.156 4.156 0 0 1 8.295 0l.302 4.574H7.705l.301-4.574z"])')):C.isLive()&&e.push(p.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M9.905 19.407h4.5v-1.5h-4.5v1.5z"])')),e},shieldPrivateMessage(){r.info("【屏蔽】私信");let e=[];return e.push(p.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])','#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])')),C.isSearch()&&(r.info("搜索-【屏蔽】私信"),e.push(p.addBlockCSS('ul:has( div>div[data-e2e="im-entry"] )','div[id^="douyin-header-menu"] >  div > div > ul:has([data-e2e="im-entry"])'))),e},shieldSubmission(){r.info("【屏蔽】投稿");let e=[];return e.push(p.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])','div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M11.349 5.17h-.033c-1.068 0-1.915 0-2.598.054-.698.056-1.29.172-1.832.441a4.75 4.75 0 0 0-2.14 2.14c-.269.542-.386 1.134-.441 1.832-.055.683-.055 1.53-.055 2.599v.064c0 1.069 0 1.916.055 2.599.055.698.172 1.29.441 1.831a4.75 4.75 0 0 0 2.14 2.14c.542.27 1.134.386 1.832.442.683.055 1.53.055 2.598.055H12.684c1.068 0 1.915 0 2.598-.055.698-.056 1.29-.172 1.832-.442a4.75 4.75 0 0 0 2.14-2.14c.269-.541.386-1.133.441-1.831.055-.683.055-1.53.055-2.599v-.064c0-1.069 0-1.916-.055-2.599-.055-.698-.172-1.29-.441-1.832a4.75 4.75 0 0 0-2.14-2.14c-.542-.269-1.134-.385-1.832-.441-.683-.055-1.53-.055-2.598-.055h-1.335zM7.554 7.008c.299-.149.676-.241 1.284-.29.616-.05 1.403-.05 2.51-.05h1.303c1.108 0 1.895 0 2.511.05.608.049.985.141 1.284.29a3.25 3.25 0 0 1 1.464 1.464c.15.3.241.676.29 1.284.05.616.05 1.403.05 2.51 0 1.109 0 1.896-.05 2.512-.049.608-.14.985-.29 1.284a3.25 3.25 0 0 1-1.464 1.464c-.299.149-.676.241-1.284.29-.616.05-1.403.05-2.51.05h-1.303c-1.108 0-1.895 0-2.511-.05-.608-.049-.985-.141-1.284-.29a3.25 3.25 0 0 1-1.464-1.464c-.15-.3-.242-.676-.29-1.284-.05-.616-.05-1.403-.05-2.511s0-1.895.05-2.511c.048-.608.14-.985.29-1.284a3.25 3.25 0 0 1 1.464-1.464zm3.696 8.259v-2.25H9v-1.5h2.25v-2.25h1.5v2.25H15v1.5h-2.25v2.25h-1.5z"])')),C.isSearch()?e.push(p.addBlockCSS('div:has(>div >div>div[data-e2e="something-button"] path[d="M11.349 5.17h-.033c-1.068 0-1.915 0-2.598.054-.698.056-1.29.172-1.832.441a4.75 4.75 0 00-2.14 2.14c-.269.542-.386 1.134-.441 1.832-.055.683-.055 1.53-.055 2.599v.064c0 1.069 0 1.916.055 2.599.055.698.172 1.29.441 1.831a4.75 4.75 0 002.14 2.14c.542.27 1.134.386 1.832.442.683.055 1.53.055 2.598.055H12.684c1.068 0 1.915 0 2.598-.055.698-.056 1.29-.172 1.832-.442a4.75 4.75 0 002.14-2.14c.269-.541.386-1.133.441-1.831.055-.683.055-1.53.055-2.599v-.064c0-1.069 0-1.916-.055-2.599-.055-.698-.172-1.29-.441-1.832a4.75 4.75 0 00-2.14-2.14c-.542-.269-1.134-.385-1.832-.441-.683-.055-1.53-.055-2.598-.055h-1.335zM7.554 7.008c.299-.149.676-.241 1.284-.29.616-.05 1.403-.05 2.51-.05h1.303c1.108 0 1.895 0 2.511.05.608.049.985.141 1.284.29a3.25 3.25 0 011.464 1.464c.15.3.241.676.29 1.284.05.616.05 1.403.05 2.51 0 1.109 0 1.896-.05 2.512-.049.608-.14.985-.29 1.284a3.25 3.25 0 01-1.464 1.464c-.299.149-.676.241-1.284.29-.616.05-1.403.05-2.51.05h-1.303c-1.108 0-1.895 0-2.511-.05-.608-.049-.985-.141-1.284-.29a3.25 3.25 0 01-1.464-1.464c-.15-.3-.242-.676-.29-1.284-.05-.616-.05-1.403-.05-2.511s0-1.895.05-2.511c.048-.608.14-.985.29-1.284a3.25 3.25 0 011.464-1.464zm3.696 8.259v-2.25H9v-1.5h2.25v-2.25h1.5v2.25H15v1.5h-2.25v2.25h-1.5z"])','div[id^="douyin-header-menu"] >  div > div > div:has(path[d="M11.349 5.17h-.033c-1.068 0-1.915 0-2.598.054-.698.056-1.29.172-1.832.441a4.75 4.75 0 0 0-2.14 2.14c-.269.542-.386 1.134-.441 1.832-.055.683-.055 1.53-.055 2.599v.064c0 1.069 0 1.916.055 2.599.055.698.172 1.29.441 1.831a4.75 4.75 0 0 0 2.14 2.14c.542.27 1.134.386 1.832.442.683.055 1.53.055 2.598.055H12.684c1.068 0 1.915 0 2.598-.055.698-.056 1.29-.172 1.832-.442a4.75 4.75 0 0 0 2.14-2.14c.269-.541.386-1.133.441-1.831.055-.683.055-1.53.055-2.599v-.064c0-1.069 0-1.916-.055-2.599-.055-.698-.172-1.29-.441-1.832a4.75 4.75 0 0 0-2.14-2.14c-.542-.269-1.134-.385-1.832-.441-.683-.055-1.53-.055-2.598-.055h-1.335zM7.554 7.008c.299-.149.676-.241 1.284-.29.616-.05 1.403-.05 2.51-.05h1.303c1.108 0 1.895 0 2.511.05.608.049.985.141 1.284.29a3.25 3.25 0 0 1 1.464 1.464c.15.3.241.676.29 1.284.05.616.05 1.403.05 2.51 0 1.109 0 1.896-.05 2.512-.049.608-.14.985-.29 1.284a3.25 3.25 0 0 1-1.464 1.464c-.299.149-.676.241-1.284.29-.616.05-1.403.05-2.51.05h-1.303c-1.108 0-1.895 0-2.511-.05-.608-.049-.985-.141-1.284-.29a3.25 3.25 0 0 1-1.464-1.464c-.15-.3-.242-.676-.29-1.284-.05-.616-.05-1.403-.05-2.511s0-1.895.05-2.511c.048-.608.14-.985.29-1.284a3.25 3.25 0 0 1 1.464-1.464zm3.696 8.259v-2.25H9v-1.5h2.25v-2.25h1.5v2.25H15v1.5h-2.25v2.25h-1.5z"])')):C.isLive()&&e.push(p.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])')),e},shieldClientTip(){r.info("【屏蔽】客户端提示");let e=[];return e.push(p.addBlockCSS('ul li div[data-e2e="something-button"] + div div:has(>a[download*="douyin-downloader"])','#douyin-header pace-island[id^="island_"] ul > div:has(>a[class][download])','#douyin-header pace-island[id^="island_"] ul[class] li div[data-e2e="im-entry"]  div>div div div:has(a[download][href])','#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container div:has(+ #wallpaper-modal)')),C.isSearch()&&e.push(p.addBlockCSS('div[id^="douyin-header-menu"] ul li div[data-e2e="im-entry"] div > div > div:has(>a[download*="douyin-downloader"])','div[id^="douyin-header-menu"] ul > div:has(>a[download*="douyin-downloader"])')),e},shieldWallpaper(){r.info("【屏蔽】壁纸");let e=[];return e.push(p.addBlockCSS('div[id^="douyin-header-menu"] pace-island > div > div:has(span.semi-icon)')),C.isSearch()?e.push(p.addBlockCSS('div[id^="douyin-header-"] span[aria-describedby]:has(.semi-icon)','div[id^="douyin-header-menu"] >  div > div > div:has(span.semi-icon)')):C.isLive()&&e.push(p.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container:has(span.semi-icon)','#douyin-header pace-island[id^="island"] > div[class] span:has(.semi-icon)')),e},shieldLeftNavigator(){r.info("【屏蔽】左侧导航栏");let e=[];return e.push(p.addBlockCSS("#douyin-navigation")),e.push(x(`
			/* 修复顶部导航栏的宽度 */
			#douyin-header{
				width: 100%;
			}`)),e},shieldTopNavigator(){r.info("【屏蔽】顶部导航栏");let e=[];return e.push(p.addBlockCSS("#douyin-header")),e.push(x(`
			/* 修复视频的高度 */
			#douyin-right-container{
				padding-top: 0px !important;
			}
		`)),C.isSearch()&&e.push(x(`
				/* 把搜索顶部的工具栏置顶 */
				#search-content-area > div > div:nth-child(1) > div:nth-child(1){
					top: 0;
				}`)),e},shieldBottomQuestionButton(){return r.info("屏蔽底部问题按钮"),p.addBlockCSS(["#douyin-sidebar","#douyin-temp-sidebar"])}},lt={init(){s.execMenuOnce("shieldSearch",()=>this.shieldSearch()),s.execMenuOnce("shieldSearchPlaceholder",()=>this.shieldSearchPlaceholder()),s.execMenuOnce("shieldSearchGuessYouWantToSearch",()=>this.shieldSearchGuessYouWantToSearch()),s.execMenuOnce("shieldSearchTiktokHotspot",()=>this.shieldSearchTiktokHotspot());},shieldSearch(){return r.info("【屏蔽】搜索框"),p.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div:has(input[data-e2e="searchbar-input"])')},shieldSearchPlaceholder(){r.info("【屏蔽】搜索框的提示");let e=[];return e.push(p.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div div:has( + input[data-e2e="searchbar-input"])')),e.push(x(`
			#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div input[data-e2e="searchbar-input"]::placeholder{
				color: transparent;
			}`)),e},shieldSearchGuessYouWantToSearch(){return r.info("【屏蔽】搜索-猜你想搜"),p.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-guess-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-guess-container"]')},shieldSearchTiktokHotspot(){return r.info("【屏蔽】搜索-抖音热点"),p.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-hot-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-hot-container"]')}},st={removeEnvCheck(){r.info("移除环境检测");let e=B.setInterval;B.setInterval=function(i,t){let o=i.toString().trim();if(o.includes("debugger")){r.success(["拦截→",[o]]);return}if(o.includes("checkEXp")){r.success(["拦截→",[o]]);return}return e.call(this,i,t)};}},we={disguiseLogin(){r.info("伪装登录");const e=2e4;let i=parseInt((Math.random()*1e6).toString()),t=Object.defineProperty({},"uid",{value:i,writable:!1});function o(a){var m,f,g,b,w,N,z,K,J,X,Z,ee,te,ie,ne,re,oe,ae,le,se,de,ce,ue,he,pe,me,fe,ve,ge,ye;let l=[],d=u.getReactObj(a),c=d==null?void 0:d.reactFiber;return d==null||d.reactProps,(g=(f=(m=c==null?void 0:c.alternate)==null?void 0:m.return)==null?void 0:f.memoizedProps)!=null&&g.userInfo&&l.push((N=(w=(b=c==null?void 0:c.alternate)==null?void 0:b.return)==null?void 0:w.memoizedProps)==null?void 0:N.userInfo),(X=(J=(K=(z=c==null?void 0:c.alternate)==null?void 0:z.return)==null?void 0:K.memoizedProps)==null?void 0:J.userInfo)!=null&&X.userInfo&&l.push((te=(ee=(Z=c==null?void 0:c.alternate)==null?void 0:Z.return)==null?void 0:ee.memoizedProps)==null?void 0:te.userInfo.userInfo),(oe=(re=(ne=(ie=c==null?void 0:c.alternate)==null?void 0:ie.return)==null?void 0:ne.return)==null?void 0:re.memoizedProps)!=null&&oe.userInfo&&l.push((de=(se=(le=(ae=c==null?void 0:c.alternate)==null?void 0:ae.return)==null?void 0:le.return)==null?void 0:se.memoizedProps)==null?void 0:de.userInfo),(me=(pe=(he=(ue=(ce=c==null?void 0:c.alternate)==null?void 0:ce.return)==null?void 0:ue.return)==null?void 0:he.memoizedProps)==null?void 0:pe.userInfo)!=null&&me.userInfo&&l.push((ye=(ge=(ve=(fe=c==null?void 0:c.alternate)==null?void 0:fe.return)==null?void 0:ve.return)==null?void 0:ge.memoizedProps)==null?void 0:ye.userInfo.userInfo),l}function n(a){o(a).forEach(l=>{Object.defineProperties(l,{info:{value:t,writable:!1},isLogin:{value:!0,writable:!1}});});}if(q.watchVideDataListChange(a=>{n(a);}),u.waitNode("#root div[class*='-os']",e).then(()=>{u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:u.debounce(()=>{let a=q.getOSElement();a&&n(a);},70)});}).catch(a=>{}),C.isLive())r.info("伪装登录：live"),u.waitNode("#douyin-header div:has(.dy-tip-container)",e).then(()=>{u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:u.debounce(()=>{n(document.querySelector("#douyin-header"));},70)});});else if(C.isSearch()){let a=function(l){var m,f,g,b,w,N,z;let d=u.getReactObj(l);d==null||d.reactFiber;let c=d==null?void 0:d.reactProps;typeof((b=(g=(f=(m=c==null?void 0:c.children)==null?void 0:m[1])==null?void 0:f.props)==null?void 0:g.userInfo)==null?void 0:b.isLogin)=="boolean"&&(c.children[1].props.userInfo.isLogin=!0),typeof((z=(N=(w=c==null?void 0:c.children)==null?void 0:w[1])==null?void 0:N.props)==null?void 0:z.isClient)=="boolean"&&(c.children[1].props.isClient=!0);};r.info("伪装登录：search"),u.waitNode("#root > div",e).then(l=>{if(!l){r.error("#root > div获取失败");return}u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:u.debounce((d,c)=>{a(l);},70)});});}},watchLoginDialogToClose(){r.info("监听登录弹窗并关闭"),p.addBlockCSS('div[id^="login-full-panel-"]'),u.waitNode("body").then(()=>{u.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){var i,t;let e=document.querySelector('body > div[id^="login-full-panel-"] .dy-account-close');e&&((t=(i=u.getReactObj(e))==null?void 0:i.reactProps)==null||t.onClick(new Event("click")));}});});}},dt={init(){s.execMenu("douyin-redirect-url-home-to-root",()=>{this.redirectUrlHomeToRoot();});},redirectUrlHomeToRoot(){window.location.pathname==="/home"&&(r.info("从首页跳转到根目录"),window.location.href=window.location.origin+"/?is_from_mobile_home=1&recommend=1");}},Be={init(){dt.init(),s.execMenuOnce("debug",()=>{st.removeEnvCheck();}),s.execMenuOnce("watchLoginDialogToClose",()=>{we.watchLoginDialogToClose();}),s.execMenuOnce("disguiseLogin",()=>{we.disguiseLogin();}),s.execMenuOnce("dy-initialScale",()=>{this.initialScale();}),s.execMenu("dy-apple-removeMetaAppleItunesApp",()=>{this.removeMetaAppleItunesApp();}),at.init(),lt.init(),C.isLive()?(r.info("Router: 直播"),ze.init()):C.isVideo()?(r.info("Router: 推荐视频"),R.init(),C.isSearch()&&(r.info("Router: 推荐视频-搜索"),_e.init())):r.error("未知router: "+window.location.hostname);},initialScale(){r.info("设置<meta>的viewport固定缩放倍率为1并移除页面原有的<meta>"),v.ready(()=>{let e=v.createElement("meta",{},{name:"viewport",content:"width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"});v.remove("meta[name='viewport']"),u.waitNode("head").then(()=>{document.head.appendChild(e);});});},removeMetaAppleItunesApp(){u.waitNodeList(['meta[name="apple-itunes-app"]'],1e4).then(e=>{e&&e.forEach(i=>{i.remove();});});}},P={isMDouYin(){return window.location.hostname==="m.douyin.com"||window.location.hostname==="www.iesdouyin.com"},isShareUser(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/user/")},isShareVideo(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/video/")},isShareNote(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/note/")},isShareMusic(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/music/")},isShareChallenge(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/challenge/")}},ct=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 上面屏蔽后的空白区域 */\r
.user-card .nav-bar-placeholder,\r
/* 视频区域底部的【打开抖音App看更多内容】 */\r
.select-list .img-button{\r
    display: none !important;\r
}`,V={getVideoUrl(e){return "https://www.douyin.com/video/"+e},getCollectionUrl(e){return "https://www.douyin.com/collection/"+e},getNoteUrl(e){return "https://www.douyin.com/note/"+e},getHashTagUrl(e){return "https://www.douyin.com/hashtag/"+e},getUserHomeUrl(e){return "https://www.douyin.com/user/"+e},getMusicUrl(e){return "https://www.douyin.com/music/"+e}},ut={init(){x(ct),s.execMenuOnce("m-dy-share-user-coverPlayletList",()=>{this.coverPlayletList();}),s.execMenuOnce("m-dy-share-user-coverPostListContainer",()=>{this.coverPostListContainer();});},coverPlayletList(){v.on(document,"click",".user-playlet-list .playlet-item",e=>{var c,m,f,g;u.preventEvent(e);let i=e.target,t=(c=u.getReactObj(i))==null?void 0:c.reactFiber;if((t==null?void 0:t.key)==null){y.error("获取视频合集key失败");return}let n=t==null?void 0:t.index;if(n==null){y.error("获取视频合集index失败");return}let a=(g=(f=(m=t==null?void 0:t.return)==null?void 0:m.return)==null?void 0:f.pendingProps)==null?void 0:g.playletList;if(a==null){y.error("获取视频合集playletList失败");return}let l=a[n],d=V.getCollectionUrl(l.mix_id);window.open(d,"_blank");},{capture:!0});},coverPostListContainer(){v.on(document,"click",".post-list-container .user-post-cover",e=>{var o,n,a,l,d;u.preventEvent(e);let i=e.target,t=(o=u.getReactObj(i))==null?void 0:o.reactFiber;if((a=(n=t==null?void 0:t.return)==null?void 0:n.memoizedProps)!=null&&a.productionUrl){let c=(d=(l=t==null?void 0:t.return)==null?void 0:l.memoizedProps)==null?void 0:d.productionUrl;window.open(c,"_blank");}else y.error("获取视频链接失败");},{capture:!0});}},ht=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 视频描述信息区域中的 打开抖音看精彩视频 */\r
.footer .img-button,\r
/* 登录页面 */\r
.login-page {\r
	display: none !important;\r
}\r
`,pt=`.video-container {\r
	height: 100% !important;\r
	margin-top: 0 !important;\r
}\r
.footer {\r
	bottom: 50px !important;\r
}\r
.mix-info {\r
	bottom: 0px !important;\r
}\r
`,mt={init(){x(ht),x(pt),s.execMenuOnce("m-dy-share-video-coverGlobalClick",()=>{this.coverGlobalClick();});},coverGlobalClick(){[".right-con",".footer",".mix-info"].forEach(i=>{Me.on(document,"click",i,t=>u.preventEvent(t),{capture:!0});});}},ft=`/* 顶部 打开看看 登录 */\r
.container .adapt-login-header,\r
/* 底部中间的 App内打开 */\r
.container .float-button-con {\r
	display: none !important;\r
}\r
\r
.gallery-container {\r
	margin-top: 10px !important;\r
}\r
`,vt={init(){x(ft),s.execMenuOnce("m-dy-share-note-blockRecommend",()=>this.blockRecommend()),s.execMenuOnce("m-dy-share-note-blockComment",()=>this.blockComment()),s.execMenuOnce("m-dy-share-note-blockFooterToobar",()=>this.blockFooterToobar()),s.execMenuOnce("m-dy-share-note-coverUser",()=>{this.coverUser();}),s.execMenuOnce("m-dy-share-note-coverHashTag",()=>{this.coverHashTag();}),s.execMenuOnce("m-dy-share-note-coverMusic",()=>{this.coverMusic();}),s.execMenuOnce("m-dy-share-note-coverRecommend",()=>{this.coverRecommend();}),s.execMenuOnce("m-dy-share-note-coverExcitingGraphicsAndText",()=>{this.coverExcitingGraphicsAndText();});},blockRecommend(){return r.info("【屏蔽】相关推荐"),p.addBlockCSS(".recommend-con")},blockComment(){return r.info("【屏蔽】评论"),p.addBlockCSS(".comment-con")},blockFooterToobar(){return r.info("【屏蔽】底部工具栏"),p.addBlockCSS(".footer-con")},coverRecommend(){r.info("覆盖相关推荐的点击事件"),v.on(document,"click","#masonry .card",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.return.memoizedProps.awemeId,n=V.getNoteUrl(o);window.open(n,"_blank");},{capture:!0});},coverUser(){r.info("覆盖用户点击事件"),v.on(document,"click",".message-con__top",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.return.return.memoizedProps.video.authorInfo.sec_uid,n=V.getUserHomeUrl(o);window.open(n,"_blank");},{capture:!0});},coverHashTag(){r.info("覆盖话题点击事件"),v.on(document,"click",".message-con__content__body .message-con__content__body-text",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.index,l=t.return.return.return.return.memoizedProps.video.splitStrArr[o].hashtagId,d=V.getHashTagUrl(l);window.open(d,"_blank");},{capture:!0});},coverMusic(){r.info("覆盖音乐点击事件"),v.on(document,"click",".message-con__footer",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.return.return.memoizedProps.video.musicId,n=V.getMusicUrl(o);window.open(n,"_blank");},{capture:!0});},coverExcitingGraphicsAndText(){r.info("覆盖精彩图文点击事件"),v.on(document,"click",".container .related-list-con .related-note-item",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let n=t.return.memoizedProps.itemData.awemeId,a=V.getNoteUrl(n);window.open(a,"_blank");},{capture:!0}),v.on(document,"click",".related-title-con",e=>u.preventEvent(e),{capture:!0});}},gt=`/* 顶部 打开看看 登录 */\r
.page-reflow-challenge .header,\r
/* 底部的 打开抖音App看更多内容 */\r
.page-reflow-challenge .bottom-btn__con {\r
	display: none !important;\r
}\r
\r
.page-reflow-challenge {\r
	padding-top: 0 !important;\r
}\r
`,yt={init(){x(gt),s.onceExec("m-dy-share-challenge-coverTopJump",()=>{this.coverTopJump();}),s.execMenuOnce("m-dy-share-challenge-coverVideoCard",()=>{this.coverVideoCard();});},coverTopJump(){r.info("阻止上面区域点击跳转至下载页面"),v.on(document,"click",".challenge-body",e=>{u.preventEvent(e);},{capture:!0});},coverVideoCard(){r.info("覆盖视频卡片点击事件"),v.on(document,"click","#pagelet-worklist li.item",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.return.return.return.memoizedProps.listData,n=t.index,a=o[n],l=V.getVideoUrl(a.aweme_id);window.open(l,"_blank");},{capture:!0});}},xt=`/* 顶部 打开App，发现更多内容 */\r
.page-reflow-music .header,\r
/* ↑屏蔽后的 顶部空白区域 */\r
.page-reflow-music .banner-placeholder ,\r
/* 底部 打开抖音App看更多内容 */\r
.page-reflow-music .bottom-btn__con {\r
	display: none !important;\r
}\r
`,bt={init(){x(xt),s.execMenuOnce("m-dy-share-music-coverVideoCard",()=>{this.coverVideoCard();});},coverVideoCard(){r.info("覆盖视频卡片点击事件"),v.on(document,"click","#pagelet-worklist li.item",e=>{u.preventEvent(e);let i=e.target,t=u.getReactObj(i).reactFiber;if(!t){r.error("获取reactFiber失败"),y.error("获取reactFiber失败");return}let o=t.return.return.return.memoizedProps.listData,n=t.index,a=o[n],l=V.getVideoUrl(a.aweme_id);window.open(l,"_blank");},{capture:!0});}},Ct={init(){P.isShareUser()?(r.info("M-Router: 分享用户"),ut.init()):P.isShareVideo()?(r.info("M-Router: 分享视频"),mt.init()):P.isShareNote()?(r.info("M-Router: 分享笔记"),vt.init()):P.isShareChallenge()?(r.info("M-Router: 分享话题"),yt.init()):P.isShareMusic()?(r.info("M-Router: 分享音乐"),bt.init()):r.error("未知M-router: "+window.location.hostname);}};s.init();P.isMDouYin()?Ct.init():Be.init();

})(Qmsg, Utils, DOMUtils, pops);