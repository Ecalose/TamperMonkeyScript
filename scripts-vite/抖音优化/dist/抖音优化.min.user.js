// ==UserScript==
// @name         抖音优化
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2025.10.11.23
// @author       WhiteSevs
// @description  视频过滤，包括广告、直播或自定义规则，伪装登录、屏蔽登录弹窗、自定义清晰度选择、未登录解锁画质选择、禁止自动播放、自动进入全屏、双击进入全屏、屏蔽弹幕和礼物特效、手机模式、修复进度条拖拽、自定义视频和评论区背景色等
// @license      GPL-3.0-only
// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAF19JREFUeF7tnQl8U1X2x38vabqlLWOFrpStUMrWsrdUEARkEREQCoiAghswHQdQEFREGXfhD24MjOiMIqKD4IyICCObFCgt1JaC0ELpmq0L3ZLuyft/bkpL8pI07yUvaVre/Xz6KTT3nnvOud93381dzqXAU+riGzJarMMoGogGqD4A3RXAPQC8eKribhSjBVBJA0UUkAfgGgXq90YRzpZUybL4cAhlj5BAn9DxoOkFAGYB8LdHllCWsweuAfgvDWpvkUaWzrn07QI2ARDkExpPg14FGqNsrVgox58HaFCHAd2HRRrFEa5SOQEQ7B08VEdR7wCYxLUiIb8TPEDjB0qke1WpVv7BtjbWAARJQ9bQwPtsBQv52tID9CqVRrGNjQZsAKACpSG7ATzORqCQxzU8QIHerdQoFlvTplUAuvp19W/Q0gcAeqw1QcLnrugB+qRELJ5dWFl4y5J2FgFoanztYYAa6YqmCTqx9QCdLBGLp1qCwCIAgdLgEwA1jm01Qj5X9gB1SqWRPQCAZmppFoAgafBXNKhFrmySoBtnD+xRaeQLrQIQKA1eCVBbOYsXCri8ByhgrVIj/8BQUaMeIMgnqD9Ni664vCWCgjZ7QETTwxTVitRmAUYABHqHHACln9YVUsf1wFGVRj7ZBIAAafBkCtQvHddu85aJ40bYbbL2bIrdMpwpgKKouUq1bB+ps6UHCJCG/kyBnupMRVyhLj/VZbvUqN/5FWpfa2cTpBTOqdTyuBYAAqSh0RToNLs80U4L2wtAw76DqElY3/6sp6gJKrXsuL4HCJSGvAvgpfZnhf0a2wtA45GTqF6cYL8izpfwuUojf7oZgKsAIp2vQ9vXyARg2NVsTkr1u5aPtJWvmpQ5W1vBSU4bZL6l0sjvpTr7hkaIdXRmGyjgElUyARh+LRvfDBvOWrfClEvotGQTfChRS5knVVdxpNri9Dtr2Y7OqBNhDBUkDX2SBv1PR1fmqvKZAIy4lo09HAAgdmWMegwD1WT3VlNKKM7CfnWxq5rcoheZGCJLvR8CeN7ltXWQgkwARl7LxtccAUhauh4xKXdeHa+U3sQXlQoHacyr2D0EALKN6K7d4cMEIObaTeweNoyTl7P2/4I+r3/RUmZzWT62lBdwktE2malkKkAaco0C+raNAm1fKxOA2Myb+GooNwCIFckPLMaIklq9QadqyjFf2S5m1OWkByCjFbJ9+65MTABGZd7ElzYAcGnHNxj06X/0PizWNiAqP7k9+LOGANAIQNwetHWEjnwBQHS7GLcAQ6uIO4EJsjT8Ua9xhMq8yiQAmGwS4LUGFxfGBCAuMwf/GjrUJq1vHDyGLuu3w48S441budhRIbNJjjMLCQAw1gLuy8rBP4fYBgBpuLPLNmDUmUxcqKvCdPklZ7alTXUJADAAGJ2Vgy/sAMDwVRCvvIzEGteeERQAYAAwJisHn9sJQPOr4LCmFCuLr9v0ZDqrkAAAA4D7s3Kxa8gQu/2f/vFX6LLjAN4szcUBF54VFABgADD2ei4+G2w/AISggp9PomrtVswtSEeJtsFuqBwhQADAgQCQBqu/no+f5iZgxfWLjmg/u2UKADAAGHc9D/8YPNhuxxoJKK/CW7OfxsfnE/mVy4M0AQAGAA9cz8NOvgEgDUXTmLNtO85s/gR0RSUPTcePCAEABgDjb+RhRzTPPYBBWy0+cRKnjv+G+m8OgFa1/ZKxAAADgAk38vB3BwJAWFiReAb/69UV2sRkNJ5OQsOPR0GXts0GEgEABgATb+Rje3Q0P/1rK1I+/y0R2yN6oMpXqs/VeDYFdKECOpkCdHEp6JJS6IpvwdFbzgUAGAA8mJ2PT6McDwBp9CtZ2fiopAgnos1vx9TMWiIA4OhHkbkY5EwAmm376XwK9rhRuBgZbmSuAICjWx8AE4BJ2fn4xEk9ANO8vYnncBxapPcIQ/k9fhAAaAMAJmcX4OOoKCfUbLkKlaoY57NvomrLl0g5ew5FjQ0o0tajSNv0m88kjAEYY4ApNwvw0aC2BaC5gS8Pj8eAOuMQDsE5Z/hsfwgAMACYerMAHwoA8AqZSwtjjgEeulmAbQIALt1mvCpnCkAhtg0axGsdtgoTXgG2eo5DOSYA03IKsXUgewAq8mTo1D2UQ43sswoAsPeVzTmZADycU4j/4wDA5S/2oTpXhpGbVtqsg6WCAgC8u9RUIBOA6TkybBk4kHXNBIABW/chuYsX7n1+IXrPfJB1WWsZBQCseYiHz5kAPJIjw2YbACCqqGktMgb3xJCPNsDLv5Pd2gkAMFxIBQdCPKgfRIFdQJGfoC76f8PDHaiuAa2pBq2uBtQaNBw7zWoenQnAjFwZPhjAvQcwVPWGWIvioX3Q7Zm56DrK9i3mAgDkyFLcCLiNHw23cXH6xmeb2E6jOgKAVSXXscm/FzwoEdI7e0E8JQ7D1i1jq3pLvrsWAFG3UEgemwXJzKkQ9erO2XGkgK0AzMyV4/0BA1jX2TwGMCwwW3EZJEJIQqeueMW/Sf8ckRaKAd3h98AIRC6cBYmXp9U67joARJG94U4a/rFZoDr5WXVQaxlsBWBWrhzv8QQA0a+HxFMPwuO+gS3qVtJa3PDzQF1UOAKmjUPv6RPMmnLXAEBJveHx+ov6xodEwrnhO5eUIbi0DKHqanTT0ejr44OeL3yEvIIClOkaUU1rUa3T4d0ycu+ScWK+Ah7Nk+Pd/vz0AIY1TfS+B3N9AjBd2tlEBx1o1NA0akGjjiI/FBrETT8dfi1A1LMbPLe8Drf72Eeld6+tw8jLWZgAEaYOGgB/f9PT7edHxmNkjfWFFCYAs/PkeMcBADS3+jAPX8z1DUC8TwC8DOIKsaW+Qy0GiWOGwvubv4PyadoW1VoKkasQU6BErMQdU4YPgZdX67fRHY+NxwMa7gDMyVPg7f79ralzZ6B2ex7A3BigNSG9JF76HmGStz/6uXuzrq/DACB5ZDK8Ptti1XC/SjWeysrF8rFjrOY1zHBoVDweUnMHID5fgbf6OR4AQ10Dxe6I8vBBlLsU0eS3hw/I38ylDgGA53sb4P7kPKsNOj31Cp4L7YqIXj2s5mVm2B8Xj0er2gcA5ozzpkS4Vyxp+eksavr3dp5jDjh9P4DXzs2QzJzSaoP2y87HMzX1eDjG9kDO394Xj3mV3AGYm6/Am07uATjTzWMBpwLgvmQ+PN81jappaM/ylAwsj42Bp6eHXWbaCsC8fCX+1o/9hFNr8wB2GeCkwk4DgHzH9znVFETJUlqeeBGrJk/kxXRbAZhfoMSmSAEAXhrBUIjPyQMQ9YuwKPe53T/ghWVLeavXVgAeK1DiDQEA3tpBL8jzg41wXxxvUeizu77Di3/lPlfempa2ArCgQInXBQD4A0Aydwa8Pn7LosBlPx3H6nmz+avwtiTbAVDh9Uj2gdOFMUArTUf5+kB6aA9EfY1PvDQXWZ5yGavGcft+z5YUWwF4vFCFjX0FANj6udV8Hi+ugMeaFWbzRJ1Pw7f33w83NztjVNbWAeVVQFkV0NAIRPYA3CWwFYCFhSq8JgBgf/uTp548/aQXYCZdbgH+cUuN8WP019ZwT9dy8cdn38LvdDpCa+6EaW8WVCemIBPR6MUIy2NuFo25FrCosAgb+rIPnSy8Aiw0n+db6+H+tPkLxxd8/zNef4L7ZeSl+/8HzdbdCKtoCsrMNbEBYHFhEV4VAODqWtP8Pkk/g6z0MVOPU0n4NjbW7AqexVq1OmQl/A19Eu2LwM0GgCdkRXglQugB7CLAbcIY/SqfufT++QzMHH8/e/nZhchZ8gp6lNWwL2MhpwCAqWMcMhNoqfufkXIJH4wby74hswshm78GIbWm73mmkNS6Kn1AxtQ6Ncp1DSjTNqJc14ieEk/0dPPS//7czC0ezDHAk7JivBxhecKKWa8wBjDTnD6//dfsV79d1wtw/2CWJ2+ra5E/bgnCzAzyDKskjb67SomkWtsibzEBWCIrxnoBAPYPKTMnGf0TAJgpXF6Ew33Yv1szlr6CgSmtx9ndVl6A98rybVfWTICIpfJirOsj9AA2O1WycDa8trxhUn5ZRhZWx8awkluRdhV+iza2mndYwQXIG+tYyWstE7MHeEpejJcEAGz3q9cX2yCZZrqit09WiuiI3qwEX0zYhKGnLN/pO7QgBYpGfiJlMAF4Wl6CtX36sNKTZBLGAAxXSY9+B3G08a5art3/leFz0d/Cw9285551C1nJKADA85Ux5r7/L0+9glVjRrNqs8zTyYhYsdls3rdu5eGTikJWcthmYgLwjKIEa3oLPQBb/5nk8716GhRjm/aeHAVGDGS30fL7v7yG2SevmchNq1NjuuISGml+rzhiAvCsogQvCgDY3P7wk6UDjAWeQ0WV6NOT3RGvg8texsNnbpgo8FxRJn7UlNiumIWSTACeU5Tihd7sxirCGMCMU81dx36mRocune9l1XhHn3oJDybnGOW92VCD+wpTWZXnmomp7zJlKVaHCwBw9WNLfnMA/OHhCzc3N1YyTy56EWPTjL/bkyef9AB8J3Lc3DftmJHY5cpSrBIAsN3VTACkmmr8HsA+hs7/lqzFxAu5Rgq8VpqDzyrltitloSQ5ei79wfji9BXKW1gZbn4Dizkx5zduw8gDZ40+4vubCu+GGwjkfS2ACUCwshinwtnPrKUc+hXD1/3DyOZ5yiv4raacdz+Ym7TiCsCJmcsxLrtUAKDZA74ZJ0EF3DkBG5mdjx85xt49FjkF4yV3joc7agDo+c4rcF/6mFHjPS8vQQKHiaCk4XMQUycykjFNfglkcao9JN57AO+9O/QRPZrTkMyb+I7jZcy7Jy3GQsWdTR/rSrPxZaWSV3+S+AM+p/+rDzVjmF7OLsSTUezDxGX3fwS9xMbBHkYXpiK7wf7la14NtiCMdwA8N6yGe8Kd/f3heXIc5nDcmuh5YOeXGLJ1vz64AknkXP+H5fxOAEkWPAqvrZtM3PJOZi5mD2V3bVz66fOIWmF6wHVgfjJKXfSaOKbBvAPAdGyXkjKc6d6LM8xfT3kCj8uaniJHfAvw3rMdbhNNN6Z8kpmHSUPZ3Rl0eNM2TNlnPAAk+oblnuV9woqzA1kW4B0A8ZBBkP6yt6V6j7p6ZPjfCY/CUi+kpaajZv46xHr4oqCxDiMLLrAtajWfJ4lGsvxJs/m+zCrAqCHs9izsm5uAOVeLjOSotPUYnJ9iVQdXycA7AMQw7+93wW1MbIuNp9QNCA4M4GzzD39+FQ+dugZ3SoSxhb8jq6GaswxmAfHwaP1uZXMpLCkVxyaYj9djLv+h4bPwUJ1xSJvk2krMUGTYraezBDgEADKyJiPs5vThlWxMHTncJpu+W7kRsUd+xy+aW9h4y3iGkKtAMuDzvXTCYrFlv57F6hnTWIk9tWsvYrbt14eCM0z71EV43sUvjDbU1yEAUMEB8Ek82BL65dmUDLw4jsNGUEYT/Oulv6HfgTN6AMiikC3JbdI4eO/+xGJRt0I5jnh3QlhYV1biD49fhCnFpmvWm8vysaW8gJUMV8jkEACIYWSETQaEJI1Pv4odcTYeArntpezMG8h4Yj2WXTYddLXmSFFYCCTzZlo8odRc9pnTF7BmCrs4v1eOn0FAwmZ0FptGNBtTmIob7eQrILHdYQC4jR4J7/1f6P3bqaIKR7074Z4/2R8/9+W3P8Hu3Ew07DsINFi+kVs8MBKSeTP0jU918m31YXsoKxfbOFwZ/+ucBEzINB78kQou1akxWZ7uCg82ax0cBgDRwHBS6L30LMyKY7cn0Jr2Pfd+CxJkqvG3c6DLKpp+yisgCugMqkcYyFMvCmO//pAlNQ0zZ0mH0nwZqqb+Gd1FpkGc3i7Lw8c8z1dY84W9nzsUAMmch+H16bt6Haf9fgVbR7PbFWTNqAvJFzEnKQnuTy2wlrXVzwedPo/9U1qPV8QUkLj8NdyXaLphheSbJEtHRr1tYxS7DLGjsEMB0PcC+z+H2+gY/WvgkMQbAV1MI2Xaon9VZRWe27ELydMfBIktzCk1NmJRSgY2TBzPqVjZzXyUzlqFcJ3piWYy90/WANpbcjgA5Hu39/efg/LyxKoLlznH+7Pm0P8cPIyk2loc6x6MigGtnzugi0oQn5WL+d26Iaof+zMKzTokTVqKGIX5J3xNSTa+ruJ3vcKa7Xx87nAAiJLuyxbD84216FGgwMGe4fDwsC8CmCXDz6VdwpnyclRSFKpEFKokboCORoSmBj0oCpEBXRAVxf4uAMN6kl54GzFH08xW3R4Hf82GOAUAUhmJCkoGbq+lXsVCW+MC8IG8DTKyfzqOe9Z9inso88Es2uvTT1zhNABIZT6//4rQ+kZ87eePMA6jdBvajNciabHzEa3Rdbin3+kAkAp9s87ikQuXseURdlOuvLakDcLOLFiNuAzLS9Ht+elvEwBIpdKj/8Y7VbWYO5n9wosNbWd3kbOPJmDUddMJn2bB/9GUYLkDNqvarTgHAU59BRjqFfTdZ9gV1g3DbRyUcbDRpqznpj2L2HzL+xBzGmoRV3jRJtmuVKjNACBOGPb+RvxzzqMIMNhD6ArOSXpwKWKUrU/oTJCl4Y96jSuoa48OWgIAWWRv/fYFe6qwUvbhZUuwK2EF0CPEgbWwF508bjFGlLYehOovxVn4Xl3MXqjr5iwjAMgAtKn3n+kXjUXjJyDivRfazFUX3vwU0gMnENlgvL7PVGhDaQ52OeCMQlsYTgOZVKA09DxAs7+wx0GaksuU1vbsD9Gf5yN80QwH1WIq9ureg9Bs/w7Dyq3HG5guv4QL7WS7N0sHHiU9wNcAuAftY1kDl2wEgvc7hyOrTzBCVj+BsPsdx+WVf30P9e5DGFlk/T1OtnmtLLkOMvDrYOkjKkgasoYG3ncVw8gFSiv/FIZHpJ2R4Qmoo8IROGsiwh+2/yujWlWC63t+hPbAMQyrsLyXwNAXhzSlWF1yA5W6RldxEW96UKCWUF18Q0aLdDjNm1SeBJGLFgkIXd2a1g1kaERBty4QR/eBf+xg9Jw8FmIPy3cM1mlqoEzNQFHaVVQnpsLvphwRNTTIXTxsUka9BjsrZNjfMQZ7Zk3Wiqi++kt1AqUh5HCbPxvHODNPkNgdS/2CscQvGD4i03n4PKoRanfjv4u1NPwbdAig2J1GZtpDDnTsrJRjZ4Uc9bT56V9n+sCBdV1TaeT9mgHYBeApB1Zml+jeEq8WEOwS1ErhKp0W+9VF+sbP7XjvenOWv6fSyNc1AeATOh40bXxQ3lGetkNuhMQb06X36q9f7cvhssXWqjxWXYYj1bfwc3VpuznOZYcLW4rSoAYXaWTpLfeqBfqEnAWNUXwId4aMkZ5+eNDbHz3cPPVnCMlvc68JQ11qaZ0+vJxCW4eDmlIc1JTcVY3e7Asa1OEijewh8v8WAIJ8QuNpmv63MxrPUXWQbdrNQHR384RSW3+7wcnvOn3sYCEBNOgpRRrFESMAbg8GyR8nCU7qwB6g8YOqWt50YMOwByD/CfYOHqqjqPa/xNWB289e0yhKN0CpVv5hFgDyR1ebGLLXYKG8oQfoVSqNYpvhX4wv1739iStNDwsNyI8HKNC7lRrFYqY0swA07RUMPQHQHG534EdRQYojPECfVGkUD5iTbAkAdPXr6t+g1R4GKMetyDjCVkEmwwN0skQsnlpYWXiLEwAk820I9gPUOMGv7dED1CmJmHrUUuObfAuwZGKQNPgrGtSi9uiCu1jnPSqNnLRZq9G1Lb4CmI4LlAavBKitd7FD243pFLBWqZF/wEZh1gDovyL6BPWndaI3QWEWG+FCHqd74KiIptcrqhWsI2tzAqDZnABp8GRA9FcK9FSnmyhUaOoBCucoUFuVatk+ru6xCYA7IIRGU6BJrFWyiY/9ldtctRTym/MAGdX/AIr6RqWWHbfVRXYBYFhpZ9/QCDcd4mjQJMxmJA10pwASG44E/bXzinBbzesQ5Ui0zDKAKgTo6xSQrhXhXHGVPJEP6/4fAayH1yFvEgIAAAAASUVORK5CYII=
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*.douyin.com/*
// @match        *://*.iesdouyin.com/*
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@86be74b83fca4fa47521cded28377b35e1d7d2ac/lib/CoverUMD/index.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.9.3/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.7.2/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@2.5.4/dist/index.umd.min.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.5.0/dist/index.umd.min.js
// @connect      *
// @connect      www.toutiao.com
// @grant        GM_deleteValue
// @grant        GM_download
// @grant        GM_getResourceText
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (k, z, ne, Te) {
	'use strict';

	var gt=typeof GM_deleteValue<"u"?GM_deleteValue:void 0,et=typeof GM_download<"u"?GM_download:void 0,tt=typeof GM_getResourceText<"u"?GM_getResourceText:void 0,Ve=typeof GM_getValue<"u"?GM_getValue:void 0,Me=typeof GM_info<"u"?GM_info:void 0,bt=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,ve=typeof GM_setValue<"u"?GM_setValue:void 0,Ct=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,kt=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,A=typeof unsafeWindow<"u"?unsafeWindow:void 0,xt=window;const ct="GM_Panel",He="data-init",oe="data-key",ae="data-default-value",wt="data-init-more-value",N="data-storage-api",pe={get width(){return globalThis.innerWidth},get height(){return globalThis.innerHeight}},te={setting:{get width(){return pe.width<550?"88vw":pe.width<700?"550px":"700px"},get height(){return pe.height<450?"70vh":pe.height<550?"450px":"550px"}},settingMiddle:{get width(){return pe.width<350?"88vw":"350px"}},info:{get width(){return pe.width<350?"88vw":"350px"},get height(){return pe.height<250?"88vh":"250px"}}};class St{storageKey;listenerData;constructor(e){if(typeof e=="string"){const i=e.trim();if(i=="")throw new Error("key参数不能为空字符串");this.storageKey=i;}else throw new Error("key参数类型错误，必须是字符串");this.listenerData=new ne.Dictionary,this.getLocalValue=this.getLocalValue.bind(this),this.set=this.set.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.delete=this.delete.bind(this),this.has=this.has.bind(this),this.keys=this.keys.bind(this),this.values=this.values.bind(this),this.clear=this.clear.bind(this),this.addValueChangeListener=this.addValueChangeListener.bind(this),this.removeValueChangeListener=this.removeValueChangeListener.bind(this),this.triggerValueChangeListener=this.triggerValueChangeListener.bind(this);}getLocalValue(){let e=Ve(this.storageKey);return e==null&&(e={},this.setLocalValue(e)),e}setLocalValue(e){ve(this.storageKey,e);}set(e,i){const n=this.get(e),o=this.getLocalValue();Reflect.set(o,e,i),this.setLocalValue(o),this.triggerValueChangeListener(e,n,i);}get(e,i){const n=this.getLocalValue();return Reflect.get(n,e)??i}getAll(){return this.getLocalValue()}delete(e){const i=this.get(e),n=this.getLocalValue();Reflect.deleteProperty(n,e),this.setLocalValue(n),this.triggerValueChangeListener(e,i,void 0);}has(e){const i=this.getLocalValue();return Reflect.has(i,e)}keys(){const e=this.getLocalValue();return Reflect.ownKeys(e)}values(){const e=this.getLocalValue();return Reflect.ownKeys(e).map(i=>Reflect.get(e,i))}clear(){gt(this.storageKey);}addValueChangeListener(e,i){const n=Math.random(),o=this.listenerData.get(e)||[];return o.push({id:n,key:e,callback:i}),this.listenerData.set(e,o),n}removeValueChangeListener(e){let i=false;for(const[n,o]of this.listenerData.entries()){for(let a=0;a<o.length;a++){const l=o[a];(typeof e=="string"&&l.key===e||typeof e=="number"&&l.id===e)&&(o.splice(a,1),a--,i=true);}this.listenerData.set(n,o);}return i}async triggerValueChangeListener(...e){const[i,n,o]=e;if(!this.listenerData.has(i))return;let a=this.listenerData.get(i);for(let l=0;l<a.length;l++){const u=a[l];if(typeof u.callback=="function"){let s=this.get(i),d,c;typeof n<"u"&&e.length>=2?c=n:c=s,typeof o<"u"&&e.length>2?d=o:d=s,await u.callback(i,c,d);}}}}const Q=new St(ct),we={$data:{__contentConfig:null,get contentConfig(){return this.__contentConfig==null&&(this.__contentConfig=new b.Dictionary),this.__contentConfig},__defaultBottomContentConfig:[]},addContentConfig(t){Array.isArray(t)||(t=[t]);let e=this.$data.contentConfig.keys().length;this.$data.contentConfig.set(e,t);},getAllContentConfig(){return this.$data.contentConfig.values().flat()},getConfig(t=0){return this.$data.contentConfig.get(t)??[]},getDefaultBottomContentConfig(){return this.$data.__defaultBottomContentConfig.length?this.$data.__defaultBottomContentConfig:[{id:"script-version",title:`版本：${Me?.script?.version||"未知"}`,isBottom:true,forms:[],clickFirstCallback(t,e,i){let n=Me?.script?.supportURL||Me?.script?.namespace;return typeof n=="string"&&b.isNotNull(n)&&window.open(n,"_blank"),false}}]},setDefaultBottomContentConfig(t){this.$data.__defaultBottomContentConfig=t;}},ut={$data:{__menuOption:[{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{h.showPanel(we.getConfig(0));}}],get menuOption(){return this.__menuOption}},init(){this.initExtensionsMenu();},initExtensionsMenu(){h.isTopWindow()&&ht.add(this.$data.menuOption);},addMenuOption(t){Array.isArray(t)||(t=[t]),this.$data.menuOption.push(...t);},updateMenuOption(t){Array.isArray(t)||(t=[t]),t.forEach(e=>{let i=this.$data.menuOption.findIndex(n=>n.key===e.key);i!==-1&&(this.$data.menuOption[i]=e);});},getMenuOption(t=0){return this.$data.menuOption[t]},deleteMenuOption(t=0){this.$data.menuOption.splice(t,1);}},y={waitRemove(...t){t.forEach(e=>{typeof e=="string"&&z.waitNodeList(e).then(i=>{i.forEach(n=>n.remove());});});},createBlockCSSNode(...t){let e=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(i=>{Array.isArray(i)?e=e.concat(i):e.push(i);}),z.createElement("style",{type:"text/css",innerHTML:`${e.join(`,
`)}{display: none !important;}`})},addBlockCSS(...t){let e=[];if(t.length!==0&&!(t.length===1&&typeof t[0]=="string"&&t[0].trim()===""))return t.forEach(i=>{Array.isArray(i)?e=e.concat(i):e.push(i);}),B(`${e.join(`,
`)}{display: none !important;}`)},setGMResourceCSS(t){const e=typeof tt=="function"?tt(t.keyName):null;return typeof e=="string"&&e?B(e):y.loadStyleLink(t.url)},async loadStyleLink(t){let e=document.createElement("link");return e.rel="stylesheet",e.type="text/css",e.href=t,new Promise(i=>{z.ready(()=>{document.head.appendChild(e),i(e);});})},async loadScript(t){let e=document.createElement("script");return e.src=t,new Promise(i=>{e.onload=()=>{i(null);},(document.head||document.documentElement).appendChild(e);})},fixUrl(t){return t=t.trim(),t.startsWith("data:")||t.match(/^http(s|):\/\//i)?t:t.startsWith("//")?(t.startsWith("///")||(t=window.location.protocol+t),t):(t.startsWith("/")||(t+="/"),t=window.location.origin+t,t)},fixHttps(t){if(t.startsWith("https://")||!t.startsWith("http://"))return t;try{let e=new URL(t);return e.protocol="https:",e.toString()}catch{return t}},lockScroll(...t){let e=document.createElement("style");e.innerHTML=`
			.pops-overflow-hidden-important {
				overflow: hidden !important;
			}
		`;let i=[document.documentElement,document.body].concat(...t||[]);return i.forEach(n=>{n.classList.add("pops-overflow-hidden-important");}),(document.head||document.documentElement).appendChild(e),{recovery(){i.forEach(n=>{n.classList.remove("pops-overflow-hidden-important");}),e.remove();}}},async getClipboardText(){function t(n){navigator.clipboard.readText().then(o=>{n(o);}).catch(o=>{r.error("读取剪贴板内容失败👉",o),n("");});}function e(n){navigator.permissions.query({name:"clipboard-read"}).then(o=>{t(n);}).catch(o=>{r.error("申请剪贴板权限失败，尝试直接读取👉",o.message??o.name??o.stack),t(n);});}function i(){return !(typeof navigator?.clipboard?.readText!="function"||typeof navigator?.permissions?.query!="function")}return new Promise(n=>{if(!i()){n("");return}document.hasFocus()?e(n):window.addEventListener("focus",()=>{e(n);},{once:true});})},escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/©/g,"&copy;").replace(/®/g,"&reg;").replace(/™/g,"&trade;").replace(/→/g,"&rarr;").replace(/←/g,"&larr;").replace(/↑/g,"&uarr;").replace(/↓/g,"&darr;").replace(/—/g,"&mdash;").replace(/–/g,"&ndash;").replace(/…/g,"&hellip;").replace(/ /g,"&nbsp;").replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")},interval(t,e,i=5e3){let n,o=i-e,a=e,l=async u=>{let s=await t(u);if(typeof s=="boolean"&&!s||u){b.workerClearTimeout(n);return}if(a+=e,a>o){l(true);return}n=b.workerSetTimeout(()=>{l(false);},e);};l(false);},findParentNode(t,e,i){if(i){let n=z.closest(t,i);if(n)return n.querySelector(e)}else return z.matches(t,e)?t:z.closest(t,e)}},h={$data:{__contentConfigInitDefaultValue:null,__onceExecMenuData:null,__urlChangeReloadMenuExecOnce:null,__onceExecData:null,__panelConfig:{},$panel:null,panelContent:[],get contentConfigInitDefaultValue(){return this.__contentConfigInitDefaultValue==null&&(this.__contentConfigInitDefaultValue=new b.Dictionary),this.__contentConfigInitDefaultValue},contentConfigInitDisabledKeys:[],get onceExecMenuData(){return this.__onceExecMenuData==null&&(this.__onceExecMenuData=new b.Dictionary),this.__onceExecMenuData},get urlChangeReloadMenuExecOnce(){return this.__urlChangeReloadMenuExecOnce==null&&(this.__urlChangeReloadMenuExecOnce=new b.Dictionary),this.__urlChangeReloadMenuExecOnce},get onceExecData(){return this.__onceExecData==null&&(this.__onceExecData=new b.Dictionary),this.__onceExecData},get scriptName(){return Oe},get panelConfig(){return this.__panelConfig},set panelConfig(t){this.__panelConfig=t;},key:ct,attributeKeyName:oe,attributeDefaultValueName:ae},init(){this.initContentDefaultValue(),ut.init();},isTopWindow(){return A.top===A.self},initContentDefaultValue(){const t=n=>{if(!n.attributes||n.type==="button"||n.type==="forms"||n.type==="deepMenu")return;const o=n.attributes;let a=o[He];if(typeof a=="function"){let d=a();if(typeof d=="boolean"&&!d)return}let l=new Map,u=o[oe];if(u!=null){const d=o[ae];l.set(u,d);}let s=o[wt];if(typeof s=="object"&&s&&Object.keys(s).forEach(d=>{l.set(d,s[d]);}),!l.size){r.warn(["请先配置键",n]);return}if(n.type==="switch"){let d=typeof n.disabled=="function"?n.disabled():n.disabled;typeof d=="boolean"&&d&&this.$data.contentConfigInitDisabledKeys.push(...l.keys());}for(const[d,c]of l.entries())this.setDefaultValue(d,c);},e=n=>{for(let o=0;o<n.length;o++){let a=n[o];t(a);let l=a.forms;l&&Array.isArray(l)&&e(l);}},i=[...we.getAllContentConfig()];for(let n=0;n<i.length;n++){let o=i[n];if(!o.forms)continue;const a=o.forms;a&&Array.isArray(a)&&e(a);}this.$data.contentConfigInitDisabledKeys=[...new Set(this.$data.contentConfigInitDisabledKeys)];},setDefaultValue(t,e){this.$data.contentConfigInitDefaultValue.has(t)&&r.warn("请检查该key(已存在): "+t),this.$data.contentConfigInitDefaultValue.set(t,e);},getDefaultValue(t){return this.$data.contentConfigInitDefaultValue.get(t)},setValue(t,e){Q.set(t,e);},getValue(t,e){let i=Q.get(t);return i??(this.$data.contentConfigInitDefaultValue.has(t)?this.$data.contentConfigInitDefaultValue.get(t):e)},deleteValue(t){Q.delete(t);},hasKey(t){return Q.has(t)},addValueChangeListener(t,e){return Q.addValueChangeListener(t,(n,o,a)=>{e(t,a,o);})},removeValueChangeListener(t){Q.removeValueChangeListener(t);},triggerMenuValueChange(t,e,i){Q.triggerValueChangeListener(t,i,e);},exec(t,e,i,n=true){const o=this;let a;typeof t=="string"||Array.isArray(t)?a=()=>t:a=t;let l=false;const u=a();let s=[];Array.isArray(u)?(l=true,s=u):s.push(u);const d=s.find(_=>!this.$data.contentConfigInitDefaultValue.has(_));if(d){r.warn(`${d} 键不存在`);return}const c=JSON.stringify(s);if(n&&this.$data.onceExecMenuData.has(c))return this.$data.onceExecMenuData.get(c);let p=[];const v=[];let g=[];const C=(_,D)=>{let $=[],E=[],I=[];if(Array.isArray(D))I=I.concat(D);else if(typeof D=="object"&&D!=null){const{$css:R,destory:U}=D;R!=null&&(Array.isArray(R)?I=I.concat(R):I.push(R)),typeof U=="function"&&I.push(U);}else I.push(D);for(const R of I)if(R!=null){if(R instanceof Element){$.push(R);continue}if(typeof R=="function"){g.push(R);continue}}_?(p=p.concat($),g=g.concat(E)):(w(),S());},x=_=>this.getValue(_),w=()=>{for(let _=0;_<p.length;_++)p[_]?.remove(),p.splice(_,1),_--;},S=()=>{for(let _=0;_<g.length;_++){const D=g[_];D(),g.splice(_,1),_--;}},T=()=>{let _=false;return typeof i=="function"?_=i(s):_=s.every(D=>x(D)),_},V=_=>{if(T()){const $=s.map(I=>this.getValue(I)),E=e({value:l?$:$[0],addStoreValue:(...I)=>C(true,I)});C(true,E);}else C(false,[]);};n&&s.forEach(_=>{const D=this.addValueChangeListener(_,($,E,I)=>V());v.push(D);}),V();const F={reload(){V();},clear(){this.clearStoreStyleElements(),this.destory(),this.removeValueChangeListener(),this.clearOnceExecMenuData();},clearStoreStyleElements:()=>w(),destory(){return S()},removeValueChangeListener:()=>{v.forEach(_=>{this.removeValueChangeListener(_);});},clearOnceExecMenuData(){n&&o.$data.onceExecMenuData.delete(c);}};return this.$data.onceExecMenuData.set(c,F),F},execMenu(t,e,i=false,n=false){return this.exec(t,o=>e(o),o=>o.every(l=>{let u=!!this.getValue(l);return h.$data.contentConfigInitDisabledKeys.includes(l)&&(u=false,r.warn(`.execMenu${n?"Once":""} ${l} 被禁用`)),i&&(u=!u),u}),n)},execMenuOnce(t,e,i=false,n=false){const o=this.execMenu(t,e,i,true);if(n&&o){const a=()=>{o.reload();};this.removeUrlChangeWithExecMenuOnceListener(t),this.addUrlChangeWithExecMenuOnceListener(t,a);const l=o.clear;o.clear=()=>{l(),this.removeUrlChangeWithExecMenuOnceListener(t);};}return o},deleteExecMenuOnce(t){return t=this.transformKey(t),this.$data.onceExecMenuData.delete(t),this.$data.urlChangeReloadMenuExecOnce.delete(t),Q.removeValueChangeListener(t)},onceExec(t,e){if(t=this.transformKey(t),typeof t!="string")throw new TypeError("key 必须是字符串");this.$data.onceExecData.has(t)||(e(),this.$data.onceExecData.set(t,1));},deleteOnceExec(t){t=this.transformKey(t),this.$data.onceExecData.delete(t);},addUrlChangeWithExecMenuOnceListener(t,e){t=this.transformKey(t),this.$data.urlChangeReloadMenuExecOnce.set(t,e);},removeUrlChangeWithExecMenuOnceListener(t){t=this.transformKey(t),this.$data.urlChangeReloadMenuExecOnce.delete(t);},triggerUrlChangeWithExecMenuOnceEvent(t){this.$data.urlChangeReloadMenuExecOnce.forEach((e,i)=>{e(t);});},showPanel(t,e=`${Oe}-设置`,i=false,n=false){this.$data.$panel=null,this.$data.panelContent=[];let o=t.findIndex(l=>(typeof l.isBottom=="function"?l.isBottom():!!l.isBottom)&&l.id==="script-version")!==-1;!i&&!o&&t.push(...we.getDefaultBottomContentConfig());let a=H.panel({title:{text:e,position:"center",html:false,style:""},content:t,btn:{close:{enable:true,callback:(l,u)=>{l.close(),this.$data.$panel=null;}}},mask:{enable:true,clickEvent:{toClose:true,toHide:false},clickCallBack:(l,u)=>{l(),this.$data.$panel=null;}},width:te.setting.width,height:te.setting.height,drag:true,only:true,...this.$data.panelConfig});this.$data.$panel=a,this.$data.panelContent=t,n||this.registerConfigSearch({$panel:a,content:t});},registerConfigSearch(t){const{$panel:e,content:i}=t;let n=async(c,p)=>{if(c==null)return;let v=await p(c);return v&&typeof v.isFind=="boolean"&&v.isFind?v.data:await n(v.data,p)},o=(c,p)=>{const v=new IntersectionObserver(g=>{g.forEach(C=>{C.isIntersecting&&(p?.(),v.disconnect());});},{root:null,threshold:1});v.observe(c),c.scrollIntoView({behavior:"smooth",block:"center"});},a=c=>{const p="pops-flashing";f.animationend(c,()=>{c.classList.remove(p);}),c.classList.add(p);},l=(c,p)=>{f.preventEvent(c);let v=H.alert({title:{text:"搜索配置",position:"center"},content:{text:`
						<div class="search-wrapper">
							<input class="search-config-text" name="search-config" type="text" placeholder="请输入需要搜素的配置名称">
						</div>
						<div class="search-result-wrapper"></div>
					`,html:true},btn:{ok:{enable:false}},mask:{clickEvent:{toClose:true}},width:te.settingMiddle.width,height:"auto",drag:true,style:`
					${H.config.cssText.panelCSS}

					.search-wrapper{
						border-bottom: 1px solid rgb(235, 238, 245, 1);
					}
					.pops-content:has(.search-result-wrapper:empty) .search-wrapper{
						border-bottom: 0;
					}
					.search-config-text{
						width: 100%;
						border: 0;
						height: 32px;
						padding: 0px 10px;
						outline: none;
					}
					.search-result-wrapper{
						max-height: 400px;
						overflow: auto;
					}
					.search-result-item{
						cursor: pointer;
						padding: 5px 10px;
						display: flex;
						flex-direction: column;
					}
					.search-result-item:hover{
						background-color: #D8F1FD;
					}
					.search-result-item-path{
						display: flex;
    					align-items: center;
					}
					.search-result-item-description{
						font-size: 0.8em;
						color: #6c6c6c;
					}
					${t.searchDialogStyle??""}
				`});v.$shadowRoot.querySelector(".search-wrapper");let g=v.$shadowRoot.querySelector(".search-config-text"),C=v.$shadowRoot.querySelector(".search-result-wrapper");g.focus();let x=()=>{f.empty(C);},w=T=>{const V=b.queryProperty(T,_=>_?.next?{isFind:false,data:_.next}:{isFind:true,data:_});let F=f.createElement("div",{className:"search-result-item",innerHTML:`
							<div class="search-result-item-path">${V.matchedData?.path}</div>
							<div class="search-result-item-description">${V.matchedData?.description??""}</div>
						`});return f.on(F,"click",_=>{let $=e.$shadowRoot.querySelectorAll("aside.pops-panel-aside .pops-panel-aside-top-container li")[T.index];if(!$){k.error(`左侧项下标${T.index}不存在`);return}$.scrollIntoView({behavior:"smooth",block:"center"}),$.click(),n(T.next,async E=>{if(E?.next){let I=await f.waitNode(()=>Array.from(e.$shadowRoot.querySelectorAll(".pops-panel-deepMenu-nav-item")).find(R=>{const U=Reflect.get(R,"__formConfig__");return typeof U=="object"&&U!=null&&U.text===E.name}),2500);if(I)I.click();else return k.error("未找到对应的二级菜单"),{isFind:true,data:E};return {isFind:false,data:E.next}}else {let I=await f.waitNode(()=>Array.from(e.$shadowRoot.querySelectorAll("li:not(.pops-panel-deepMenu-nav-item)")).find(R=>Reflect.get(R,"__formConfig__")===E.matchedData?.formConfig),2500);if(I){o(I);let R=I.closest(".pops-panel-forms-fold[data-fold-enable]");R&&(R.querySelector(".pops-panel-forms-fold-container").click(),await b.sleep(500)),o(I,()=>{a(I);});}else k.error("未找到对应的菜单项");return {isFind:true,data:E}}});}),F},S=T=>{const V=new RegExp(T,"i"),F=[],_=($,E)=>{for(let I=0;I<$.length;I++){const R=$[I];let U=R.forms;if(U&&Array.isArray(U)){const Y=b.deepClone(E);if(R.type==="deepMenu"){const J=b.queryProperty(Y,j=>j?.next?{isFind:false,data:j.next}:{isFind:true,data:j});J.next={name:R.text};}_(U,Y);}else {let Y=Reflect.get(R,"text"),J=Reflect.get(R,"description");const j=[Y,J];let re=j.findIndex(W=>{if(typeof W=="string")return W.match(V)});if(re!==-1){const W=b.deepClone(E),le=b.queryProperty(W,G=>G?.next?{isFind:false,data:G.next}:{isFind:true,data:G});le.next={name:Y,matchedData:{path:"",formConfig:R,matchedText:j[re],description:J}};const fe=[];b.queryProperty(W,G=>{const ge=G?.name;return typeof ge=="string"&&ge.trim()!==""&&fe.push(ge),G?.next?{isFind:false,data:G.next}:{isFind:true,data:G}});const ye=fe.join(y.escapeHtml(" - "));le.next.matchedData.path=ye,F.push(W);}}}};for(let $=0;$<i.length;$++){const E=i[$];if(!E.forms||E.isBottom&&E.id==="script-version")continue;const I=E.forms;if(I&&Array.isArray(I)){let R=E.title;typeof R=="function"&&(R=R()),_(I,{index:$,name:R});}}let D=document.createDocumentFragment();for(const $ of F){let E=w($);D.appendChild(E);}x(),C.append(D);};f.on(g,"input",b.debounce(T=>{f.preventEvent(T);let V=f.val(g).trim();if(V===""){x();return}S(V);},200));},u=null,s=false,d;f.on(e.$shadowRoot,"dblclick","aside.pops-panel-aside .pops-panel-aside-item:not(#script-version)",l),f.on(e.$shadowRoot,"touchend","aside.pops-panel-aside .pops-panel-aside-item:not(#script-version)",(c,p)=>{clearTimeout(d),d=void 0,s&&u===p?(s=false,u=null,l(c)):(d=setTimeout(()=>{s=false;},200),s=true,u=p);},{capture:true}),e.$shadowRoot.appendChild(f.createElement("style",{type:"text/css",textContent:`
					.pops-flashing{
						animation: double-blink 1.5s ease-in-out;
					}
					@keyframes double-blink {
						 0% {
							background-color: initial;
						}
						25% {
							background-color: yellow;
						}
						50% {
							background-color: initial;
						}
						75% {
							background-color: yellow;
						}
						100% {
							background-color: initial;
						}
					}
				`}));},transformKey(t){if(Array.isArray(t)){const e=t.sort();return JSON.stringify(e)}else return t}},Ce={qmsg_config_position:{key:"qmsg-config-position",defaultValue:"bottom"},qmsg_config_maxnums:{key:"qmsg-config-maxnums",defaultValue:3},qmsg_config_showreverse:{key:"qmsg-config-showreverse",defaultValue:false}},b=ne.noConflict(),f=z.noConflict(),H=Te,r=new b.Log(Me,A.console||xt.console);let Oe=Me?.script?.name||void 0;Te.config.Utils.AnyTouch();const _t=false;r.config({debug:false,logMaxCount:250,autoClearConsole:true,tag:true});k.config({isHTML:true,autoClose:true,showClose:false,consoleLogContent(t){const e=t.getSetting().type;if(e==="loading")return  false;const i=t.getSetting().content;return e==="warning"?r.warn(i):e==="error"?r.error(i):r.info(i),true},get position(){return h.getValue(Ce.qmsg_config_position.key,Ce.qmsg_config_position.defaultValue)},get maxNums(){return h.getValue(Ce.qmsg_config_maxnums.key,Ce.qmsg_config_maxnums.defaultValue)},get showReverse(){return h.getValue(Ce.qmsg_config_showreverse.key,Ce.qmsg_config_showreverse.defaultValue)},get zIndex(){let t=ne.getMaxZIndex(),e=Te.config.InstanceUtils.getPopsMaxZIndex().zIndex;return ne.getMaxValue(t,e)+100}});H.GlobalConfig.setGlobalConfig({zIndex:()=>{let t=ne.getMaxZIndex(void 0,void 0,i=>{if(i?.classList?.contains("qmsg-shadow-container")||i?.closest("qmsg")&&i.getRootNode()instanceof ShadowRoot)return  false}),e=Te.config.InstanceUtils.getPopsMaxZIndex().zIndex;return ne.getMaxValue(t,e)+100},mask:{enable:true,clickEvent:{toClose:false,toHide:false}},drag:true});const ht=new b.GM_Menu({GM_getValue:Ve,GM_setValue:ve,GM_registerMenuCommand:bt,GM_unregisterMenuCommand:Ct}),Ee=new b.Httpx({xmlHttpRequest:kt,logDetails:_t});Ee.interceptors.request.use(t=>t);Ee.interceptors.response.use(void 0,t=>(r.error("拦截器-请求错误",t),t.type==="onabort"?k.warning("请求取消",{consoleLogContent:true}):t.type==="onerror"?k.error("请求异常",{consoleLogContent:true}):t.type==="ontimeout"?k.error("请求超时",{consoleLogContent:true}):k.error("其它错误",{consoleLogContent:true}),t));A.Object.defineProperty,A.Function.prototype.apply,A.Function.prototype.call,A.Element.prototype.appendChild,A.setTimeout;const B=f.addStyle.bind(f),q=z.selector.bind(z),K=z.selectorAll.bind(z),it=new b.GM_Cookie,Mt=Oe||"抖音优化",L={isIndex(){return window.location.hostname==="www.douyin.com"},isFollow(){return this.isIndex()&&window.location.pathname.startsWith("/follow")},isLive(){return window.location.hostname==="live.douyin.com"||this.isFollowLive()||this.isRootLive()},isFollowLive(){return this.isIndex()&&window.location.pathname.startsWith("/follow/live/")},isRootLive(){return this.isIndex()&&window.location.pathname.startsWith("/root/live/")},isRecommend(){let t=new URLSearchParams(window.location.search);return this.isIndex()&&window.location.pathname==="/"&&t.has("recommend")},isSearch(){return this.isIndex()&&(window.location.pathname.startsWith("/search/")||this.isRootSearch())},isRootSearch(){return this.isIndex()&&window.location.pathname.startsWith("/root/search/")},isChannel(){return this.isIndex()&&window.location.pathname.startsWith("/channel/")},isDiscover(){return this.isIndex()&&window.location.pathname.startsWith("/discover/")},isUser(){return this.isIndex()&&window.location.pathname.startsWith("/user/")},isVideo(){return this.isIndex()&&window.location.pathname.startsWith("/video/")},isNote(){return this.isIndex()&&window.location.pathname.startsWith("/note/")},isJingXuan(){return this.isIndex()&&window.location.pathname.startsWith("/jingxuan")},isFriend(){return this.isIndex()&&window.location.pathname.startsWith("/friend")}},Lt={init(){h.exec(["shieldTopNavigator","search-shieldTopNavigator"],()=>this.shieldTopNavigator(),t=>{const[e,i]=t;let n=h.getValue(e),o=h.getValue(i);if(L.isSearch()){if(o==1)return  true;if(o==0)return  false}return n}),h.execMenuOnce("shieldClientTip",()=>this.shieldClientTip(),void 0,true),h.execMenuOnce("shieldFillingBricksAndStones",()=>this.shieldFillingBricksAndStones(),void 0,true),h.execMenuOnce("shieldClient",()=>this.shieldClient(),void 0,true),h.execMenuOnce("shieldQuickAccess",()=>this.shieldQuickAccess(),void 0,true),h.execMenuOnce("shieldNotifitation",()=>this.shieldNotifitation(),void 0,true),h.execMenuOnce("shieldPrivateMessage",()=>this.shieldPrivateMessage(),void 0,true),h.execMenuOnce("shieldSubmission",()=>this.shieldSubmission(),void 0,true),h.execMenuOnce("shieldWallpaper",()=>this.shieldWallpaper(),void 0,true),h.execMenuOnce("shieldBottomQuestionButton",()=>this.shieldBottomQuestionButton()),h.execMenuOnce("shield-topNav-rightMenu",()=>this.shieldRightMenu()),h.execMenuOnce("shield-topNav-rightMenu-more",()=>this.shieldRightMenuMore()),h.execMenuOnce("shield-topNav-rightMenu-loginAvatar",()=>this.shieldRightMenuLoginAvatar()),h.execMenuOnce("shield-topNav-ai-search",()=>this.shieldAISearch());},shieldTopNavigator(){r.info("【屏蔽】顶部导航栏");let t=[];return t.push(y.addBlockCSS("#douyin-header")),t.push(B(`
			/* 修复视频的高度 */
			#douyin-right-container{
				padding-top: 0px !important;
			}
			/* 兼容手机模式 */
			@media screen and (max-width: 550px)  and (orientation: portrait) {
				.is-mobile-pc{
					--header-height: 0px !important;
				}
			}
		`)),t.push(B(`
				#slidelist .page-recommend-container{
					margin: 0 !important;
					height: 100vh !important;
				}
			`)),L.isSearch()&&t.push(B(`
				/* 把搜索顶部的工具栏置顶 */
				#search-content-area > div > div:nth-child(1) > div:nth-child(1){
					top: 0;
				}`)),t},shieldFillingBricksAndStones(){r.info("【屏蔽】充钻石");let t=[];const e='d="M12.8013 19.9762C12.3693 20.4436 11.6307 20.4436 11.1986 19.9762L3.11756 11.2346C2.74913 10.8361 2.72958 10.2274 3.07168 9.80599L6.92716 5.05714C7.13438 4.8019 7.44562 4.65369 7.77439 4.65369H16.2256C16.5544 4.65369 16.8656 4.8019 17.0728 5.05714L20.9283 9.80599C21.2704 10.2274 21.2508 10.8361 20.8824 11.2346L12.8013 19.9762ZM4.45944 10.4765L12 18.6334L19.5405 10.4765L16.031 6.15369H7.96901L4.45944 10.4765ZM16.0867 9.09336L16.0954 10.4557C15.3615 10.4557 14.6822 10.2315 14.1281 9.85065V12.5739C14.1281 13.9502 12.964 15.0659 11.5281 15.0659C10.0922 15.0659 8.9281 13.9502 8.9281 12.5739C8.9281 11.1976 10.0922 10.0819 11.5281 10.0819C11.6486 10.0819 11.7672 10.0897 11.8834 10.1049V11.4964C11.7713 11.4625 11.6519 11.4442 11.5281 11.4442C10.8771 11.4442 10.3494 11.95 10.3494 12.5739C10.3494 13.1978 10.8771 13.7036 11.5281 13.7036C12.179 13.7036 12.7067 13.1978 12.7067 12.5739V7.21604H14.1281C14.1281 8.25285 15.005 9.09336 16.0867 9.09336Z"';return t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${e}])`,'body .semi-portal .semi-portal-inner li.semi-dropdown-item:has(a[href*="douyin_recharge"])')),L.isSearch()?t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${e}])`)):L.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M12.8013 19.9762C12.3693 20.4436 11.6307 20.4436 11.1986 19.9762L3.11756 11.2346C2.74913 10.8361 2.72958 10.2274 3.07168 9.80599L6.92716 5.05714C7.13438 4.8019 7.44562 4.65369 7.77439 4.65369H16.2256C16.5544 4.65369 16.8656 4.8019 17.0728 5.05714L20.9283 9.80599C21.2704 10.2274 21.2508 10.8361 20.8824 11.2346L12.8013 19.9762ZM4.45944 10.4765L12 18.6334L19.5405 10.4765L16.031 6.15369H7.96901L4.45944 10.4765ZM16.0867 9.09336L16.0954 10.4557C15.3615 10.4557 14.6822 10.2315 14.1281 9.85065V12.5739C14.1281 13.9502 12.964 15.0659 11.5281 15.0659C10.0922 15.0659 8.9281 13.9502 8.9281 12.5739C8.9281 11.1976 10.0922 10.0819 11.5281 10.0819C11.6486 10.0819 11.7672 10.0897 11.8834 10.1049V11.4964C11.7713 11.4625 11.6519 11.4442 11.5281 11.4442C10.8771 11.4442 10.3494 11.95 10.3494 12.5739C10.3494 13.1978 10.8771 13.7036 11.5281 13.7036C12.179 13.7036 12.7067 13.1978 12.7067 12.5739V7.21604H14.1281C14.1281 8.25285 15.005 9.09336 16.0867 9.09336Z"])')),t},shieldClient(){r.info("【屏蔽】客户端");let t=[];return t.push(y.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[download^="douyin-downloader"])','div[id^="douyin-header-menu"] pace-island > div > div[aria-describedby]:has(a[href*="/douyin-pc-web/"])')),L.isSearch()?t.push(y.addBlockCSS('div:has(> div[data-e2e="something-button"] path[d="M18.404 19.018h-12v-1.5h12v1.5zM11.654 13.457v-8.19h1.5v8.19l3.22-3.22 1.06 1.061-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5 1.06-1.06 3.22 3.22z"])','div[id^="douyin-header-menu"] >  div > div > div:has(a[download^="douyin-downloader"])')):L.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container:has(a)','#douyin-header pace-island[id^="island"] > div[class] span:has(a[download][href*="client"])','.semi-portal-inner .semi-dropdown-content .semi-dropdown-item:has(a[download][href*="client"])')),t},shieldQuickAccess(){r.info("【屏蔽】快捷访问");let t=[];return t.push(y.addBlockCSS('header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(.quick-access-nav-icon)','div[id^="douyin-header-menu"] pace-island > div > div:has(.quick-access-nav-icon)')),L.isSearch()?(t.push(y.addBlockCSS("div:has(>div>div>.quick-access-nav-icon)")),f.waitNode('li.semi-dropdown-item[role="menuitem"]:contains("快捷访问")',1e4).then(e=>{e?.remove();})):L.isLive(),t},shieldNotifitation(){r.info("【屏蔽】通知");let t=[];return t.push(y.addBlockCSS('#douyin-right-container #douyin-header-menuCt pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),L.isSearch()?t.push(y.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > ul:has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')):L.isLive()&&t.push(y.addBlockCSS('div[id^="douyin-header-menu"] pace-island[id^="island"] > * > :has(path[d="M11.9998 4.50037C9.02034 4.50037 6.55167 6.81159 6.35561 9.78463L5.94855 15.9572H18.0507L17.6441 9.78506C17.4482 6.81184 14.9795 4.50037 11.9998 4.50037ZM7.85236 9.88334C7.99643 7.6987 9.81045 6.00037 11.9998 6.00037C14.1893 6.00037 16.0034 7.69888 16.1473 9.88365L16.4486 14.4572H7.55073L7.85236 9.88334Z"])')),t},shieldPrivateMessage(){r.info("【屏蔽】私信");let t=[];return t.push(y.addBlockCSS('#douyin-right-container pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])','#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])')),L.isSearch()&&(r.info("搜索-【屏蔽】私信"),t.push(y.addBlockCSS('ul:has( div>div[data-e2e="im-entry"] )','div[id^="douyin-header-menu"] >  div > div > ul:has([data-e2e="im-entry"])'))),t},shieldSubmission(){r.info("【屏蔽】投稿");let t=[];const e='d="M11.3487 4.90125H11.3164H11.3164C10.2479 4.90124 9.40104 4.90124 8.71799 4.95587C8.01959 5.01173 7.42807 5.12824 6.88626 5.39747C5.95866 5.8584 5.20716 6.60991 4.74622 7.53751C4.477 8.07932 4.36048 8.67084 4.30462 9.36923C4.24999 10.0523 4.24999 10.8991 4.25 11.9677V12V12.0322C4.24999 13.1008 4.24999 13.9477 4.30462 14.6307C4.36048 15.3291 4.477 15.9206 4.74622 16.4624C5.20716 17.39 5.95866 18.1415 6.88626 18.6025C7.42807 18.8717 8.01959 18.9882 8.71799 19.0441C9.40104 19.0987 10.2479 19.0987 11.3164 19.0987H11.3487H12.6513H12.6836C13.7521 19.0987 14.599 19.0987 15.282 19.0441C15.9804 18.9882 16.5719 18.8717 17.1137 18.6025C18.0413 18.1415 18.7928 17.39 19.2538 16.4624C19.523 15.9206 19.6395 15.3291 19.6954 14.6307C19.75 13.9477 19.75 13.1008 19.75 12.0322V12V11.9677C19.75 10.8991 19.75 10.0523 19.6954 9.36923C19.6395 8.67084 19.523 8.07932 19.2538 7.53751C18.7928 6.60991 18.0413 5.8584 17.1137 5.39747C16.5719 5.12824 15.9804 5.01173 15.282 4.95587C14.599 4.90124 13.7521 4.90124 12.6836 4.90125H12.6513H11.3487ZM7.55376 6.74077C7.8529 6.59212 8.22981 6.4997 8.83757 6.45109C9.45382 6.4018 10.2407 6.40125 11.3487 6.40125H12.6513C13.7593 6.40125 14.5462 6.4018 15.1624 6.45109C15.7702 6.4997 16.1471 6.59212 16.4462 6.74077C17.0809 7.05614 17.5951 7.57033 17.9105 8.205C18.0591 8.50414 18.1515 8.88105 18.2002 9.48882C18.2494 10.1051 18.25 10.8919 18.25 12C18.25 13.108 18.2494 13.8949 18.2002 14.5111C18.1515 15.1189 18.0591 15.4958 17.9105 15.7949C17.5951 16.4296 17.0809 16.9438 16.4462 17.2592C16.1471 17.4078 15.7702 17.5002 15.1624 17.5488C14.5462 17.5981 13.7593 17.5987 12.6513 17.5987H11.3487C10.2407 17.5987 9.45382 17.5981 8.83757 17.5488C8.22981 17.5002 7.8529 17.4078 7.55376 17.2592C6.91909 16.9438 6.4049 16.4296 6.08952 15.7949C5.94088 15.4958 5.84846 15.1189 5.79985 14.5111C5.75056 13.8949 5.75 13.108 5.75 12C5.75 10.8919 5.75056 10.1051 5.79985 9.48882C5.84846 8.88105 5.94088 8.50414 6.08952 8.205C6.4049 7.57033 6.91909 7.05614 7.55376 6.74077ZM11.25 15V12.75H9V11.25H11.25V8.99997H12.75V11.25H15V12.75H12.75V15H11.25Z"';return t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] pace-island > div > div:has(path[${e}])`)),L.isSearch()?t.push(y.addBlockCSS(`div[id^="douyin-header-menu"] >  div > div > div:has(path[${e}])`)):L.isLive()&&t.push(y.addBlockCSS('#douyin-header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])')),t},shieldClientTip(){r.info("【屏蔽】客户端提示");let t=[];return t.push(y.addBlockCSS('ul li div[data-e2e="something-button"] + div div:has(>a[download*="douyin-downloader"])','#douyin-header pace-island[id^="island_"] ul > div:has(>a[class][download])','#douyin-header pace-island[id^="island_"] ul[class] li div[data-e2e="im-entry"]  div>div div div:has(a[download][href])','#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container div:has(+ #wallpaper-modal)')),L.isSearch()&&t.push(y.addBlockCSS('div[id^="douyin-header-menu"] ul li div[data-e2e="im-entry"] div > div > div:has(>a[download*="douyin-downloader"])','div[id^="douyin-header-menu"] ul > div:has(>a[download*="douyin-downloader"])')),t},shieldWallpaper(){r.info("【屏蔽】壁纸");let t=[];return t.push(y.addBlockCSS('div[id^="douyin-header-menu"] pace-island > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')),L.isSearch()?t.push(y.addBlockCSS('div[id^="douyin-header-menu"] >  div > div > div:has(span.semi-icon path[d="M9.10335 4.79386C8.86882 4.64984 8.57425 4.64585 8.3359 4.78346C8.09755 4.92108 7.95372 5.17818 7.96117 5.4533L8.05873 9.05336L5.31808 11.3898C5.10864 11.5683 5.01381 11.8473 5.07104 12.1165C5.12826 12.3857 5.32833 12.6019 5.59229 12.6798L9.0463 13.6995L10.4215 17.028C10.5266 17.2824 10.7625 17.4588 11.0362 17.4875C11.3099 17.5163 11.5774 17.3929 11.7331 17.1659L13.3237 14.8471L16.4638 19.3577L17.6949 18.5007L14.6505 14.1276L17.3608 13.9168C17.6352 13.8954 17.8758 13.7255 17.9878 13.4741C18.0997 13.2226 18.065 12.9301 17.8972 12.7119L15.7022 9.85673L16.5462 6.35562C16.6107 6.08806 16.5234 5.80667 16.3189 5.62251C16.1144 5.43835 15.8254 5.38101 15.566 5.47312L12.1723 6.67838L9.10335 4.79386ZM9.56789 9.37117L9.49812 6.79649L11.693 8.14425C11.8862 8.26291 12.1227 8.28777 12.3364 8.21188L14.7635 7.34991L14.16 9.85382C14.1068 10.0743 14.1563 10.3069 14.2945 10.4867L15.8643 12.5286L13.2964 12.7284C13.0704 12.746 12.8644 12.8649 12.7361 13.0519L11.2792 15.1758L10.2957 12.7954C10.2091 12.5858 10.0324 12.4267 9.81491 12.3624L7.34469 11.6332L9.30473 9.96224C9.47729 9.81513 9.57403 9.59784 9.56789 9.37117Z"])')):L.isLive()&&t.push(y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island[id^="island_"] .dy-tip-container:has(span.semi-icon)','#douyin-header pace-island[id^="island"] > div[class] span:has(.semi-icon)')),t},shieldBottomQuestionButton(){return r.info("屏蔽底部问题按钮"),y.addBlockCSS(["#douyin-sidebar","#douyin-temp-sidebar"])},shieldRightMenu(){return r.info("【屏蔽】右侧菜单栏"),y.addBlockCSS('div[id^="douyin-header-menu"]')},shieldRightMenuMore(){return r.info("【屏蔽】更多"),y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M17 8.75H7V7.25H17V8.75ZM17 12.75H7V11.25H17V12.75ZM7 16.75H17V15.25H7V16.75Z"])')},shieldRightMenuLoginAvatar(){return r.info("【屏蔽】登录头像"),y.addBlockCSS('#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has(path[d="M6.484 43.177c4.765-5.408 11.743-8.821 19.517-8.821 7.775 0 14.753 3.413 19.517 8.821C40.754 48.587 33.776 52 26.001 52c-7.774 0-14.752-3.413-19.517-8.822zM35.287 21.356a9.286 9.286 0 1 1-18.571 0 9.286 9.286 0 0 1 18.571 0z"])','#douyin-header header div[id^="douyin-header-menu"] pace-island > div > div:has([data-e2e="live-avatar"])')},shieldAISearch(){return r.info("【屏蔽】AI搜索/抖音"),y.addBlockCSS('#douyin-header header div:has(>svg g[clip-path*="aiSearch"])')}},Vt={init(){h.execMenuOnce("shieldSearch",()=>this.shieldSearch()),h.execMenuOnce("shieldSearchPlaceholder",()=>this.shieldSearchPlaceholder()),h.execMenuOnce("shieldSearchGuessYouWantToSearch",()=>this.shieldSearchGuessYouWantToSearch()),h.execMenuOnce("shieldSearchTiktokHotspot",()=>this.shieldSearchTiktokHotspot());},shieldSearch(){return r.info("【屏蔽】搜索框"),y.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div:has(input[data-e2e="searchbar-input"])')},shieldSearchPlaceholder(){r.info("【屏蔽】搜索框的提示");let t=[];return t.push(y.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div div:has( + input[data-e2e="searchbar-input"])')),t.push(B(`
			#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div input[data-e2e="searchbar-input"]::placeholder{
				color: transparent;
			}`)),t},shieldSearchGuessYouWantToSearch(){return r.info("【屏蔽】搜索-猜你想搜"),y.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-guess-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-guess-container"]')},shieldSearchTiktokHotspot(){return r.info("【屏蔽】搜索-抖音热点"),y.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-hot-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-hot-container"]')}},nt={$data:{document_addEventListener:[],element_addEventListener:[],setTimeout:[],setInterval:[],function_apply:[],function_call:[],defineProperty:[]},document_addEventListener(t){if(this.$data.document_addEventListener.push(t),r.info("document.addEventListener hook新增劫持判断回调"),this.$data.document_addEventListener.length>1)return;const e=this;let i=new WeakMap;const n=A.document.addEventListener,o=A.document.removeEventListener;A.document.addEventListener=function(...a){let l=this,u=a[0],s=a[1],d=a[2];for(let c=0;c<e.$data.document_addEventListener.length;c++){const p=e.$data.document_addEventListener[c],v=Reflect.apply(p,this,[l,u,s,d]);if(typeof v=="function"){a[1]=v,i.set(s,{eventName:u,fn:v,options:d});break}else if(typeof v=="boolean"&&!v)return}return Reflect.apply(n,this,a)},A.document.removeEventListener=function(...a){let l=a[0],u=a[1],s=a[2];if(i.has(u)){const{eventName:d,fn:c,options:p}=i.get(u);let v=false;l===d&&(typeof s=="boolean"&&s===p||typeof s=="object"&&typeof p=="object"&&s.capture===p.capture||s==s)&&(v=true),v&&(a[1]=c);}return Reflect.apply(o,this,a)};},element_addEventListener(t){if(this.$data.element_addEventListener.push(t),r.info("Element.prototype.addEventListener hook新增劫持判断回调"),this.$data.element_addEventListener.length>1)return;const e=this;let i=new WeakMap;const n=A.Element.prototype.addEventListener,o=A.Element.prototype.removeEventListener;A.Element.prototype.addEventListener=function(...a){let l=this,u=a[0],s=a[1],d=a[2];for(let c=0;c<e.$data.element_addEventListener.length;c++){const p=e.$data.element_addEventListener[c],v=Reflect.apply(p,this,[l,u,s,d]);if(typeof v=="function"){a[1]=v,i.set(s,{eventName:u,fn:v,options:d});break}else if(typeof v=="boolean"&&!v)return}return Reflect.apply(n,this,a)},A.Element.prototype.removeEventListener=function(...a){let l=a[0],u=a[1],s=a[2];if(i.has(u)){const{eventName:d,fn:c,options:p}=i.get(u);let v=false;d===l&&(typeof s=="boolean"&&s===p||typeof s=="object"&&typeof p=="object"&&s.capture===p.capture||s==p)&&(v=true),v&&(a[1]=c);}return Reflect.apply(o,this,a)};},setTimeout(t){if(this.$data.setTimeout.push(t),r.info("window.setTimeout hook新增劫持"),this.$data.setTimeout.length>1)return;const e=this;let i=A.setTimeout;A.setTimeout=function(...n){let o=n[0],a=n[1];for(let l=0;l<e.$data.setTimeout.length;l++){const u=e.$data.setTimeout[l],s=u(o,a);if(typeof s=="boolean"&&!s)return}return Reflect.apply(i,this,n)};},setInterval(t){if(this.$data.setInterval.push(t),r.info("window.setInterval hook新增劫持"),this.$data.setInterval.length>1)return;const e=this;let i=A.setInterval;A.setInterval=function(...n){let o=n[0],a=n[1];for(let l=0;l<e.$data.setInterval.length;l++){const u=e.$data.setInterval[l],s=u(o,a);if(typeof s=="boolean"&&!s)return}return Reflect.apply(i,this,n)};},function_apply(t){if(this.$data.function_apply.push(t),r.info("Function.prototype.apply hook新增劫持"),this.$data.function_apply.length>1)return;const e=this;let i=A.Function.prototype.apply;A.Function.prototype.apply=function(...n){let o=n[0],a=n[1],l=this;for(let s=0;s<e.$data.function_apply.length;s++){let d=e.$data.function_apply[s];if(typeof d.paramsHandler=="function"){let c=d.paramsHandler(l,o,a);if(c!=null){if(c.args&&(n[0]=c.args.thisArg,n[1]=c.args.argArray,l=c.args.fn),c.preventDefault)return "result"in c?c.result:void 0;break}}}let u=i.call(l,...n);for(let s=0;s<e.$data.function_apply.length;s++){let d=e.$data.function_apply[s];typeof d.returnsHandler=="function"&&(u=d.returnsHandler(l,n[0],n[1],u).result);}return u};},function_call(t){if(this.$data.function_call.push(t),r.info("Function.prototype.call hook新增劫持"),this.$data.function_call.length>1)return;const e=this;let i=A.Function.prototype.call;A.Function.prototype.call=function(...n){let o=n[0],a=n.slice(1),l=this;for(let s=0;s<e.$data.function_call.length;s++){let d=e.$data.function_call[s];if(typeof d.paramsHandler=="function"){let c=d.paramsHandler(l,o,a);if(c!=null){if(c.args&&(n[0]=c.args.thisArg,n.splice(1,a.length,...c.args.argArray),l=c.args.fn),c.preventDefault)return "result"in c?c.result:void 0;break}}}let u=i.apply(l,n);for(let s=0;s<e.$data.function_call.length;s++){let d=e.$data.function_call[s];typeof d.returnsHandler=="function"&&(u=d.returnsHandler(l,n[0],n[1],u).result);}return u};},defineProperty(t){if(this.$data.defineProperty.push(t),r.info("Object.defineProperty hook新增劫持"),this.$data.defineProperty.length>1)return;const e=this;let i=A.Object.defineProperty;A.Object.defineProperty=function(...n){let o=n[0],a=n[1],l=n[2];for(let u=0;u<e.$data.defineProperty.length;u++){const s=e.$data.defineProperty[u],d=s(o,a,l);if(d!=null){n[0]=d.target,n[1]=d.key,n[2]=d.attributes;break}}return Reflect.apply(i,this,n)};},window_webpack(t="webpackJsonp",e,i){let n;A.Object.defineProperty(A,t,{get(){return n},set(o){r.success("成功劫持webpack，当前webpack名："+t),n=o;const a=n.push;n.push=function(...l){let u=l[0][0];return (e==u||Array.isArray(e)&&Array.isArray(u)&&JSON.stringify(e)===JSON.stringify(u))&&Object.keys(l[0][1]).forEach(s=>{let d=l[0][1][s];l[0][1][s]=function(...c){let p=d.call(this,...c);return c[0]=i(c[0]),p};}),Reflect.apply(a,this,l)};}});}},Re={$data:{hookElementAddEventListener:[]},init(){h.onceExec("hookKeyboard",()=>{Re.disableShortCut();}),h.execMenu("dy-cookie-remove__ac__",()=>{this.removeCookie();}),L.isIndex()?h.execMenuOnce("dy-video-disableDoubleClickLike",()=>{Re.disableDoubleClickLike();}):L.isLive()&&h.execMenuOnce("dy-live-disableDoubleClickLike",()=>{Re.disableDoubleClickLike();});},removeEnvCheck(){r.info("移除环境检测");let t=A.setInterval;A.setInterval=function(e,i){let n=e.toString().trim();if(n.includes("debugger")){r.success(["拦截→",[n]]);return}if(n.includes("checkEXp")){r.success(["拦截→",[n]]);return}return t.call(this,e,i)};},removeCookie(){let t=new b.GM_Cookie;["__ac_signature","__ac_referer","__ac_nonce"].forEach(i=>{t.delete({name:i,firstPartyDomain:""},n=>{n?r.error(`移除Cookie失败 ==> ${i}`,n):r.success(`移除Cookie成功 ==> ${i}`);});});},disableShortCut(){const t=e=>{if(e==null)return  false;const i=["input","textarea"].includes(e?.tagName?.toLowerCase()),n=e?.closest(".pops")&&e?.getRootNode()instanceof ShadowRoot;return i&&n};nt.document_addEventListener((e,i,n,o)=>{if(["keydown","keypress","keyup"].includes(i)&&typeof n=="function")return function(...a){let l=a[0];l.key;let u=l.code;l.charCode||l.keyCode||l.which;let s=[];l.ctrlKey&&s.push("ctrl"),l.altKey&&s.push("alt"),l.metaKey&&s.push("meta"),l.shiftKey&&s.push("shift");const d=document.activeElement,c=d?.shadowRoot?.activeElement;if(t(c??d))return;let p=[{enableKey:"dy-keyboard-hook-likeOrDislike",code:["KeyZ"]},{enableKey:"dy-keyboard-hook-comment",code:["KeyX"]},{enableKey:"dy-keyboard-hook-danmaku-enable",code:["KeyB"]},{enableKey:"dy-keyboard-hook-collect-enable",code:["KeyC"]},{enableKey:"dy-keyboard-hook-copyShareLink",code:["KeyV"]},{enableKey:"dy-keyboard-hook-clearScreen",code:["KeyJ"]},{enableKey:"dy-keyboard-hook-automaticBroadcast",code:["KeyK"]},{enableKey:"dy-keyboard-hook-videoInfo",code:["KeyI"]},{enableKey:"dy-keyboard-hook-notInterested",code:["KeyR"]},{enableKey:"dy-keyboard-hook-enterAuthorHomePage",code:["KeyF"]},{enableKey:"dy-keyboard-hook-follow",code:["KeyG"]},{enableKey:"dy-keyboard-hook-search",code:["KeyF"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheCurrentPageWithOneClick",code:["KeyQ"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-pageUpAndDown",code:["ArrowUp","ArrowDown"]},{enableKey:"dy-keyboard-hook-fastForwardAndFastBack",code:["ArrowLeft","ArrowRight"]},{enableKey:"dy-keyboard-hook-pause",code:["Space"]},{enableKey:"dy-keyboard-hook-fullScreenInsideThePage",code:["KeyY"]},{enableKey:"dy-keyboard-hook-fullScreen",code:["KeyH"]},{enableKey:"dy-keyboard-hook-watchItOutLater",code:["KeyL"]},{enableKey:"dy-keyboard-hook-volumeAdjustment",code:["Minus"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-listOfCallShortcutKeys",code:["Slash"],otherCodeList:["shift"]},{enableKey:"dy-keyboard-hook-closeTheShortcutKeyList",code:["Escape"]},{enableKey:"dy-keyboard-hook-relevantRecommendation",code:["KeyN"]},{enableKey:"dy-keyboard-hook-listenToDouyin",code:["KeyT"]},{enableKey:"dy-keyboard-hook-smallWindowPlay",code:["KeyU"]},{enableKey:"dy-keyboard-hook-recommendVideo",code:["KeyP"]}];L.isIndex()?p.push({enableKey:"dy-keyboard-hook-arrowUp-w",code:["KeyW"]},{enableKey:"dy-keyboard-hook-arrowDown-s",code:["KeyS"]},{enableKey:"dy-keyboard-hook-videoRewind",code:["KeyA"]},{enableKey:"dy-keyboard-hook-videoFastForward",code:["KeyD"]}):L.isLive()&&p.push({enableKey:"dy-live-refresh",code:["KeyE"]},{enableKey:"dy-live-screenRotation",code:["KeyD"]},{enableKey:"dy-live-enableSmallWindowMode",code:["KeyU"]},{enableKey:"dy-live-switchLiveRoom",code:["ArrowUp","ArrowDown"]});for(let v=0;v<p.length;v++){const g=p[v];if(g.code.includes(u)){if(Array.isArray(g.otherCodeList)&&g.otherCodeList.find(x=>!s.includes(x))||!h.getValue(g.enableKey))continue;return}}return Reflect.apply(n,this,a)}});},disableDoubleClickLike(){let t=Date.now();nt.element_addEventListener((e,i,n,o)=>{const a=n.toString();if(i==="click"&&e instanceof HTMLElement&&e?.classList?.contains("xgplayer")&&a.match(/video|innerContainer|video.__canvas|mouse/))return function(...l){let u=Date.now();if(u-t<=288){t=u,r.success("阻止触发双击点赞");return}t=u,Reflect.apply(n,this,l);}});}},ot={watchFeedVideoListChange(t){let e=null;f.ready(()=>{f.waitAnyNode(["#slidelist",'#search-content-area ul[data-e2e="scroll-list"]']).then(i=>{r.info("启用观察器观察加载的视频");let n=new b.LockFunction(o=>{if(e=e||this.selectorRootOSNode(),!e){r.error("watchVideDataListChange：获取osElement失败");return}t(e,o);},50);b.mutationObserver(document,{config:{childList:true,subtree:true},immediate:true,callback:(o,a)=>{n.run(a);}});});});},selectorRootOSNode(){return q("#root div[class*='-os']")||q("#douyin-right-container")}},at={disguiseLogin(){r.info("伪装登录");let t=[y.addBlockCSS(".login-tooltip-slot")];const e=2e4,n={uid:parseInt((Math.random()*1e10).toString()),secUid:"",shortId:parseInt((Math.random()*1e9).toString()),realName:"乌萨奇",nickname:"乌萨奇",desc:"除草证3级",gender:0,avatarUrl:"https://picshack.net/ib/F9JKlC3yhh.gif",avatar300Url:"https://picshack.net/ib/F9JKlC3yhh.gif",followStatus:0,followerStatus:0,awemeCount:0,watchLaterCount:0,followingCount:0,followerCount:0,followerCountStr:"",mplatformFollowersCount:9999999,favoritingCount:0,totalFavorited:9999999,userCollectCount:{logPb:{impr_id:""},collectCountList:[],statusCode:0,extra:{fatal_item_ids:[],logid:"",now:Date.now()}},uniqueId:"",customVerify:"",generalPermission:{is_hit_active_fans_grayed:false},age:new Date().getFullYear()-2019,country:"",province:"",city:"",district:"",school:"chiikawa",schoolVisible:1,enterpriseVerifyReason:"",secret:1,userCanceled:false,roomData:{},shareQrcodeUrl:"",shareInfo:{boolPersist:1,shareDesc:"长按复制此条消息，打开抖音搜索，查看TA的更多作品。",shareImageUrl:{uri:"",url_list:[]},shareQrcodeUrl:{uri:"",url_list:[]},shareUrl:"",shareWeiboDesc:"长按复制此条消息，打开抖音搜索，查看TA的更多作品。"},coverAndHeadImageInfo:{profileCoverList:[]},roomId:0,favoritePermission:1,viewHistoryPermission:true,isGovMediaVip:false,isStar:false,hideLocation:false,needSpecialShowFollowerCount:false,continuationState:0,im_role_ids:[],accountCertInfo:{},close_consecutive_chat:0,profileRankLabel:null};Object.freeze(n);function o(l){let u=[],s=b.getReactInstance(l),d=s?.reactFiber;return s?.reactProps,d?.alternate?.return?.memoizedProps?.userInfo&&u.push(d?.alternate?.return?.memoizedProps?.userInfo),d?.alternate?.return?.memoizedProps?.userInfo?.userInfo&&u.push(d?.alternate?.return?.memoizedProps?.userInfo.userInfo),d?.alternate?.return?.return?.memoizedProps?.userInfo&&u.push(d?.alternate?.return?.return?.memoizedProps?.userInfo),d?.alternate?.return?.return?.memoizedProps?.userInfo?.userInfo&&u.push(d?.alternate?.return?.return?.memoizedProps?.userInfo.userInfo),u}function a(l){o(l).forEach(u=>{u.isLogin||(u.info=n,u.isLogin=true,u.statusCode=0);});}if(ot.watchFeedVideoListChange(a),f.waitNode("#root div[class*='-os']",e).then(()=>{let l=new b.LockFunction(()=>{let u=ot.selectorRootOSNode();u&&a(u);},70);b.mutationObserver(document.body,{config:{subtree:true,childList:true},immediate:true,callback:()=>{l.run();}});}).catch(l=>{}),L.isLive())r.info("伪装登录：live"),f.waitNode('[id^="douyin-header"] div:has(.dy-tip-container)',e).then(()=>{let l=new b.LockFunction(()=>{a(q('[id^="douyin-header"]'));},70);b.mutationObserver(document.body,{config:{subtree:true,childList:true},immediate:true,callback:()=>{l.run();}});});else if(L.isSearch()){let l=function(u){let s=b.getReactInstance(u);s?.reactFiber;let d=s?.reactProps;typeof d?.children?.[1]?.props?.userInfo?.isLogin=="boolean"&&Reflect.set(d.children[1].props.userInfo,"isLogin",true),typeof d?.children?.[1]?.props?.isClient=="boolean"&&Reflect.set(d.children[1].props,"isClient",true);};r.info("伪装登录：search"),f.waitNode("#root > div",e).then(u=>{if(!u){r.error("#root > div获取失败");return}let s=new b.LockFunction(()=>{l(u);},70);b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{s.run();}});});}return h.getValue("watchLoginDialogToClose")||(t=t.concat(this.watchLoginDialogToClose())),t=t.concat(this.watchCommentDialogToClose()),t},watchLoginDialogToClose(){r.info("监听登录弹窗并关闭");let t=[y.addBlockCSS('div[id^="login-full-panel-"]')],e=new b.LockFunction(()=>{if(!h.getValue("watchLoginDialogToClose"))return;let i=q('div[id^="login-full-panel-"]');if(i&&i.children.length){let o=i.querySelector(".dy-account-close")||i.querySelector('div:has(>svg path[d="M12.7929 22.2426C12.4024 22.6331 12.4024 23.2663 12.7929 23.6568C13.1834 24.0474 13.8166 24.0474 14.2071 23.6568L18.5 19.3639L22.7929 23.6568C23.1834 24.0474 23.8166 24.0474 24.2071 23.6568C24.5976 23.2663 24.5976 22.6331 24.2071 22.2426L19.9142 17.9497L24.1066 13.7573C24.4971 13.3668 24.4971 12.7336 24.1066 12.3431C23.7161 11.9526 23.0829 11.9526 22.6924 12.3431L18.5 16.5355L14.3076 12.3431C13.9171 11.9526 13.2839 11.9526 12.8934 12.3431C12.5029 12.7336 12.5029 13.3668 12.8934 13.7573L17.0858 17.9497L12.7929 22.2426Z"])');if(o){let l=b.getReactInstance(o)?.reactProps?.onClick;typeof l=="function"?l(new Event("click")):r.error("监听到登录弹窗但是关闭失败，原因：未获取到onClick函数");}else {let a=i.querySelector("#login-panel-new > div");(!a||a&&a.children.length)&&r.error("未找到登录弹出的关闭按钮，此时键盘被聚焦在登录弹窗上从而导致'快捷键'失效",i.cloneNode(true));}}let n=q("body > div > div:contains('为保障更好的访问体验，请在登录后继续使用抖音')");if(n){let a=b.getReactInstance(n)?.reactProps?.onClick;typeof a=="function"?a(new Event("click")):r.error("监听到【为保障更好的访问体验，请在登录后继续使用抖音】但是关闭失败，原因：未获取到onClick函数");}});return b.mutationObserver(document,{config:{subtree:true,childList:true},callback:()=>{e.run();}}),t},watchCommentDialogToClose(){let t=new b.LockFunction(()=>{let i=q('[id^="related-video-card-login-guide"]');if(!i)return;let n=i.querySelector(".related-video-card-login-guide__footer-close");if(!n){r.error("监听到评论区的登录遮罩层但是未获取到关闭按钮");return}n.click();});const e=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});return [y.addBlockCSS('[id^="related-video-card-login-guide"]'),B(`
			/* 去除遮罩层 */
			[id^="related-video-card-login-guide"]+div{
				filter: none !important;
			}
		`),()=>{e?.disconnect();}]}},Bt={isVerticalScreen(){return !window.screen.orientation.type.includes("landscape")}},Rt=`/* 竖屏且高度小于550px */\r
@media screen and (max-width: 550px) and (orientation: portrait) {\r
  /* 右侧工具栏放大 */\r
  .basePlayerContainer .positionBox {\r
    bottom: 80px !important;\r
    padding-right: 5px !important;\r
    scale: unset !important;\r
    transform: scale3d(1.12, 1.12, 1.12) !important;\r
  }\r
  /* 右侧工具栏的svg再放大 */\r
  .basePlayerContainer .positionBox svg {\r
    transform: scale3d(1.12, 1.12, 1.12);\r
  }\r
  /* 重置关注按钮的scale */\r
  .basePlayerContainer .positionBox .dy-tip-container div[data-e2e="feed-follow-icon"] svg {\r
    scale: unset !important;\r
  }\r
\r
  /* 调整顶部搜索框的宽度 */\r
  #douyin-header\r
    div[data-click="doubleClick"]\r
    > div[data-click="doubleClick"]\r
    > div:has(input[data-e2e="searchbar-input"]) {\r
    width: 150px;\r
    padding-right: 0;\r
    max-width: unset;\r
    flex: 1;\r
  }\r
  /* 搜索框获取焦点时自动放大宽度 */\r
  #douyin-header\r
    div[data-click="doubleClick"]\r
    > div[data-click="doubleClick"]\r
    > div:has(input[data-e2e="searchbar-input"]:focus) {\r
    width: 100vw;\r
    width: 100dvw;\r
  }\r
  /* 搜索页面 搜索详情的宽度、视频结果列表的宽度 */\r
  #search-content-area > div,\r
  #search-content-area > div div:has(+ #search-result-container),\r
  #search-content-area > div #search-result-container {\r
    width: 100%;\r
    width: -webkit-fill-available;\r
  }\r
  /* 搜索页面 视频右侧的工具栏缩小 */\r
  #search-content-area .basePlayerContainer .positionBox {\r
    bottom: 28px !important;\r
    transform: scale3d(0.6, 0.6, 0.6) !important;\r
  }\r
  /* 搜索页面 搜索出的用户信息换行 */\r
  #search-content-area #search-result-container ul[data-e2e="scroll-list"] li .search-result-card > div > div {\r
    flex-wrap: wrap;\r
  }\r
  /* 搜索页面 搜索结果筛选选项 综合、视频、用户、直播的超出宽度换行 */\r
  #search-content-area div:has(> div > div > span[data-key="general"]) {\r
    overflow: auto;\r
    gap: 10px;\r
  }\r
  /* 搜索页面 搜索结果筛选选项 */\r
  #search-content-area div:has(> span[data-key="general"]) {\r
    gap: 10px;\r
  }\r
  /* 搜索页面 搜索结果筛选选项弹窗修复 */\r
  #search-content-area div:has(> div > span[data-key="general"]) {\r
    position: unset !important;\r
  }\r
  /* 搜索页面 搜索结果筛选选项 */\r
  #search-content-area div:has(> span[data-key="general"]) > * {\r
    white-space: nowrap !important;\r
    width: auto !important;\r
    width: fit-content !important;\r
    margin-left: 0px !important;\r
    margin-right: 0px !important;\r
  }\r
  /* 去除设置min-width超出浏览器宽度的问题 */\r
  body {\r
    min-width: 100% !important;\r
  }\r
  /* 去除设置width导致顶部工具栏超出浏览器宽度的问题 */\r
  #douyin-right-container #douyin-header {\r
    width: 100%;\r
  }\r
  /* 去除设置 */\r
  #douyin-right-container #douyin-header > div[data-click="doubleClick"] {\r
    min-width: 100%;\r
  }\r
\r
  /* /video/xxx页面 */\r
  /* 点赞、评论、分享偏移 */\r
  div[data-e2e="video-detail"] .leftContainer .basePlayerContainer .positionBox {\r
    padding-right: 30px !important;\r
  }\r
  /* 底部工具栏右侧的按钮 */\r
  div[data-e2e="video-detail"] .leftContainer .xgplayer.xgplayer-pc .xg-right-grid {\r
    margin-right: 35px !important;\r
  }\r
  /* 评论区全屏 */\r
  div[data-e2e="video-detail"] .leftContainer > div:has(.comment-mainContent[data-e2e="comment-list"]),\r
  div[data-e2e="video-detail"] .leftContainer > div > div:has(.comment-mainContent[data-e2e="comment-list"]) {\r
    width: 100vw !important;\r
  }\r
\r
  /* 设置视频区域的高度 */\r
  #slidelist {\r
    width: 100%;\r
    height: calc(100vh - var(--header-height)) !important;\r
  }\r
  /* 修正网页全屏下的视频高度 */\r
  #slidelist[class*="isCssFullScreen"] {\r
    height: 100vh !important;\r
  }\r
  /* 去除视频区域右侧偏移 */\r
  .is-mobile-pc div[data-e2e="slideList"] {\r
    padding-right: 0px !important;\r
  }\r
}\r
\r
/* 横屏且高度小于550px */\r
@media screen and (max-height: 550px) and (orientation: landscape) {\r
  /* 右侧工具栏缩小 */\r
  .basePlayerContainer .positionBox {\r
    transform: scale(0.95) !important;\r
    bottom: 42px !important;\r
    padding-right: 10px !important;\r
  }\r
  /* 右侧工具栏的svg再缩小 */\r
  .basePlayerContainer .positionBox svg {\r
    transform: scale3d(0.95, 0.95, 0.95);\r
  }\r
  /* 修复全屏下不显示视频底部的控制栏 */\r
  .isCssFullScreen [data-e2e="slideList"] {\r
    min-height: auto !important;\r
  }\r
}\r
`,It={init(){h.execMenuOnce("dy-video-shieldUserCommentToolBar",()=>this.shieldUserCommentToolBar()),h.execMenuOnce("dy-video-shieldUserCommentEveryOneAllSearch",()=>this.shieldUserCommentEveryOneAllSearch());},shieldUserCommentToolBar(){return r.info("【屏蔽】评论工具栏"),[y.addBlockCSS(".comment-input-container")]},shieldUserCommentEveryOneAllSearch(){return r.info("【屏蔽】大家都在搜"),[y.addBlockCSS(".comment-header-with-search")]}},Ne={init(){h.execMenuOnce("dy-video-bottom-shieldVideoInfoWrap",()=>this.shieldVideoInfoWrap()),h.execMenuOnce("dy-video-blockClickRecommend",()=>this.blockClickRecommend()),h.execMenuOnce("dy-video-blockTitleTopTag",()=>this.blobkTitleTopTag()),h.execMenuOnce("dy-video-bottom-shieldVideoUnderTitleTag",()=>this.shieldVideoUnderTitleTag()),h.execMenuOnce("dy-video-blockAIIdentifyTheScreen",()=>this.blockAIIdentifyTheScreen()),h.execMenuOnce("dy-video-blockClickUpdateReminder",()=>this.blockClickUpdateReminder()),h.execMenuOnce("dy-video-blockAuthorDeclaration",()=>this.blockAuthorDeclaration());},shieldVideoInfoWrap(){return r.info("【屏蔽】视频信息"),[y.addBlockCSS("#video-info-wrap")]},blockClickRecommend(){return r.info("【屏蔽】点击推荐"),y.addBlockCSS(".xgplayer-recommend-tag")},blobkTitleTopTag(){return r.info("【屏蔽】视频标题上的标签"),y.addBlockCSS("span:has(+#video-info-wrap):has(img)","span:has(+div #video-info-wrap):has(img)")},shieldVideoUnderTitleTag(){return r.info("【屏蔽】视频标题下的标签"),[y.addBlockCSS("#video-info-wrap .under-title-tag")]},blockAIIdentifyTheScreen(){return r.info("【屏蔽】识别画面"),[y.addBlockCSS('.under-title-tag + div:has(svg g[filter*="icon_ai_svg__filter"])','[data-e2e="video-desc"] + div:has(svg g[filter*="icon_ai_svg__filter"])')]},blockClickUpdateReminder(){let t=new b.LockFunction(()=>{let e=K(".basePlayerContainer div:has(>div>div):contains('及时接收作品更新提醒')");if(e.length){for(const i of e){const o=i.closest(".basePlayerContainer")?.querySelector(".video-info-detail");o&&f.css(o,"paddingBottom","8px");}f.remove(e),r.success("【屏蔽】及时接收作品更新提醒");}});b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});},blockAuthorDeclaration(){return r.info("【屏蔽】作者声明"),[y.addBlockCSS("div:has(>a.safetyBar)")]}},At={init(){h.execMenuOnce("shieldBottomVideoToolBar",()=>this.shieldBottomVideoToolBar()),h.execMenuOnce("shieldBottomVideoToolbarDanmuContainer",()=>this.shieldBottomVideoToolbarDanmuContainer()),h.execMenuOnce("shieldBottomVideoToolbar-autoPlay",()=>this.autoPlay()),h.execMenuOnce("shieldBottomVideoToolbar-aiNotes",()=>this.aiNotes()),h.execMenuOnce("shieldBottomVideoToolbar-clearScreen",()=>this.clearScreen()),h.execMenuOnce("shieldBottomVideoToolbar-playclarity",()=>this.playclarity()),h.execMenuOnce("shieldBottomVideoToolbar-playback",()=>this.playback()),h.execMenuOnce("shieldBottomVideoToolbar-watchLater",()=>this.watchLater()),h.execMenuOnce("shieldBottomVideoToolbar-miniMode",()=>this.miniMode()),h.execMenuOnce("shieldBottomVideoToolbar-pageFullScreen",()=>this.pageFullScreen()),h.execMenuOnce("shieldBottomVideoToolbar-fullScreen",()=>this.fullScreen());},shieldBottomVideoToolBar(){return r.info("【屏蔽】底部视频工具栏"),[y.addBlockCSS("xg-controls.xgplayer-controls"),he.removeStyleBottom(),B(`
				/* 视频标题往下移 */
				div:has(> #video-info-wrap){
					bottom: 0px !important;
				}
			`)]},shieldBottomVideoToolbarDanmuContainer(){return r.info("【屏蔽】底部视频工具栏的弹幕容器"),[y.addBlockCSS('xg-controls xg-inner-controls .danmakuContainer[data-e2e="danmaku-container"]')]},aiNotes(){return r.info("【屏蔽】AI笔记"),[y.addBlockCSS('.ai-note-container[data-e2e="ai-note-container"]')]},autoPlay(){return r.info("【屏蔽】连播"),[y.addBlockCSS(".xgplayer-autoplay-setting")]},clearScreen(){return r.info("【屏蔽】清屏"),[y.addBlockCSS(".xgplayer-immersive-switch-setting")]},playclarity(){return r.info("【屏蔽】清晰度"),[y.addBlockCSS(".xgplayer-playclarity-setting")]},playback(){return r.info("【屏蔽】倍速"),[y.addBlockCSS(".xgplayer-playback-setting")]},watchLater(){return r.info("【屏蔽】稍后再看"),[y.addBlockCSS(".xgplayer-watch-later")]},miniMode(){return r.info("【屏蔽】小窗模式"),[y.addBlockCSS(".xgplayer-pip")]},pageFullScreen(){return r.info("【屏蔽】网页全屏"),[y.addBlockCSS(".xgplayer-page-full-screen")]},fullScreen(){return r.info("【屏蔽】进入全屏"),[y.addBlockCSS(".xgplayer-fullscreen")]}},Tt={init(){h.execMenuOnce("shieldPlaySwitchButton",()=>this.shieldPlaySwitchButton()),h.execMenuOnce("blockAIDouYin",()=>this.blockAIDouYin()),h.execMenuOnce("shieldAuthorAvatar",()=>this.shieldAuthorAvatar()),h.execMenuOnce("shieldLikeButton",()=>this.shieldLikeButton()),h.execMenuOnce("shieldCommentButton",()=>this.shieldCommentButton()),h.execMenuOnce("shieldCollectionButton",()=>this.shieldCollectionButton()),h.execMenuOnce("shieldSharenButton",()=>this.shieldSharenButton()),h.execMenuOnce("shieldListenDouYinButton",()=>this.shieldListenDouYinButton()),h.execMenuOnce("shieldRelatedRecommendationsButton",()=>this.shieldRelatedRecommendationsButton()),h.execMenuOnce("shieldMoreButton",()=>this.shieldMoreButton());},shieldPlaySwitchButton(){return r.info("【屏蔽】切换播放"),[y.addBlockCSS('.positionBox  .xgplayer-playswitch[data-state="normal"]',"div.xgplayer-playswitch",".xgplayer-playswitch"),B(`
			div[data-e2e="slideList"]{
				/* 修复屏蔽后的视频宽度占据 */
				padding: 0px !important;
			}
			`)]},blockAIDouYin(){return r.info("【屏蔽】AI抖音"),y.addBlockCSS('.immersive-player-switch-on-hide-interaction-area > div:has(>svg path[d="M8.175 4.88C8.318 2.458 10.38.548 12.815.665l.12.008a4.428 4.428 0 0 1 3.08 1.586 4.354 4.354 0 0 1 1.014 2.948l-.005.108c-.016.282-.06.556-.129.82l-.113.444 1.927-.499.111-.027c2.335-.543 4.733.81 5.362 3.105l.05.182a4.351 4.351 0 0 1-.524 3.23l-.06.096a4.409 4.409 0 0 1-2.514 1.87l-.105.028h-.001a4.336 4.336 0 0 1-.827.133l-.458.03 1.075 1.67.06.096c1.221 2.003.705 4.63-1.222 5.957l-.095.063a4.44 4.44 0 0 1-3.424.605l-.11-.027a4.41 4.41 0 0 1-2.568-1.795l-.06-.09-.056-.09a4.355 4.355 0 0 1-.326-.65l-.17-.421-1.263 1.528c-1.53 1.85-4.265 2.207-6.162.774l-.09-.07a4.376 4.376 0 0 1-1.636-3.044l-.008-.112a4.361 4.361 0 0 1 .994-3.061 4.64 4.64 0 0 1 .592-.59l.352-.293-1.856-.722c-2.28-.886-3.468-3.423-2.606-5.68v-.001A4.407 4.407 0 0 1 3.68 6.245a4.448 4.448 0 0 1 3.991.37l.386.24.118-1.975zm4.57-2.218a2.413 2.413 0 0 0-2.547 2.165v.01l-.463 7.542a.046.046 0 0 1-.053.041l-.011-.003-.163-.064h-.001l-2.109-.821c.165-.28.28-.606.31-.978l.006-.09A2.422 2.422 0 0 0 6.475 8.23l-.081-.043-.104-.049a2.42 2.42 0 0 0-1.479-.153l-.102.024a2.403 2.403 0 0 0-1.652 1.446 2.396 2.396 0 0 0 1.285 3.076l.01.004 7.082 2.769a.044.044 0 0 1 .02.068l-.112.134v.001l-1.44 1.74a2.312 2.312 0 0 0-.775-.568l-.067-.03-.086-.033c-.856-.319-1.842-.147-2.517.48l-.066.064a2.38 2.38 0 0 0-.692 1.538c-.047.744.252 1.5.876 2.01a2.428 2.428 0 0 0 3.339-.265l.003-.004.003-.004 4.84-5.833a.046.046 0 0 1 .04-.016c.012 0 .022.005.03.012l.007.009.092.146.001.001 1.22 1.893c-.28.122-.547.302-.78.555l-.049.054v.001c-.64.74-.793 1.807-.337 2.682.282.545.737.927 1.257 1.13a2.418 2.418 0 0 0 2.19-.206 2.393 2.393 0 0 0 .78-3.24l-.002-.004-.003-.004-4.09-6.373-.001-.001-.005-.009a.043.043 0 0 1 .032-.055l.17-.044 2.195-.569c.032.325.133.654.328.974a2.445 2.445 0 0 0 2.462 1.146l.112-.022a2.405 2.405 0 0 0 1.358-.818l.29-.442a2.375 2.375 0 0 0 .206-1.621l-.018-.073a2.415 2.415 0 0 0-2.858-1.737l-.009.002-7.369 1.894h-.002a.043.043 0 0 1-.039-.009.043.043 0 0 1-.016-.037l.013-.204v-.002l.132-2.212c.32.07.67.077 1.034-.009.955-.225 1.708-.997 1.859-1.972a2.371 2.371 0 0 0-.296-1.56l-.055-.09a2.41 2.41 0 0 0-1.82-1.106l-.075-.005z"])','.immersive-player-switch-on-hide-interaction-area > div:has(>svg g[filter*="entryIcon_svg__filter"])','.immersive-player-switch-on-hide-interaction-area > div > div:has(>svg g[filter*="entryIcon_svg__filter"])','.xgplayer div:has(>svg path[d="M22.94 21.309l.58 1.364a45.819 45.819 0 0 0 2.125 4.34l.528.947-.108.056-1.077.543-.102.052-.054-.102-.576-1.087a44.077 44.077 0 0 1-.22-.423 7.704 7.704 0 0 0-3.902.001c-.087.169-.154.3-.219.422l-.576 1.087-.054.102-.102-.052-1.077-.543-.108-.056.059-.106.468-.841a45.902 45.902 0 0 0 2.125-4.34l.58-1.364.038-.086.091.017c.482.086.97.086 1.451 0l.093-.017.037.086zm6.011-.019a3.731 3.731 0 0 0-.173.9c-.022.342-.034.69-.034 1.035v3.067c0 .345.012.694.034 1.035l.022.227c.029.226.08.452.151.673l.05.153h-1.92l.049-.153c.095-.295.153-.597.173-.9.022-.345.033-.694.033-1.035v-3.067c0-.34-.01-.689-.033-1.034a3.753 3.753 0 0 0-.173-.9l-.05-.154h1.921l-.05.153zM17.161 5.395l.123.008a4.527 4.527 0 0 1 3.14 1.602 4.367 4.367 0 0 1 1.033 2.978l-.005.109c-.015.284-.063.56-.13.828l-.117.447 1.964-.504.113-.027c2.38-.549 4.824.818 5.465 3.136l.05.184a4.368 4.368 0 0 1-.534 3.265l-.06.097a4.495 4.495 0 0 1-1.965 1.674c-3.71 1.444-5.893-1.51-6.663-3.187l.134-.034 2.236-.575c.033.329.136.661.333.984a2.5 2.5 0 0 0 2.51 1.157l.113-.021a2.456 2.456 0 0 0 1.384-.825l.297-.448a2.37 2.37 0 0 0 .209-1.637l-.018-.075c-.334-1.268-1.63-2.035-2.914-1.753h-.01l-7.51 1.916h-.022a.056.056 0 0 1-.02-.01.048.048 0 0 1-.017-.037l.014-.205.136-2.238c.327.071.682.079 1.054-.008.973-.227 1.74-1.006 1.894-1.992a2.371 2.371 0 0 0-.303-1.578l-.055-.09a2.46 2.46 0 0 0-1.855-1.118l-.076-.006c-1.323-.076-2.469.897-2.596 2.188v.009l-.47 7.62a.047.047 0 0 1-.053.04l-.013-.002-.166-.065-2.15-.83c.169-.284.285-.612.316-.987l.007-.092a2.443 2.443 0 0 0-1.263-2.256l-.084-.043-.105-.048a2.482 2.482 0 0 0-1.508-.155l-.104.024a2.443 2.443 0 0 0-1.683 1.46c-.487 1.219.104 2.59 1.31 3.109l.008.003 7.22 2.797c.03.012.036.048.02.068l-.114.136-1.467 1.759a2.335 2.335 0 0 0-.79-.573l-.068-.03-.086-.034c-.873-.321-1.878-.147-2.566.484l-.069.065a2.407 2.407 0 0 0 .188 3.584 2.49 2.49 0 0 0 3.404-.268l.006-.006 3.485-4.165v3.166l-.5.607v-.004l-1.29 1.543c-1.559 1.868-4.346 2.229-6.28.782l-.092-.07a4.41 4.41 0 0 1-1.668-3.076l-.009-.113a4.384 4.384 0 0 1 1.619-3.688l.357-.297-1.892-.729c-2.323-.895-3.535-3.457-2.656-5.739a4.475 4.475 0 0 1 2.565-2.555 4.577 4.577 0 0 1 4.068.373l.393.244.12-1.995h-.001c.146-2.447 2.248-4.375 4.728-4.258zm4.679 17.909a45.987 45.987 0 0 1-.964 2.191 9.16 9.16 0 0 1 2.417 0 45.878 45.878 0 0 1-.963-2.191l-.245-.6-.245.6z"])','.immersive-player-switch-on-hide-interaction-area > div:has(> div >svg >defs+ g[clip-path*="__lottie_element_"])')},shieldAuthorAvatar(){return r.info("【屏蔽】作者头像"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-avatar"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-avatar"])')]},shieldLikeButton(){return r.info("【屏蔽】点赞"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-digg"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="video-player-digg"])')]},shieldCommentButton(){return r.info("【屏蔽】评论"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="feed-comment-icon"])','.basePlayerContainer div[aria-describedby]:has([data-e2e="feed-comment-icon"])')]},shieldCollectionButton(){return r.info("【屏蔽】收藏"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-collect"])','.basePlayerContainer div[data-e2e="video-player-collect"][data-e2e-state="video-player-no-collect"]')]},shieldSharenButton(){return r.info("【屏蔽】分享"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-share"])','.basePlayerContainer div:has(>div[data-e2e="video-player-share"])')]},shieldListenDouYinButton(){return r.info("【屏蔽】听抖音"),[y.addBlockCSS('.basePlayerContainer div[aria-describedby]:has(path[d="M9.68718 12.4801C8.612 14.3927 8.1197 16.7374 8.05821 19.0767C8.23942 18.9661 8.4351 18.8725 8.64383 18.7988L9.16952 18.6132C10.7699 18.0482 12.5315 18.8701 13.1042 20.4491L15.3865 26.7417C15.9591 28.3206 15.126 30.0586 13.5257 30.6236L13 30.8092C11.4155 31.3686 9.85676 30.6485 8.86663 29.2939C8.83318 29.2583 8.80192 29.22 8.7732 29.1788C7.33136 27.1149 6.42117 24.618 6.13186 21.9841C5.75876 18.5873 6.12658 14.6403 7.8929 11.4983C9.70099 8.28189 12.9317 6 17.9885 6C23.0436 6 26.2778 8.27305 28.092 11.4819C29.8643 14.6168 30.2393 18.557 29.8725 21.9536C29.5881 24.5883 28.6825 27.0875 27.2445 29.155C27.2194 29.1911 27.1924 29.2251 27.1636 29.2569C26.1749 30.6354 24.6023 31.3737 23.0035 30.8092L22.4778 30.6236C20.8774 30.0586 20.0443 28.3206 20.617 26.7417L22.8993 20.4491C23.472 18.8701 25.2335 18.0482 26.8339 18.6132L27.3596 18.7988C27.5669 18.8719 27.7613 18.9648 27.9415 19.0744C27.8783 16.7301 27.382 14.3817 26.3001 12.468C24.846 9.89593 22.2949 8.02429 17.9885 8.02428C13.684 8.02428 11.1369 9.90129 9.68718 12.4801Z"])')]},shieldRelatedRecommendationsButton(){return r.info("【屏蔽】看相关"),[y.addBlockCSS('div.dy-tip-container:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','div.dy-tip-container:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d="M14 8a8 8 0 0 0-8 8v4a8 8 0 0 0 8 8h8a8 8 0 0 0 8-8v-4a8 8 0 0 0-8-8h-8zm8.5 10.866a1 1 0 0 0 0-1.732l-6-3.464a1 1 0 0 0-1.5.866v6.928a1 1 0 0 0 1.5.866l6-3.464z"])','.basePlayerContainer div[aria-describedby]:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])'),B(`
				/* 修复分享的悬浮框距离底部的高度 */
				[data-e2e="video-player-share"]+div[data-e2e="video-share-container"] > div:first-child{
					bottom: 0px !important;
				}
			`)]},shieldMoreButton(){return r.info("【屏蔽】更多"),[y.addBlockCSS('div.dy-tip-container:has([data-e2e="video-play-more"])','.basePlayerContainer div[data-e2e="video-play-more"]'),B(`
				/* 修复分享的悬浮框距离底部的高度 */
				[data-e2e="video-player-share"]+div[data-e2e="video-share-container"] > div:first-child{
					bottom: 0px !important;
				}
			`)]}},rt={init(){h.execMenuOnce("shieldRightExpandCommentButton",()=>this.shieldRightExpandCommentButton()),h.execMenuOnce("shieldSearchFloatingBar",()=>this.shieldSearchFloatingBar(),void 0,true),h.execMenuOnce("shieldCloseFullScreenButton",()=>this.shieldCloseFullScreenButton(),void 0,true),h.execMenuOnce("dy-video-blockShopInfo",()=>this.blockShopInfo()),Ne.init(),At.init(),Tt.init(),It.init();},shieldRightExpandCommentButton(){return r.info("【屏蔽】右侧的展开评论按钮"),[y.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] > div > div > button[type="button"]','.playerContainer button[type=button] svg > g[filter] > path[d="M21.316 29.73a1.393 1.393 0 01-1.97 0l-5.056-5.055a1.393 1.393 0 010-1.97l.012-.011 5.044-5.045a1.393 1.393 0 011.97 1.97l-4.07 4.071 4.07 4.071a1.393 1.393 0 010 1.97z"]'),B(`
			.basePlayerContainer .positionBox{
				padding-right: 20px !important;
			}`)]},shieldSearchFloatingBar(){r.info("【屏蔽】搜索悬浮栏");let t=[];return t.push(y.addBlockCSS("#slideMode + div",'.playerContainer .slider-video>div>div:has([data-e2e="searchbar-button"])')),(L.isSearch()||L.isDiscover())&&t.push(y.addBlockCSS('#douyin-right-container > div > div > div > div:has( div> input[data-e2e="searchbar-input"])')),L.isUser()&&t.push(y.addBlockCSS('#douyin-right-container > div > div > div > div:has( div> input[data-e2e="searchbar-input"])')),L.isVideo()&&t.push(y.addBlockCSS('[data-e2e="video-detail"] .video-detail-container > div > div > div:nth-child(2):has( div> input[data-e2e="searchbar-input"])')),t},shieldCloseFullScreenButton(){r.info("【屏蔽】网页全屏关闭按钮");let t=[];return t.push(y.addBlockCSS('.playerContainer .slider-video > div > div:has(path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),(L.isSearch()||L.isDiscover())&&t.push(y.addBlockCSS('#douyin-right-container  div > div:has( > svg > path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),L.isUser()&&t.push(y.addBlockCSS('#douyin-right-container  div > div > div:has( > svg > path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),L.isVideo()&&t.push(y.addBlockCSS('#douyin-right-container  div > div > div:has( > svg > path[d="M17.448 17.448a1.886 1.886 0 0 1-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 1 1 .552 14.78L6.332 9 .552 3.22A1.886 1.886 0 1 1 3.22.552L9 6.332l5.78-5.78a1.886 1.886 0 1 1 2.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 0 1 0 2.668z"])')),t},blockShopInfo(){return r.info("【屏蔽】购物信息"),y.addBlockCSS(".xgplayer-shop-anchor")}};class ft{key="short-cut";$data;isWaitPress=false;currentWaitEnterPressInstanceHandler=null;constructor(e){typeof e=="string"&&(this.key=e),this.$data={otherShortCutOptions:[]};}initConfig(e,i){this.hasOption(e)||this.setOption(e,i);}getStorageKey(){return this.key}getLocalAllOptions(){return Ve(this.key,[])}hasOption(e){return !!this.getLocalAllOptions().find(o=>o.key===e)}hasOptionValue(e){return this.hasOption(e)?this.getOption(e)?.value!=null:false}getOption(e,i){return this.getLocalAllOptions().find(a=>a.key===e)??i}setOption(e,i){let n=this.getLocalAllOptions(),o=n.findIndex(a=>a.key===e);o==-1?n.push({key:e,value:i}):Reflect.set(n[o],"value",i),ve(this.key,n);}emptyOption(e){let i=false,n=this.getLocalAllOptions(),o=n.findIndex(a=>a.key===e);return o!==-1&&(n[o].value=null,i=true),ve(this.key,n),i}deleteOption(e){let i=false,n=this.getLocalAllOptions(),o=n.findIndex(a=>a.key===e);return o!==-1&&(n.splice(o,1),i=true),ve(this.key,n),i}translateKeyboardValueToButtonText(e){let i="";return e.ohterCodeList.forEach(n=>{i+=b.stringTitleToUpperCase(n,true)+" + ";}),i+=b.stringTitleToUpperCase(e.keyName),i}getShowText(e,i){if(this.hasOption(e)){let n=this.getOption(e);return n.value==null?i:this.translateKeyboardValueToButtonText(n.value)}else return i}async enterShortcutKeys(e){const i=this;return new Promise(n=>{this.isWaitPress=true;let o=f.listenKeyboard(window,"keyup",(a,l,u)=>{const s={keyName:a,keyValue:l,ohterCodeList:u};let d={};try{const c=JSON.stringify(s),p=this.getLocalAllOptions();Array.isArray(this.$data.otherShortCutOptions)&&p.push(...this.$data.otherShortCutOptions);for(let v=0;v<p.length;v++){let g=p[v];if(g.key===e)continue;const C=JSON.stringify(g.value);let x=!1;if(g.value!=null&&c===C&&(x=!0),x){d={status:!1,key:g.key,option:s};return}}this.setOption(e,s),d={status:!0,key:e,option:s};}catch(c){console.log(c),d={status:false,key:e,option:s};}finally{i.isWaitPress=false,o.removeListen(),i.currentWaitEnterPressInstanceHandler=null,n(d);}});i.currentWaitEnterPressInstanceHandler=null,i.currentWaitEnterPressInstanceHandler=()=>{i.isWaitPress=false,o.removeListen();};})}cancelEnterShortcutKeys(){typeof this.currentWaitEnterPressInstanceHandler=="function"&&this.currentWaitEnterPressInstanceHandler();}initGlobalKeyboardListener(e,i){let n=this.getLocalAllOptions();if(!n.length){r.warn("没有设置快捷键");return}const o=this;function a(s,d){f.listenKeyboard(s,"keydown",(c,p,v,g)=>{if(o.isWaitPress)return;i?.isPrevent&&f.preventEvent(g),n=o.getLocalAllOptions();let C=n.findIndex(x=>{let w=x.value,S={keyName:c,keyValue:p,ohterCodeList:v};if(JSON.stringify(w)===JSON.stringify(S))return x});if(C!=-1){let x=n[C];x.key in d&&(r.info(["调用快捷键",x]),d[x.key].callback());}},{capture:!!i?.capture});}let l={},u={};Object.keys(e).forEach(s=>{let d=e[s];(d.target==null||typeof d.target=="string"&&d.target==="")&&(d.target="window"),d.target==="window"?Reflect.set(l,s,d):Reflect.set(u,s,d);}),a(window,l),f.ready(()=>{Object.keys(u).forEach(async s=>{let d=u[s];if(typeof d.target=="string")f.waitNode(d.target,1e4).then(c=>{if(!c)return;let p={};Reflect.set(p,s,d),a(c,p);});else if(typeof d.target=="function"){let c=await d.target();if(c==null)return;let p={};Reflect.set(p,s,d),a(c,p);}else {let c={};Reflect.set(c,s,d),a(d.target,c);}});});}}const ie={shortCut:new ft("video-short-cut"),$data:{rateMap:["0.75","1","1.25","1.5","1.75","2","3"]},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-video-rate-low":{target:"window",callback(){r.info("触发快捷键 ==> 调用倍速：小");let t=A.sessionStorage.getItem("player_playbackratio")??"1",e=ie.$data.rateMap.findIndex(n=>n===t);if(e===0){r.warn("触发快捷键 ==> 已是最小倍速: "+t);return}let i=ie.$data.rateMap[e-1];r.info("触发快捷键 ==> 设置倍速: "+i),he.chooseVideoRate(i);}},"dy-video-rate-up":{target:"window",callback(){r.info("触发快捷键 ==> 调用倍速：大");let t=A.sessionStorage.getItem("player_playbackratio")??"1",e=ie.$data.rateMap.findIndex(n=>n===t);if(e===ie.$data.rateMap.length-1){r.warn("触发快捷键 ==> 已是最大倍速: "+t);return}let i=ie.$data.rateMap[e+1];r.info("触发快捷键 ==> 设置倍速: "+i),he.chooseVideoRate(i);}},"dy-video-shortcut-immersionMode":{target:"window",callback(){r.info("触发快捷键 ==> 沉浸模式");let t=h.getValue("fullScreen");h.setValue("fullScreen",!t),h.execMenuOnce("fullScreen",()=>he.fullScreen());}},"dy-video-shortcut-changeVideoMuted":{target:"window",callback(){r.info("触发快捷键 ==> 切换静音状态"),K("video").forEach(t=>{let e=!t.muted;r.success(`切换video标签的静音状态为 ${e}`),t.muted=e;});}}}}};class Et{isBacking=false;config;constructor(e){this.config=e,this.enterGestureBackMode=this.enterGestureBackMode.bind(this),this.quitGestureBackMode=this.quitGestureBackMode.bind(this),this.popStateEvent=this.popStateEvent.bind(this),(typeof this.config.backDelayTime!="number"||isNaN(this.config.backDelayTime))&&(this.config.backDelayTime=150),this.config.win==null&&(this.config.win=self);}popStateEvent(e){f.preventEvent(e),!this.isBacking&&this.quitGestureBackMode(true);}enterGestureBackMode(){r.success("进入手势模式");let e=this.config.hash;e.startsWith("#")||(e.startsWith("/")||(e="/"+e),e="#"+e),this.config.useUrl&&(e=this.config.win.location.origin+this.config.win.location.pathname+this.config.win.location.search+e),this.config.win.history.pushState({},"",e),r.success("监听popstate事件"),f.on(this.config.win,"popstate",this.popStateEvent,{capture:true});}async quitGestureBackMode(e=false){this.isBacking=true,r.success("退出手势模式"),typeof this.config.beforeHistoryBackCallBack=="function"&&this.config.beforeHistoryBackCallBack(e);let i=Date.now()+1e3*5;for(;;){if(Date.now()>i){r.error("未知情况，history.back()失败，无法退出手势模式");break}if(this.config.win.location.hash.endsWith(this.config.hash))r.info("history.back()"),this.config.win.history.back(),await ne.sleep(this.config.backDelayTime||150);else break}r.success("移除popstate事件"),f.off(this.config.win,"popstate",this.popStateEvent,{capture:true}),this.isBacking=false,typeof this.config.afterHistoryBackCallBack=="function"&&this.config.afterHistoryBackCallBack(e);}}const pt={videoCommentDrawer:"videoCommentDrawer"},$t=()=>{let t=Object.values(pt).find(e=>globalThis.location.hash.endsWith(e));t&&(globalThis.location.hash="",r.success("发现残留的手势返回hash，已清理 ==> "+t));},Dt={init(){Ft.init(),Pt.init();}},Ft={init(){h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-enterUserHome",()=>this.blockEnterUserHomeMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-follow",()=>this.blockFollowMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-addLike",()=>this.blockAddLikeMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-comment",()=>this.blockCommentMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-collect",()=>this.blockCollectMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-share",()=>this.blockShareMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-seeCorrelation",()=>this.blockSeeCorrelationMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-rightToolBar-more",()=>this.blockMoreMouseHoverTip());},blockEnterUserHomeMouseHoverTip(){return r.info("禁用进入作者主页按钮的悬浮提示"),y.addBlockCSS(' div > div:has( >a[data-e2e="video-avatar"]) + .semi-portal')},blockFollowMouseHoverTip(){return r.info("禁用关注按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="feed-follow-icon"]  .semi-portal')},blockAddLikeMouseHoverTip(){return r.info("禁用点赞按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-digg"] + .semi-portal')},blockCommentMouseHoverTip(){return r.info("禁用评论按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="feed-comment-icon"] + .semi-portal')},blockCollectMouseHoverTip(){return r.info("禁用收藏按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-collect"] + .semi-always-dark')},blockShareMouseHoverTip(){return r.info("禁用分享按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-share-container"]')},blockSeeCorrelationMouseHoverTip(){return r.info("禁用看相关推荐按钮的悬浮提示"),y.addBlockCSS('div:has(+[data-e2e="video-play-more"]) .semi-portal')},blockMoreMouseHoverTip(){return r.info("禁用更多按钮的悬浮提示"),y.addBlockCSS('[data-e2e="video-play-more"] > div:has([data-e2e="more-music-detail"])')}},Pt={init(){h.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-automaticBroadcast",()=>this.blockAutomaticBroadcast()),h.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-clearScreen",()=>this.blockClearScreenMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-watchLater",()=>this.blockWatchLaterMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-pageFullScreen",()=>this.blockPageFullScreenMouseHoverTip()),h.execMenuOnce("dy-video-mouseHoverTip-bottomToolBar-fullScreen",()=>this.blockFullScreenMouseHoverTip());},blockAutomaticBroadcast(){return r.info("禁用自动连播按钮的悬浮提示"),y.addBlockCSS('div[data-e2e="video-player-auto-play"] + .xgTips')},blockClearScreenMouseHoverTip(){return r.info("禁用清屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-immersive-switch-setting .xgTips")},blockWatchLaterMouseHoverTip(){return r.info("禁用稍后再看按钮的悬浮提示"),y.addBlockCSS(".xgplayer-watch-later .xgTips",".xgplayer-watch-later-item + .xgTips")},blockPageFullScreenMouseHoverTip(){return r.info("禁用网页全屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-page-full-screen .xgTips")},blockFullScreenMouseHoverTip(){return r.info("禁用全屏按钮的悬浮提示"),y.addBlockCSS(".xgplayer-fullscreen .xg-tips")}},Fe=(t,e)=>{let i="data-is-inject-mouse-hide",n="data-opacity-show",o="data-opacity-hide",a=()=>h.getValue(t),l=(p=a())=>p===0?`
            ${e.join(",")}{
                opacity: 0 !important;
                
                &:hover,
                &[${n}]{
                    opacity: 1 !important;
                }
                ${p===0?"transition: none !important;":""}
            }
            `:`
            ${e.join(",")}{
                &[${o}]{
                    opacity: 0 !important;
                }
                &:hover{
                    opacity: 1 !important;
                }
            }
            `,u=B(l()),s=h.addValueChangeListener(t,(p,v,g)=>{f.html(u,l(g));}),d=new b.LockFunction(()=>{e.forEach(p=>{let v=q(`${p}:not([${i}])`);if(!v)return;v.setAttribute(i,"");let g=0;f.on(v,["mouseenter","touchstart"],C=>{clearTimeout(g),a()===0?v.setAttribute(n,""):v.removeAttribute(o);}),f.on(v,["mouseleave","touchend"],C=>{a()===0?v.removeAttribute(n):v.setAttribute(o,"");}),a()===0||(g=setTimeout(()=>{v.setAttribute(o,"");},a()));});}),c=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:(p,v)=>{d.run();}});return {destory(){u.remove(),h.removeValueChangeListener(s),c?.disconnect();},$style:u}},xe={async waitReactPropsToSet(t,e,i){Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);function n(){let o=null;return typeof t=="string"?o=f.selector(t):typeof t=="function"?o=t():t instanceof HTMLElement&&(o=t),o}typeof t=="string"&&!await f.waitNode(t,1e4)||i.forEach(o=>{typeof o.msg=="string"&&r.info(o.msg);function a(){let l=n();if(l==null)return {status:false,isTimeout:true,inst:null,$el:l};let u=b.getReactInstance(l);if(u==null)return {status:false,isTimeout:false,inst:null,$el:l};let s=Array.from(e).findIndex(p=>{let v=u[p];if(!v)return  false;let g=o.check(v,l);return g=!!g,g}),d=e[s],c=u[d];return {status:s!==-1,isTimeout:false,inst:c,$el:l}}b.waitPropertyByInterval(()=>n(),()=>a().status,250,1e4).then(()=>{let l=a();if(l.status){let u=l.inst;o.set(u,l.$el);}else typeof o.failWait=="function"&&o.failWait(l.isTimeout);});});}},he={$flag:{isWaitEnterFullScreen:false},init(){rt.init(),h.onceExec("dy-short-cut",()=>{ie.init();}),Dt.init(),h.execMenuOnce("changeCommentToBottom",()=>this.changeCommentToBottom()),h.execMenuOnce("fullScreen",()=>this.fullScreen()),h.execMenuOnce("parseVideo",()=>this.hookDownloadButtonToParseVideo()),h.execMenuOnce("dy-video-hookCopyLinkButton",()=>this.hookCopyLinkButton()),h.exec(["autoEnterElementFullScreen","search-autoEnterElementFullScreen"],()=>{this.autoEnterElementFullScreen();},t=>{const[e,i]=t;let n=h.getValue(e),o=h.getValue(i);if(L.isSearch()&&n){if(o==1)return  true;if(o==0)return  false}return n},false),h.execMenuOnce("dy-video-doubleClickEnterElementFullScreen",()=>this.doubleClickEnterElementFullScreen()),h.execMenuOnce(["dy-video-bgColor-enable","dy-video-changeBackgroundColor"],t=>this.changeBackgroundColor(t.value[1])),h.execMenuOnce("repairProgressBar",()=>{let t=[];return h.onceExec("repairProgressBar",()=>{t.push(...this.repairVideoProgressBar());}),t}),h.execMenuOnce("dy-video-gestureBackCloseComment",()=>this.gestureBackCloseComment()),h.execMenuOnce("dy-video-removeStyle-bottom",()=>this.removeStyleBottom()),h.execMenuOnce("dy-video-disableRightToolbarTransform",()=>this.disableRightToolbarTransform()),he.chooseQuality(h.getValue("chooseVideoDefinition")),f.ready(()=>{he.chooseQuality(h.getValue("chooseVideoDefinition")),h.execMenuOnce("dy-video-waitToRemovePauseDialog",()=>this.waitToRemovePauseDialog()),h.execMenuOnce("mobileMode",()=>this.mobileMode()),h.execMenuOnce("dy-video-titleInfoAutoHide",()=>this.titleInfoAutoHide()),h.execMenuOnce("dy-video-videoControlsAutoHide",()=>this.videoControlsAutoHide()),h.execMenuOnce("dy-video-rightToolBarAutoHide",()=>this.rightToolBarAutoHide());});},fullScreen(){r.info("沉浸模式");let t=[];return t.push(y.addBlockCSS(".slider-video .positionBox","#video-info-wrap","xg-controls.xgplayer-controls")),t.push(Ne.blobkTitleTopTag()),t.push(rt.shieldSearchFloatingBar()),t.push(Ne.blockClickRecommend()),t.push(B(`
			/* 视频全屏 */
			xg-video-container.xg-video-container{
				bottom: 0px !important;
			}
			/* 图文的图片全屏 */
			.basePlayerContainer  .focusPanel .dySwiperSlide img[src]{
				height: 99% !important;
			}
      /* 修复有时候背景为全黑的问题 */
      .isCssFullScreen .basePlayerContainer video{
        height: calc(100% - 2px) !important;
      }
      `)),t},autoEnterElementFullScreen(t=false){if(this.$flag.isWaitEnterFullScreen){r.warn("已存在等待进入全屏...");return}this.$flag.isWaitEnterFullScreen=true,t?f.ready(()=>{let e=new KeyboardEvent("keydown",{bubbles:true,cancelable:true,key:"Y",code:"KeyY",keyCode:89,which:89});document.dispatchEvent(e),this.$flag.isWaitEnterFullScreen=false,r.success("成功自动进入网页全屏-快捷键");}):f.ready(()=>{xe.waitReactPropsToSet(()=>q('xg-icon[data-e2e="xgplayer-page-full-screen"] .xgplayer-icon')||q('[data-e2e="feed-active-video"] dy-icon.douyin-player-page-full-screen .douyin-player-icon'),"reactProps",{check(e){return typeof e?.onClick=="function"},set:(e,i)=>{this.$flag.isWaitEnterFullScreen=false,r.success("成功自动进入网页全屏-点击按钮"),i.click();}});});},doubleClickEnterElementFullScreen(){let t=false;return r.info("注册双击进入网页全屏事件"),[f.on(document,"click",[".newVideoPlayer","#sliderVideo"],i=>{t?(t=false,he.autoEnterElementFullScreen(true)):(t=true,setTimeout(()=>{t=false;},250));}).off]},changeCommentToBottom(){return r.info("评论区移到中间"),[B(`
      /* 竖屏样式 */
      @media screen and (orientation: portrait) {
        #sliderVideo[data-e2e="feed-video"] #videoSideBar #relatedVideoCard,
        #sliderVideo[data-e2e="feed-video"] #videoSideCard #relatedVideoCard{
          display: none !important;
        }
        /* 左侧的视频宽度撑满 */
        #sliderVideo[data-e2e] .playerContainer,
        #slideMode[data-e2e] .playerContainer{
          width: 100% !important;
        }
        /* 右侧的评论区宽度撑满，position使用absolute */
        #sliderVideo[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
        #slideMode[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
        #sliderVideo[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard),
        #slideMode[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard){
          width: 100%;
          height: 75%;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: rgba(0, 0, 0, 0.9);
          transition: height .15s linear !important;
          position: absolute;
        }
      }
		`)]},chooseQuality(t=0){r.info("选择视频清晰度: "+t);let e="MANUAL_SWITCH",n=[{done:1,gearClarity:"20",gearName:"超清 4K",gearType:-2,qualityType:72},{done:1,gearClarity:"10",gearName:"超清 2K",gearType:-1,qualityType:7},{done:1,gearClarity:"5",gearName:"高清 1080P",gearType:1,qualityType:2},{done:1,gearClarity:"4",gearName:"高清 720P",gearType:2,qualityType:15},{done:1,gearClarity:"3",gearName:"标清 540P",gearType:3,qualityType:21},{done:1,gearClarity:"2",gearName:"极速",gearType:4,qualityType:21},{done:1,gearClarity:"0",gearName:"智能",gearType:0}].find(a=>a.gearType===t);function o(a){A.sessionStorage.setItem(e,a);}if(n){let a=JSON.stringify(n),l=setInterval(()=>{o(a);},250);setTimeout(()=>{clearInterval(l);},10*1e3),r.success("设置当前视频的清晰度: "+n.gearName);}else r.error("该清晰度不存在: "+t);},chooseVideoRate(t="1"){let e="player_playbackratio";function i(n="1"){A.sessionStorage.setItem(e,n),K("xg-icon.xgplayer-playback-setting").forEach(o=>{b.getReactInstance(o).reactContainer?.memoizedState?.element?.props?.xgCase?.updatePlayBackRatio();});}i(t);},hookDownloadButtonToParseVideo(){r.info("修改页面的分享-下载按钮变成解析视频");function t(i,n){let o="";n.forEach(l=>{let u=`${l.width}x${l.height} @${l.fps}`;o+=`
          		<div class="douyin-video-link-item">
					<div class="dy-video-name">
						<span>清晰度信息：</span>
						<span>${u}</span>
					</div>
					<div class="dy-video-size">
						<span>视频大小：</span>
						<span>${b.formatByteToSize(l.dataSize)}</span>
					</div>
					<div class="dy-video-download-uri">
						<span>下载地址：</span>
						<a href="${l.url}" data-file-name="${i} - ${u}.${l.format}">${l.url}</a>
					</div>
					${l.backUrl.length?`
						<div class="dy-video-back-uri">
							<span>备用地址：</span>
							${l.backUrl.map((s,d)=>`
									<a href="${s}" data-file-name="${i} - ${u}.${l.format}">地址${d+1}</a>
								`).join("，")}
						</div>
					`:""}
				</div>
            	`;}),o=`<div class="douyin-video-link-container">${o}</div>`;let a=H.alert({title:{text:"视频解析",position:"center"},content:{text:o,html:true},mask:{enable:true,clickEvent:{toClose:true}},btn:{ok:{enable:false}},width:window.innerWidth>550?"550px":"88vw",height:window.innerHeight>550?"550px":"80vh",drag:true,dragLimit:true,style:`
          .douyin-video-link-container a{
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
          }
          .douyin-video-link-item{
              white-space: nowrap;
              overflow: hidden;
              text-overflow: ellipsis;
              margin: 10px;
          }
          .dy-video-download-uri{
            display: flex;
          }
          .dy-video-back-uri{
            display: flex;
          }`});f.on(a.popsElement,"click","a",(l,u)=>{f.preventEvent(l);let s=u.getAttribute("href"),d=u.getAttribute("data-file-name"),c=function(){try{return typeof et=="function"}catch(S){return console.error(S),false}};if(h.getValue("dy-video-popupDownloadRenameFileName")){const S=globalThis.prompt("请确认下载的文件名",d);if(typeof S=="string")r.info(`重命名下载的文件名：${d} -> ${S}`),d=S;else {k.info("取消下载");return}}if(!c()){r.error("当前脚本环境不支持API 【GM_download】"),window.open(s,"_blank");return}k.info("调用【GM_download】下载视频");let v=null,g=false,C=false,x=k.loading("下载中...",{showClose:true,onClose(){!g&&typeof v=="function"&&v();}}),w=et({url:s,name:d,headers:{Referer:window.location.href},onload(){g=true,x.close(),k.success(`下载 ${d} 已完成`,{consoleLogContent:true});},onprogress(S){if(typeof S=="object"&&"loaded"in S&&"total"in S&&!C){let V=(S.loaded/S.total*100).toFixed(2);x.setText(`下载中...${V}%`),S.loaded===S.total&&(C=true);}},onerror(S){x.close(),r.error("下载失败error👉",S),typeof S=="object"&&S.error?k.error(`下载 ${d} 失败或已取消 原因：${S.error}`,{timeout:6e3}):k.error(`下载 ${d} 失败或已取消`);},ontimeout(){x.close(),k.error(`下载 ${d} 请求超时`);}});typeof w=="object"&&w!=null&&"abort"in w&&(v=w.abort);},{capture:true});}return [f.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button + div',function(i,n){f.preventEvent(i);let o=n,a=b.getReactInstance(o.parentElement)?.reactFiber;if(!a){k.error("获取rectFiber属性失败",{consoleLogContent:true});return}try{let l=a?.return?.memoizedProps?.awemeInfo;if(!l){k.error("获取awemeInfo属性失败",{consoleLogContent:!0});return}r.info(["解析的awemeInfo: ",l]);let u=[],s=l?.video?.bitRateList;if(s!=null&&Array.isArray(s)&&(u=u.concat(s.map(p=>{let v={url:p.playApi,width:p.width,height:p.height,format:p.format,fps:0,dataSize:p.dataSize,backUrl:[]};return typeof p.fps=="number"&&(v.fps=p.fps),Array.isArray(p.playAddr)&&(v.backUrl=v.backUrl.concat(p.playAddr.map(g=>g.src))),v}).filter(p=>p!=null))),!u.length){k.error("未获取到视频的有效链接信息",{consoleLogContent:!0});return}let d=[];for(let p=0;p<u.length;p++){const v=u[p];let g=d.findIndex(C=>C.width===v.width&&C.height===v.height&&C.fps===v.fps);g!=-1?d[g].dataSize<v.dataSize&&d.splice(g,1,v):d.push(v);}d=d.map(p=>(p.url.startsWith("http:")&&(p.url=p.url.replace("http:","")),p)),b.sortListByProperty(d,p=>p.width);let c=(l?.authorInfo?.nickname||"未知作者")+" - "+(l?.desc||"未知视频文案");t(c,d);}catch(l){r.error(l),k.error("解析视频失败",{consoleLogContent:true});}},{capture:true}).off]},hookCopyLinkButton(){return r.info("修改页面的分享-复制链接"),[f.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button:contains("复制链接")',e=>{f.preventEvent(e);let i=e.target,n=b.getReactInstance(i.parentElement)?.reactFiber;if(!n){k.error("获取rectFiber属性失败",{consoleLogContent:true});return}let o=n?.return?.return?.memoizedProps?.awemeInfo;if(o==null||typeof o!="object"){k.error("获取awemeInfo属性失败",{consoleLogContent:true});return}r.info("视频awemeInfo：",o);let a=o?.shareInfo?.shareUrl;if(typeof a!="string"){k.error("获取shareUrl属性失败",{consoleLogContent:true});return}r.info("视频链接："+a),b.copy(a).then(l=>{let u=n?.return?.return?.memoizedProps?.toast;l?typeof u=="function"?u("已复制链接"):k.success("已复制链接"):typeof u=="function"?u("复制链接失败"):k.error("复制链接失败");});},{capture:true}).off]},mobileMode(){r.info("启用手机模式");let t=[];return mt.initialScale(),t.push(y.addBlockCSS("img#douyin-temp-sidebar"),B(Rt)),h.onceExec("repairProgressBar",()=>{t.push(...this.repairVideoProgressBar());}),t},repairVideoProgressBar(){r.info("修复进度条按钮");let t=[B(`
			/* 禁止触发touch事件，因为会影响到按钮点击不到 */
      @media screen and (max-width: 600px) and (orientation: portrait),
        screen and (max-height: 600px) and (orientation: landscape) {
        xg-outer,
        xg-inners {
          pointer-events: none;
        }
      }
			`)];const e=()=>h.getValue("mobileMode")||h.getValue("repairProgressBar"),i=()=>Bt.isVerticalScreen()?window.innerWidth<=600:window.innerHeight<=600;return f.ready(()=>{f.on(document.body,"touchstart","xg-progress",(n,o)=>{if(!e()||!i())return;const a=o.querySelector("xg-outer");a&&(a.style.height="6px");},{capture:true}),f.on(document.body,"touchend","xg-progress",(n,o)=>{if(!e()||!i())return;const a=o.querySelector("xg-outer");a&&(a.style.height="");},{capture:true});}),t},changeBackgroundColor(t){return r.info("修改视频背景颜色"),B(`
		/* 推荐的直播间背景 */
		xgmask,
		#sliderVideo > div,
		/* 用户主页的视频 */
		.basePlayerContainer .imgBackground,
		/* 搜索的图文视频 */
		.basePlayerContainer .dySwiperSlide img+div{
			background: ${t}  !important;
		}
		`)},titleInfoAutoHide(){return r.info("自动隐藏视频标题"),Fe("dy-video-titleInfoAutoHide-delayTime",['#sliderVideo[data-e2e="feed-active-video"] #video-info-wrap','#slideMode[data-e2e="feed-active-video"] #video-info-wrap','div[data-e2e="video-detail"] #video-info-wrap'])},videoControlsAutoHide(){return r.info("自动隐藏视频控件"),Fe("dy-video-videoControlsAutoHide-delayTime",['#sliderVideo[data-e2e="feed-active-video"] xg-controls.xgplayer-controls','#slideMode[data-e2e="feed-active-video"] xg-controls.xgplayer-controls','div[data-e2e="video-detail"] xg-controls.xgplayer-controls'])},rightToolBarAutoHide(){r.info("自动隐藏右侧工具栏");const t=Fe("dy-video-titleInfoAutoHide-delayTime",['#sliderVideo[data-e2e="feed-active-video"] .positionBox','#slideMode[data-e2e="feed-active-video"] .positionBox','div[data-e2e="video-detail"] .positionBox']);return [B(`
			.positionBox{
				transition: opacity 0.5s;
			}
		  `),,t.$style,t.destory]},gestureBackCloseComment(){r.info("手势返回关闭评论区");let t=new Et({hash:pt.videoCommentDrawer,useUrl:true,beforeHistoryBackCallBack(a){a&&i();}});const e='#relatedVideoCard .semi-tabs + div svg:has(path[d="M22.133 23.776a1.342 1.342 0 1 0 1.898-1.898l-4.112-4.113 4.112-4.112a1.342 1.342 0 0 0-1.898-1.898l-4.112 4.112-4.113-4.112a1.342 1.342 0 1 0-1.898 1.898l4.113 4.112-4.113 4.113a1.342 1.342 0 0 0 1.898 1.898l4.113-4.113 4.112 4.113z"])';function i(){let a=q(e);if(a){let l=b.getReactInstance(a);if(l){let u=l.reactProps?.onClick;typeof u=="function"?u():k.error("调用关闭评论区按钮的onClick函数失败");}else k.error("获取关闭评论区按钮react信息失败");}else k.error("未找到关闭评论区的按钮");}const n=f.on(document,"click",'.xgplayer div[data-e2e="feed-comment-icon"]',a=>{r.info("手势 => 打开评论区"),f.waitNode(e,1e4).then(l=>{l&&(r.info("手势 => 评论区出现"),t.enterGestureBackMode());});},{capture:true}),o=f.on(document,"click",e,a=>{r.info("手势 => 关闭评论区"),t.quitGestureBackMode();},{capture:true});return [n.off,o.off]},waitToRemovePauseDialog(){r.info("监听信息区域【长时间无操作，已暂停播放】弹窗");let t=n=>{let o=f.text(n);if(o.includes("长时间无操作")&&o.includes("暂停播放")){k.info("出现【长时间无操作，已暂停播放】弹窗",{consoleLogContent:true});let a=b.getReactInstance(n);if(typeof a.reactProps=="object"){let l=b.queryProperty(a.reactProps,u=>{if(typeof u?.props?.onClose=="function")return {isFind:true,data:u.props.onClose};{let s=u?.props?.children??u?.children;return {isFind:false,data:Array.isArray(s)?s[0]:s}}});typeof l=="function"&&(k.success("调用函数关闭【长时间无操作，已暂停播放】弹窗",{consoleLogContent:true}),l());}}},e=new b.LockFunction(()=>{h.getValue("dy-video-waitToRemovePauseDialog")&&[...Array.from(K(".basePlayerContainer xg-bar.xg-right-bar + div")),...Array.from(K('.basePlayerContainer div:has(>div):contains("长时间无操作")'))].forEach(n=>{t(n);});});const i=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{e.run();}});return [()=>{i?.disconnect();}]},removeStyleBottom(){return r.info("移除video的bottom偏移"),B(`
			#sliderVideo[data-e2e="feed-active-video"] div:has( > div > #video-info-wrap),
			div:has( > div > pace-island > #video-info-wrap ),
			xg-video-container.xg-video-container{
				bottom: 0 !important;
			}
		`)},disableRightToolbarTransform(){return r.info("禁用右侧工具栏的transform"),B(`
			.basePlayerContainer .positionBox{
				transform: unset !important;
			}
		`)}},Le={key:"douyin-live-danmu-rule",$data:{rule:[]},init(){this.initRule();},initRule(){this.$data.rule=[],this.get().trim().split(`
`).forEach(i=>{if(i.trim()=="")return;i=i.trim();let n=new RegExp(i.trim());this.$data.rule.push(n);});},change(){this.execMessageFilter([...Array.from(K("xg-danmu.xgplayer-danmu > div > div:not([data-is-filter])")),...Array.from(K("#DanmakuLayout .danmu > div > div:not([data-is-filter])"))],"弹幕"),this.execMessageFilter(Array.from(K("#chatroom .webcast-chatroom .webcast-chatroom___item:not([data-is-filter])")),"聊天室"),h.getValue("live-message-shield-emoji-chat")&&f.hide([...Array.from(K("xg-danmu.xgplayer-danmu > div:has(>img):not([data-is-filter])")),...Array.from(K("#DanmakuLayout .danmu > div > div:has(>img):not([data-is-filter])"))],false);},execMessageFilter(t,e){for(let i=0;i<t.length;i++){let n=t[i],o=b.getReactInstance(n),a=o?.reactFiber?.return?.memoizedProps?.message||o?.reactFiber?.memoizedProps?.children?.props?.children?.props?.message||o?.reactContainer?.memoizedState?.element?.props?.message;if(typeof a!="object"||a==null)continue;let l=a?.payload?.content||a?.payload?.common?.describe,u=a.method,s=a?.payload?.chat_by,d=a?.payload?.biz_scene,c=false;c||(u==="WebcastGiftMessage"?h.getValue("live-danmu-shield-gift")&&(c=true):u==="WebcastChatMessage"?s==="0"||(s==="9"||s==="10")&&h.getValue("live-danmu-shield-lucky-bag")&&(c=true):u==="WebcastRoomMessage"||u==="WebcastFansclubMessage"||u==="WebcastEmojiChatMessage"&&h.getValue("live-message-shield-emoji-chat")&&(c=true)),!c&&typeof d=="string"&&d==="common_text_game_score"&&h.getValue("live-message-shield-biz_scene-common_text_game_score")&&(c=true),c||(c=typeof l=="string"&&this.$data.rule.some(p=>{if(l.match(p))return r.info("自定义规则过滤 "+e+" 消息: "+l),true})),c&&(n.setAttribute("data-is-filter","true"),f.hide(n,false));}},set(t){ve(this.key,t);},get(){return Ve(this.key,"")}},Ot={filterMessage(){let t=new b.LockFunction(()=>{L.isLive()&&Le.change();});return f.ready(()=>{r.success("消息过滤"),Le.init(),b.mutationObserver(document.body,{config:{childList:true,subtree:true},immediate:true,callback:()=>{t.run();}});}),[B(`
				/* 修复一下聊天室屏蔽了某些聊天导致上下抖动不停 */
				.webcast-chatroom___list > div{
					height: 100% !important;
				}
			`)]}},Nt={init(){h.execMenuOnce("live-shieldChatRoom",()=>this.shieldChatRoom()),h.execMenuOnce("live-shielChatRoomVipSeats",()=>this.shielChatRoomVipSeats()),h.execMenuOnce("dy-live-shieldUserLevelIcon",()=>this.shieldUserLevelIcon()),h.execMenuOnce("dy-live-shieldUserVIPIcon",()=>this.shieldUserVIPIcon()),h.execMenuOnce("dy-live-shieldUserFansIcon",()=>this.shieldUserFansIcon()),h.execMenuOnce("dy-live-shieldMessage",()=>this.shieldMessage());},shieldChatRoom(){return r.info("【屏蔽】评论区（聊天室）"),[y.addBlockCSS("#chatroom","#RightBackgroundLayout"),B(`
            div[data-e2e="living-container"],
            div[data-e2e="living-container"] > div{
                margin-bottom: 0px !important;
            }`)]},shielChatRoomVipSeats(){return r.info("【屏蔽】评论区的贵宾席"),[y.addBlockCSS("#chatroom > div > div:has(#audiencePanelScrollId)",'#chatroom > div > div:has([data-e2e="live-room-audience"])','#chatroom > pace-island > div > div:has([data-e2e="live-room-audience"])')]},shieldUserLevelIcon(){return r.info("【屏蔽】用户等级图标"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>img[src*="level"])')]},shieldUserVIPIcon(){return r.info("【屏蔽】VIP图标"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>img[src*="subscribe"])')]},shieldUserFansIcon(){return r.info("【屏蔽】粉丝牌"),[y.addBlockCSS('#chatroom .webcast-chatroom___item span:has(>div[style*="fansclub"])','#chatroom .webcast-chatroom___item span:has(>img[src*="fansclub"])')]},shieldMessage(){return r.info("【屏蔽】信息播报"),[y.addBlockCSS("#chatroom .webcast-chatroom___bottom-message",'#chatroom >div:nth-child(2)>div>div:nth-child(4):not(:has([id^="audiencePanelScrollId"]))','#chatroom >pace-island>div>div:first-child>div:nth-child(4):not(:has([id^="audiencePanelScrollId"]))')]}},Ht={init(){h.execMenuOnce("dy-live-blockVideoRightMenu-downloadClient",()=>this.blockDownloadClient());},blockDownloadClient(){return r.info("【屏蔽】右键菜单-下载客户端"),[y.addBlockCSS('.__menu_container_className:has(>a[href*="douyin-pc-web"])')]}},Ut={init(){h.execMenuOnce("live-shieldGiftColumn",()=>this.shieldGiftColumn()),h.execMenuOnce("live-shieldTopToolBarInfo",()=>this.shieldTopToolBarInfo()),h.execMenuOnce("live-shieldGiftEffects",()=>this.shieldGiftEffects()),h.execMenuOnce("live-shieldLucky",()=>this.shieldLucky()),h.execMenuOnce("live-shielYellowCar",()=>this.shieldYellowCar()),h.execMenuOnce("live-shieldDanmuku",()=>this.shieldDanmu()),h.execMenuOnce("live-block-exhibition-banner-dylive-tooltip",()=>this.block_exhibition_banner_dylive_tooltip()),Nt.init(),Ht.init();},shieldGiftColumn(){return r.info("【屏蔽】底部的礼物栏"),[y.addBlockCSS('div[data-e2e="living-container"] [id^="living_room_player_container"] > :last-child:has(.gitBarOptimizeEnabled )','div[data-e2e="living-container"] >div> div:has(>pace-island >.gitBarOptimizeEnabled)','div[data-e2e="living-container"] xg-controls > div:has(div[data-e2e="gifts-container"]):not(:has(video))',"#BottomLayout",".douyin-player .douyin-player-controls >div:nth-child(2):has(> .gitBarOptimizeEnabled )",'div[data-e2e="living-container"] >div div:has(>pace-island>.gitBarOptimizeEnabled)'),B(`
            /* 去除全屏状态下的礼物栏后，上面的工具栏bottom也去除 */
            div[data-e2e="living-container"] xg-controls xg-inner-controls:has(+div div[data-e2e="gifts-container"]){
                bottom: 0 !important;
            }`)]},shieldTopToolBarInfo(){return r.info("【屏蔽】顶栏信息"),[y.addBlockCSS('div[data-e2e="living-container"] div[id*="living_room_player_container"] > pace-island[id^="island_"]','div[data-e2e="living-container"] div[id*="living_room_player_container"] >div>div>pace-island[id^="island_"]:has(.__isFullPlayer)','div[data-e2e="living-container"] xg-bar.xg-top-bar',"#HeaderLayout",".douyin-player .douyin-player-top-bar"),B(`
				/* 去除屏蔽顶部后直播的video偏移 */
				#PlayerLayout [id^="living_player_containerdouyin-player"]{
					padding-top: 0 !important;
				}
			`)]},shieldGiftEffects(){f.ready(()=>{f.waitNode(()=>f.selector("xg-icon.pluginContainer > div:contains('屏蔽礼物特效')")||f.selector(`xg-icon[classname*="pluginContainer"] > div:contains('屏蔽礼物特效')`)||f.selector('.douyin-player-controls-right > slot > div:has([data-e2e="effect-switch"])'),1e4).then(t=>{if(!t){r.error("【屏蔽】礼物特效失败，原因：获取按钮超时");return}let{reactFiber:e}=b.getReactInstance(t),i=e?.memoizedProps?.children?.[1]?.props?.onClick;typeof i=="function"?(r.info("调用【屏蔽】礼物特效按钮的onClick函数"),i()):r.error("【屏蔽】礼物特效失败，原因：未获取到onClick函数");});});},shieldLucky(){return r.info("【屏蔽】福袋"),[y.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"] > pace-island[id^="island_"]:has(.ShortTouchContainer):has(>div > div:not([class*="video_layout_container"]) > div)',"#ShortTouchLayout x-view","#ShortTouchLayout .ShortTouchContainer")]},shieldYellowCar(){return r.info("【屏蔽】小黄车"),[y.addBlockCSS('div[id^="living_room_player_container"] .basicPlayer  > div:has(div[data-e2e="yellowCart-container"])',"#EcmoCardLayout")]},shieldDanmu(){return r.info("屏蔽弹幕"),[y.addBlockCSS("xg-danmu.xgplayer-danmu","#DanmakuLayout")]},block_exhibition_banner_dylive_tooltip(){return r.info("【屏蔽】点亮展馆帮主播集星"),[y.addBlockCSS('[data-e2e="exhibition-banner"] .dylive-tooltip')]}},Kt={$data:{playerInstance:null},$el:{$playerIns:null},initMenu(){ht.add({key:"live-parsePlayerInstance",text:"⚙ PlayerInstance",autoReload:false,showText(t,e){return t},callback:()=>{let t=q('[id^="living_room_player_container"]');if(!t){r.error("获取playerInstance所在的元素失败"),k.error("获取playerInstance所在的元素失败");return}this.$el.$playerIns=t;let e=this.parseElementPlayerIns(this.$el.$playerIns);if(e==null){r.error("获取playerInstance失败"),r.error("获取playerInstance失败");return}this.$data.playerInstance=e,this.showParseDialog();}});},parseElementPlayerIns(t){return b.getReactInstance(t)?.reactFiber?.child?.child?.memoizedProps?.playerInstance},showParseDialog(){r.info(["解析的信息：",this.$data.playerInstance]);let t=this.$data.playerInstance?.url||this.$data.playerInstance?.src,e=this.$data.playerInstance?.config.url;H.alert({title:{text:"解析信息",position:"center"},content:{text:`
                <div class="live-dy-parse-container">
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">推流地址：</div>
                        <a class="live-dy-parse-item-value" href="${e}" target="_blank">${e}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">blob地址：</div>
                        <a class="live-dy-parse-item-value" href="${t}" target="_blank">${t}
                        </a>
                    </div>
                    <div class="live-dy-parse-item">
                        <div class="live-dy-parse-item-name">播放器版本：</div>
                        <div class="live-dy-parse-item-value">${this.$data.playerInstance?.version}
                        </div>
                    </div>
                </div>
                `,html:true},mask:{clickEvent:{toClose:true}},btn:{ok:{enable:false}},width:window.innerWidth>550?"550px":"88wv",height:window.innerHeight>550?"550px":"70vh",style:`
            .live-dy-parse-container{
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            .live-dy-parse-item{
                display: flex;
                flex-wrap: wrap;
                border: 1px solid #919191;
                border-left: 0px;
                border-right: 0px;
                width: 100%;
                background: #0af9ee;
                padding: 5px 5px;
            }
            `});}},Ie={shortCut:new ft("live-short-cut"),$data:{blockChatRoom:false},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-live-block-chatroom":{target:"window",callback(){r.info("快捷键 ==> 【屏蔽】聊天室");let t=h.getValue("live-shieldChatRoom");h.setValue("live-shieldChatRoom",!t);}},"dy-live-shieldGiftEffects":{target:"window",callback:()=>{r.info("快捷键 ==> 【屏蔽】礼物特效");let t=h.getValue("live-shieldGiftEffects");h.setValue("live-shieldGiftEffects",!t);}},"dy-live-shortcut-changeVideoMuted":{target:"window",callback(){r.info("触发快捷键 ==> 切换静音状态"),K("video").forEach(t=>{let e=!t.muted;r.success(`切换video标签的静音状态为 ${e}`),t.muted=e;});}}}}},ee={auto:{label:"自动",sign:0},origin:{label:"原画",sign:5},uhd:{label:"蓝光",sign:4},hd:{label:"超清",sign:3},sd:{label:"高清",sign:2},ld:{label:"标清",sign:1}},Wt={init(){Ut.init(),Ie.init(),h.execMenuOnce("live-danmu-shield-rule-enable",()=>Ot.filterMessage()),h.execMenu("live-pauseVideo",()=>{this.disableVideoAutoPlay();}),h.exec(["live-bgColor-enable","live-changeBackgroundColor"],()=>this.changeBackgroundColor()),h.onceExec("live-parsePlayerInstance",()=>{Kt.initMenu();}),h.execMenuOnce("live-prevent-wheel-switchLiveRoom",()=>[f.on(document,["wheel","mousewheel"],e=>{h.getValue("live-prevent-wheel-switchLiveRoom")&&L.isLive()&&f.preventEvent(e);},{capture:true}).off]),f.ready(()=>{h.execMenuOnce("live-waitToRemovePauseDialog",()=>this.waitToRemovePauseDialog()),h.execMenu("live-chooseQuality",t=>{t.value!=="auto"&&this.chooseQuality(t.value);}),h.execMenu("live-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),h.execMenu("dy-live-autoCloseChatRoom",()=>{this.autoCloseChatRoom();});});},autoEnterElementFullScreen(){f.ready(()=>{xe.waitReactPropsToSet("xg-icon.xgplayer-fullscreen + xg-icon  div:has(>svg)","reactFiber",{check(t){return typeof t?.memoizedProps?.onClick=="function"},set(t,e){let i=e.closest("xg-icon");if(i&&f.text(i).includes("退出网页全屏")){r.warn("抖音已自动进入网页全屏，不执行脚本的操作");return}r.success("成功自动进入网页全屏"),t.memoizedProps.onClick();}});});},chooseQuality(t="origin"){xe.waitReactPropsToSet('xg-inner-controls xg-right-grid >div:has([data-e2e="quality-selector"])',"reactProps",{check(e){return typeof e?.children?.props?.children?.props?.qualityHandler=="object"&&typeof e?.children?.props?.children?.props?.qualityHandler?.getCurrentQualityList=="function"},set(e){let i=e.children.props.children.props.qualityHandler,n=i.getCurrentQualityList();n.includes(t)||(k.warning("当前直播没有【"+t+"】画质，自动选择最高画质"),n.sort((o,a)=>ee[o]?ee[a]?ee[o].sign-ee[a].sign:(r.error("画质【"+a+"】不存在"),0):(r.error("画质【"+o+"】不存在"),0)),t=n[n.length-1]),i.setCurrentQuality(t),r.success("成功设置画质为【"+t+"】");}}),xe.waitReactPropsToSet("#PlayerLayout .douyin-player-controls .QualitySwitchNewPlugin > div","reactFiber",{check(e,i){return typeof e?.return?.memoizedProps?.qualityHandler?.setCurrentQuality=="function"&&Array.isArray(e?.return?.memoizedProps?.qualityList)},set(e,i){let n=e.return.memoizedProps.qualityHandler,o=e?.return?.memoizedProps?.qualityList;o.includes(t)||(k.warning("当前直播没有【"+t+"】画质，自动选择最高画质"),o.sort((a,l)=>ee[a]?ee[l]?ee[a].sign-ee[l].sign:(r.error("画质【"+l+"】不存在"),0):(r.error("画质【"+a+"】不存在"),0)),t=o[o.length-1]),n.setCurrentQuality(t),r.success("成功设置画质为【"+t+"】");}});},unlockImageQuality(){r.info("解锁画质选择"),f.on(document,"click",'div[data-e2e="quality-selector"] > div',function(t,e){f.preventEvent(t);try{let i=b.getReactInstance(e),n=e.closest(".QualitySwitchNewPlugin"),o=e.closest(".QualitySwitchNewPlugin > div")||e.closest("div[data-index]"),a=b.getReactInstance(o),l={getCurrentQuality(){return i?.reactFiber?.key},getCurrentQualityList(){return a?.reactFiber?.return?.memoizedProps?.qualityList||a?.reactProps?.children?.ref?.current},setCurrentQuality(s){let d=a?.reactFiber?.return?.memoizedProps?.qualityHandler?.setCurrentQuality||a?.reactFiber?.child?.memoizedProps?.qualityHandler?.setCurrentQuality||a?.reactFiber?.return?.memoizedProps?.qualityHandler?.setCurrentQuality||a?.reactProps?.children?.ref?.current?.setCurrentQuality;if(typeof d=="function")d(s);else throw new Error("not find function：setCurrentQuality ")}};if(n){let d=b.getReactInstance(n)?.reactFiber?.child?.ref?.current;typeof d=="object"&&d!=null&&typeof d?.getCurrentQuality=="function"&&typeof d?.getCurrentQualityList=="function"&&typeof d?.setCurrentQuality=="function"&&(l=d);}let u=l.getCurrentQuality();r.info("当前选择的画质: "+u),r.info(["所有的画质: ",l.getCurrentQualityList()]),l.setCurrentQuality(u);}catch(i){r.error(i),k.error("切换画质失败");}},{capture:true});},waitToRemovePauseDialog(){r.info("监听【长时间无操作，已暂停播放】弹窗");let t=(n,o)=>{let a=f.text(n);if(a.includes("长时间无操作")&&a.includes("暂停播放")){k.info(`检测${o}：出现【长时间无操作，已暂停播放】弹窗`,{consoleLogContent:true});let l=b.getReactInstance(n);if(typeof l.reactContainer=="object"){let u=b.queryProperty(l.reactContainer,s=>typeof s.onClose=="function"?{isFind:true,data:s.onClose}:typeof s?.memoizedProps?.onClose=="function"?{isFind:true,data:s?.memoizedProps?.onClose}:{isFind:false,data:s.child})||l?.reactContainer?.memoizedState?.element?.props?.children?.props?.onClose;typeof u=="function"&&(k.success(`检测${o}：调用函数关闭弹窗`,{consoleLogContent:true}),u());}}},e=new b.LockFunction(()=>{h.getValue("live-waitToRemovePauseDialog")&&(K("body > div[elementtiming='element-timing']").forEach(n=>{t(n,"1");}),K('body > div:not([id="root"]):not(:empty)').forEach(n=>{t(n,"2");}));});const i=b.mutationObserver(document.body||document.documentElement,{config:{subtree:true,childList:true},immediate:true,callback(){e.run();}});return [()=>{i?.disconnect();}]},disableVideoAutoPlay(){f.waitAnyNode(['.basicPlayer[data-e2e="basicPlayer"] video',"#PlayerLayout .douyin-player video"],1e4).then(t=>{if(!t)return;t.autoplay=false,t.pause();let e=3e3,i=a=>{f.preventEvent(a),t.autoplay=false,t.pause(),r.success("成功禁止自动播放视频(直播)");};f.offAll(t,"play"),f.offAll(t,"pause"),f.on(t,"play",i,{capture:true});let n=()=>{let a=new KeyboardEvent("keydown",{bubbles:true,cancelable:true,key:"E",code:"KeyE"});document.body.dispatchEvent(a);};setTimeout(()=>{f.off(t,"play",i,{capture:true}),r.info("移除监听自动播放");let a=()=>{f.offAll(t,"play"),f.on(t,"play",l=>{r.info("播放-视频重载"),n();},{once:true,capture:true});};f.on(t,"pause",l=>{a();},{capture:true}),a();},e);});},changeBackgroundColor(){r.info("修改视频背景颜色");let t=h.getValue("live-changeBackgroundColor");return B(`
		div[id^="living_room_player_container"] div[data-anchor-id="living-background"] div:has(>.xgplayer-dynamic-bg),
		#LeftBackgroundLayout {
			background: ${t} !important;
		}
		div[id^="living_room_player_container"] div[data-anchor-id="living-background"] .xgplayer-dynamic-bg,
		#LeftBackgroundLayout .douyin-player-dynamic-background{
			visibility: hidden;
		}
		`)},autoCloseChatRoom(){xe.waitReactPropsToSet("#chatroom .chatroom_close","reactFiber",{check(t,e){return typeof t?.memoizedProps?.onClick=="function"},set(t,e){r.info("自动关闭聊天室-点击关闭聊天室按钮"),e.click();}});}},zt={init(){h.execMenu("douyin-redirect-url-home-to-root",()=>{this.redirectUrlHomeToRoot();});},redirectUrlHomeToRoot(){window.location.pathname==="/home"&&(r.info("从首页跳转到根目录"),window.location.href=window.location.origin+"/?is_from_mobile_home=1&recommend=1");}},qt=`/* 去除顶部的padding距离 */\r
#douyin-right-container {\r
  padding-top: 0;\r
}\r
/* 放大放大顶部的综合、视频、用户等header的宽度 */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) {\r
  width: 100vw;\r
}\r
/* 放大顶部的综合、视频、用户等header */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) > div {\r
  transform: scale(0.8);\r
}\r
/* 视频宽度 */\r
ul[data-e2e="scroll-list"] {\r
  padding: 0px 10px;\r
}\r
#sliderVideo {\r
  width: -webkit-fill-available;\r
}\r
/* 距离是顶部导航栏的高度 */\r
#search-content-area {\r
  margin-top: 65px;\r
}\r
/* 从其它页面进入搜索页面，例如路径是/root/search，会出现返回按钮 */\r
#douyin-header header {\r
  flex-direction: row-reverse !important;\r
}\r
#douyin-header header > div:nth-child(2) {\r
  position: unset !important;\r
}\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
  #sliderVideo {\r
    width: 100%;\r
  }\r
  /* 调整顶部搜索框的宽度 */\r
  #component-header\r
    div[data-click="doubleClick"]\r
    > div[data-click="doubleClick"]\r
    > div:has(input[data-e2e="searchbar-input"]) {\r
    width: -webkit-fill-available;\r
    padding-right: 0;\r
  }\r
}\r
`,Gt={init(){h.execMenuOnce("douyin-search-shieldReleatedSearches",()=>this.shieldReleatedSearches()),h.execMenuOnce("douyin-search-blockAIAsk",()=>this.blockAIAsk()),h.execMenuOnce("douyin-search-blockAskAI",()=>this.blockAskAI()),this.resizeSearchFilterBar();},resizeSearchFilterBar(){f.ready(()=>{const t=q("div:has(+#search-result-container)"),e=q("#search-result-container");if(!t||!e)return;const i=f.width(e);f.css(t,"width",i+"px");});},shieldReleatedSearches(){r.info("【屏蔽】相关搜索");let t=new b.LockFunction(()=>{L.isSearch()&&K('[id^="waterfall_item"]:has(.search-result-card p)').forEach(i=>{const n=i.querySelector("p");f.text(n).includes("相关搜索")&&f.remove(i);});});const e=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{t.run();}});return [y.addBlockCSS("#search-content-area > div > div:nth-child(2)"),B(`
			/* 把搜索结果宽度自适应 */
			#search-result-container{
        width: auto !important;
			}`),()=>{e.disconnect();}]},blockAIAsk(){return r.info("【屏蔽】AI问一问"),y.addBlockCSS("#search-content-area > div > div:nth-child(2) > div > div:first-child")},blockAskAI(){return r.info("【屏蔽】问问AI"),y.addBlockCSS('#search-toolbar-container>div:has(svg path[d="M14.837 12.506a42.284 42.284 0 0 0 1.96 4.006l.433.775-.992.5-.53-1.001-.208-.4-.017-.032-.034-.009a7.2 7.2 0 0 0-2.023-.233 7.247 7.247 0 0 0-1.647.234l-.034.009-.015.031-.21.4-.53 1-.99-.5.432-.774a42.367 42.367 0 0 0 1.96-4.006l.535-1.255c.456.082.918.082 1.375 0l.535 1.255zm4.538-1.914c-.09.28-.145.567-.164.855-.02.317-.032.64-.032.96v2.823c0 .32.01.643.032.96.019.288.074.575.164.854h-1.472c.09-.28.145-.566.164-.854.021-.32.032-.644.032-.96v-2.823c0-.316-.01-.64-.032-.96a3.556 3.556 0 0 0-.164-.855h1.472zm-6.086 2.411c-.28.684-.585 1.377-.907 2.06l-.063.133.146-.02a8.351 8.351 0 0 1 2.299 0l.145.02-.062-.133a42.237 42.237 0 0 1-.907-2.06l-.326-.796-.325.796z"])')}},Yt={init(){Gt.init(),h.execMenuOnce("mobileMode",()=>this.mobileMode()),h.execMenuOnce("dy-search-disableClickToEnterFullScreen",()=>this.disableClickToEnterFullScreen()),h.execMenuOnce("live-setSearchResultFilterWithVideoStyle",t=>this.setSearchResultFilterWithVideoStyle(t.value));},mobileMode(){r.info("搜索-手机模式");let t=[];return t.push(B(qt)),t.push(B(`
			@media screen and (max-width: 550px){
				div#search-body-container {
					display: flex;
				}
				div#search-body-container #component-Navigation {
					flex: 0;
				}
				div#search-body-container #douyin-right-container {
					flex: 1 auto;
				}
				div#search-body-container #douyin-right-container #search-content-area > div {
					width: 100% !important;
				}
				div#search-body-container #douyin-right-container #search-content-area > div > div > div {
					width: 100% !important;
					margin-left: 0px;
					margin-right: 0px;
					padding-left: 0px;
					padding-right: 0px;
				}
				/* 上面的搜索结果筛选 */
				#search-content-area > div >div> div:first-child > div:first-child > div:last-child{
					overflow: auto;
					text-wrap: nowrap;
					height: auto;
				}
				/* 视频右侧的TA的作品↓ */
				#searchSideCard{
					width: unset !important;
				}
				#searchSideCard > div{
					padding: 0px !important;
				}
				#searchSideCard > div:has(>div+svg),
				#searchSideCard ul[data-e2e="scroll-list"]{
					padding: 0px 10px !important;
				}
				#searchSideCard ul[data-e2e="scroll-list"] .video-playing-item > div{
					width: auto;
				}
				/* 视频右侧的TA的作品↑ */
				/* 悬浮的筛选 */
				#douyin-right-container #douyin-header{
        			background-color: var(--color-bg-b0);
				}
				xg-right-grid{
					margin: auto !important;
				}
			}
		`)),f.waitNode("#relatedVideoCard").then(e=>{r.info("评论区展开的className："+e.className),t.push(B(`
					html[data-vertical-screen]
						#sliderVideo[data-e2e="feed-active-video"]
						#videoSideBar:has(#relatedVideoCard[class="${e.className}"]) {
							width: 100vw !important;
					}`));}),t},disableClickToEnterFullScreen(){r.info("搜索-禁止点击视频区域进入全屏");const t=f.on(document,"click",".focusPanel",(i,n)=>{if(!L.isSearch())return;f.preventEvent(i);let l=(n.parentElement?.parentElement).querySelector("video");l?l.paused?(l.play(),r.info(".focusPanel：播放视频")):(l.pause(),r.info(".focusPanel：暂停视频")):k.error(".focusPanel未找到 video标签",{isHTML:false});},{capture:true}),e=f.on(document,"click","#sliderVideo video",(i,n)=>{if(!L.isSearch())return;f.preventEvent(i);let o=n;o.paused?(o.play(),r.info("#sliderVideo video：播放视频")):(o.pause(),r.info("#sliderVideo video：暂停视频"));},{capture:true});return [t.off,e.off]},setSearchResultFilterWithVideoStyle(t="one"){if(r.info(`设置搜索结果-按视频过滤的显示样式：${t}`),t==="one")return it.set({name:"SEARCH_RESULT_LIST_TYPE",value:encodeURIComponent('"single"')}),B(`
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(100% - 21px);
				}
			}
			`);if(t==="double")return it.set({name:"SEARCH_RESULT_LIST_TYPE",value:encodeURIComponent('"multi"')}),B(`	
			@media screen and (max-width: 800px){
				.search-horizontal-new-layout ul[data-e2e="scroll-list"] li{
					width: calc(50% - 21px);
				}
			}
			`)}},jt={init(){h.exec(["shieldLeftNavigator","search-shieldLeftNavigator"],()=>this.shieldLeftNavigator(),t=>{const[e,i]=t;let n=h.getValue(e),o=h.getValue(i);if(L.isSearch()){if(o==1)return  true;if(o==0)return  false}return n}),h.execMenuOnce("shieldLeftNavigator-tab-home",()=>this.block_tab_home()),h.execMenuOnce("shieldLeftNavigator-tab-recommend",()=>this.block_tab_recommend()),h.execMenuOnce("shieldLeftNavigator-tab-follow",()=>this.block_tab_follow()),h.execMenuOnce("shieldLeftNavigator-tab-friend",()=>this.block_tab_friend()),h.execMenuOnce("shieldLeftNavigator-tab-user_self",()=>this.block_tab_user_self()),h.execMenuOnce("shieldLeftNavigator-tab-live",()=>this.block_tab_live()),h.execMenuOnce("shieldLeftNavigator-tab-vs",()=>this.block_tab_vs()),h.execMenuOnce("shieldLeftNavigator-tab-series",()=>this.block_tab_series()),h.execMenuOnce("shieldLeftNavigator-tab-ai-search",()=>this.block_tab_ai_search());},shieldLeftNavigator(){r.info("【屏蔽】左侧导航栏");let t=[];return t.push(y.addBlockCSS("#douyin-navigation")),t.push(B(`
			/* 修复顶部导航栏的宽度 */
			#douyin-header{
				width: 100%;
			}`)),t},block_tab_home(){return r.info("【屏蔽】精选"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-discover)')},block_tab_recommend(){return r.info("【屏蔽】推荐"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-recommend)')},block_tab_follow(){return r.info("【屏蔽】关注"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-follow)')},block_tab_friend(){return r.info("【屏蔽】朋友"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-friend)')},block_tab_user_self(){return r.info("【屏蔽】我的"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self)')},block_tab_user_self_like(){return r.info("【屏蔽】喜欢"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_like)')},block_tab_user_self_collection(){return r.info("【屏蔽】收藏"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_collection)')},block_tab_user_self_record(){return r.info("【屏蔽】观看历史"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div > div:has(.tab-user_self_record)')},block_tab_live(){return r.info("【屏蔽】直播"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-live)')},block_tab_vs(){return r.info("【屏蔽】放映厅"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-vs)')},block_tab_series(){return r.info("短剧"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-series)')},block_tab_ai_search(){return r.info("【屏蔽】AI搜索"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has([class^="tab-aisearch"])')},block_tab_channel_300203(){return r.info("【屏蔽】知识"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300203)')},block_tab_channel_300205(){return r.info("【屏蔽】游戏"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300205)')},block_tab_channel_300206(){return r.info("【屏蔽】二次元"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300206)')},block_tab_channel_300209(){return r.info("【屏蔽】音乐"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300209)')},block_tab_channel_300204(){return r.info("【屏蔽】美食"),y.addBlockCSS('div[data-e2e="douyin-navigation"] > div > div > div > div:has(.tab-channel_300204)')}},Qt=`/* 从顶部往下弹出的下载抖音电脑版的drawer提示 */\r
#douyin-web-download-guide-container\r
/* 视频信息区域的 及时接收作品更新提醒 下载电脑客户端 */\r
/* 但是这个CSS又会屏蔽右键菜单 */\r
/*.basePlayerContainer xg-bar.xg-right-bar + div:not(:has(>svg))*/ ,\r
/* 下载客户端，使用壁纸 */\r
div:has(+#wallpaper-modal),\r
/* 下载客户端，实时接收消息通知 */\r
/* 下载客户端，实时接收好友消息 */\r
div:has(> a[download*="douyin-downloade"]):has(+.popShadowAnimation),\r
div:has(> a[download*="douyin-downloade"]):has(+div>[data-e2e="listDlgTest-container"]),\r
/* 客户端登录访问更便捷 */\r
div:has(> a[download*="douyin-downloade"]):has(+.userMenuPanelShadowAnimation),\r
/* 前往电脑客户端，即享下载视频 */\r
[data-e2e="video-share-container"] div:has(>div>div> a[download*="douyin-downloader"]):first-child,\r
/* so.douyin.com的广告item */\r
.card-item:has(.h5-ad-video-card),\r
.card-item:has([data-is-ad="true"]) {\r
  display: none !important;\r
}\r
`,Jt=`/* 资料右边的 下载桌面客户端，桌面快捷访问 */\r
div[data-e2e="user-detail"] div:has(> div > a[href*="douyin-pc"]) {\r
  display: none !important;\r
}\r
`,Zt={init(){B(Jt),f.ready(()=>{h.execMenu("dy-user-addShowUserUID",()=>{this.addShowUserUID();});});},addShowUserUID(){xe.waitReactPropsToSet('[data-e2e="user-detail"] [data-e2e="user-info"]',"reactFiber",{msg:"显示UID",check(t){return typeof t?.return?.memoizedProps?.userInfo?.uid=="string"},set(t,e){let i=t?.return?.memoizedProps?.userInfo?.uid;f.remove(e.querySelectorAll(".gm-user-uid"));let n=f.createElement("p",{className:"gm-user-uid",innerHTML:`
							<span>UID：${i}</span>
						`},{style:"color: var(--color-text-t3);margin-right: 20px;font-size: 12px;line-height: 20px;cursor: pointer;"});f.on(n,"click",o=>{f.preventEvent(o),b.copy(i),k.success("复制成功");}),e.appendChild(n);}});}},Xt=`/* 单个视频页面右侧的 下载客户端，桌面快捷访问 */\r
div[data-e2e="video-detail"] div > :has(> div:last-child > a[href*="douyin-pc-web"]) {\r
  display: none !important;\r
}\r
`,ei={init(){B(Xt);}},Se={$data:{__storeApiFn:null,get storeApiValue(){return this.__storeApiFn||(this.__storeApiFn=new ne.Dictionary),this.__storeApiFn}},getStorageApi(t){if(this.hasStorageApi(t))return this.$data.storeApiValue.get(t)},hasStorageApi(t){return this.$data.storeApiValue.has(t)},setStorageApi(t,e){this.$data.storeApiValue.set(t,e);},initComponentsStorageApi(t,e,i){let n;this.hasStorageApi(t)?n=this.getStorageApi(t):n=i,this.setComponentsStorageApiProperty(e,n);},setComponentsStorageApiProperty(t,e){Reflect.set(t.props,N,e);}},ti=function(t,e,i,n,o,a="",l,u,s,d){let c={text:t,type:"input",isNumber:false,isPassword:false,attributes:{},props:{},description:n,afterAddToUListCallBack:s,getValue(){return this.props[N].get(e,i)},callback(p,v,g){this.props[N].set(e,v);},placeholder:a};return Reflect.set(c.attributes,oe,e),Reflect.set(c.attributes,ae,i),Se.initComponentsStorageApi("input",c,{get(p,v){return h.getValue(p,v)},set(p,v){h.setValue(p,v);}}),c},lt=function(t,e,i,n,o,a,l="请至少选择一个选项",u,s){let d=[];typeof n=="function"?d=n():d=n;let c={text:t,type:"select-multiple",description:a,placeholder:l,attributes:{},props:{},getValue(){return this.props[N].get(e,i)},selectConfirmDialogDetails:u,callback(p){let v=this.props[N],g=[];p.forEach(C=>{g.push(C.value);}),r.info("多选-选择：",g),v.set(e,g);},data:d};return Reflect.set(c.attributes,oe,e),Reflect.set(c.attributes,ae,i),Se.initComponentsStorageApi("select-multiple",c,{get(p,v){return h.getValue(p,v)},set(p,v){h.setValue(p,v);}}),c},m=function(t,e,i,n,o,a,l,u){let s={text:t,type:"switch",description:o,disabled:l,attributes:{},props:{},getValue(){return this.props[N].get(e,i)},callback(d,c){let p=!!c;r.success(`${p?"开启":"关闭"} ${t}`),this.props[N].set(e,p),typeof u=="function"&&u(d,p);},afterAddToUListCallBack:a};return Reflect.set(s.attributes,oe,e),Reflect.set(s.attributes,ae,i),Se.initComponentsStorageApi("switch",s,{get(d,c){return h.getValue(d,c)},set(d,c){h.setValue(d,c);}}),s};class ii{option;constructor(e){this.option=e;}async showView(){let e=H.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <form class="rule-form-container" onsubmit="return false">
                        <ul class="rule-form-ulist"></ul>
                        <input type="submit" style="display: none;" />
                    </form>
                    `,html:true},btn:b.assign({ok:{callback:async()=>{await a();}}},this.option.btn||{},true),drag:true,mask:{enable:true},style:`
                ${H.config.cssText.panelCSS}
                
                .rule-form-container {
                    
                }
                .rule-form-container li{
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    padding: 5px 20px;
                    gap: 10px;
                }
				.rule-form-ulist-dynamic{
					--button-margin-top: 0px;
					--button-margin-right: 0px;
					--button-margin-bottom: 0px;
					--button-margin-left: 0px;
					display: flex;
					flex-direction: column;
					align-items: flex-start;
					padding: 5px 0px 5px 20px;
				}
				.rule-form-ulist-dynamic__inner{
					width: 100%;
				}
				.rule-form-ulist-dynamic__inner-container{
					display: flex;
					align-items: center;
				}
				.dynamic-forms{
					width: 100%;
				}
                .pops-panel-item-left-main-text{
                    max-width: 150px;
                }
                .pops-panel-item-right-text{
                    padding-left: 30px;
                }
                .pops-panel-item-right-text,
                .pops-panel-item-right-main-text{
                    text-overflow: ellipsis;
                    overflow: hidden;
                    white-space: nowrap;
                }
				.pops-panel-item-left-desc-text{
					line-height: normal;
					margin-top: 6px;
					font-size: 0.8em;
					color: rgb(108, 108, 108);
				}

                ${this.option?.style??""}
            `,width:typeof this.option.width=="function"?this.option.width():window.innerWidth>500?"500px":"88vw",height:typeof this.option.height=="function"?this.option.height():window.innerHeight>500?"500px":"80vh"}),i=e.$shadowRoot.querySelector(".rule-form-container");e.$shadowRoot.querySelector("input[type=submit]");let n=e.$shadowRoot.querySelector(".rule-form-ulist"),o=await this.option.getView(await this.option.data());n.appendChild(o);const a=async()=>{(await this.option.onsubmit(i,await this.option.data())).success&&(e.close(),await this.option.dialogCloseCallBack(true));};}}class ni{option;$data={isFilteredData:[]};constructor(e){this.option=e;}showView(){let e=H.alert({title:{text:this.option.title,position:"center"},content:{text:`
                <div class="filter-container"></div>
                `},btn:{ok:{text:"关闭",type:"default"}},drag:true,mask:{enable:true},width:window.innerWidth>500?"350px":"80vw",height:window.innerHeight>500?"300px":"70vh",style:`
            .filter-container{
                height: 100%;
                display: flex;
                flex-direction: column;
                gap: 20px;
            }
            .filter-container button{
                text-wrap: wrap;
                padding: 8px;
                height: auto;
                text-align: left;
            }
            `}),i=e.$shadowRoot.querySelector(".filter-container"),n=document.createDocumentFragment();this.option.filterOption.forEach(o=>{let a=f.createElement("button",{innerText:o.name},{type:"button"}),l=async()=>{this.$data.isFilteredData=[],(await this.option.getAllRuleInfo()).forEach(async s=>{await o.filterCallBack(s.data)?f.show(s.$el,false):(f.hide(s.$el,false),this.$data.isFilteredData.push(s.data));}),typeof this.option.execFilterCallBack=="function"&&await this.option.execFilterCallBack(),e.close();};f.on(a,"click",async u=>{f.preventEvent(u),!(typeof o.callback=="function"&&!await o.callback(u,l))&&await l();}),n.appendChild(a);}),i.appendChild(n);}getFilteredData(){return this.$data.isFilteredData}}class oi{option;constructor(e){this.option=e;}async showView(e){let i=H.confirm({title:{text:this.option.title,position:"center"},content:{text:`
                    <div class="rule-view-container">
                    </div>
                    `,html:true},btn:{merge:true,reverse:false,position:"space-between",ok:{enable:this.option?.bottomControls?.add?.enable||true,type:"primary",text:"添加",callback:async l=>{this.showEditView(false,await this.option.getAddData(),i.$shadowRoot);}},close:{enable:true,callback(l){i.close();}},cancel:{enable:this.option?.bottomControls?.filter?.enable||false,type:"default",text:"过滤",callback:async(l,u)=>{if(typeof this.option?.bottomControls?.filter?.callback=="function"){let c=await this.option.bottomControls.filter.callback();if(typeof c=="boolean"&&!c)return}let s=()=>Array.from(i.$shadowRoot.querySelectorAll(".rule-view-container .rule-item")),d=u.target.closest(".pops-confirm-btn").querySelector(".pops-confirm-btn-cancel span");if(f.text(d).includes("取消")){let c=await this.option?.bottomControls?.filter?.cancelFilterCallback?.({$button:d,getAllRuleElement:s});if(typeof c=="boolean"&&!c)return;s().forEach(p=>{f.show(p,false);}),f.text(d,"过滤");}else {let c=new ni({title:this.option.bottomControls?.filter?.title??"过滤规则",filterOption:this.option.bottomControls?.filter?.option||[],execFilterCallBack:async()=>{f.text(d,"取消过滤"),await this.option.bottomControls?.filter?.execFilterCallBack?.();const p=c.getFilteredData();p.length&&f.text(d,`取消过滤(${p.length})`);},getAllRuleInfo:()=>s().map(p=>({data:this.parseRuleItemElement(p).data,$el:p}))});c.showView();}}},other:{enable:this.option?.bottomControls?.clear?.enable||true,type:"xiaomi-primary",text:`清空所有(${(await this.option.data()).length})`,callback:l=>{let u=H.confirm({title:{text:"提示",position:"center"},content:{text:"确定清空所有的数据？",html:false},btn:{ok:{enable:true,callback:async s=>{if(r.success("清空所有"),typeof this.option?.bottomControls?.clear?.callback=="function"&&this.option.bottomControls.clear.callback(),(await this.option.data()).length){k.error("清理失败");return}else k.success("清理成功");await this.updateDeleteAllBtnText(i.$shadowRoot),this.clearContent(i.$shadowRoot),u.close();}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}}},mask:{enable:true},width:window.innerWidth>500?"500px":"88vw",height:window.innerHeight>500?"500px":"80vh",style:`
            ${H.config.cssText.panelCSS}
            
            .rule-item{
                display: flex;
                align-items: center;
                line-height: normal;
                font-size: 16px;
                padding: 4px 8px;
                gap: 8px;
            }
            .rule-name{
                flex: 1;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            .rule-controls{
                display: flex;
                align-items: center;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
                gap: 8px;
                padding: 0px;
            }
            .rule-controls-enable{
                
            }
            .rule-controls-edit{
                
            }
            .rule-controls-delete{
                
            }
            .rule-controls-edit,
            .rule-controls-delete{
                width: 16px;
                height: 16px;
                cursor: pointer;
            }
            `}),n=await this.option.data(),o=false,a=0;for(let l=0;l<n.length;l++){let u=n[l],s=await this.appendRuleItemElement(i.$shadowRoot,u),d=true;typeof e=="function"?d=e(u):typeof e=="number"&&!isNaN(e)&&(d=await this.option.bottomControls?.filter?.option[e]?.filterCallBack(u)??d),d||(o=true,f.hide(s,false),a++);}if(o){let l=i.$shadowRoot.querySelector(".pops-confirm-btn-cancel span");f.text(l,`取消过滤${a?`(${a})`:""}`);}}showEditView(e,i,n,o,a,l){let u=async d=>{if(d){if(typeof l=="function"){let c=await this.option.getData(i);l(c);}}else if(e||await this.option.deleteData(i),typeof a=="function"){let c=await this.option.getData(i);a(c);}};new ii({title:e?"编辑":"添加",data:()=>i,dialogCloseCallBack:u,getView:async d=>await this.option.itemControls.edit.getView(d,e),btn:{ok:{enable:true,text:e?"修改":"添加"},cancel:{callback:async(d,c)=>{d.close(),await u(false);}},close:{callback:async(d,c)=>{d.close(),await u(false);}}},onsubmit:async(d,c)=>{let p=await this.option.itemControls.edit.onsubmit(d,e,c);return p.success?e?(k.success("修改成功"),n&&await this.updateRuleItemElement(p.data,o,n)):n&&await this.appendRuleItemElement(n,p.data):e&&r.error("修改失败"),p},style:this.option.itemControls.edit.style,width:this.option.itemControls.edit.width,height:this.option.itemControls.edit.height}).showView();}parseViewElement(e){let i=e.querySelector(".rule-view-container"),n=e.querySelector(".pops-confirm-btn button.pops-confirm-btn-other");return {$container:i,$deleteBtn:n}}parseRuleItemElement(e){let i=e.querySelector(".rule-controls-enable"),n=i.querySelector(".pops-panel-switch"),o=i.querySelector(".pops-panel-switch__input"),a=i.querySelector(".pops-panel-switch__core"),l=e.querySelector(".rule-controls-edit"),u=e.querySelector(".rule-controls-delete");return {$enable:i,$enableSwitch:n,$enableSwitchInput:o,$enableSwitchCore:a,$edit:l,$delete:u,data:Reflect.get(e,"data-rule")}}async createRuleItemElement(e,i){let n=await this.option.getDataItemName(e),o=f.createElement("div",{className:"rule-item",innerHTML:`
			<div class="rule-name">${n}</div>
			<div class="rule-controls">
				<div class="rule-controls-enable">
					<div class="pops-panel-switch">
						<input class="pops-panel-switch__input" type="checkbox">
						<span class="pops-panel-switch__core">
							<div class="pops-panel-switch__action">
							</div>
						</span>
					</div>
				</div>
				<div class="rule-controls-edit">
					${H.config.iconSVG.edit}
				</div>
				<div class="rule-controls-delete">
					${H.config.iconSVG.delete}
				</div>
			</div>
			`});Reflect.set(o,"data-rule",e);let a="pops-panel-switch-is-checked";const{$enable:l,$enableSwitch:u,$enableSwitchCore:s,$enableSwitchInput:d,$delete:c,$edit:p}=this.parseRuleItemElement(o);return this.option.itemControls.enable.enable?(f.on(s,"click",async v=>{let g=false;u.classList.contains(a)?(u.classList.remove(a),g=false):(u.classList.add(a),g=true),d.checked=g,await this.option.itemControls.enable.callback(e,g);}),await this.option.itemControls.enable.getEnable(e)&&u.classList.add(a)):l.remove(),this.option.itemControls.edit.enable?f.on(p,"click",v=>{f.preventEvent(v),this.showEditView(true,e,i,o,g=>{e=null,e=g;});}):p.remove(),this.option.itemControls.delete.enable?f.on(c,"click",v=>{f.preventEvent(v);let g=H.confirm({title:{text:"提示",position:"center"},content:{text:"确定删除该条数据？",html:false},btn:{ok:{enable:true,callback:async C=>{r.success("删除数据"),await this.option.itemControls.delete.deleteCallBack(e)?(k.success("成功删除该数据"),o.remove(),await this.updateDeleteAllBtnText(i),g.close()):k.error("删除该数据失败");}},cancel:{text:"取消",enable:true}},mask:{enable:true},width:"300px",height:"200px"});}):c.remove(),o}async appendRuleItemElement(e,i){let{$container:n}=this.parseViewElement(e),o=[],a=Array.isArray(i)?i:[i];for(let l=0;l<a.length;l++){let u=a[l],s=await this.createRuleItemElement(u,e);n.appendChild(s),o.push(s);}return await this.updateDeleteAllBtnText(e),o}async updateRuleContaienrElement(e){this.clearContent(e);const{$container:i}=this.parseViewElement(e);let n=await this.option.data();await this.appendRuleItemElement(e,n),await this.updateDeleteAllBtnText(e);}async updateRuleItemElement(e,i,n){let o=await this.createRuleItemElement(e,n);i.after(o),i.remove();}clearContent(e){const{$container:i}=this.parseViewElement(e);f.html(i,"");}setDeleteBtnText(e,i,n=false){const{$deleteBtn:o}=this.parseViewElement(e);n?f.html(o,i):f.text(o,i);}async updateDeleteAllBtnText(e){let i=await this.option.data();this.setDeleteBtnText(e,`清空所有(${i.length})`);}}class ai{option;constructor(e){this.option=e;}getAllRule(){return Ve(this.option.STORAGE_API_KEY,[])}setAllRule(e){ve(this.option.STORAGE_API_KEY,e);}clearAllRule(){this.setAllRule([]);}getRule(e){const i=this.getAllRule(),n=i.findIndex(o=>o.uuid===e);if(n!==-1)return i[n]}setRule(e){const i=this.getAllRule(),n=i.findIndex(a=>a.uuid===e.uuid);let o=false;return n!==-1&&(i[n]=e,this.setAllRule(i),o=true),o}addRule(e){const i=this.getAllRule(),n=i.findIndex(a=>a.uuid===e.uuid);let o=false;return n!==-1||(i.push(e),this.setAllRule(i),o=true),o}updateRule(e){const i=this.getAllRule(),n=i.findIndex(o=>o.uuid===e.uuid);n!==-1?i[n]=e:i.push(e),this.setAllRule(i);}deleteRule(e){const i=this.getAllRule(),n=typeof e=="string"?e:e.uuid,o=i.findIndex(a=>a.uuid===n);return o!==-1?(i.splice(o,1),this.setAllRule(i),true):false}importRules(e){const i=H.alert({title:{text:"请选择导入方式",position:"center"},content:{text:`
                    <div class="btn-control" data-mode="local">本地导入</div>
                    <div class="btn-control" data-mode="network">网络导入</div>
                    <div class="btn-control" data-mode="clipboard">剪贴板导入</div>
                `,html:true},btn:{ok:{enable:false},close:{enable:true,callback(s,d){s.close();}}},mask:{enable:true},drag:true,width:te.info.width,height:te.info.height,style:`
                .btn-control{
                    display: inline-block;
                    margin: 10px;
                    padding: 10px;
                    border: 1px solid #ccc;
                    border-radius: 5px;
                    cursor: pointer;
                }
            `}),n=i.$shadowRoot.querySelector(".btn-control[data-mode='local']"),o=i.$shadowRoot.querySelector(".btn-control[data-mode='network']"),a=i.$shadowRoot.querySelector(".btn-control[data-mode='clipboard']"),l=async s=>{let d=this.getAllRule();const c=[],p=[];let v=false;for(let C=0;C<s.length;C++){const x=s[C],w=d.findIndex(S=>S.uuid===x.uuid);w!==-1?p.push({index:w,data:x}):c.push(x);}if(p.length&&await new Promise(x=>{H.alert({title:{text:"覆盖规则",position:"center"},content:{text:`存在相同的uuid的规则 ${p.length}条，是否进行覆盖？`,html:true},btn:{close:{callback(w,S){w.close(),x(false);}},ok:{text:"覆盖",callback(w,S){w.close(),x(true);}}},width:te.info.width,height:te.info.height,mask:{enable:true},drag:true});})){for(const x of p)d[x.index]=x.data;v=true;}c.length&&(d=d.concat(c)),this.setAllRule(d);const g=`共 ${s.length} 条规则，新增 ${c.length} 条，覆盖 ${v?p.length:0} 条`;k.success(g),e?.();},u=s=>new Promise(async d=>{const c=b.toJSON(s);if(!Array.isArray(c)){r.error(c),k.error("导入失败，格式不符合（不是数组）",{consoleLogContent:true}),d(false);return}if(!c.length){k.error("导入失败，解析出的数据为空",{consoleLogContent:true}),d(false);return}await l(c),d(true);});f.on(n,"click",s=>{f.preventEvent(s),i.close();const d=f.createElement("input",{type:"file",accept:".json"});f.on(d,["propertychange","input"],c=>{if(!d.files?.length)return;const p=d.files[0],v=new FileReader;v.onload=()=>{u(v.result);},v.readAsText(p,"UTF-8");}),d.click();}),f.on(o,"click",s=>{f.preventEvent(s),i.close();const d=H.prompt({title:{text:"网络导入",position:"center"},content:{text:"",placeholder:"请填写URL",focus:true},btn:{close:{enable:true,callback(v,g){v.close();}},ok:{text:"导入",callback:async(v,g)=>{const C=v.text;if(b.isNull(C)){k.error("请填入完整的url");return}const x=k.loading("正在获取配置..."),w=await Ee.get(C,{allowInterceptConfig:false});if(x.close(),!w.status){r.error(w),k.error("获取配置失败",{consoleLogContent:true});return}await u(w.data.responseText)&&v.close();}},cancel:{enable:false}},mask:{enable:true},drag:true,width:te.info.width,height:"auto"}),c=d.$shadowRoot.querySelector("input"),p=d.$shadowRoot.querySelector(".pops-prompt-btn-ok");f.on(c,["input","propertychange"],v=>{f.val(c)===""?f.attr(p,"disabled","true"):f.removeAttr(p,"disabled");}),f.listenKeyboard(c,"keydown",(v,g,C)=>{v==="Enter"&&C.length===0&&f.val(c)!==""&&f.trigger(p,"click");}),f.trigger(c,"input");}),f.on(a,"click",async s=>{f.preventEvent(s),i.close();const d=await b.getClipboardInfo();if(d.error!=null){k.error(d.error.toString());return}if(d.content.trim()===""){k.warning("获取到的剪贴板内容为空");return}await u(d.content);});}exportRules(e="rule.json"){const i=this.getAllRule(),n=new Blob([JSON.stringify(i,null,4)]),o=globalThis.URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=e,a.click(),setTimeout(()=>{globalThis.URL.revokeObjectURL(o);},1500);}}class st{$data={dislike_request_queue:[]};parseAwemeInfoDictData(e,i=false){let n=e?.authorInfo||e?.author,o=n?.nickname?.toString(),a=n?.uid?.toString(),l=e?.desc?.toString(),u=e?.music?.album,s=e?.music?.author,d=e?.music?.title,c=e?.stats?.collectCount||e?.statistics?.collect_count,p=e?.stats?.commentCount||e?.statistics?.comment_count,v=e?.stats?.diggCount||e?.statistics?.digg_count,g=e?.stats?.shareCount||e?.statistics?.share_count,C=e?.video?.duration,x=e?.textExtra||e?.text_extra,w=[],S=false,T=false,V=false,F=false,_=e?.riskInfos?.content||e?.risk_infos?.content,D,$=[],E=e?.aweme_type===68;typeof x=="object"&&Array.isArray(x)&&x?.forEach(M=>{let O=M?.hashtagName||M?.hashtag_name;typeof O=="string"&&O.trim()!=""&&w.push(O);});let I,R,U=e?.videoTag||e?.video_tag,Y=[],J=[],j=e?.aweme_id||e?.awemeId,re,W,le,fe,ye,G=[],ge=false,Ue,Ke;typeof U=="object"&&Array.isArray(U)&&U.forEach(M=>{let O=M?.tagName||M?.tag_name,Z=M?.tagId||M?.tag_id;if(typeof O=="string"&&O.trim()!=""&&Y.push(O),typeof Z=="number"||typeof Z=="string"){let X=Z.toString();X.trim()!=""&&X!="0"&&J.push(X);}});const $e=e?.cellRoom||e?.cell_room;if(typeof $e=="object"&&$e!=null){S=true,i&&r.success("直播间：cellRoom is not null");let M=$e.rawdata;typeof M=="string"&&(M=b.toJSON(M)),typeof M=="object"&&M!=null&&(re=M?.owner?.web_rid,W=M?.title,le=M?.owner?.nickname,fe=M?.user_count,ye=M?.dynamic_label?.splice_label?.text,typeof re!="string"&&(re=void 0),typeof W!="string"&&(W=void 0),typeof le!="string"&&(le=void 0),typeof fe!="number"&&(fe=void 0),typeof ye!="string"&&(ye=void 0));}T=[()=>{if(e.isAds||e.is_ads)return i&&r.success("广告：isAds is true"),true},()=>{if(typeof e.rawAdData=="string"&&b.isNotNull(e.rawAdData)||typeof e.raw_ad_data=="string"&&b.isNotNull(e.raw_ad_data))return i&&r.success("广告：rawAdData is not null"),true},()=>{if(e.webRawData){if(e.webRawData?.brandAd?.is_ad)return i&&r.success("广告：webRawData.brandAd.is_ad is 1"),true;if(e.webRawData?.insertInfo?.is_ad)return i&&r.success("广告：webRawData.insertInfo.is_ad is true"),true}},()=>{if(typeof e?.web_raw_data=="string"){const M=b.toJSON(e.webRawData);if(typeof M?.brand_ad=="string"&&b.toJSON(M.brand_ad)?.is_ad)return i&&r.success("广告：web_raw_data.brand_ad.is_ad is 1"),true}}].some(M=>M()),(typeof _=="string"&&_.trim()===""||typeof _!="string")&&(_=void 0);let be=e?.seriesInfo||e?.series_info;if(typeof be=="object"&&be!=null){V=true,D=be?.seriesName||be?.series_name;let M=be?.seriesContentTypes||be?.series_content_types;Array.isArray(M)&&M.forEach(O=>{let Z=O.name;$.push(Z);});}let _e=e?.mixInfo||e?.mix_info;typeof _e=="object"&&b.isNotNull(_e)&&(I=_e?.mixName||_e?.mix_name,R=_e?.desc),E&&(C=void 0);let Be=[],We=e?.suggest_words||e?.suggest_words?.suggest_words||e?.suggestWords;Array.isArray(We)&&We.forEach(M=>{let O=M?.words;Array.isArray(O)&&O.forEach(Z=>{let X=Z?.word;typeof X=="string"&&X.trim()!==""&&Be.push(X);});}),Be=[...new Set(Be)];let De="",ze=e?.author?.account_cert_info;if(typeof ze=="string"){let M=b.toJSON(ze);typeof M.label_text=="string"&&(De=M.label_text);}else typeof e?.authorInfo?.accountCertInfo?.labelText=="string"&&(De=e?.authorInfo?.accountCertInfo?.labelText);let vt=e?.author?.custom_verify||e?.authorInfo?.customVerify||"",yt=e?.author?.enterprise_verify_reason||e?.authorInfo?.enterpriseVerifyReason||"";const se=e?.entertainmentProductInfo||e?.entertainment_product_info;typeof se=="object"&&se!=null&&(typeof se.product_id=="number"&&(Ue=se.product_id.toString()),typeof se.title=="string"&&(Ke=se.title),(typeof se?.buy_schema=="string"||typeof se?.buy_panel_schema=="string")&&(ge=true));const qe=e?.video?.bitRateList||e?.video?.bit_rate;return Array.isArray(qe)&&(qe.forEach(M=>{const O={},Z=M?.bitRate||M?.bit_rate;typeof Z=="number"&&(O.bitRate=Z);const X=M?.dataSize||M?.play_addr?.data_size;typeof X=="number"&&(O.dataSize=X);const Ge=M?.format;typeof Ge=="string"&&(O.format=Ge);const Ye=M?.isH265||M?.is_h265;typeof Ye=="number"&&(O.isH265=Ye);const je=M?.fps||M?.FPS;typeof je=="number"&&(O.fps=je);const Qe=M?.gearName||M?.gear_name;typeof Qe=="string"&&(O.gearName=Qe);const Je=M?.qualityType||M?.quality_type;typeof Je=="number"&&(O.qualityType=Je);const Ze=M?.width||M?.play_addr?.width;typeof Ze=="number"&&(O.width=Ze);const Xe=M?.height||M?.play_addr?.height;typeof Xe=="number"&&(O.height=Xe),G.push(O);}),G=[...new Set(G)]),{awemeId:j,nickname:o,uid:a,desc:l,textExtra:w,videoTag:Y,videoTagId:J,suggestWord:Be,musicAlbum:u,musicAuthor:s,musicTitle:d,authorAccountCertInfo:De,authorCustomVerify:vt,authorEnterpriseVerifyReason:yt,riskInfoContent:_,seriesInfoName:D,seriesInfoContentTypes:$,mixInfoName:I,mixInfoDesc:R,collectCount:c,commentCount:p,diggCount:v,shareCount:g,duration:C,liveStreamRoomId:re,liveStreamRoomTitle:W,liveStreamNickName:le,liveStreamRoomUserCount:fe,liveStreamRoomDynamicSpliceLabel:ye,videoBitRateList:G,productId:Ue,productTitle:Ke,isLive:S,isAds:T,isSeriesInfo:V,isMixInfo:F,isPicture:E,isProduct:ge}}async checkFilterWithRule(e,i){if(e.videoInfoValue==null||e.ruleValue==null)return  false;if(!!i.isFunctionHandler&&typeof e.ruleValue=="string"){let a=await b.createFunction("data",i.ruleValue,true).bind({utils:b,DOMUtils:z,httpx:Ee,Qmsg:k,pops:H,log:r,window,unsafeWindow:A})({ruleKey:e.ruleKey,transformAwemeInfo:e.transformAwemeInfo});if(typeof a!="boolean")throw r.error(e,i),new Error("过滤器规则：函数返回值必须是true或false");return a}if(typeof e.videoInfoValue=="string"){if(e.videoInfoValue.match(e.ruleValue))return  true}else if(typeof e.videoInfoValue=="object"){if(Array.isArray(e.videoInfoValue)&&e.videoInfoValue.find(a=>typeof a=="string"&&e.ruleValue!=null?!!a.match(e.ruleValue):false))return  true}else if(typeof e.videoInfoValue=="number"){if(typeof e.ruleValue=="string"){let o=e.ruleValue.trim(),a=o.match(/(\d+)/);if(!a)return r.warn("过滤器-解析比较大小的数字失败: ",e),false;let l=Number(a[1]);if(o.startsWith(">")){if(o.startsWith(">=")){if(e.videoInfoValue>=l)return  true}else if(e.videoInfoValue>l)return  true}else if(o.startsWith("<")){if(o.startsWith("<=")){if(e.videoInfoValue<=l)return  true}else if(e.videoInfoValue<l)return  true}else if(o.startsWith("=")){if(e.videoInfoValue===l)return  true}else return r.warn("视频过滤器-未经允许的比较符号: ",e),false}}else if(typeof e.videoInfoValue=="boolean"&&typeof e.ruleValue=="string"){let o=e.ruleValue.trim();return e.videoInfoValue.toString()===o}return  false}async checkAwemeInfoIsFilter(e,i,n){let o=this.parseAwemeInfoDictData(i),a=false,l=null,u=[],s=[];e:for(let d=0;d<e.length;d++){const c=e[d],p=Array.isArray(c.data.ruleName)?c.data.ruleName:[c.data.ruleName];for(let v=0;v<p.length;v++){const g=p[v];if(!Reflect.has(o,g))continue;let C=g,x=o[C],w={videoInfoKey:C,videoInfoValue:x,ruleKey:c.data.ruleName,ruleValue:c.data.ruleValue,transformAwemeInfo:o,rule:c};if(a=await this.checkFilterWithRule(w,c.data),a)if(Array.isArray(c.dynamicData)&&c.dynamicData.length){let S=[];for(let T=0;T<c.dynamicData.length;T++){const V=c.dynamicData[T];let F=V.ruleName,_=o[F],D={videoInfoKey:F,videoInfoValue:_,ruleKey:V.ruleName,ruleValue:V.ruleValue,transformAwemeInfo:o,rule:c};S.push(D);let $=await this.checkFilterWithRule(D,V);if(a=a&&$,!a)break}a&&r.success([`视频过滤器-多组 ==> ${c.name}`,o,w,S,i,c]);}else r.success([`视频过滤器 ==> ${c.name}`,o,w,i,c]);if(a)if(n)u.push(c);else {l=c;break e}else n&&s.push(c);}}return {isFilter:a,matchedFilterRule:n?u:l,notMatchedFilterRule:n?s:null,transformAwemeInfo:o,awemeInfo:i}}async sendDislikeVideo(e,i){}removeAweme(...e){if(e.length===1){let i=e[0];i!=null&&i instanceof HTMLElement&&i.remove();}else if(e.length===2){let i=e[0],n=e[1];if(typeof n=="number"){let o=i[n];o!=null&&o instanceof Element&&o?.remove(),i.splice(n,1);}}}}const ri={__ajaxHooker:null,get ajaxHooker(){return this.__ajaxHooker==null&&(this.__ajaxHooker=b.ajaxHooker()),this.__ajaxHooker}},dt=function(t,e,i,n,o,a="",l,u){let s={text:t,type:"textarea",attributes:{},props:{},description:n,placeholder:a,disabled:l,getValue(){let c=this.props[N].get(e,i);return Array.isArray(c)?c.join(`
`):c},callback(d,c){this.props[N].set(e,c);}};return Reflect.set(s.attributes,oe,e),Reflect.set(s.attributes,ae,i),Se.initComponentsStorageApi("switch",s,{get(d,c){return h.getValue(d,c)},set(d,c){h.setValue(d,c);}}),s},ce={$key:{ENABLE_KEY:"shieldVideo-exec-network-enable"},$data:{isFilterAwemeInfoList:new ne.Dictionary,networkAwemeInfoMap:new ne.Dictionary,__videoFilterRuleStorage:null,get videoFilterRuleStorage(){return this.__videoFilterRuleStorage==null&&(this.__videoFilterRuleStorage=new ai({STORAGE_API_KEY:"dy-video-filter-rule"})),this.__videoFilterRuleStorage},get onlyShowFilteredVideo(){return h.getValue("shieldVideo-only-show-filtered-video")},videoFilterRules:[]},init(){if(L.isLive()){h.deleteExecMenuOnce(this.$key.ENABLE_KEY);return}this.execFilter(),f.ready(()=>{h.execMenuOnce("shieldVideo-add-parseVideoInfoButton",()=>this.addParseButton());});},getFilterRules(t,e=true){if(!h.getValue(this.$key.ENABLE_KEY))return [];const i=this.$data.videoFilterRuleStorage.getAllRule();if(!i.length)return [];if(i.sort((n,o)=>n.data.isFunctionHandler&&!o.data.isFunctionHandler?1:!n.data.isFunctionHandler&&o.data.isFunctionHandler?-1:0),typeof t=="string"){const n=Array.isArray(t)?t:[t];return i.filter(a=>typeof e=="boolean"&&e&&!a.enable?false:a.data.scope.includes("all")||n.findIndex(l=>a.data.scope.includes(l))!==-1)}else return i.filter(o=>!(typeof e=="boolean"&&e&&!o.enable))},execFilter(){const t=this;h.execMenuOnce(this.$key.ENABLE_KEY,async()=>{r.info("执行视频过滤器");const e=new st,i=s=>{if(this.$data.onlyShowFilteredVideo&&(s.isFilter=!s.isFilter,typeof s.transformAwemeInfo.awemeId=="string"&&s.matchedFilterRule)){const d=this.$data.isFilterAwemeInfoList.get(s.transformAwemeInfo.awemeId)||[];d.push(s.matchedFilterRule),this.$data.isFilterAwemeInfoList.set(s.transformAwemeInfo.awemeId,d);}typeof s.transformAwemeInfo.awemeId=="string"&&ce.$data.networkAwemeInfoMap.set(s.transformAwemeInfo.awemeId,{awemeInfo:s.awemeInfo,transformAwemeInfo:s.transformAwemeInfo});},n=(s,d)=>{d.response=async c=>{const p=t.getFilterRules(s);if(!p.length)return;const v=b.toJSON(c.responseText),g=v.aweme_list;if(Array.isArray(g)){for(let C=0;C<g.length;C++){const x=g[C]||{},w=await e.checkAwemeInfoIsFilter(p,x);i(w),w.isFilter&&(e.sendDislikeVideo(w.matchedFilterRule,x),e.removeAweme(g,C--));}c.responseText=JSON.stringify(v);}};},o=(s,d)=>{d.response=async c=>{const p=t.getFilterRules(s);if(!p.length)return;const v=b.toJSON(c.responseText),g=v.data;if(Array.isArray(g)){for(let C=0;C<g.length;C++){const x=g[C],w=x.aweme||{};typeof x?.cell_room=="object"&&x?.cell_room!=null&&(w.cell_room=x?.cell_room);const S=await e.checkAwemeInfoIsFilter(p,w);i(S),S.isFilter&&(e.sendDislikeVideo(S.matchedFilterRule,w),e.removeAweme(g,C--));}c.responseText=JSON.stringify(v);}};},a=(s,d)=>{d.response=async c=>{const p=t.getFilterRules(s);if(!p.length)return;const v=b.toJSON(c.responseText),g=v.cards;if(Array.isArray(g)){for(let C=0;C<g.length;C++){const x=g[C],w=b.toJSON(x?.aweme||"{}"),S=await e.checkAwemeInfoIsFilter(p,w);i(S),S.isFilter&&(e.sendDislikeVideo(S.matchedFilterRule,w),e.removeAweme(g,C--));}c.responseText=JSON.stringify(v);}};},l=(s,d)=>{d.response=async c=>{const p=t.getFilterRules(s);if(!p.length)return;const v=b.toJSON(c.responseText),g=v.data;if(Array.isArray(g)){for(let C=0;C<g.length;C++){const x=g[C],w=x.aweme_info||{},S=x?.aweme_mix_info;if(w==null&&S!=null){const T=S?.mix_items;if(Array.isArray(T)){for(let V=0;V<T.length;V++){const F=T[V],_=await e.checkAwemeInfoIsFilter(p,F);i(_),_.isFilter&&(e.sendDislikeVideo(_.matchedFilterRule,F),e.removeAweme(T,V--));}T.length===0&&e.removeAweme(g,C--);}}else {const T=await e.checkAwemeInfoIsFilter(p,w);i(T),T.isFilter&&(e.sendDislikeVideo(T.matchedFilterRule,w),e.removeAweme(g,C--));}}c.responseText=JSON.stringify(v);}};},u=(s,d)=>{d.response=async c=>{const p=t.getFilterRules(s);if(!p.length)return;const v=b.toJSON(c.responseText),g=v.aweme_detail;if(typeof g=="object"&&g!=null){const C=await e.checkAwemeInfoIsFilter(p,g);i(C),C.isFilter&&e.sendDislikeVideo(C.matchedFilterRule,g),c.responseText=JSON.stringify(v);}};};ri.ajaxHooker.hook(s=>{const d=y.fixUrl(s.url),c=new URL(d);c.pathname.startsWith("/aweme/v1/web/tab/feed")?n("xhr-tab",s):c.pathname.startsWith("/aweme/v1/web/aweme/post/")?n("xhr-userHome",s):c.pathname.startsWith("/aweme/v1/web/mix/aweme/")?n("xhr-mix",s):c.pathname.startsWith("/aweme/v1/web/aweme/related/")?n("xhr-related",s):c.pathname.startsWith("/aweme/v1/web/follow/feed")?o("xhr-follow",s):c.pathname.startsWith("/aweme/v1/web/familiar/feed")?o("xhr-familiar",s):c.pathname.startsWith("/aweme/v1/web/module/feed")?a("xhr-module",s):c.pathname.startsWith("/aweme/v1/web/general/search/single/")||c.pathname.startsWith("/aweme/v1/web/search/item/")?l("xhr-search",s):c.pathname.startsWith("/aweme/v1/web/aweme/detail/")&&u("xhr-video",s);});});},addParseButton(){const t=new st,e=async a=>{const l=this,u=b.getReactInstance(a)?.reactFiber,s=u?.return?.memoizedProps?.awemeInfo||u?.return?.return?.memoizedProps?.awemeInfo||u?.return?.memoizedProps?.originData;if(s==null){k.error("未获取到awemeInfo信息");return}if(typeof s!="object"){k.error("获取到的awemeInfo信息不是对象");return}let d;const c=t.parseAwemeInfoDictData(s,false);if(r.info(["视频页面原始awemeInfo：",s]),r.info(["视频页面解析出的transformAwemeInfo：",c]),typeof c.awemeId=="string"&&ce.$data.networkAwemeInfoMap.has(c.awemeId)){const g=ce.$data.networkAwemeInfoMap.get(c.awemeId);d=g.transformAwemeInfo,r.info(["视频网络接口存储的Info：",g]);}else d=c;let p=[],v=false;if(this.$data.isFilterAwemeInfoList.has(d.awemeId))p=p.concat(p);else {const g=this.getFilterRules(),C=await t.checkAwemeInfoIsFilter(g,s,true);C.matchedFilterRule.length?(v=true,p=p.concat(C.matchedFilterRule)):(v=false,p=p.concat(C.notMatchedFilterRule));}H.confirm({title:{text:"视频awemeInfo",position:"center"},content:{text:JSON.stringify(d,null,4).trim(),html:false},drag:true,btn:{merge:!!p.length,position:p.length?"space-between":"flex-end",ok:{enable:true,text:"添加过滤规则",callback(g,C){l.getRuleViewInstance().showEditView(false,l.getTemplateData());}},cancel:{enable:true,text:"规则管理器",callback(g,C){l.showView();}},other:{enable:!!p.length,text:`${v?"":"非"}命中的规则(${p.length})`,type:v?"xiaomi-primary":"violet",callback(g,C){l.getRuleViewInstance().showView(x=>!!p.find(S=>x.uuid===S.uuid));}}},mask:{enable:true,clickEvent:{toClose:true}},width:te.setting.width,height:te.setting.height,style:`
				.pops-confirm-content p{
					white-space: break-spaces;
				}
			`});},i=()=>f.createElement("xg-icon",{className:"gm-video-filter-parse-btn",innerHTML:`
						<div class="xgplayer-icon">
							<span role="img" class="semi-icon semi-icon-default">
								<svg
									viewBox="0 0 32 32"
									width="1em"
									height="1em"
									style="font-size: 32px"
									xmlns="http://www.w3.org/2000/svg"
									focusable="false"
									fill="none">
									<g>
										<path
											stroke="null"
											fill="currentColor"
											d="m9.78829,8.17117l1.77477,0l0,1.73974l-1.77477,0l0,4.34935a1.77477,1.73974 0 0 1 -1.77477,1.73974a1.77477,1.73974 0 0 1 1.77477,1.73974l0,4.34935l1.77477,0l0,1.73974l-1.77477,0c-0.9495,-0.23486 -1.77477,-0.78288 -1.77477,-1.73974l0,-3.47948a1.77477,1.73974 0 0 0 -1.77477,-1.73974l-0.88739,0l0,-1.73974l0.88739,0a1.77477,1.73974 0 0 0 1.77477,-1.73974l0,-3.47948a1.77477,1.73974 0 0 1 1.77477,-1.73974m12.42342,0a1.77477,1.73974 0 0 1 1.77477,1.73974l0,3.47948a1.77477,1.73974 0 0 0 1.77477,1.73974l0.88739,0l0,1.73974l-0.88739,0a1.77477,1.73974 0 0 0 -1.77477,1.73974l0,3.47948a1.77477,1.73974 0 0 1 -1.77477,1.73974l-1.77477,0l0,-1.73974l1.77477,0l0,-4.34935a1.77477,1.73974 0 0 1 1.77477,-1.73974a1.77477,1.73974 0 0 1 -1.77477,-1.73974l0,-4.34935l-1.77477,0l0,-1.73974l1.77477,0m-6.21171,10.43844a0.88739,0.86987 0 0 1 0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,-0.86987a0.88739,0.86987 0 0 1 0.88739,-0.86987m-3.54955,0a0.88739,0.86987 0 0 1 0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,-0.86987a0.88739,0.86987 0 0 1 0.88739,-0.86987m7.0991,0a0.88739,0.86987 0 0 1 0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,0.86987a0.88739,0.86987 0 0 1 -0.88739,-0.86987a0.88739,0.86987 0 0 1 0.88739,-0.86987z"
											clip-rule="evenodd"
											fill-rule="evenodd" />
									</g>
								</svg>
							</span>
						</div>
						<div class="xg-tips">解析信息</div>
				`}),n=new b.LockFunction(()=>{L.isLive()||(K(".basePlayerContainer xg-right-grid:not(:has(.gm-video-filter-parse-btn))").forEach(a=>{const l=i();f.on(l,"click",async u=>{f.preventEvent(u);const s=a.closest(".basePlayerContainer");await e(s);}),f.prepend(a,l);}),[...Array.from(K('[data-e2e="feed-live"] xg-right-grid:not(:has(.gm-video-filter-parse-btn))')),...Array.from(K('[data-e2e="feed-live"] .douyin-player-controls-right:not(:has(.gm-video-filter-parse-btn))'))].forEach(a=>{if(!b.isVisible(a,false))return;const l=i();f.on(l,"click",async u=>{f.preventEvent(u);const s=a.closest('[data-e2e="feed-live"]');await e(s);}),f.prepend(a,l);}));}),o=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{n.run();}});return [B(`
      xg-icon .xg-tips{
        display: none;
      }
			.basePlayerContainer .gm-video-filter-parse-btn{
				margin-left: 4px;
			}
			.basePlayerContainer .gm-video-filter-parse-btn .semi-icon{
				display: flex;
				justify-content: center;
				align-items: center;
			}
			.basePlayerContainer .gm-video-filter-parse-btn .semi-icon svg{
				
			}
      /* 修复搜索结果单列页面 解析按钮的高度错位 */
      .searchControl33px .xg-right-grid xg-icon.gm-video-filter-parse-btn span svg{
				transform: translateY(-6px) !important;
			}`),()=>{f.remove(".gm-video-filter-parse-btn"),o?.disconnect();}]},getRuleViewInstance(){const t=H.config.PanelHandlerComponents(),e=o=>({get(a,l){return o[a]??l},set(a,l){o[a]=l;}}),i={title:"视频过滤器",data:()=>this.$data.videoFilterRuleStorage.getAllRule(),getAddData:()=>this.getTemplateData(),getDataItemName:o=>o.name,updateData:o=>this.$data.videoFilterRuleStorage.setRule(o),deleteData:o=>this.$data.videoFilterRuleStorage.deleteRule(o),getData:o=>ce.$data.videoFilterRuleStorage.getAllRule().find(u=>u.uuid===o.uuid)??o,itemControls:{enable:{enable:true,getEnable(o){return o.enable},callback:(o,a)=>{o.enable=a,i.updateData(o);}},edit:{enable:true,getView:(o,a)=>{const l=document.createDocumentFragment();a||(o=this.getTemplateData());const u=m("启用","enable",true);Reflect.set(u.props,N,e(o));const s=t.createSectionContainerItem_switch(u),d=ti("规则名称","name","","",void 0,"必填");Reflect.set(d.props,N,e(o));const c=t.createSectionContainerItem_input(d),p=lt("作用域","scope",[],[{text:"所有",value:"all"},{text:"精选",value:"xhr-module"},{text:"推荐",value:"xhr-tab"},{text:"关注",value:"xhr-follow"},{text:"朋友",value:"xhr-familiar"},{text:"搜索",value:"xhr-search"},{text:"用户主页",value:"xhr-userHome"},{text:"混合信息",value:"xhr-mix"},{text:"相关推荐",value:"xhr-related"}].map(V=>({...V,value:V.value})),void 0,"选择需要在xxx上生效的作用域");Reflect.set(p.props,N,e(o.data));const v=t.createSectionContainerItem_select_multiple_new(p),g=["isLive","isAds","isSeriesInfo","isMixInfo","isPicture","isProduct","awemeId","nickname","uid","desc","textExtra","videoTag","videoTagId","suggestWord","musicAlbum","musicAuthor","musicTitle","authorAccountCertInfo","authorCustomVerify","authorEnterpriseVerifyReason","riskInfoContent","seriesInfoName","seriesInfoContentTypes","mixInfoName","mixInfoDesc","collectCount","commentCount","diggCount","shareCount","duration","liveStreamRoomId","liveStreamRoomTitle","liveStreamNickName","liveStreamRoomUserCount","liveStreamRoomDynamicSpliceLabel","videoBitRateList","productId","productTitle"],C=V=>{const F=Array.isArray(V.ruleName)?V.ruleName:[V.ruleName],_=lt("属性名","ruleName",F,g.map(W=>({text:W,value:W})),void 0,"选择需要的属性名 ");Reflect.set(_.props,N,e(V));const D=t.createSectionContainerItem_select_multiple_new(_),$=(W,le)=>{le?(f.html(Y,"自定义函数"),f.html(J,"返回值必须为boolean值")):(f.html(Y,R.text),f.html(J,R.description??""));},E=m("是否使用自定义函数处理","isFunctionHandler",false,void 0,"执行自定义函数来判断是否进行过滤",void 0,false,$);Reflect.set(E.props,N,e(V));const I=t.createSectionContainerItem_switch(E),R=dt("属性值","ruleValue","","如果是字符串，可正则，注意转义");Reflect.set(R.props,N,e(V));const U=t.createSectionContainerItem_textarea(R),Y=U.querySelector(".pops-panel-item-left-main-text"),J=U.querySelector(".pops-panel-item-left-desc-text"),j=dt("备注","remarks","","");Reflect.set(j.props,N,e(V));const re=t.createSectionContainerItem_textarea(j);return V.isFunctionHandler&&$(null,E.getValue()),[D,I,U,re]},x=f.createElement("div",{className:"rule-form-ulist-dynamic",innerHTML:`
							<div class="rule-form-ulist-dynamic__inner"></div>
							<div class="pops-panel-button pops-panel-button-no-icon">
								<button class="pops-panel-button_inner" type="button" data-type="default">
									<i class="pops-bottom-icon" is-loading="false"></i>
									<span class="pops-panel-button-text">添加额外属性</span>
								</button>
							</div>
							`}),w=x.querySelector(".rule-form-ulist-dynamic__inner"),S=x.querySelector(".pops-panel-button"),T=(V={ruleName:[],isFunctionHandler:false,ruleValue:"",remarks:""})=>{const F=f.createElement("div",{className:"rule-form-ulist-dynamic__inner-container",innerHTML:`
									<div class="dynamic-control-delete">
										<div class="pops-panel-button pops-panel-button-no-icon">
											<button class="pops-panel-button_inner" type="button" data-type="danger">
												<i class="pops-bottom-icon" is-loading="false"></i>
												<span class="pops-panel-button-text">×</span>
											</button>
										</div>
									</div>
									<ul class="dynamic-forms"></ul>
								`}),_=F.querySelector(".dynamic-control-delete");f.on(_,"click",E=>{if(f.preventEvent(E),F.remove(),Array.isArray(o.dynamicData)){const I=o.dynamicData.findIndex(R=>R==V);I!==-1&&o.dynamicData.splice(I,1);}});const D=F.querySelector(".dynamic-forms"),$=C(V);D.append(...$),w.appendChild(F);};if(f.on(S,"click",V=>{f.preventEvent(V),T();}),Array.isArray(o.dynamicData))for(let V=0;V<o.dynamicData.length;V++){const F=o.dynamicData[V];T(F);}return l.append(s,c,v,...C(o.data),x),l},onsubmit:async(o,a,l)=>{const u=o.querySelectorAll(".rule-form-ulist > li"),s=this.getTemplateData();if(a&&(s.uuid=l.uuid),u.forEach(c=>{const p=Reflect.get(c,"__formConfig__");if(!p)return;const v=Reflect.get(p,"attributes");if(!v)return;const g=Reflect.get(c,N),C=Reflect.get(v,oe),x=Reflect.get(v,ae),w=g.get(C,x);Reflect.has(s,C)?Reflect.set(s,C,w):Reflect.has(s.data,C)?Reflect.set(s.data,C,w):r.error(`${C}不在数据中`);}),o.querySelectorAll(".rule-form-ulist-dynamic__inner-container").forEach(c=>{const p={};c.querySelectorAll(".dynamic-forms > li").forEach(v=>{const g=Reflect.get(v,"__formConfig__");if(!g)return;const C=Reflect.get(g,"attributes");if(!C)return;const x=Reflect.get(v,N),w=Reflect.get(C,oe),S=Reflect.get(C,ae),T=x.get(w,S);Reflect.set(p,w,T);}),s.dynamicData.push(p);}),s.name.trim()==="")return k.error("规则名称不能为空"),{success:false,data:s};if(s.data.scope.length===0)return k.error("请选择作用域"),{success:false,data:s};if(s.data.ruleName.length===0)return k.error("请选择属性名"),{success:false,data:s};if(s.data.ruleValue.trim()==="")return k.error((s.data.isFunctionHandler?"自定义函数":"属性值")+"不能为空"),{success:false,data:s};let d=false;return a?d=!!await i.updateData(s):d=this.$data.videoFilterRuleStorage.addRule(s),{success:d,data:s}},style:`
          .pops-panel-textarea textarea{
              height: 150px;
          }
					.pops-panel-item-left-desc-text{
						line-height: normal;
						margin-top: 6px;
						font-size: 0.8em;
						color: rgb(108, 108, 108);
					}
					.rule-form-ulist-dynamic{
						--button-margin-top: 0px;
						--button-margin-right: 0px;
						--button-margin-bottom: 0px;
						--button-margin-left: 0px;
						display: flex;
						flex-direction: column;
						align-items: flex-start;
						padding: 5px 20px;
					}
					.rule-form-ulist-dynamic__inner{
						width: 100%;
					}
					.rule-form-ulist-dynamic__inner-container{
						display: flex;
						align-items: center;
					}
					.dynamic-forms{
						width: 100%;
					}
					.pops-panel-textarea textarea{
						height: 60px;
						min-height: 60px;
						width: 250px;
						max-width: 400px;
						min-width: 250px;
						resize: auto;
						transition: unset;
					}
          li[data-key="isFunctionHandler"]:has(.pops-panel-switch-is-checked) + li[data-key="ruleValue"] .pops-panel-textarea {
            flex: 1;
            justify-items: end;
          }
          li[data-key="isFunctionHandler"]:has(.pops-panel-switch-is-checked) + li[data-key="ruleValue"] textarea {
            height: 200px;
            width: calc(100% - 100px);
            max-width: unset;
          }
          `,width:()=>window.innerWidth>700?"700px":"88vw"},delete:{enable:true,deleteCallBack:async o=>await i.deleteData(o)}},bottomControls:{filter:{enable:true,option:[{name:"过滤-已启用",filterCallBack(o){return o.enable},callback(o,a){return h.setValue("dy-video-ui-rule-filter-option-index",0),true}},{name:"过滤-未启用",filterCallBack(o){return !o.enable},callback(o,a){return h.setValue("dy-video-ui-rule-filter-option-index",1),true}}],cancelFilterCallback(o){h.deleteValue("dy-video-ui-rule-filter-option-index");}},clear:{enable:true,callback:()=>{this.$data.videoFilterRuleStorage.clearAllRule();}}}};return new oi(i)},showView(){this.getRuleViewInstance().showView(h.getValue("dy-video-ui-rule-filter-option-index"));},getTemplateData(){return {uuid:b.generateUUID(),enable:true,name:"",data:{scope:[],ruleName:"nickname",isFunctionHandler:false,ruleValue:"",remarks:""},dynamicData:[]}}},li=`/* 右侧视频信息里的 下载客户端，桌面快捷访问 */\r
[data-e2e="note-detail"] div:has(> [data-e2e="user-info"]) > div:has(a[download*="douyin-downloader"]) {\r
  display: none !important;\r
}\r
`,si={init(){B(li);}},di={init(){f.ready(()=>{h.execMenuOnce("dy-recommend-automaticContinuousPlayback",()=>this.automaticContinuousPlayback());});},automaticContinuousPlayback(){r.info("自动连播");const t="data-automaticContinuousPlayback";let e=(a=false)=>q(`.page-recommend-container:not(:has([data-e2e="feed-live"])) [data-e2e="feed-active-video"] video${a?`:not([${t}])`:""}`),i=()=>{if(h.getValue("dy-keyboard-hook-pageUpAndDown")){k.error("自动连播切换失败，请勿禁用↑↓翻页快捷键");return}let a=new KeyboardEvent("keydown",{bubbles:true,cancelable:true,key:"ArrowDown",code:"ArrowDown",keyCode:40,which:40});document.body.dispatchEvent(a);},n=new b.LockFunction(()=>{if(!L.isRecommend())return;let a=e();if(!a||a.hasAttribute(t))return;a.setAttribute(t,"true");let l=a.src;f.on(a,"ended",u=>{r.success("视频播放完毕，切换至下一个视频"),f.preventEvent(u),l=a.src;let s=!!a.closest("#slideMode");y.interval(d=>{if(d)return r.error("切换视频超时，切换失败"),false;let c=e(),p=c?.src;if(s){if(p&&a===c&&l!==p)return r.success("合集-切换视频成功"),false}else if(a!==c)return r.success("切换视频成功"),false;i();},500,5e3);},{capture:true});});const o=b.mutationObserver(document,{config:{subtree:true,childList:true},immediate:true,callback:()=>{n.run();}});return [()=>{o?.disconnect();}]}},mt={init(){h.onceExec("dy-global-block-css",()=>this.removeAds()),$t(),Re.init(),ce.init(),zt.init(),h.execMenuOnce("watchLoginDialogToClose",()=>at.watchLoginDialogToClose()),h.execMenuOnce("disguiseLogin",()=>at.disguiseLogin()),h.execMenuOnce("dy-initialScale",()=>{this.initialScale();}),h.execMenu("dy-apple-removeMetaAppleItunesApp",()=>{this.removeMetaAppleItunesApp();}),jt.init(),Lt.init(),Vt.init(),h.execMenuOnce("dy-common-listenRouterChange",()=>this.listenRouterChange(),false,false),h.execMenuOnce("dy-search-click-to-new-tab",()=>this.navSearchClickToNewTab()),L.isLive()?(r.info("Router: 直播"),Wt.init()):L.isIndex()?(he.init(),L.isRecommend()?(r.info("Router: 推荐"),di.init()):L.isSearch()?(r.info("Router: 搜索"),Yt.init()):L.isUser()?(r.info("Router: 用户页面"),Zt.init()):L.isVideo()?(r.info("Router: 单个视频页面"),ei.init()):L.isChannel()?r.info("Router: Channel页面"):L.isNote()?(r.info("Router:  笔记页面"),si.init()):r.warn("子router: "+window.location.href)):window.location.hostname.startsWith("lf-zt.douyin.com")||r.error("未适配router: "+window.location.href);},removeAds(){return f.waitNode(()=>f.selector('#douyin-navigation [data-e2e="douyin-navigation"] > div > div > div:regexp("下载抖音精选|条条都是宝藏视频")'),1e4).then(t=>{t&&f.remove(t);}),[B(Qt)]},initialScale(){r.info("设置<meta>的viewport固定缩放倍率为1并移除页面原有的<meta>"),f.ready(()=>{let t=f.createElement("meta",{},{name:"viewport",content:"width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"});f.remove("meta[name='viewport']"),f.waitNode("head").then(()=>{document.head.appendChild(t);});});},removeMetaAppleItunesApp(){f.waitNodeList(['meta[name="apple-itunes-app"]'],1e4).then(t=>{t&&t.forEach(e=>{e.remove();});});},listenRouterChange(){r.info("监听Router重载");let t=window.location.href;const e=()=>{const i=t,n=window.location.href;t=n,r.info("Router Change："+n),h.triggerUrlChangeWithExecMenuOnceEvent({url:n,beforeUrl:i}),this.init();};return f.on(window,"wb_url_change",e),[()=>{f.off(window,"wb_url_change",e);}]},navSearchClickToNewTab(){r.info("新标签页打开搜索结果");const t=n=>`https://www.douyin.com/search/${encodeURIComponent(n)}`,e=f.on(document,"click",['div[data-click="doubleClick"]:has(input[data-e2e="searchbar-input"]) button[data-e2e="searchbar-button"]','a[href*="douyin.com/search/"]'],(n,o)=>{f.preventEvent(n);let a;if(o instanceof HTMLAnchorElement)a=o.href;else {const l=o.closest('div[data-click="doubleClick"]');if(!l){k.error("未找到搜索框元素");return}const u=l.querySelector("input");let s=u.value;if(s==null||s===""){const d=f.prev(u);if(d)s=f.text(d);else {const c=u.placeholder.trim();if(c!=null&&c!=="")s=c;else {r.error("搜索内容为空，不进行搜索");return}}}r.info("当前的搜索内容："+s),a=t(s);}r.info(`新标签页打开搜索：${a}`),window.open(a,"_blank");},{capture:true}),i=f.on(document,"click",'[data-e2e="searchbar-button"] + div [data-text][data-index]',(n,o)=>{const a=n.composedPath()[0];if(a.closest(".icon[data-text]")||a.matches(".icon[data-text]"))return;f.preventEvent(n);const l=o.getAttribute("data-text");if(!l){r.error("未找到搜索建议内容",o),k.error("未找到搜索建议内容");return}const u=t(l);window.open(u,"_blank");},{capture:true});return [e.off,i.off]}},ke={isMDouYin(){return window.location.hostname==="m.douyin.com"||window.location.hostname==="www.iesdouyin.com"},isShareUser(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/user/")},isShareVideo(){return this.isMDouYin()&&(window.location.pathname.startsWith("/share/video/")||window.location.pathname.startsWith("/shipin/"))},isShareNote(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/note/")},isShareMusic(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/music/")},isShareChallenge(){return this.isMDouYin()&&window.location.pathname.startsWith("/share/challenge/")}},ci=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 上面屏蔽后的空白区域 */\r
.user-card .nav-bar-placeholder,\r
/* 视频区域底部的【打开抖音App看更多内容】 */\r
.select-list .img-button {\r
  display: none !important;\r
}\r
`,de={getVideoUrl(t){return "https://www.douyin.com/video/"+t},getCollectionUrl(t){return "https://www.douyin.com/collection/"+t},getNoteUrl(t){return "https://www.douyin.com/note/"+t},getHashTagUrl(t){return "https://www.douyin.com/hashtag/"+t},getUserHomeUrl(t){return "https://www.douyin.com/user/"+t},getMusicUrl(t){return "https://www.douyin.com/music/"+t}},ui={init(){B(ci),h.execMenuOnce("m-dy-share-user-coverPlayletList",()=>this.coverPlayletList()),h.execMenuOnce("m-dy-share-user-coverPostListContainer",()=>this.coverPostListContainer());},coverPlayletList(){return [f.on(document,"click",".user-playlet-list .playlet-item",e=>{f.preventEvent(e);let i=e.target,n=b.getReactInstance(i)?.reactFiber;if(n?.key==null){k.error("获取视频合集key失败");return}let a=n?.index;if(a==null){k.error("获取视频合集index失败");return}let l=n?.return?.return?.pendingProps?.playletList;if(l==null){k.error("获取视频合集playletList失败");return}let u=l[a],s=de.getCollectionUrl(u.mix_id);window.open(s,"_blank");},{capture:true}).off]},coverPostListContainer(){return [f.on(document,"click",".post-list-container .user-post-cover",e=>{f.preventEvent(e);let i=e.target,n=b.getReactInstance(i)?.reactFiber;if(n?.return?.memoizedProps?.productionUrl){let o=n?.return?.memoizedProps?.productionUrl;window.open(o,"_blank");}else k.error("获取视频链接失败");},{capture:true}).off]}},hi=`/* 顶部 打开看看 登录 */\r
.adapt-login-header,\r
/* 视频描述信息区域中的 打开抖音看精彩视频 */\r
.footer .img-button,\r
/* 登录页面 */\r
.login-page ,\r
/* 底部左下角 打开抖音看精彩视频 */\r
.footer .bottom-btn-con-new,\r
/* 合集 打开抖音看精彩视频 */\r
.container .end-page-info-button {\r
  display: none !important;\r
}\r
`,fi=`.video-container {\r
  height: 100% !important;\r
  margin-top: 0 !important;\r
}\r
.footer {\r
  bottom: 50px !important;\r
}\r
.mix-info {\r
  bottom: 0px !important;\r
}\r
`,pi={init(){B(hi),B(fi),h.execMenuOnce("m-dy-share-video-coverGlobalClick",()=>this.coverGlobalClick());},coverGlobalClick(){return [z.on(document,"click",[".right-con",".footer",".mix-info"],e=>z.preventEvent(e),{capture:true}).off]}},mi=`/* 顶部 打开看看 登录 */\r
.container .adapt-login-header,\r
/* 底部中间的 App内打开 */\r
.container .float-button-con {\r
  display: none !important;\r
}\r
\r
.gallery-container {\r
  margin-top: 10px !important;\r
}\r
`,vi={init(){B(mi),h.execMenuOnce("m-dy-share-note-blockRecommend",()=>this.blockRecommend()),h.execMenuOnce("m-dy-share-note-blockComment",()=>this.blockComment()),h.execMenuOnce("m-dy-share-note-blockFooterToobar",()=>this.blockFooterToobar()),h.execMenuOnce("m-dy-share-note-coverUser",()=>this.coverUser()),h.execMenuOnce("m-dy-share-note-coverHashTag",()=>this.coverHashTag()),h.execMenuOnce("m-dy-share-note-coverMusic",()=>this.coverMusic()),h.execMenuOnce("m-dy-share-note-coverRecommend",()=>this.coverRecommend()),h.execMenuOnce("m-dy-share-note-coverExcitingGraphicsAndText",()=>this.coverExcitingGraphicsAndText());},blockRecommend(){return r.info("【屏蔽】相关推荐"),y.addBlockCSS(".recommend-con")},blockComment(){return r.info("【屏蔽】评论"),y.addBlockCSS(".comment-con")},blockFooterToobar(){return r.info("【屏蔽】底部工具栏"),y.addBlockCSS(".footer-con")},coverRecommend(){return r.info("覆盖相关推荐的点击事件"),[f.on(document,"click","#masonry .card",e=>{f.preventEvent(e);let i=e.target,n=b.getReactInstance(i).reactFiber;if(!n){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}let o=n?.return?.memoizedProps.awemeId,a=de.getNoteUrl(o);window.open(a,"_blank");},{capture:true}).off]},coverUser(){r.info("覆盖用户点击事件");const t=(e,i)=>{f.preventEvent(e);const n=b.getReactInstance(i).reactFiber;if(!n){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}const o=n?.return?.return?.memoizedProps?.video?.authorInfo?.sec_uid,a=de.getUserHomeUrl(o);window.open(a,"_blank");};return f.on(document,"click",".message-con__top",t,{capture:true}),[()=>{f.off(document,"click",".message-con__top",t,{capture:true});}]},coverHashTag(){r.info("覆盖话题点击事件");const t=(e,i)=>{f.preventEvent(e);const n=b.getReactInstance(i).reactFiber;if(!n){k.error("获取reactFiber失败");return}const o=n.index,u=(n?.return?.return?.return?.return?.memoizedProps?.video?.splitStrArr)[o].hashtagId,s=de.getHashTagUrl(u);window.open(s,"_blank");};return f.on(document,"click",".message-con__content__body .message-con__content__body-text",t,{capture:true}),[()=>{f.off(document,"click",".message-con__content__body .message-con__content__body-text",t,{capture:true});}]},coverMusic(){return r.info("覆盖音乐点击事件"),[f.on(document,"click",".message-con__footer",e=>{f.preventEvent(e);let i=e.target,n=b.getReactInstance(i).reactFiber;if(!n){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}let o=n?.return?.return?.memoizedProps?.video?.musicId,a=de.getMusicUrl(o);window.open(a,"_blank");},{capture:true}).off]},coverExcitingGraphicsAndText(){r.info("覆盖精彩图文点击事件");const t=f.on(document,"click",".container .related-list-con .related-note-item",i=>{f.preventEvent(i);let n=i.target,o=b.getReactInstance(n).reactFiber;if(!o){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}let l=(o?.return?.memoizedProps?.itemData).awemeId,u=de.getNoteUrl(l);window.open(u,"_blank");},{capture:true}),e=f.on(document,"click",".related-title-con",i=>f.preventEvent(i),{capture:true});return [t.off,e.off]}},yi=`/* 顶部 打开看看 登录 */\r
.page-reflow-challenge .header,\r
/* 底部的 打开抖音App看更多内容 */\r
.page-reflow-challenge .bottom-btn__con {\r
  display: none !important;\r
}\r
\r
.page-reflow-challenge {\r
  padding-top: 0 !important;\r
}\r
`,gi={init(){B(yi),h.onceExec("m-dy-share-challenge-coverTopJump",()=>this.coverTopJump()),h.execMenuOnce("m-dy-share-challenge-coverVideoCard",()=>this.coverVideoCard());},coverTopJump(){r.info("阻止上面区域点击跳转至下载页面"),f.on(document,"click",".challenge-body",t=>{f.preventEvent(t);},{capture:true});},coverVideoCard(){r.info("覆盖视频卡片点击事件");const t=(e,i)=>{f.preventEvent(e);let n=b.getReactInstance(i).reactFiber;if(!n){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}let o=n?.return?.return?.return?.memoizedProps.listData,a=n.index,l=o[a],u=de.getVideoUrl(l.aweme_id);window.open(u,"_blank");};return f.on(document,"click","#pagelet-worklist li.item",t,{capture:true}),[()=>{f.off(document,"click","#pagelet-worklist li.item",t,{capture:true});}]}},bi=`/* 顶部 打开App，发现更多内容 */\r
.page-reflow-music .header,\r
/* ↑屏蔽后的 顶部空白区域 */\r
.page-reflow-music .banner-placeholder ,\r
/* 底部 打开抖音App看更多内容 */\r
.page-reflow-music .bottom-btn__con {\r
  display: none !important;\r
}\r
`,Ci={init(){B(bi),h.execMenuOnce("m-dy-share-music-coverVideoCard",()=>this.coverVideoCard());},coverVideoCard(){r.info("覆盖视频卡片点击事件");const t=(e,i)=>{f.preventEvent(e);let n=b.getReactInstance(i).reactFiber;if(!n){r.error("获取reactFiber失败"),k.error("获取reactFiber失败");return}let o=n?.return?.return?.return?.memoizedProps.listData,a=n.index,l=o[a],u=de.getVideoUrl(l.aweme_id);window.open(u,"_blank");};return f.on(document,"click","#pagelet-worklist li.item",t,{capture:true}),[()=>{f.off(document,"click","#pagelet-worklist li.item",t,{capture:true});}]}},ki={init(){ke.isShareUser()?(r.info("M-Router: 分享用户"),ui.init()):ke.isShareVideo()?(r.info("M-Router: 分享视频"),pi.init()):ke.isShareNote()?(r.info("M-Router: 分享笔记"),vi.init()):ke.isShareChallenge()?(r.info("M-Router: 分享话题"),gi.init()):ke.isShareMusic()?(r.info("M-Router: 分享音乐"),Ci.init()):r.error("未知M-router: "+window.location.hostname);}},ue=function(t,e,i,n,o,a,l){let u=[];typeof n=="function"?u=n():u=n;let s={text:t,type:"select",description:a,attributes:{},props:{},getValue(){return this.props[N].get(e,i)},callback(d,c,p){let v=c;if(r.info(`选择：${p}`),typeof o=="function"&&o(d,v,p))return;this.props[N].set(e,v);},data:u};return Reflect.set(s.attributes,oe,e),Reflect.set(s.attributes,ae,i),Se.initComponentsStorageApi("select",s,{get(d,c){return h.getValue(d,c)},set(d,c){h.setValue(d,c);}}),s},xi=(t,e)=>{let i=e.sectionBodyContainer.querySelector(".keyboard-oneClickOpen"),n=e.sectionBodyContainer.querySelector(".keyboard-oneClickClose"),o=a=>{e.sectionBodyContainer?.querySelectorAll(".pops-panel-switch").forEach(l=>{let u=l.querySelector(".pops-panel-switch__input"),s=l.querySelector(".pops-panel-switch__core");a?u.checked||s.click():u.checked&&s.click();});};f.on(i,"click",a=>{f.preventEvent(a),o(true);}),f.on(n,"click",a=>{f.preventEvent(a),o(false);});},P={text:`
		<p>注：开启是禁用该快捷键、关闭是不禁用该快捷键</p>
        <a href="javascript:;" class="keyboard-oneClickOpen">禁用全部快捷键</a>
        <br>
        <a href="javascript:;" class="keyboard-oneClickClose">取消禁用全部快捷键</a>
    `,afterEnterDeepMenuCallBack:xi};function wi(){const t=/Firefox/.test(window.navigator.userAgent),e=document.createElement("canvas"),i=e.getContext("webgl")||e.getContext("experimental-webgl"),n=t?null:i.getExtension("WEBGL_debug_renderer_info");return i.getParameter(n?.UNMASKED_RENDERER_WEBGL??i?.RENDERER)}const Si={id:"panel-config-common",title:"通用",forms:[{text:"",type:"forms",forms:[{text:"Toast配置",type:"deepMenu",forms:[{text:"",type:"forms",forms:[ue("Toast位置","qmsg-config-position","bottom",[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],(t,e,i)=>{r.info("设置当前Qmsg弹出位置"+i);},"Toast显示在页面九宫格的位置"),ue("最多显示的数量","qmsg-config-maxnums",3,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,"限制Toast显示的数量"),m("逆序弹出","qmsg-config-showreverse",false,void 0,"修改Toast弹出的顺序")]}]}]},{type:"forms",text:"",forms:[{type:"own",getLiElementCallBack(t){let e=f.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
							<p class="pops-panel-item-left-main-text">WebGL</p>
							<p class="pops-panel-item-left-desc-text"></p>
							`}),i=e.querySelector(".pops-panel-item-left-desc-text"),n="";try{n=wi();}catch(o){r.error(o),n=o.toString();}return f.text(i,n),f.append(t,e),t}},{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("伪装登录","disguiseLogin",false,void 0,"该功能残缺，在部分区域内会失效或者导致功能异常"),m("initial-scale=1","dy-initialScale",false,void 0,"可配合手机模式放大页面"),m("移除<meta> apple-itunes-app","dy-apple-removeMetaAppleItunesApp",true,void 0,"Safari使用，移除顶部横幅【Open in the 抖音 app】"),m("监听Router改变","dy-common-listenRouterChange",true,void 0,"当地址栏改变时，功能重载，建议开启"),m("移除某些Cookie","dy-cookie-remove__ac__",false,void 0,"阻止触发验证弹窗（maybe）"),m("新标签页打开搜索结果","dy-search-click-to-new-tab",false,void 0,"点击搜索框的<code>搜索</code>按钮时，点击视频区域的<code>#话题</code>时，新标签页打开")]},{text:"Url重定向",type:"forms",forms:[m("重定向/home","douyin-redirect-url-home-to-root",false,void 0,"/home => /")]}]},{type:"deepMenu",text:"禁用抖音快捷键",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text,forms:[m("赞|取消赞","dy-keyboard-hook-likeOrDislike",false,void 0,"Z"),m("评论","dy-keyboard-hook-comment",false,void 0,"X"),m("开启/关闭弹幕","dy-keyboard-hook-danmaku-enable",false,void 0,"B"),m("收藏/取消收藏","dy-keyboard-hook-collect-enable",false,void 0,"C"),m("复制分享口令","dy-keyboard-hook-copyShareLink",false,void 0,"V"),m("清屏","dy-keyboard-hook-clearScreen",false,void 0,"J"),m("自动连播","dy-keyboard-hook-automaticBroadcast",false,void 0,"K"),m("视频信息","dy-keyboard-hook-videoInfo",false,void 0,"I"),m("不感兴趣","dy-keyboard-hook-notInterested",false,void 0,"R"),m("进入作者主页","dy-keyboard-hook-enterAuthorHomePage",false,void 0,"F"),m("关注/取消关注","dy-keyboard-hook-follow",false,void 0,"G"),m("抖音搜索","dy-keyboard-hook-search",false,void 0,"Shift+F"),m("一键关闭当前页","dy-keyboard-hook-closeTheCurrentPageWithOneClick",false,void 0,"Shift+Q"),m("上下翻页","dy-keyboard-hook-pageUpAndDown",false,void 0,"↑↓"),m("快进快退","dy-keyboard-hook-fastForwardAndFastBack",false,void 0,"← →"),m("暂停","dy-keyboard-hook-pause",false,void 0,"空格"),m("网页内全屏","dy-keyboard-hook-fullScreenInsideThePage",false,void 0,"Y"),m("全屏","dy-keyboard-hook-fullScreen",false,void 0,"H"),m("稍后再看","dy-keyboard-hook-watchItOutLater",false,void 0,"L"),m("音量调整","dy-keyboard-hook-volumeAdjustment",false,void 0,"Shift + / Shift -"),m("呼出快捷键列表","dy-keyboard-hook-listOfCallShortcutKeys",false,void 0,"?"),m("关闭快捷键列表","dy-keyboard-hook-closeTheShortcutKeyList",false,void 0,"ESC"),m("相关推荐","dy-keyboard-hook-relevantRecommendation",false,void 0,"N"),m("听抖音","dy-keyboard-hook-listenToDouyin",false,void 0,"T"),m("小窗播放","dy-keyboard-hook-smallWindowPlay",false,void 0,"U"),m("推荐视频","dy-keyboard-hook-recommendVideo",false,void 0,"P")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-全局",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text,forms:[m("【屏蔽】登录弹窗","watchLoginDialogToClose",true,void 0,"屏蔽元素且自动等待元素出现并关闭登录弹窗"),m("【屏蔽】底部？按钮","shieldBottomQuestionButton",true,void 0,"屏蔽元素")]}]},{text:"布局屏蔽-左侧导航栏",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text,forms:[m("【屏蔽】左侧导航栏","shieldLeftNavigator",false,void 0,"屏蔽元素"),m("【屏蔽】精选","shieldLeftNavigator-tab-home",false,void 0,"屏蔽元素"),m("【屏蔽】推荐","shieldLeftNavigator-tab-recommend",false,void 0,"屏蔽元素"),m("【屏蔽】AI搜索/抖音","shieldLeftNavigator-tab-ai-search",false,void 0,"屏蔽元素"),m("【屏蔽】关注","shieldLeftNavigator-tab-follow",false,void 0,"屏蔽元素"),m("【屏蔽】朋友","shieldLeftNavigator-tab-friend",false,void 0,"屏蔽元素"),m("【屏蔽】我的","shieldLeftNavigator-tab-user_self",false,void 0,"屏蔽元素"),m("【屏蔽】直播","shieldLeftNavigator-tab-live",false,void 0,"屏蔽元素"),m("【屏蔽】放映厅","shieldLeftNavigator-tab-vs",false,void 0,"屏蔽元素"),m("【屏蔽】短剧","shieldLeftNavigator-tab-series",false,void 0,"屏蔽元素")]}]},{text:"布局屏蔽-顶部导航栏",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】顶部导航栏","shieldTopNavigator",false,void 0,"屏蔽元素"),m("【屏蔽】右侧菜单栏","shield-topNav-rightMenu",false,void 0,"屏蔽元素"),m("【屏蔽】客户端提示","shieldClientTip",true,void 0,"屏蔽元素"),m("【屏蔽】充钻石","shieldFillingBricksAndStones",true,void 0,"屏蔽元素"),m("【屏蔽】客户端","shieldClient",true,void 0,"屏蔽元素"),m("【屏蔽】快捷访问","shieldQuickAccess",false,void 0,"屏蔽元素"),m("【屏蔽】通知","shieldNotifitation",false,void 0,"屏蔽元素"),m("【屏蔽】私信","shieldPrivateMessage",false,void 0,"屏蔽元素"),m("【屏蔽】投稿","shieldSubmission",false,void 0,"屏蔽元素"),m("【屏蔽】壁纸","shieldWallpaper",false,void 0,"屏蔽元素"),m("【屏蔽】更多","shield-topNav-rightMenu-more",false,void 0,"屏蔽元素"),m("【屏蔽】登录头像","shield-topNav-rightMenu-loginAvatar",false,void 0,"屏蔽元素"),m("【屏蔽】AI搜索","shield-topNav-ai-search",false,void 0,"屏蔽元素")]}]},{text:"布局屏蔽-搜索",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】搜索框","shieldSearch",false,void 0,"屏蔽元素"),m("【屏蔽】搜索框的提示","shieldSearchPlaceholder",false,void 0,"屏蔽元素"),m("【屏蔽】猜你想搜","shieldSearchGuessYouWantToSearch",false,void 0,"屏蔽元素"),m("【屏蔽】抖音热点","shieldSearchTiktokHotspot",false,void 0,"屏蔽元素")]}]},{type:"deepMenu",text:"布局屏蔽-鼠标悬浮提示",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text+"<br>视频区域-右侧工具栏",forms:[m("进入作者主页","dy-video-mouseHoverTip-rightToolBar-enterUserHome",false),m("关注","dy-video-mouseHoverTip-rightToolBar-follow",false),m("点赞","dy-video-mouseHoverTip-rightToolBar-addLike",false),m("评论","dy-video-mouseHoverTip-rightToolBar-comment",false),m("收藏","dy-video-mouseHoverTip-rightToolBar-collect",false),m("分享","dy-video-mouseHoverTip-rightToolBar-share",false),m("看相关","dy-video-mouseHoverTip-rightToolBar-seeCorrelation",false),m("更多","dy-video-mouseHoverTip-rightToolBar-more",false)]},{type:"forms",text:"视频区域-底部工具栏",forms:[m("自动连播","dy-video-mouseHoverTip-bottomToolBar-automaticBroadcast",false),m("清屏","dy-video-mouseHoverTip-bottomToolBar-clearScreen",false),m("稍后再看","dy-video-mouseHoverTip-bottomToolBar-watchLater",false),m("网页全屏","dy-video-mouseHoverTip-bottomToolBar-pageFullScreen",false),m("全屏","dy-video-mouseHoverTip-bottomToolBar-fullScreen",false)]}]}]}]},Ae=function(t,e,i,n,o,a,l,u,s,d){let c={text:t,type:"button",attributes:{},props:{},description:e,buttonIcon:n,buttonIsRightIcon:o,buttonIconIsLoading:a,buttonType:l,buttonText:i,callback(p){typeof u=="function"&&u(p);},afterAddToUListCallBack:s};return Reflect.set(c.attributes,He,()=>{c.disable=false;}),c},me=function(t,e,i,n,o,a="default",l){let u=o,s=()=>l.getShowText(i,u),d=Ae(t,e,s,"keyboard",false,false,a,async c=>{let v=c.target.closest(".pops-panel-button")?.querySelector("span");if(l.isWaitPress){k.warning("请先执行当前的录入操作");return}if(l.hasOptionValue(i))l.emptyOption(i),k.success("清空快捷键");else {let g=k.loading("请按下快捷键...",{showClose:true,onClose(){l.cancelEnterShortcutKeys();}}),{status:C,option:x,key:w}=await l.enterShortcutKeys(i);g.close(),C?(r.success(["成功录入快捷键",x]),k.success("成功录入")):k.error(`快捷键 ${l.translateKeyboardValueToButtonText(x)} 已被 ${w} 占用`);}v.innerHTML=s();});return d.attributes={},Reflect.set(d.attributes,He,()=>false),d},Pe=function(t,e,i,n,o,a,l,u,s,d){let c={text:t,type:"slider",description:u,attributes:{},props:{},getValue(){return this.props[N].get(e,i)},getToolTipContent(p){return typeof l=="function"?l(p):`${p}`},callback(p,v){this.props[N].set(e,v);},min:n,max:o,step:s};return Reflect.set(c.attributes,oe,e),Reflect.set(c.attributes,ae,i),Se.initComponentsStorageApi("slider",c,{get(p,v){return h.getValue(p,v)},set(p,v){h.setValue(p,v);}}),c},_i={id:"panel-config-video",title:"视频",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[ue("清晰度","chooseVideoDefinition",-2,[{text:"超清 4K",value:-2},{text:"超清 2K",value:-1},{text:"高清 1080P",value:1},{text:"高清 720P",value:2},{text:"标清 540P",value:3},{text:"极速",value:4},{text:"智能",value:0}],void 0,"自行选择清晰度"),m("沉浸模式","fullScreen",false,void 0,"移除右侧工具栏、底部信息栏等"),m("手机模式","mobileMode",false,void 0,"放大文字和图标"),m("评论区移到中间","changeCommentToBottom",true,void 0,"修改评论区为中间弹出而非右侧区域"),m("修复进度条","repairProgressBar",false,void 0,"修复移动端不能点击拖拽和定位进度的问题（仅移动端使用）"),m("禁用双击点赞","dy-video-disableDoubleClickLike",false,void 0,"禁止视频区域双击点赞"),m("手势返回关闭评论区","dy-video-gestureBackCloseComment",false,void 0,"浏览器手势返回时关闭评论区"),m("监听并关闭【长时间无操作，已暂停播放】弹窗","dy-video-waitToRemovePauseDialog",true,void 0,"自动监听并检测弹窗"),m("修改复制链接内容","dy-video-hookCopyLinkButton",true,void 0,"分享->复制链接，复制的内容仅为链接，不包含其它"),m("自动进入网页全屏","autoEnterElementFullScreen",false,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),m("双击进入网页全屏","dy-video-doubleClickEnterElementFullScreen",false,void 0,"双击视频自动进入网页全屏，检测间隔250ms"),m("移除video的bottom偏移","dy-video-removeStyle-bottom",false,void 0,""),m("禁用右侧工具栏的transform","dy-video-disableRightToolbarTransform",false,void 0,"")]},{type:"forms",text:"解析下载",forms:[m("视频解析","parseVideo",true,void 0,"点击视频右侧工具栏的分享按钮-下载（无视<code>该视频不支持下载</code>的提示）"),m("弹出下载重命名文件名弹窗","dy-video-popupDownloadRenameFileName",false,void 0,"当点击下载时，如果启用该功能，则弹出下载重命名文件名弹窗，可自定义文件名")]},{text:"视频区域背景色",type:"forms",forms:[m("启用","dy-video-bgColor-enable",false,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"dy-video-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(t){let e=f.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色，包括评论区</p>
											`}),i=f.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");n.value=h.getValue("dy-video-changeBackgroundColor");let o=f.createElement("style");return f.append(document.head,o),f.on(n,["input","propertychange"],a=>{r.info("选择颜色："+n.value),o.innerHTML=`
												#sliderVideo > div{
													background: ${n.value};
												}
												`,h.setValue("dy-video-changeBackgroundColor",n.value);}),t.appendChild(e),t.appendChild(i),t}}]},{type:"forms",text:"视频标题",forms:[m("自动隐藏视频标题","dy-video-titleInfoAutoHide",false,void 0,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Pe("延迟自动隐藏的时间","dy-video-titleInfoAutoHide-delayTime",3e3,0,8e3,void 0,t=>`${t}ms`,"设置首次延迟自动隐藏视频标题的时间，单位（ms）",100)]},{type:"forms",text:"底部的视频控件",forms:[m("自动隐藏视频控件","dy-video-videoControlsAutoHide",false,void 0,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Pe("延迟自动隐藏的时间","dy-video-videoControlsAutoHide-delayTime",3e3,0,8e3,void 0,t=>`${t}ms`,"设置首次延迟自动隐藏视频标题的时间，单位（ms）",100)]},{type:"forms",text:"右侧工具栏",forms:[m("自动隐藏右侧工具栏","dy-video-rightToolBarAutoHide",false,void 0,"鼠标移入时自动显示，鼠标移除时自动隐藏"),Pe("延迟自动隐藏的时间","dy-video-rightToolBarAutoHide-delayTime",3e3,0,8e3,void 0,t=>`${t}ms`,"设置首次延迟自动隐藏视频标题的时间，单位（ms）",100)]}]},{text:"自定义快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[me("倍速 -> 小","视频倍速变小","dy-video-rate-low",void 0,"点击录入快捷键",void 0,ie.shortCut),me("倍速 -> 大","视频倍速变大","dy-video-rate-up",void 0,"点击录入快捷键",void 0,ie.shortCut),me("沉浸模式","移除右侧工具栏、底部信息栏等","dy-video-shortcut-immersionMode",void 0,"点击录入快捷键",void 0,ie.shortCut),me("切换静音状态","切换video标签的muted属性","dy-video-shortcut-changeVideoMuted",void 0,"点击录入快捷键",void 0,ie.shortCut)]}]},{type:"deepMenu",text:"禁用抖音快捷键",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text,forms:[m("上翻页","dy-keyboard-hook-arrowUp-w",false,void 0,"W"),m("下翻页","dy-keyboard-hook-arrowDown-s",false,void 0,"S"),m("快退","dy-keyboard-hook-videoRewind",false,void 0,"A"),m("快进","dy-keyboard-hook-videoFastForward",false,void 0,"D")]}]},{text:"过滤器",type:"deepMenu",forms:[{text:'<a href="https://greasyfork.org/zh-CN/scripts/494643-%E6%8A%96%E9%9F%B3%E4%BC%98%E5%8C%96#:~:text=%E5%B1%8F%E8%94%BD%E8%A7%84%E5%88%99" target="_blank">点击查看规则</a>',type:"forms",forms:[m("启用","shieldVideo-exec-network-enable",true,void 0,"开启后以下功能才会生效"),m("仅显示被过滤的视频","shieldVideo-only-show-filtered-video",false,void 0,"只会显示过滤规则命中的视频"),m("新增 {...} 按钮","shieldVideo-add-parseVideoInfoButton",true,void 0,"在视频的底部的工具栏中显示 {...} 按钮，用于查看视频信息以便于进行添加过滤规则"),Ae("视频过滤规则","可过滤视频","自定义",void 0,false,false,"primary",()=>{ce.showView();})]},{type:"forms",text:"",forms:[Ae("数据导入","导入自定义规则数据","导入",void 0,false,false,"primary",()=>{ce.$data.videoFilterRuleStorage.importRules();}),Ae("数据导出","导出自定义规则数据","导出",void 0,false,false,"primary",()=>{ce.$data.videoFilterRuleStorage.exportRules(Mt+"-视频过滤规则.json");})]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-视频区域内",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text+"<br>右侧工具栏",type:"forms",forms:[m("【屏蔽】切换播放","shieldPlaySwitchButton",false,void 0,"屏蔽元素，在右侧作者头像上方或者是在右侧区域"),m("【屏蔽】AI抖音","blockAIDouYin",false,void 0,"屏蔽元素"),m("【屏蔽】作者头像","shieldAuthorAvatar",false,void 0,"屏蔽元素"),m("【屏蔽】点赞","shieldLikeButton",false,void 0,"屏蔽元素"),m("【屏蔽】评论","shieldCommentButton",false,void 0,"屏蔽元素"),m("【屏蔽】收藏","shieldCollectionButton",false,void 0,"屏蔽元素"),m("【屏蔽】分享","shieldSharenButton",false,void 0,"屏蔽元素"),m("【屏蔽】听抖音","shieldListenDouYinButton",false,void 0,"屏蔽元素"),m("【屏蔽】看相关","shieldRelatedRecommendationsButton",false,void 0,"屏蔽元素"),m("【屏蔽】更多","shieldMoreButton",false,void 0,"<code>...</code>按钮")]},{text:"底部工具栏-视频信息区域",type:"forms",forms:[m("【屏蔽】视频信息","dy-video-bottom-shieldVideoInfoWrap",false,void 0,"屏蔽元素，可代替【清屏】功能"),m("<code>【屏蔽】点击推荐</code>或<code>【屏蔽】共xx人推荐</code>","dy-video-blockClickRecommend",false,void 0,"屏蔽元素"),m("【屏蔽】视频标题上面的标签","dy-video-blockTitleTopTag",false,void 0,"例如：每周精选、抖音精选"),m("【屏蔽】视频标题下面的标签","dy-video-bottom-shieldVideoUnderTitleTag",false,void 0,"例如：相关搜索、AI搜索、合集...等"),m("【屏蔽】及时接收作品更新提醒","dy-video-blockClickUpdateReminder",false,void 0,"屏蔽元素"),m("【屏蔽】作者声明","dy-video-blockAuthorDeclaration",false,void 0,"例如：<code>作者声明：虚构演绎，仅供娱乐</code>"),m("【屏蔽】识别画面","dy-video-blockAIIdentifyTheScreen",false,void 0,"屏蔽元素")]},{type:"forms",text:"底部工具栏-播放工具",forms:[m("【屏蔽】播放工具组件","shieldBottomVideoToolBar",false,void 0,"屏蔽元素"),m("【屏蔽】弹幕容器","shieldBottomVideoToolbarDanmuContainer",false,void 0,"屏蔽元素（不包括屏蔽弹幕）"),m("【屏蔽】AI笔记","shieldBottomVideoToolbar-aiNotes",false,void 0,"屏蔽元素"),m("【屏蔽】连播","shieldBottomVideoToolbar-autoPlay",false,void 0,"屏蔽元素"),m("【屏蔽】清屏","shieldBottomVideoToolbar-clearScreen",false,void 0,"屏蔽元素"),m("【屏蔽】清晰度","shieldBottomVideoToolbar-playclarity",false,void 0,"屏蔽元素"),m("【屏蔽】倍速","shieldBottomVideoToolbar-playback",false,void 0,"屏蔽元素"),m("【屏蔽】稍后再看","shieldBottomVideoToolbar-watchLater",false,void 0,"屏蔽元素"),m("【屏蔽】小窗模式","shieldBottomVideoToolbar-miniMode",false,void 0,"屏蔽元素"),m("【屏蔽】网页全屏","shieldBottomVideoToolbar-pageFullScreen",false,void 0,"屏蔽元素"),m("【屏蔽】进入全屏","shieldBottomVideoToolbar-fullScreen",false,void 0,"屏蔽元素")]},{text:"其它",type:"forms",forms:[m("【屏蔽】右侧的展开评论按钮","shieldRightExpandCommentButton",true,void 0,"屏蔽元素"),m("【屏蔽】搜索悬浮栏","shieldSearchFloatingBar",true,void 0,"屏蔽元素，一般出现在左上角"),m("【屏蔽】网页全屏关闭按钮","shieldCloseFullScreenButton",true,void 0,"屏蔽元素，一般开启网页全屏后出现在左上角"),m("【屏蔽】购物信息","dy-video-blockShopInfo",true,void 0,"屏蔽元素，该元素出现在视频底部的用户名、标题信息的上面")]}]},{text:"布局屏蔽-评论区域内",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】评论工具栏","dy-video-shieldUserCommentToolBar",false,void 0,"屏蔽元素"),m("【屏蔽】大家都在搜","dy-video-shieldUserCommentEveryOneAllSearch",false,void 0,"在评论区的顶部出现")]}]}]}]},Mi={id:"panel-config-search",title:"搜索",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("禁止点击视频区域进入全屏","dy-search-disableClickToEnterFullScreen",false,void 0,"禁止点击视频区域时会触发自动进入全屏功能"),ue("自动进入网页全屏","search-autoEnterElementFullScreen",0,()=>[{text:`跟随主设置（${Q.get("autoEnterElementFullScreen")?"是":"否"}）`,value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,["视频","功能","自动进入网页全屏"].map(t=>`<code>${t}</code>`).join("-")),ue("搜索结果-视频-显示样式","live-setSearchResultFilterWithVideoStyle","one",[{text:"单列",value:"one"},{text:"双列",value:"double"}],void 0,"自定义搜索结果，按视频筛选的结果项的显示样式")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】相关搜索","douyin-search-shieldReleatedSearches",false,void 0,"屏蔽右边的相关搜索"),m("【屏蔽】AI问一问","douyin-search-blockAIAsk",false,void 0,"相关搜索上面的问一问"),m("【屏蔽】问问AI","douyin-search-blockAskAI",false,void 0,"为你找到以下结果，问问AI智能总结内容")]}]},{text:"布局屏蔽-左侧导航栏",type:"deepMenu",forms:[{text:"",type:"forms",forms:[ue("【屏蔽】左侧导航栏","search-shieldLeftNavigator",-1,()=>[{text:`跟随主设置（${Q.get("shieldLeftNavigator")?"是":"否"}）`,value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,["通用","布局屏蔽-左侧导航栏","【屏蔽】左侧导航栏"].map(t=>`<code>${t}</code>`).join("-"))]}]},{text:"布局屏蔽-顶部导航栏",type:"deepMenu",forms:[{text:"",type:"forms",forms:[ue("【屏蔽】顶部导航栏","search-shieldTopNavigator",-1,()=>[{text:`跟随主设置（${Q.get("shieldTopNavigator")?"是":"否"}）`,value:-1},{text:"是",value:1},{text:"否",value:0}],void 0,["通用","布局屏蔽-顶部导航栏","【屏蔽】顶部导航栏"].map(t=>`<code>${t}</code>`).join("-"))]}]}]}]},Li={id:"panel-config-live",title:"直播",forms:[{text:"",type:"forms",forms:[{text:"功能",type:"deepMenu",forms:[{text:"功能",type:"forms",forms:[ue("清晰度","live-chooseQuality","origin",Object.keys(ee).map(t=>{let e=ee[t];return {value:t,text:e.label}}),void 0,"自行选择清晰度"),m("自动进入网页全屏","live-autoEnterElementFullScreen",false,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),m("监听并关闭【长时间无操作，已暂停播放】弹窗","live-waitToRemovePauseDialog",true,void 0,"自动监听并检测弹窗"),m("禁止自动播放","live-pauseVideo",false,void 0,"3秒内禁止任何形式的播放"),m("禁用双击点赞","dy-live-disableDoubleClickLike",false,void 0,"禁止直播视频区域双击点赞"),m("自动关闭聊天室","dy-live-autoCloseChatRoom",false,void 0,"自动点击关闭聊天室按钮"),m("禁用鼠标滚轮切换直播间","live-prevent-wheel-switchLiveRoom",false,void 0,"")]},{text:"视频区域背景色",type:"forms",forms:[m("启用","live-bgColor-enable",false,void 0,"自定义视频背景色"),{type:"own",attributes:{"data-key":"live-changeBackgroundColor","data-default-value":"#000000"},getLiElementCallBack(t){let e=f.createElement("div",{className:"pops-panel-item-left-text",innerHTML:`
											<p class="pops-panel-item-left-main-text">视频背景颜色</p>
											<p class="pops-panel-item-left-desc-text">自定义视频背景颜色</p>
											`}),i=f.createElement("div",{className:"pops-panel-item-right",innerHTML:`
											<input type="color" class="pops-color-choose" />
											`}),n=i.querySelector(".pops-color-choose");return n.value=h.getValue("live-changeBackgroundColor"),f.on(n,["input","propertychange"],o=>{r.info("选择颜色："+n.value),h.setValue("live-changeBackgroundColor",n.value);}),t.appendChild(e),t.appendChild(i),t}}]}]},{text:"消息过滤器",type:"deepMenu",description:"包括：弹幕、聊天室",forms:[{text:"",type:"forms",forms:[m("启用","live-danmu-shield-rule-enable",false,void 0,"启用自定义的弹幕过滤规则"),m("【屏蔽】送礼信息","live-danmu-shield-gift",false,void 0,""),m("【屏蔽】福袋口令","live-danmu-shield-lucky-bag",false,void 0,"")]},{type:"forms",text:"聊天室",forms:[m("【屏蔽】xxx 为主播加了 xx分","live-message-shield-biz_scene-common_text_game_score",false,void 0,""),m("【屏蔽】emoji","live-message-shield-method-emoji-chat",false,void 0,"")]},{type:"forms",text:"",forms:[{type:"own",getLiElementCallBack(t){let e=f.createElement("div",{className:"pops-panel-textarea",innerHTML:`<textarea placeholder="请输入屏蔽规则，每行一个
例如：屏蔽包含'主播'的消息
主播" style="height:350px;"></textarea>`},{style:"width: 100%;"}),i=e.querySelector("textarea");return i.value=Le.get(),f.on(i,["input","propertychange"],b.debounce(function(){Le.set(i.value),Le.init();},1e3)),t.appendChild(e),t}}]}]},{text:"自定义快捷键",type:"deepMenu",forms:[{text:"",type:"forms",forms:[me("【屏蔽】聊天室","","dy-live-block-chatroom",void 0,"点击录入快捷键",void 0,Ie.shortCut),me("【屏蔽】礼物特效","","dy-live-shieldGiftEffects",void 0,"点击录入快捷键",void 0,Ie.shortCut),me("切换静音状态","切换video标签的muted属性","dy-live-shortcut-changeVideoMuted",void 0,"点击录入快捷键",void 0,Ie.shortCut)]}]},{type:"deepMenu",text:"禁用抖音快捷键",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{type:"forms",text:P.text,forms:[m("刷新","dy-live-refresh",false,void 0,"E"),m("屏幕旋转","dy-live-screenRotation",false,void 0,"D"),m("开启小窗模式","dy-live-enableSmallWindowMode",false,void 0,"U"),m("切换直播间","dy-live-switchLiveRoom",false,void 0,"↑↓")]}]}]},{text:"",type:"forms",forms:[{text:"布局屏蔽-视频区域内",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】顶栏信息","live-shieldTopToolBarInfo",false,void 0,"屏蔽元素，包括直播作者、右侧的礼物展馆"),m("【屏蔽】底部的礼物栏","live-shieldGiftColumn",false,void 0,"屏蔽元素"),m("【屏蔽】礼物特效","live-shieldGiftEffects",false,void 0,"屏蔽元素"),m("【屏蔽】福袋","live-shieldLucky",false,void 0,"屏蔽元素"),m("【屏蔽】弹幕","live-shieldDanmuku",false,void 0,"屏蔽元素"),m("【屏蔽】小黄车","live-shielYellowCar",false,void 0,"屏蔽元素"),m("【屏蔽】点亮展馆帮主播集星","live-block-exhibition-banner-dylive-tooltip",false,void 0,"屏蔽元素，礼物展馆下面的悬浮提示")]},{type:"forms",text:"右键菜单",forms:[m("【屏蔽】下载客户端","dy-live-blockVideoRightMenu-downloadClient",true,void 0,"屏蔽右键菜单项")]}]},{text:"布局屏蔽-聊天室",type:"deepMenu",afterEnterDeepMenuCallBack:P.afterEnterDeepMenuCallBack,forms:[{text:P.text,type:"forms",forms:[m("【屏蔽】聊天室","live-shieldChatRoom",false,void 0,"屏蔽元素"),m("【屏蔽】贵宾席","live-shielChatRoomVipSeats",false,void 0,"屏蔽元素"),m("【屏蔽】用户等级图标","dy-live-shieldUserLevelIcon",false,void 0,"屏蔽元素"),m("【屏蔽】VIP图标","dy-live-shieldUserVIPIcon",false,void 0,"屏蔽元素"),m("【屏蔽】粉丝牌","dy-live-shieldUserFansIcon",false,void 0,"屏蔽元素"),m("【屏蔽】信息播报","dy-live-shieldMessage",false,void 0,"底部滚动播报的的xxx来了，xxx给主播点赞")]}]}]}]},Vi={id:"panel-config-user",title:"用户",forms:[{text:"功能",type:"forms",forms:[m("显示UID","dy-user-addShowUserUID",true,void 0,"在用户信息区域下方显示当前用户的uid")]}]},Bi={id:"m-panel-config-share-user",title:"主页",headerTitle:"/share/user<br />主页",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("视频合集","m-dy-share-user-coverPlayletList",true,void 0,"正确跳转视频合集页面"),m("视频列表","m-dy-share-user-coverPostListContainer",true,void 0,"正确跳转视频页面")]}]}]}]},Ri={id:"m-panel-config-share-note",title:"笔记",headerTitle:"/share/note<br />笔记",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("精彩图文","m-dy-share-note-coverExcitingGraphicsAndText",true,void 0,"正确跳转笔记页面"),m("用户","m-dy-share-note-coverUser",true,void 0,"正确跳转用户主页"),m("话题","m-dy-share-note-coverHashTag",true,void 0,"正确跳转相关话题"),m("音乐","m-dy-share-note-coverMusic",true,void 0,"正确跳转相关音乐"),m("相关推荐","m-dy-share-note-coverRecommend",true,void 0,"正确跳转笔记页面")]}]},{text:"屏蔽元素",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("【屏蔽】评论","m-dy-share-note-blockComment",false,void 0,"屏蔽元素"),m("【屏蔽】相关推荐","m-dy-share-note-blockRecommend",false,void 0,"屏蔽元素"),m("【屏蔽】底部工具栏","m-dy-share-note-blockFooterToobar",false,void 0,"屏蔽元素")]}]}]}]},Ii={id:"m-panel-config-share-challenge",title:"话题",headerTitle:"/share/challenge<br />话题",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("顶部区域","m-dy-share-challenge-coverTopJump",true,void 0,"阻止跳转至下载页面"),m("视频卡片","m-dy-share-challenge-coverVideoCard",true,void 0,"正确跳转视频页面")]}]}]}]},Ai={id:"m-panel-config-share-video",title:"视频",headerTitle:"/share/video<br />视频",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("全局点击","m-dy-share-video-coverGlobalClick",true,void 0,"阻止跳转至下载页")]}]}]}]},Ti={id:"m-panel-config-share-music",title:"音乐",headerTitle:"/share/music<br />音乐",forms:[{text:"",type:"forms",forms:[{text:"覆盖点击事件",type:"deepMenu",forms:[{text:"",type:"forms",forms:[m("视频卡片","m-dy-share-music-coverVideoCard",true,void 0,"正确跳转视频页面")]}]}]}]},Ei={id:"panel-config-recommend",title:"推荐",forms:[{text:"功能",type:"forms",forms:[m("自动连播","dy-recommend-automaticContinuousPlayback",false,void 0,"注意：请勿和推荐页面自带的<code>连播</code>功能同时使用")]}]};we.addContentConfig([Si,_i,Ei,Mi,Li,Vi]);we.addContentConfig([Bi,Ri,Ii,Ai,Ti]);ut.addMenuOption({key:"show_pops_m_panel_setting",text:"⚙ 移动端设置",autoReload:false,isStoreValue:false,showText(t){return t},callback:()=>{h.showPanel(we.getConfig(1),`${h.$data.scriptName}-移动端设置`);}});h.init();ke.isMDouYin()?ki.init():mt.init();

})(Qmsg, DOMUtils, Utils, pops);