// ==UserScript==
// @name         图片右键菜单
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2025.5.25
// @author       WhiteSevs
// @description  在浏览器预览图片页面添加全局右键菜单，右键直接复制该图片的Uri编码，支持自动判断图片类型，包括：jpg、jpeg、png、gif、webp、ico，支持手动判断图片类型，包括：jpg、jpeg、png、gif。
// @license      GPL-3.0-only
// @icon         data:image/png;base64,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
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*/*
// @require      https://fastly.jsdelivr.net/gh/WhiteSevs/TamperMonkeyScript@86be74b83fca4fa47521cded28377b35e1d7d2ac/lib/CoverUMD/index.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/utils@2.6.6/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/domutils@1.5.4/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/@whitesev/pops@2.0.7/dist/index.umd.js
// @require      https://fastly.jsdelivr.net/npm/qmsg@1.3.2/dist/index.umd.js
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (m, P, E, A) {
	'use strict';

	var w=typeof GM_getValue<"u"?GM_getValue:void 0,C=typeof GM_info<"u"?GM_info:void 0,U=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,T=typeof GM_setValue<"u"?GM_setValue:void 0,j=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,q=typeof GM_xmlhttpRequest<"u"?GM_xmlhttpRequest:void 0,_=typeof unsafeWindow<"u"?unsafeWindow:void 0,B=window;const O="图片右键菜单",p=E.noConflict();P.noConflict();const x=A,h=new p.Log(C,_.console||B.console);var L;const $=((L=C==null?void 0:C.script)==null?void 0:L.name)||O,R=false;h.config({debug:R,logMaxCount:1e3,autoClearConsole:true,tag:true});m.config(Object.defineProperties({html:true,autoClose:true,showClose:false},{position:{get(){return c.getValue("qmsg-config-position","bottom")}},maxNums:{get(){return c.getValue("qmsg-config-maxnums",5)}},showReverse:{get(){return c.getValue("qmsg-config-showreverse",true)}},zIndex:{get(){let e=E.getMaxZIndex(),t=A.config.InstanceUtils.getPopsMaxZIndex().zIndex;return E.getMaxValue(e,t)+100}}}));const F=new p.GM_Menu({GM_getValue:w,GM_setValue:T,GM_registerMenuCommand:U,GM_unregisterMenuCommand:j}),I=new p.Httpx({xmlHttpRequest:q});I.interceptors.request.use(e=>e);I.interceptors.response.use(void 0,e=>(h.error("拦截器-请求错误",e),e.type==="onabort"?m.warning("请求取消"):e.type==="onerror"?m.error("请求异常"):e.type==="ontimeout"?m.error("请求超时"):m.error("其它错误"),e));I.config({logDetails:R});_.Object.defineProperty,_.Function.prototype.apply,_.Function.prototype.call,_.Element.prototype.appendChild,_.setTimeout;p.addStyle.bind(p);document.querySelector.bind(document);document.querySelectorAll.bind(document);const y="GM_Panel",W="data-init",b="data-key",V="data-default-value",H="data-init-more-value",v="data-storage-api",N=function(e,t,n,a,i,l){let o={text:e,type:"switch",description:i,attributes:{},props:{},getValue(){return !!this.props[v].get(t,n)},callback(s,f){let r=!!f;h.success(`${r?"开启":"关闭"} ${e}`),this.props[v].set(t,r);},afterAddToUListCallBack:l};return Reflect.set(o.attributes,b,t),Reflect.set(o.attributes,V,n),Reflect.set(o.props,v,{get(s,f){return c.getValue(s,f)},set(s,f){c.setValue(s,f);}}),o},D=function(e,t,n,a,i,l){let o=[];typeof a=="function"?o=a():o=a;let s={text:e,type:"select",description:l,attributes:{},props:{},getValue(){return this.props[v].get(t,n)},callback(f,r,g){let u=r;h.info(`选择：${g}`),this.props[v].set(t,u),typeof i=="function"&&i(f,u,g);},data:o};return Reflect.set(s.attributes,b,t),Reflect.set(s.attributes,V,n),Reflect.set(s.props,v,{get(f,r){return c.getValue(f,r)},set(f,r){c.setValue(f,r);}}),s},K={id:"component-common",title:"通用",forms:[{text:"Toast配置",type:"forms",forms:[D("Toast位置","qmsg-config-position","bottom",[{value:"topleft",text:"左上角"},{value:"top",text:"顶部"},{value:"topright",text:"右上角"},{value:"left",text:"左边"},{value:"center",text:"中间"},{value:"right",text:"右边"},{value:"bottomleft",text:"左下角"},{value:"bottom",text:"底部"},{value:"bottomright",text:"右下角"}],(e,t,n)=>{h.info("设置当前Qmsg弹出位置"+n);},"Toast显示在页面九宫格的位置"),D("最多显示的数量","qmsg-config-maxnums",3,[{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}],void 0,"限制Toast显示的数量"),N("逆序弹出","qmsg-config-showreverse",false,void 0,"修改Toast弹出的顺序")]}]},S={setting:{get width(){return window.innerWidth<550?"88vw":"550px"},get height(){return window.innerHeight<450?"70vh":"450px"}}},c={$data:{__data:null,__oneSuccessExecMenu:null,__onceExec:null,__listenData:null,get data(){return c.$data.__data==null&&(c.$data.__data=new p.Dictionary),c.$data.__data},get oneSuccessExecMenu(){return c.$data.__oneSuccessExecMenu==null&&(c.$data.__oneSuccessExecMenu=new p.Dictionary),c.$data.__oneSuccessExecMenu},get onceExec(){return c.$data.__onceExec==null&&(c.$data.__onceExec=new p.Dictionary),c.$data.__onceExec},get scriptName(){return $},key:y,attributeKeyName:b,attributeDefaultValueName:V},$listener:{get listenData(){return c.$data.__listenData==null&&(c.$data.__listenData=new p.Dictionary),c.$data.__listenData}},init(){this.initPanelDefaultValue(),this.initExtensionsMenu();},isTopWindow(){return _.top===_.self},initExtensionsMenu(){this.isTopWindow()&&F.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:false,isStoreValue:false,showText(e){return e},callback:()=>{this.showPanel();}}]);},initPanelDefaultValue(){let e=this;function t(i){if(!i.attributes)return;let l={},o=i.attributes[b];o!=null&&(l[o]=i.attributes[V]);let s=i.attributes[W];if(typeof s=="function"){let g=s();if(typeof g=="boolean"&&!g)return}let f=i.attributes[H];f&&typeof f=="object"&&Object.assign(l,f);let r=Object.keys(l);if(!r.length){h.warn(["请先配置键",i]);return}r.forEach(g=>{let u=l[g];e.$data.data.has(g)&&h.warn("请检查该key(已存在): "+g),e.$data.data.set(g,u);});}function n(i){for(let l=0;l<i.length;l++){let o=i[l];t(o);let s=o.forms;s&&Array.isArray(s)&&n(s);}}let a=this.getPanelContentConfig();for(let i=0;i<a.length;i++){let l=a[i];if(!l.forms)continue;let o=l.forms;o&&Array.isArray(o)&&n(o);}},setValue(e,t){let n=w(y,{}),a=n[e];n[e]=t,T(y,n),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,a,t);},getValue(e,t){let a=w(y,{})[e];return a??(this.$data.data.has(e)?this.$data.data.get(e):t)},deleteValue(e){let t=w(y,{}),n=t[e];Reflect.deleteProperty(t,e),T(y,t),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,n,void 0);},addValueChangeListener(e,t){let n=Math.random();return this.$listener.listenData.set(e,{id:n,key:e,callback:t}),n},removeValueChangeListener(e){let t=null;for(const[n,a]of this.$listener.listenData.entries())if(a.id===e){t=n;break}typeof t=="string"?this.$listener.listenData.delete(t):console.warn("没有找到对应的监听器");},triggerMenuValueChange(e,t,n){if(this.$listener.listenData.has(e)){let a=this.$listener.listenData.get(e);if(typeof a.callback=="function"){let i=this.getValue(e),l=i,o=i;typeof t<"u"&&arguments.length>1&&(l=t),typeof n<"u"&&arguments.length>2&&(o=n),a.callback(e,o,l);}}},hasKey(e){let t=w(y,{});return e in t},execMenu(e,t,n=false){if(!(typeof e=="string"||typeof e=="object"&&Array.isArray(e)))throw new TypeError("key 必须是字符串或者字符串数组");let a=[];typeof e=="object"&&Array.isArray(e)?a=[...e]:a.push(e);let i;for(let l=0;l<a.length;l++){const o=a[l];if(!this.$data.data.has(o)){h.warn(`${e} 键不存在`);return}let s=c.getValue(o);if(n&&(s=!s),!s)break;i=s;}i&&t(i);},execMenuOnce(e,t,n,a){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){h.warn(`${e} 键不存在`);return}if(this.$data.oneSuccessExecMenu.has(e))return;this.$data.oneSuccessExecMenu.set(e,1);let i=()=>{let r=c.getValue(e);return typeof n=="function"?n(e,r):r},l=[],o=r=>{let g=i(),u=[];if(r instanceof HTMLStyleElement?u=[r]:Array.isArray(r)&&(u=[...r.filter(d=>d!=null&&d instanceof HTMLStyleElement)]),g)l=l.concat(u);else for(let d=0;d<u.length;d++)u[d].remove(),u.splice(d,1),d--;},s=r=>{let g=[];if(r){let u=t(r,o);u instanceof HTMLStyleElement?g=[u]:Array.isArray(u)&&(g=[...u.filter(d=>d!=null&&d instanceof HTMLStyleElement)]);}for(let u=0;u<l.length;u++)l[u].remove(),l.splice(u,1),u--;l=[...g];};this.addValueChangeListener(e,(r,g,u)=>{let d=u;typeof a=="function"&&(d=a(r,u,g)),s(d);});let f=i();f&&s(f);},execInheritMenuOnce(e,t,n,a){let i=this;const l=(o,s)=>{let f=i.getValue(o),r=i.getValue(s);if(typeof a=="function"){let g=a(f,r);if(g!==void 0)return g}return f};this.execMenuOnce(e,n,()=>l(e,t),()=>l(e,t)),this.execMenuOnce(t,()=>{},()=>false,()=>(this.triggerMenuValueChange(e),false));},onceExec(e,t){if(typeof e!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(e)||(t(),this.$data.onceExec.set(e,1));},showPanel(){x.panel({title:{text:`${$}-设置`,position:"center",html:false,style:""},content:this.getPanelContentConfig(),mask:{enable:true,clickEvent:{toClose:true,toHide:false}},width:S.setting.width,height:S.setting.height,drag:true,only:true});},getPanelContentConfig(){return [K]}},M={default:{getBase64Image(e,t="image/png"){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var a=n.getContext("2d");a.drawImage(e,0,0,e.width,e.height);var i=n.toDataURL("image/png");return i}},gif:{getImageFileFromUrl(e,t,n){fetch(e).then(a=>a.blob()).then(a=>{let i=new File([a],t,{type:"image/gif"});n(i);});},chooseStaticImg(e){let t=null;return new Promise((n,a)=>{this.getImageFileFromUrl(e,"图片.gif",i=>{let l=new FileReader;l.onloadend=()=>{t=l.result,n(t);},l.readAsDataURL(i);});})}},async networkQueryContentType(e){let t=await I.head(e,{fetch:true});if(t.status&&t.data.responseFetchHeaders.has("Content-Type"))return t.data.responseFetchHeaders.get("Content-Type")}},G=[{rule:".png",type:"image/png"},{rule:".jpg",type:"image/jpg"},{rule:".jpeg",type:"image/jpeg"},{rule:".webp",type:"image/webp"},{rule:".ico",type:"image/ico"},{rule:".gif",type:"image/gif"}],Q={init(){let e=document.body.querySelectorAll("img");if(e.length!==1){h.error("页面中的<img>元素数量不为1");return}h.info("注入全局右键-图片");let t=e[0],n=t.src;x.rightClickMenu({target:_,data:[{icon:x.config.iconSVG.documentCopy,iconIsLoading:false,text:"自动判断",async callback(){let a=null;if(n.startsWith("http")||n.startsWith("file:")){let i=-1;i=G.findIndex(l=>n.endsWith(l.rule)),i!==-1&&(a=G[i].type),!a&&n.startsWith("http")&&(m.info("通过网络请求判断类型"),a=await M.networkQueryContentType(n),h.info("请求获取的Content-Type："+a),a&&m.success("图片类型："+a));}a?a.endsWith("gif")?M.gif.chooseStaticImg(n).then(i=>{p.setClip(i),m.success("复制成功！");}):(p.setClip(M.default.getBase64Image(t,a)),m.success("复制成功！")):m.error("未知的图片类型");}},{icon:x.config.iconSVG.chromeFilled,iconIsLoading:false,text:"其它类型",callback(a){return  false},item:[{icon:x.config.iconSVG.documentCopy,iconIsLoading:false,text:"jpg",callback(){p.setClip(M.default.getBase64Image(t,"image/jpg")),m.success("复制成功！");}},{icon:x.config.iconSVG.documentCopy,iconIsLoading:false,text:"jpeg",callback(){p.setClip(M.default.getBase64Image(t,"image/jpeg")),m.success("复制成功！");}},{icon:x.config.iconSVG.documentCopy,iconIsLoading:false,text:"png",callback(){p.setClip(M.default.getBase64Image(t,"image/png")),m.success("复制成功！");}},{icon:x.config.iconSVG.documentCopy,iconIsLoading:false,text:"gif",callback(){M.gif.chooseStaticImg(n).then(a=>{p.setClip(a),m.success("复制成功！");});}}]}]});}};document.documentElement.hasAttribute("style")&&document.body.hasAttribute("style")&&document.body.children.length&&document.querySelector('meta[name="viewport"]')&&(c.init(),Q.init());

})(Qmsg, DOMUtils, Utils, pops);