// ==UserScript==
// @name         抖音优化
// @namespace    https://github.com/WhiteSevs/TamperMonkeyScript
// @version      2024.6.10
// @author       WhiteSevs
// @description  过滤广告、过滤直播、可自定义过滤视频的屏蔽关键字、伪装登录、直播屏蔽弹幕、礼物特效等
// @license      GPL-3.0-only
// @icon         data:image/png;base64,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
// @supportURL   https://github.com/WhiteSevs/TamperMonkeyScript/issues
// @match        *://*.douyin.com/*
// @require      https://update.greasyfork.org/scripts/494167/1376186/CoverUMD.js
// @require      https://update.greasyfork.org/scripts/456485/1384984/pops.js
// @require      https://cdn.jsdelivr.net/npm/qmsg@1.1.2/dist/index.umd.js
// @require      https://cdn.jsdelivr.net/npm/@whitesev/utils@1.4.2/dist/index.umd.js
// @require      https://cdn.jsdelivr.net/npm/@whitesev/domutils@1.1.1/dist/index.umd.js
// @grant        GM_addStyle
// @grant        GM_deleteValue
// @grant        GM_getValue
// @grant        GM_info
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @run-at       document-start
// ==/UserScript==

(function (k, we, be) {
	'use strict';

	var ue=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};var V=(e,t,i)=>(ue(e,t,"read from private field"),i?i.call(e):t.get(e)),U=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i);},D=(e,t,i,n)=>(ue(e,t,"write to private field"),t.set(e,i),i);var w=typeof GM_getValue<"u"?GM_getValue:void 0,A=typeof GM_info<"u"?GM_info:void 0,_e=typeof GM_registerMenuCommand<"u"?GM_registerMenuCommand:void 0,R=typeof GM_setValue<"u"?GM_setValue:void 0,ke=typeof GM_unregisterMenuCommand<"u"?GM_unregisterMenuCommand:void 0,b=typeof unsafeWindow<"u"?unsafeWindow:void 0,ye=window;const Me="抖音优化",f=we.noConflict();let y=be.noConflict();const Se=ye.pops||b.pops,Be=b.console||ye.console,o=new f.Log(A,Be);var ge;let he=((ge=A==null?void 0:A.script)==null?void 0:ge.name)||Me;o.config({debug:!1,logMaxCount:100,autoClearConsole:!0,tag:!0});k.config({position:"bottom",html:!0,maxNums:5,autoClose:!0,showClose:!1,showReverse:!0,zIndex:1e7});const Ve=new f.GM_Menu({GM_getValue:w,GM_setValue:R,GM_registerMenuCommand:_e,GM_unregisterMenuCommand:ke}),S=f.addStyle,E="GM_Panel",P="data-key",N="data-default-value",c=function(e,t,i,n,d){let a={text:e,type:"switch",description:d,attributes:{},getValue(){return !!l.getValue(t,i)},callback(u,r){o.success(`${r?"开启":"关闭"} ${e}`),l.setValue(t,!!r);},afterAddToUListCallBack:void 0};return a.attributes&&(a.attributes[P]=t,a.attributes[N]=!!i),a},Ee={id:"panel-config-common",title:"通用",forms:[{text:"功能",type:"forms",forms:[c("debug模式","debug",!0,void 0,"移除抖音的开发者模式检测"),c("伪装登录","disguiseLogin",!1,void 0,"使用随机UID进行伪装"),c("initial-scale=1","dy-initialScale",!1,void 0,"可配合手机模式放大页面"),c("移除<meta> apple-itunes-app","dy-apple-removeMetaAppleItunesApp",!0,void 0,"Safari使用，移除顶部横幅【Open in the 抖音 app】")]},{text:"Url重定向",type:"forms",forms:[c("重定向/home","douyin-redirect-url-home-to-root",!1,void 0,"/home => /")]},{text:"屏蔽",type:"forms",forms:[c("【屏蔽】登录弹窗","watchLoginDialogToClose",!0,void 0,"屏蔽元素且自动等待元素出现并关闭登录弹窗"),c("【屏蔽】底部？按钮","shieldBottomQuestionButton",!0,void 0,"屏蔽元素")]},{text:"主框架-屏蔽",type:"forms",forms:[c("【屏蔽】客户端提示","shieldClientTip",!0,void 0,"屏蔽元素"),c("【屏蔽】充砖石","shieldFillingBricksAndStones",!0,void 0,"屏蔽元素"),c("【屏蔽】客户端","shieldClient",!0,void 0,"屏蔽元素"),c("【屏蔽】快捷访问","shieldQuickAccess",!1,void 0,"屏蔽元素"),c("【屏蔽】通知","shieldNotifitation",!1,void 0,"屏蔽元素"),c("【屏蔽】私信","shieldPrivateMessage",!1,void 0,"屏蔽元素"),c("【屏蔽】投稿","shieldSubmission",!1,void 0,"屏蔽元素"),c("【屏蔽】左侧导航栏","shieldLeftNavigator",!1,void 0,"屏蔽元素"),c("【屏蔽】顶部导航栏","shieldTopNavigator",!1,void 0,"屏蔽元素")]},{text:"搜索-屏蔽",type:"forms",forms:[c("【屏蔽】搜索框","shieldSearch",!1,void 0,"屏蔽元素"),c("【屏蔽】搜索框的提示","shieldSearchPlaceholder",!1,void 0,"屏蔽元素"),c("【屏蔽】猜你想搜","shieldSearchGuessYouWantToSearch",!1,void 0,"屏蔽元素"),c("【屏蔽】抖音热点","shieldSearchTiktokHotspot",!1,void 0,"屏蔽元素")]}]},h={isVerticalScreen(){return !window.screen.orientation.type.includes("landscape")},addBlockCSS(...e){let t=[];e.length!==0&&(e.length===1&&typeof e[0]=="string"&&e[0].trim()===""||(e.forEach(i=>{Array.isArray(i)?t=t.concat(i):t.push(i);}),f.addStyle(`${t.join(`,
`)}{display: none !important;}`)));}},$={key:"douyin-live-danmu-rule",$data:{rule:[],isFilterAttrName:"data-is-filter"},init(){this.parseRule();},parseRule(){this.get().trim().split(`
`).forEach(i=>{if(i.trim()=="")return;i=i.trim();let n=new RegExp(i.trim());this.$data.rule.push(n);});},change(){var t,i,n,d,a,u,r;let e=Array.from(document.querySelectorAll("xg-danmu.xgplayer-danmu > div > div"));if(e.length)for(let s=0;s<e.length;s++){let m=e[s];if(m.hasAttribute(this.$data.isFilterAttrName))continue;let p=(d=(n=(i=(t=f.getReactObj(m))==null?void 0:t.reactFiber)==null?void 0:i.return)==null?void 0:n.memoizedProps)==null?void 0:d.message,g=((a=p==null?void 0:p.payload)==null?void 0:a.content)||((r=(u=p==null?void 0:p.payload)==null?void 0:u.common)==null?void 0:r.describe);for(let v=0;v<this.$data.rule.length;v++){const M=this.$data.rule[v];if(typeof g=="string"&&M.test(g)){o.info("过滤弹幕: "+g),m.setAttribute(this.$data.isFilterAttrName,"true"),y.hide(m);break}}}},set(e){R(this.key,e);},get(){return w(this.key,"")}},fe={shieldDanmu(){o.info("屏蔽弹幕"),h.addBlockCSS("xg-danmu.xgplayer-danmu");},filterDanmu(){f.waitNode("xg-danmu.xgplayer-danmu",1e5).then(e=>{if(!e){o.error("xg-danmu.xgplayer-danmu获取失败");return}o.success("弹幕过滤"),$.init(),f.mutationObserver(e,{config:{childList:!0,subtree:!0},callback:()=>{$.change();}});});}},Te={id:"panel-config-live",title:"直播",forms:[{text:"功能",type:"forms",forms:[c("自动进入网页全屏","live-autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),c("解锁画质选择","live-unlockImageQuality",!0,void 0,"未登录的情况下选择原画实际上是未登录的情况下最高选择的画质"),c("监听并关闭【长时间无操作，已暂停播放】弹窗","live-waitToRemovePauseDialog",!0,void 0,"自动监听并检测弹窗")]},{text:"视频区域内-屏蔽",type:"forms",forms:[c("【屏蔽】顶栏信息","live-shieldTopToolBarInfo",!1,void 0,"屏蔽元素，包括直播作者、右侧的礼物展馆"),c("【屏蔽】底部的礼物栏","live-shieldGiftColumn",!1,void 0,"屏蔽元素"),c("【屏蔽】礼物特效","live-shieldGiftEffects",!1,void 0,"屏蔽元素"),c("【屏蔽】弹幕","live-shieldDanmuku",!1,void 0,"屏蔽元素")]},{text:"聊天室-屏蔽",type:"forms",forms:[c("【屏蔽】聊天室","live-shieldChatRoom",!1,void 0,"屏蔽元素"),c("【屏蔽】贵宾席","live-shielChatRoomVipSeats",!1,void 0,"屏蔽元素"),c("【屏蔽】用户等级图标","dy-live-shieldUserLevelIcon",!1,void 0,"屏蔽元素"),c("【屏蔽】VIP图标","dy-live-shieldUserVIPIcon",!1,void 0,"屏蔽元素"),c("【屏蔽】粉丝牌","dy-live-shieldUserFansIcon",!1,void 0,"屏蔽元素"),c("【屏蔽】信息播报","dy-live-shieldMessage",!1,void 0,"底部滚动播报的的xxx来了，xxx给主播点赞")]},{text:"弹幕屏蔽规则(可正则)",type:"forms",forms:[c("启用","live-danmu-shield-rule-enable",!1,void 0,"启用弹幕屏蔽规则"),{type:"own",getLiElementCallBack(e){let t=y.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=t.querySelector("textarea");return i.value=$.get(),y.on(i,["input","propertychange"],f.debounce(function(){$.set(i.value);},200)),e.appendChild(t),e}}]}]},Ie=function(e,t,i,n,d,a){let u=[];typeof n=="function"?u=n():u=n;let r={text:e,type:"select",description:a,attributes:{},getValue(){return l.getValue(t,i)},callback(s,m,p){l.setValue(t,m);},data:u};return r.attributes&&(r.attributes[P]=t,r.attributes[N]=i),r},z={watchVideDataListChange(e){let t=null;y.ready(()=>{f.waitNode("#slidelist").then(i=>{f.mutationObserver(i,{config:{childList:!0,subtree:!0},callback:()=>{if(t||(t=this.getOSElement()),!t){o.error("watchVideDataListChange：获取osElement失败");return}e(t);}});});});},getOSElement(){return document.querySelector("#root div[class*='-os']")||document.querySelector("#douyin-right-container")}},O={key:"douyin-shield-rule",$data:{rule:new f.Dictionary,isFirstLoad:!0},init(){this.parseRule(),o.info(["当前自定义视频拦截规则: ",this.$data.rule.getItems()]);let e=null;z.watchVideDataListChange(f.debounce(t=>{var a;let i=document.querySelector('#slidelist div[data-e2e="slideList"]');if(!i){o.error("未获取到视频列表元素");return}let n=(a=f.getReactObj(i))==null?void 0:a.reactFiber;if(n==null){o.error(["元素上不存在reactFiber属性",i]);return}let d=n==null?void 0:n.return.memoizedProps.data;if(d.length){if(this.$data.isFirstLoad){let u=d[d.length-1];if(e==null&&(e=u.awemeId),e===u.awemeId)return;this.$data.isFirstLoad=!1;}for(let u=0;u<d.length;u++){let r=d[u],s=this.getVideoInfoTagMap(r),m=!1;if(m||typeof r.cellRoom=="object"&&l.getValue("shieldVideo-live")&&(o.success("屏蔽直播: cellRoom is not null"),m=!0),m||r.isAds&&l.getValue("shieldVideo-ads")&&(o.success("屏蔽广告: isAds is true"),m=!0),!m)for(const[p,g]of this.$data.rule.entries()){if(!(p in s))continue;let v=s[p];if(v!=null){if(typeof v=="string"){if(m=!!v.match(g),m){o.success(["自定义屏蔽: "+p+"  "+g,s]);break}}else if(typeof v=="object"&&Array.isArray(v)&&v.find(B=>!!B.match(g))){m=!0,o.success(["自定义屏蔽: "+p+"  "+g,s]);break}}}m&&(d.splice(u,1),u--);}}},150));},getVideoInfoTagMap(e){var u,r,s,m,p,g;let t=(r=(u=e==null?void 0:e.authorInfo)==null?void 0:u.nickname)==null?void 0:r.toString(),i=(m=(s=e==null?void 0:e.authorInfo)==null?void 0:s.uid)==null?void 0:m.toString(),n=(p=e==null?void 0:e.desc)==null?void 0:p.toString(),d=[];typeof(e==null?void 0:e.textExtra)=="object"&&Array.isArray(e==null?void 0:e.textExtra)&&((g=e==null?void 0:e.textExtra)==null||g.forEach(v=>{d.push(v.hashtagName);}));let a=[];return typeof(e==null?void 0:e.videoTag)=="object"&&Array.isArray(e==null?void 0:e.videoTag)&&(e==null||e.videoTag.forEach(v=>{a.push(v.tagName);})),{nickname:t,uid:i,desc:n,textExtra:d,videoTag:a}},parseRule(){this.get().trim().split(`
`).forEach(i=>{if(f.isNull(i))return;let d=i.trim().split("##");if(d.length<2)return;let a=d[0];d.shift();let u=d.join("");try{let r=new RegExp(u,"g");this.$data.rule.set(a,r);}catch(r){o.error(["自定义视频过滤规则-正则解析错误："+r]),o.error("错误的规则："+i);}});},set(e){R(this.key,e);},get(){return w(this.key,"")}},me=function(e,t,i,n,d,a,u,r){return {text:e,type:"button",description:t,buttonIcon:n,buttonIsRightIcon:d,buttonIconIsLoading:a,buttonType:u,buttonText:i,callback(m){typeof r=="function"&&r(m);},afterAddToUListCallBack:void 0}};var _,I;class Re{constructor(t){U(this,_,"short-cut");U(this,I,!1);typeof t=="string"&&D(this,_,t);}getValue(t,i){let n=w(V(this,_),[]);return t?n.find(a=>a.key===t)??i:n}setValue(t,i,n,d){let a=w(V(this,_),[]);a.push({key:t,value:{keyName:i,keyValue:n,ohterCodeList:d}}),R(V(this,_),a);}deleteValue(t){let i=!1,n=w(V(this,_),[]),d=n.findIndex(a=>a.key===t);return d!==-1&&(n.splice(d,1),i=!0),R(V(this,_),n),i}getShowText(t,i){let n=this.getValue(t);if(n){let d="";return n.value.ohterCodeList.forEach(a=>{n.key===t&&(d+=f.stringTitleToUpperCase(a,!0)+" + ");}),d+=n.value.keyName,d}else return i}inputShortCut(t,i,n){if((this.getValue(t)??i)===i){let a=k.loading("请按下快捷键...",{showClose:!0,onClose(){u.removeListen();}});D(this,I,!0);let u=f.listenKeyboard(window,"keyup",(r,s,m)=>{let p=JSON.stringify({keyName:r,keyValue:s,ohterCodeList:m}),g=this.getValue();for(let v=0;v<g.length;v++)if(p===JSON.stringify(g[v].value)){k.error(`快捷键 ${this.getShowText(g[v].key,r)} 已被占用`),D(this,I,!1),a.close();return}this.setValue(t,r,s,m),typeof n=="function"&&n(this.getShowText(t,i)),D(this,I,!1),a.close();});}else this.deleteValue(t);typeof n=="function"&&n(this.getShowText(t,i));}initGlobalKeyboardListener(t){let i=this.getValue();i.length&&f.listenKeyboard(window,"keydown",(n,d,a)=>{if(V(this,I))return;i=this.getValue();let u=i.findIndex(r=>{let s=r.value,m={keyName:n,keyValue:d,ohterCodeList:a};if(JSON.stringify(s)===JSON.stringify(m))return r});if(u!=-1){let r=i[u];o.info(["调用快捷键",r]),r.key in t&&t[r.key].callback();}});}}_=new WeakMap,I=new WeakMap;const ve={init(){l.execMenu("shieldRightExpandCommentButton",()=>{this.shieldRightExpandCommentButton();}),l.execMenu("shieldSearchFloatingBar",()=>{this.shieldSearchFloatingBar();}),l.execMenu("shieldCloseFullScreenButton",()=>{this.shieldCloseFullScreenButton();}),l.execMenu("shieldPlaySwitchButton",()=>{this.shieldPlaySwitchButton();}),l.execMenu("shieldAuthorAvatar",()=>{this.shieldAuthorAvatar();}),l.execMenu("shieldLikeButton",()=>{this.shieldLikeButton();}),l.execMenu("shieldCommentButton",()=>{this.shieldCommentButton();}),l.execMenu("shieldCollectionButton",()=>{this.shieldCollectionButton();}),l.execMenu("shieldSharenButton",()=>{this.shieldSharenButton();}),l.execMenu("shieldRelatedRecommendationsButton",()=>{this.shieldRelatedRecommendationsButton();}),l.execMenu("shieldMoreButton",()=>{this.shieldMoreButton();}),l.execMenu("shieldBottomVideoToolBar",()=>{this.shieldBottomVideoToolBar();});},shieldRightExpandCommentButton(){o.info("【屏蔽】右侧的展开评论按钮"),h.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] > div > div > button[type="button"]','.playerContainer button[type=button] svg > g[filter] > path[d="M21.316 29.73a1.393 1.393 0 01-1.97 0l-5.056-5.055a1.393 1.393 0 010-1.97l.012-.011 5.044-5.045a1.393 1.393 0 011.97 1.97l-4.07 4.071 4.07 4.071a1.393 1.393 0 010 1.97z"]'),S(`
		.basePlayerContainer .positionBox{
			padding-right: 20px !important;
		}
    	`);},shieldSearchFloatingBar(){o.info("【屏蔽】搜索悬浮栏"),h.addBlockCSS('.slider-video div:has([data-e2e="searchbar-button"])','div:has(>div > svg[class] >  defs [d="M0 0h24v24H0z"]','div[data-e2e="feed-active-video"] + div:has(>div>div>div > input[data-e2e="searchbar-input"])',"#slideMode + div",'div:has(>div>div+input[data-e2e="searchbar-input"])');},shieldCloseFullScreenButton(){o.info("【屏蔽】网页全屏关闭按钮"),h.addBlockCSS('#sliderVideo[data-e2e="feed-active-video"] div.slider-video > div:has(path[d="M17.448 17.448a1.886 1.886 0 01-2.668 0L9 11.668l-5.78 5.78A1.886 1.886 0 11.552 14.78L6.332 9 .552 3.22A1.886 1.886 0 113.22.552L9 6.332l5.78-5.78a1.886 1.886 0 112.668 2.668L11.668 9l5.78 5.78a1.886 1.886 0 010 2.668z"])');},shieldPlaySwitchButton(){o.info("【屏蔽】切换播放"),h.addBlockCSS('.positionBox  .xgplayer-playswitch[data-state="normal"]',"div.xgplayer-playswitch",".xgplayer-playswitch"),S(`
		div[data-e2e="slideList"]{
			/* 修复屏蔽后的视频宽度占据 */
			padding: 0px !important;
		}
		`);},shieldAuthorAvatar(){o.info("【屏蔽】作者头像"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="video-avatar"])');},shieldLikeButton(){o.info("【屏蔽】点赞"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-digg"])');},shieldCommentButton(){o.info("【屏蔽】评论"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="feed-comment-icon"])');},shieldCollectionButton(){o.info("【屏蔽】收藏"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-collect"])');},shieldSharenButton(){o.info("【屏蔽】分享"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="video-player-share"])');},shieldRelatedRecommendationsButton(){o.info("【屏蔽】看相关"),h.addBlockCSS('div.dy-tip-container:has(path[d="M14 8a8 8 0 00-8 8v4a8 8 0 008 8h8a8 8 0 008-8v-4a8 8 0 00-8-8h-8zm8.5 10.866a1 1 0 000-1.732l-6-3.464a1 1 0 00-1.5.866v6.928a1 1 0 001.5.866l6-3.464z"])','div.dy-tip-container:has(path[d=" M-4,-10 C-4,-10 4,-10 4,-10 C8.418000221252441,-10 12,-6.418000221252441 12,-2 C12,-2 12,2 12,2 C12,6.418000221252441 8.418000221252441,10 4,10 C4,10 -4,10 -4,10 C-8.418000221252441,10 -12,6.418000221252441 -12,2 C-12,2 -12,-2 -12,-2 C-12,-6.418000221252441 -8.418000221252441,-10 -4,-10z M4.5,0.8659999966621399 C5.166999816894531,0.48100000619888306 5.166999816894531,-0.48100000619888306 4.5,-0.8659999966621399 C4.5,-0.8659999966621399 -1.5,-4.329999923706055 -1.5,-4.329999923706055 C-2.1670000553131104,-4.715000152587891 -3,-4.234000205993652 -3,-3.4639999866485596 C-3,-3.4639999866485596 -3,3.4639999866485596 -3,3.4639999866485596 C-3,4.234000205993652 -2.1670000553131104,4.715000152587891 -1.5,4.329999923706055 C-1.5,4.329999923706055 4.5,0.8659999966621399 4.5,0.8659999966621399z"])');},shieldMoreButton(){o.info("【屏蔽】更多"),h.addBlockCSS('div.dy-tip-container:has([data-e2e="video-play-more"])');},shieldBottomVideoToolBar(){o.info("【屏蔽】底部视频工具栏"),h.addBlockCSS("xg-controls.xgplayer-controls"),S(`
		div:has( > div > pace-island > #video-info-wrap ),
		xg-video-container.xg-video-container{
			bottom: 0 !important;
		}
  		`);}},Le={init(){l.execMenuOnce("douyin-search-shieldReleatedSearches",()=>{this.shieldReleatedSearches();});},shieldReleatedSearches(){o.info("【屏蔽】相关搜索"),h.addBlockCSS("#search-content-area > div > div:nth-child(2)"),S(`
        #search-content-area > div > div:nth-child(1) > div:nth-child(1){
            width: 100dvw;
        }
        `);}},De=`/* 去除顶部的padding距离 */\r
#douyin-right-container {\r
	padding-top: 0;\r
}\r
/* 放大放大顶部的综合、视频、用户等header的宽度 */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) {\r
	width: 100dvw;\r
}\r
/* 放大顶部的综合、视频、用户等header */\r
#search-content-area > div > div:nth-child(1) > div:nth-child(1) > div {\r
	transform: scale(0.8);\r
}\r
/* 视频宽度 */\r
ul[data-e2e="scroll-list"] {\r
	padding: 0px 10px;\r
}\r
#sliderVideo {\r
	width: -webkit-fill-available;\r
}\r
/* 距离是顶部导航栏的高度 */\r
#search-content-area {\r
	margin-top: 65px;\r
}\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#sliderVideo {\r
		width: 100dvw;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#component-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: -webkit-fill-available;\r
		padding-right: 0;\r
	}\r
}\r
\r
`,Ce={init(){Le.init();},mobileMode(){o.info("搜索-手机模式"),S(De),f.waitNode("#relatedVideoCard").then(e=>{o.info("评论区展开的className："+e.className),S(`
				html[data-vertical-screen]
					#sliderVideo[data-e2e="feed-active-video"]
					#videoSideBar:has(#relatedVideoCard[class="${e.className}"]) {
						width: 100dvw !important;
				}`);});}},C={isLive(){return window.location.hostname==="live.douyin.com"},isVideo(){return window.location.hostname==="www.douyin.com"},isSearch(){return window.location.hostname==="www.douyin.com"&&window.location.pathname.startsWith("/search")}},Ae={init(){l.execMenuOnce("dy-video-shieldUserCommentToolBar",()=>{this.shieldUserCommentToolBar();}),l.execMenuOnce("dy-video-shieldUserCommentEveryOneAllSearch",()=>{this.shieldUserCommentEveryOneAllSearch();});},shieldUserCommentToolBar(){o.info("【屏蔽】评论工具栏"),h.addBlockCSS(".comment-input-container");},shieldUserCommentEveryOneAllSearch(){o.info("【屏蔽】大家都在搜"),h.addBlockCSS(".comment-header-with-search");}},Pe=`/* 右侧工具栏放大 */\r
.basePlayerContainer .positionBox {\r
	scale: unset !important;\r
	bottom: 80px !important;\r
	padding-right: 5px !important;\r
	transform: scale(1.12) !important;\r
}\r
/* 图标再放大 */\r
.basePlayerContainer .positionBox svg {\r
	transform: scale(1.12);\r
}\r
/* 重置关注按钮的scale */\r
.basePlayerContainer\r
	.positionBox\r
	.dy-tip-container\r
	div[data-e2e="feed-follow-icon"]\r
	svg {\r
	scale: unset;\r
}\r
/* 设备处于横向方向，即宽度大于高度。 */\r
@media screen and (orientation: landscape) {\r
	/* 右侧工具栏放大 */\r
	.basePlayerContainer .positionBox {\r
		/*transform: scale(0.95) !important;\r
		bottom: 42px !important;*/\r
		padding-right: 10px !important;\r
	}\r
}\r
/* 该设备是纵向的，即高度大于或等于宽度 */\r
@media screen and (orientation: portrait) {\r
}\r
\r
/* 调整视频列表的宽度 */\r
@media screen and (max-width: 550px) {\r
	#slidelist {\r
		width: 100dvw;\r
		height: 100dvh;\r
	}\r
	/* 调整顶部搜索框的宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]) {\r
		width: 150px;\r
		padding-right: 0;\r
		max-width: unset;\r
	}\r
	/* 搜索框获取焦点时自动放大宽度 */\r
	#douyin-header\r
		div[data-click="doubleClick"]\r
		> div[data-click="doubleClick"]\r
		> div:has(input[data-e2e="searchbar-input"]:focus) {\r
		width: 100dvw;\r
	}\r
	/* 去除设置min-width超出浏览器宽度的问题 */\r
	body {\r
		min-width: 100% !important;\r
	}\r
	/* 去除设置width导致顶部工具栏超出浏览器宽度的问题 */\r
	#douyin-right-container #douyin-header {\r
		width: 100%;\r
	}\r
	/* 去除设置 */\r
	#douyin-right-container #douyin-header > div[data-click="doubleClick"] {\r
		min-width: 100%;\r
	}\r
}\r
`,T={init(){ve.init(),x.init(),Ae.init(),l.execMenu("shieldVideo",()=>{O.init();}),l.execMenu("changeCommentToBottom",()=>{T.changeCommentToBottom();}),l.execMenu("fullScreen",()=>{this.fullScreen();}),l.execMenu("parseVideo",()=>{T.parseVideo();}),l.execMenu("autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),l.execMenu("dy-video-doubleClickEnterElementFullScreen",()=>{this.doubleClickEnterElementFullScreen();}),y.ready(()=>{T.chooseVideoDefinition(l.getValue("chooseVideoDefinition")),l.execMenu("mobileMode",()=>{this.mobileMode();});});},fullScreen(){o.info("全屏"),h.addBlockCSS(".slider-video .positionBox","#video-info-wrap","xg-controls.xgplayer-controls"),ve.shieldSearchFloatingBar(),S(`
        /* 视频全屏 */
        xg-video-container.xg-video-container{
            bottom: 0px !important;
        }
        `);},autoEnterElementFullScreen(){f.waitNode('xg-icon[data-e2e="xgplayer-page-full-screen"] .xgplayer-icon:has([d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(e=>{o.success("自动进入网页全屏"),e.click();});},doubleClickEnterElementFullScreen(){let e=!1;o.info("注册双击进入网页全屏事件"),y.on(document,"click","#sliderVideo",()=>{e?(e=!1,T.autoEnterElementFullScreen()):(e=!0,setTimeout(()=>{e=!1;},250));});},changeCommentToBottom(){o.info("评论区修改为底部");let e="data-vertical-screen";function t(){h.isVerticalScreen()?(o.success("自动判断: 竖屏"),document.documentElement.setAttribute(e,"true")):(o.success("自动判断: 横屏"),document.documentElement.removeAttribute(e));}t(),S(`
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideBar #relatedVideoCard,
		html[${e}] #sliderVideo[data-e2e="feed-video"] #videoSideCard #relatedVideoCard{
			display: none !important;
		}
		/* 左侧的视频宽度撑满 */
		html[${e}] #sliderVideo[data-e2e] .playerContainer,
		html[${e}] #slideMode[data-e2e] .playerContainer{
			width: 100% !important;
		}
		/* 右侧的评论区宽度撑满，position使用absolute */
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideBar:has(#relatedVideoCard),
		html[${e}] #sliderVideo[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard),
		html[${e}] #slideMode[data-e2e="feed-active-video"] #videoSideCard:has(#relatedVideoCard){
			width: 100%;
			height: 75%;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.9);
			transition: height .15s linear !important;
			position: absolute;
		}
		`),l.getValue("douyin-video-autoCheckChangeCommentToBottom")&&y.on(window,"resize",t);},chooseVideoDefinition(e=0){o.info("选择视频清晰度: "+e);let t="MANUAL_SWITCH",n=[{clarityReal:["normal_1080_0","normal_720_0","low_720_0","normal_540_0","low_540_0","adapt_low_540_0","lower_540_0"],done:1,gearClarity:"5",gearName:"高清",gearType:1,qualityType:1},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"4",gearName:"清晰",gearType:2,qualityType:15},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"3",gearName:"流畅",gearType:3,qualityType:28},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"2",gearName:"极速",gearType:4,qualityType:21},{clarityReal:["normal_1080_0","low_540_0","low_720_0","normal_720_0","normal_540_0","adapt_low_540_0","lower_540_0","adapt_lowest_720_1","adapt_540_1","adapt_lower_540_1"],done:1,gearClarity:"0",gearName:"智能",gearType:0}].find(a=>a.gearType===e);function d(a){b.sessionStorage.setItem(t,a);}if(n){let a=0,u=JSON.stringify(n),r=setInterval(()=>{d(u),a++,a>=20&&clearInterval(r);},500);o.success("设置当前视频的清晰度: "+e);}else o.error("该清晰度不存在: "+e);},chooseVideoRate(e="1"){let t="player_playbackratio";function i(n="1"){b.sessionStorage.setItem(t,n),document.querySelectorAll("xg-icon.xgplayer-playback-setting").forEach(d=>{var u,r,s,m;let a=f.getReactObj(d).reactContainer;(m=(s=(r=(u=a==null?void 0:a.memoizedState)==null?void 0:u.element)==null?void 0:r.props)==null?void 0:s.xgCase)==null||m.updatePlayBackRatio();});}i(e);},parseVideo(){o.info("让下载按钮变成解析视频");function e(t){let i="";t.forEach(n=>{i+=`
          		<div class="douyin-video-link-item"><a href="${n}" target="_blank">${n}</a></div>
            	`;}),i=`<div class="douyin-video-link-container">${i}</div>`,Se.alert({title:{text:"视频解析",position:"center"},content:{text:i,html:!0},mask:{enable:!0,clickEvent:{toClose:!0}},width:"50dvw",height:"50dvh",drag:!0,dragLimit:!0,style:`
                .douyin-video-link-container{

                }
                .douyin-video-link-item{
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    margin: 10px;
                }
                .douyin-video-link-item a{

                }
                `});}y.on(document,"click",'div[data-e2e="video-share-container"] div[data-inuser="false"] button + div',function(t){var d;let i=t.target,n=(d=f.getReactObj(i.parentElement))==null?void 0:d.reactFiber;if(!n){k.error("获取rectFiber属性失败");return}try{let a=[],u=n.return.memoizedProps.awemeInfo.video.playAddr,r=n.return.memoizedProps.awemeInfo.video.playAddrH265;if(u!=null&&Array.isArray(u)&&(a=a.concat(u)),r!=null&&Array.isArray(r)&&(a=a.concat(r)),!a.length){k.error("未获取到视频的有效链接信息");return}let s=a.map(m=>m.src);e(s);}catch{k.error("解析视频失败");}},{capture:!0});},mobileMode(){o.info("启用手机模式"),xe.initialScale(),h.addBlockCSS("img#douyin-temp-sidebar"),S(Pe),C.isSearch()&&l.onceExec("douyin-search-mobileMode",()=>{Ce.mobileMode();});}},x={shortCut:new Re("video-short-cut"),$data:{rateMap:["0.75","1","1.25","1.5","1.75","2","3"]},init(){this.shortCut.initGlobalKeyboardListener(this.getShortCutMap());},getShortCutMap(){return {"dy-video-rate-low":{callback(){o.info("调用倍速 => 小");let e=b.sessionStorage.getItem("player_playbackratio")??"1",t=x.$data.rateMap.findIndex(n=>n===e);if(t===0){o.warn("已是最小倍速: "+e);return}let i=x.$data.rateMap[t-1];o.info("设置倍速: "+i),T.chooseVideoRate(i);}},"dy-video-rate-up":{callback(){o.info("调用倍速 => 大");let e=b.sessionStorage.getItem("player_playbackratio")??"1",t=x.$data.rateMap.findIndex(n=>n===e);if(t===x.$data.rateMap.length-1){o.warn("已是最大倍速: "+e);return}let i=x.$data.rateMap[t+1];o.info("设置倍速: "+i),T.chooseVideoRate(i);}}}}},Ne={id:"panel-config-video",title:"视频",forms:[{text:"功能",type:"forms",forms:[c("沉浸模式","fullScreen",!1,void 0,"移除右侧工具栏、底部信息栏等"),c("手机模式","mobileMode",!1,void 0,"放大各种文字和图标")]},{text:"视频",type:"forms",forms:[Ie("清晰度","chooseVideoDefinition",1,[{text:"智能",value:0},{text:"极速",value:4},{text:"流畅",value:3},{text:"清晰",value:2},{text:"高清",value:1}],void 0,"自行选择清晰度"),c("视频解析","parseVideo",!0,void 0,"分享->下载(灰色的也可点击)"),c("评论区移到中间","changeCommentToBottom",!0,void 0,"修改评论区为中间弹出而非右侧区域"),c("↑自适应评论区位置","douyin-video-autoCheckChangeCommentToBottom",!0,void 0,"根据window.screen.orientation.type自动判断是否开启【评论区移到中间】"),c("自动进入网页全屏","autoEnterElementFullScreen",!1,void 0,"网页加载完毕后自动点击网页全屏按钮进入全屏"),c("双击进入网页全屏","dy-video-doubleClickEnterElementFullScreen",!1,void 0,"双击视频自动进入网页全屏，检测间隔250ms")]},{text:"快捷键",type:"forms",forms:[me("倍速 -> 小","视频倍速变小",()=>x.shortCut.getShowText("dy-video-rate-low","暂无快捷键"),"keyboard",!1,!1,"default",e=>{var n;let i=(n=e.target.closest(".pops-panel-button"))==null?void 0:n.querySelector("span");x.shortCut.inputShortCut("dy-video-rate-low","暂无快捷键",d=>{i.innerHTML=d;});}),me("倍速 -> 大","视频倍速变大",()=>x.shortCut.getShowText("dy-video-rate-up","暂无快捷键"),"keyboard",!1,!1,"default",e=>{var n;let i=(n=e.target.closest(".pops-panel-button"))==null?void 0:n.querySelector("span");x.shortCut.inputShortCut("dy-video-rate-up","暂无快捷键",d=>{i.innerHTML=d;});})]},{text:"视频区域内-屏蔽",type:"forms",forms:[c("【屏蔽】右侧的展开评论按钮","shieldRightExpandCommentButton",!0,void 0,"屏蔽元素"),c("【屏蔽】搜索悬浮栏","shieldSearchFloatingBar",!0,void 0,"屏蔽元素，一般出现在左上角"),c("【屏蔽】网页全屏关闭按钮","shieldCloseFullScreenButton",!0,void 0,"屏蔽元素，一般开启网页全屏后出现在左上角"),c("【屏蔽】切换播放","shieldPlaySwitchButton",!1,void 0,"屏蔽元素，在右侧作者头像上方"),c("【屏蔽】作者头像","shieldAuthorAvatar",!1,void 0,"屏蔽元素"),c("【屏蔽】点赞","shieldLikeButton",!1,void 0,"屏蔽元素"),c("【屏蔽】评论","shieldCommentButton",!1,void 0,"屏蔽元素"),c("【屏蔽】收藏","shieldCollectionButton",!1,void 0,"屏蔽元素"),c("【屏蔽】分享","shieldSharenButton",!1,void 0,"屏蔽元素"),c("【屏蔽】看相关","shieldRelatedRecommendationsButton",!1,void 0,"屏蔽元素"),c("【屏蔽】更多","shieldMoreButton",!1,void 0,"...按钮，屏蔽元素"),c("【屏蔽】底部视频工具栏","shieldBottomVideoToolBar",!1,void 0,"屏蔽元素")]},{text:"评论区域内-屏蔽",type:"forms",forms:[c("【屏蔽】评论工具栏","dy-video-shieldUserCommentToolBar",!1,void 0,"屏蔽元素"),c("【屏蔽】大家都在搜","dy-video-shieldUserCommentEveryOneAllSearch",!1,void 0,"在评论区的顶部出现")]},{text:"视频过滤规则(可正则)",type:"forms",forms:[c("启用","shieldVideo",!0,void 0,"开启后可启用下面的屏蔽功能"),c("【屏蔽】直播","shieldVideo-live",!0,void 0,"过滤掉直播"),c("【屏蔽】广告","shieldVideo-ads",!0,void 0,"过滤掉广告"),{type:"own",getLiElementCallBack(e){let t=y.createElement("div",{className:"pops-panel-textarea",innerHTML:'<textarea placeholder="请输入屏蔽规则，每行一个" style="height:350px;"></textarea>'},{style:"width: 100%;"}),i=t.querySelector("textarea");return i.value=O.get(),y.on(i,["input","propertychange"],f.debounce(function(){O.set(i.value);},200)),e.appendChild(t),e}}]}]},$e={id:"panel-config-search",title:"搜索",forms:[{text:"屏蔽",type:"forms",forms:[c("【屏蔽】相关搜索","douyin-search-shieldReleatedSearches",!1,void 0,"屏蔽右边的相关搜索")]}]},l={$data:{data:new f.Dictionary,oneSuccessExecMenu:new f.Dictionary,onceExec:new f.Dictionary,scriptName:he,key:E,attributeKeyName:P,attributeDefaultValueName:N},$listener:{listenData:new f.Dictionary},init(){this.initPanelDefaultValue(),this.initExtensionsMenu();},initExtensionsMenu(){b.top===b.self&&Ve.add([{key:"show_pops_panel_setting",text:"⚙ 设置",autoReload:!1,isStoreValue:!1,showText(e){return e},callback:()=>{this.showPanel();}}]);},initPanelDefaultValue(){let e=this;function t(n){if(!n.attributes)return;let d=n.attributes[P],a=n.attributes[N];if(d==null){console.warn("请先配置键",n);return}e.$data.data.has(d)&&console.warn("请检查该key(已存在): "+d),e.$data.data.set(d,a);}let i=this.getPanelContentConfig();for(let n=0;n<i.length;n++){let d=i[n];if(!d.forms)continue;let a=d.forms;for(let u=0;u<a.length;u++){let r=a[u];if(r.forms){let s=r.forms;for(let m=0;m<s.length;m++)t(s[m]);}else t(r);}}},setValue(e,t){let i=w(E,{}),n=i[e];i[e]=t,R(E,i),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,n,t);},getValue(e,t){let n=w(E,{})[e];return n??(this.$data.data.has(e)?this.$data.data.get(e):t)},deleteValue(e){let t=w(E,{}),i=t[e];Reflect.deleteProperty(t,e),R(E,t),this.$listener.listenData.has(e)&&this.$listener.listenData.get(e).callback(e,i,void 0);},addValueChangeListener(e,t){let i=Math.random();return this.$listener.listenData.set(e,{id:i,key:e,callback:t}),i},removeValueChangeListener(e){let t=null;for(const[i,n]of this.$listener.listenData.entries())if(n.id===e){t=i;break}typeof t=="string"?this.$listener.listenData.delete(t):console.warn("没有找到对应的监听器");},hasKey(e){let t=w(E,{});return e in t},execMenu(e,t){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){o.warn(`${e} 键不存在`);return}let i=l.getValue(e);i&&t(i);},execMenuOnce(e,t){if(typeof e!="string")throw new TypeError("key 必须是字符串");if(!this.$data.data.has(e)){o.warn(`${e} 键不存在`);return}let i=l.getValue(e);if(i){if(this.$data.oneSuccessExecMenu.has(e))return;t(i),this.$data.oneSuccessExecMenu.set(e,1);}},onceExec(e,t){if(typeof e!="string")throw new TypeError("key 必须是字符串");this.$data.onceExec.has(e)||(t(),this.$data.onceExec.set(e,1));},showPanel(){Se.panel({title:{text:`${he}-设置`,position:"center",html:!1,style:""},content:this.getPanelContentConfig(),mask:{enable:!0,clickEvent:{toClose:!0,toHide:!1}},isMobile:!0,width:this.getWidth(),height:this.getHeight(),drag:!0,only:!0});},getWidth(){return window.outerWidth<550?"92dvw":"550px"},getHeight(){return window.outerHeight<450?"80dvh":"450px"},getPanelContentConfig(){return [Ee,Ne,Te,$e]}},Ue={init(){l.execMenu("shieldClientTip",()=>{this.shieldClientTip();}),l.execMenu("shieldFillingBricksAndStones",()=>{this.shieldFillingBricksAndStones();}),l.execMenu("shieldClient",()=>{this.shieldClient();}),l.execMenu("shieldQuickAccess",()=>{this.shieldQuickAccess();}),l.execMenu("shieldNotifitation",()=>{this.shieldNotifitation();}),l.execMenu("shieldPrivateMessage",()=>{this.shieldPrivateMessage();}),l.execMenu("shieldSubmission",()=>{this.shieldSubmission();}),l.execMenu("shieldLeftNavigator",()=>{this.shieldLeftNavigator();}),l.execMenu("shieldTopNavigator",()=>{this.shieldTopNavigator();}),l.execMenuOnce("shieldBottomQuestionButton",()=>{this.shieldBottomQuestionButton();});},shieldFillingBricksAndStones(){o.info("【屏蔽】充砖石"),h.addBlockCSS('pace-island[id^="island"] > div[class]:not([data-click]):has(div[data-e2e="something-button"]) > :has(path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])'),C.isSearch()&&(o.info("搜索-【屏蔽】充砖石"),h.addBlockCSS('div:has(>div>div>div>div[data-e2e="something-button"] path[d="M5.757 12.268a6.397 6.397 0 1112.793 0 6.397 6.397 0 01-12.793 0zm6.396-7.897a7.897 7.897 0 100 15.793 7.897 7.897 0 000-15.793zm2.127 3.52v-.497h-1.5v6.462h.001c0 .854-.685 1.536-1.517 1.536a1.527 1.527 0 01-1.517-1.536c0-.854.685-1.536 1.517-1.536v-1.5c-1.672 0-3.017 1.365-3.017 3.036 0 1.67 1.345 3.036 3.017 3.036s3.017-1.365 3.017-3.036h-.001v-3.228a3.184 3.184 0 001.715.498v-1.5a1.725 1.725 0 01-1.715-1.735z"])'));},shieldClient(){o.info("【屏蔽】客户端"),h.addBlockCSS('pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) .dy-tip-container'),C.isSearch()&&(o.info("搜索-【屏蔽】客户端"),h.addBlockCSS('div:has(> div[data-e2e="something-button"] path[d="M18.404 19.018h-12v-1.5h12v1.5zM11.654 13.457v-8.19h1.5v8.19l3.22-3.22 1.06 1.061-4.5 4.5a.75.75 0 01-1.06 0l-4.5-4.5 1.06-1.06 3.22 3.22z"])'));},shieldQuickAccess(){o.info("【屏蔽】快捷访问"),h.addBlockCSS('header pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(.quick-access-nav-icon)'),C.isSearch()&&(o.info("搜索-【屏蔽】快捷访问"),h.addBlockCSS("div:has(>div>div>.quick-access-nav-icon)"));},shieldNotifitation(){o.info("【屏蔽】通知"),h.addBlockCSS('pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(path[d="M9.905 19.407h4.5v-1.5h-4.5v1.5z"])'),C.isSearch()&&(o.info("搜索-【屏蔽】通知"),h.addBlockCSS('ul:has( div>div[data-e2e="notice-entry"] )'));},shieldPrivateMessage(){o.info("【屏蔽】私信"),h.addBlockCSS('pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > ul:has(div[data-e2e="im-entry"])'),C.isSearch()&&(o.info("搜索-【屏蔽】私信"),h.addBlockCSS('ul:has( div>div[data-e2e="im-entry"] )'));},shieldSubmission(){o.info("【屏蔽】投稿"),h.addBlockCSS('pace-island[id^="island"] > div[class]:has(div[data-e2e="something-button"]) > :has(ul[data-e2e="cooperate-list"])'),C.isSearch()&&(o.info("搜索-【屏蔽】投稿"),h.addBlockCSS('div:has(>div >div>div[data-e2e="something-button"] path[d="M11.349 5.17h-.033c-1.068 0-1.915 0-2.598.054-.698.056-1.29.172-1.832.441a4.75 4.75 0 00-2.14 2.14c-.269.542-.386 1.134-.441 1.832-.055.683-.055 1.53-.055 2.599v.064c0 1.069 0 1.916.055 2.599.055.698.172 1.29.441 1.831a4.75 4.75 0 002.14 2.14c.542.27 1.134.386 1.832.442.683.055 1.53.055 2.598.055H12.684c1.068 0 1.915 0 2.598-.055.698-.056 1.29-.172 1.832-.442a4.75 4.75 0 002.14-2.14c.269-.541.386-1.133.441-1.831.055-.683.055-1.53.055-2.599v-.064c0-1.069 0-1.916-.055-2.599-.055-.698-.172-1.29-.441-1.832a4.75 4.75 0 00-2.14-2.14c-.542-.269-1.134-.385-1.832-.441-.683-.055-1.53-.055-2.598-.055h-1.335zM7.554 7.008c.299-.149.676-.241 1.284-.29.616-.05 1.403-.05 2.51-.05h1.303c1.108 0 1.895 0 2.511.05.608.049.985.141 1.284.29a3.25 3.25 0 011.464 1.464c.15.3.241.676.29 1.284.05.616.05 1.403.05 2.51 0 1.109 0 1.896-.05 2.512-.049.608-.14.985-.29 1.284a3.25 3.25 0 01-1.464 1.464c-.299.149-.676.241-1.284.29-.616.05-1.403.05-2.51.05h-1.303c-1.108 0-1.895 0-2.511-.05-.608-.049-.985-.141-1.284-.29a3.25 3.25 0 01-1.464-1.464c-.15-.3-.242-.676-.29-1.284-.05-.616-.05-1.403-.05-2.511s0-1.895.05-2.511c.048-.608.14-.985.29-1.284a3.25 3.25 0 011.464-1.464zm3.696 8.259v-2.25H9v-1.5h2.25v-2.25h1.5v2.25H15v1.5h-2.25v2.25h-1.5z"])'));},shieldClientTip(){o.info("【屏蔽】客户端提示"),h.addBlockCSS('ul li div[data-e2e="something-button"] + div div:has(>a[download*="douyin-downloader"])','#douyin-header pace-island[id^="island_"] ul > div:has(>a[class][download])','#douyin-header pace-island[id^="island_"] ul[class] li div[data-e2e="im-entry"]  div>div div div:has(a[download][href])');},shieldLeftNavigator(){o.info("【屏蔽】左侧导航栏"),h.addBlockCSS("#douyin-navigation"),S(`
		/* 修复顶部导航栏的宽度 */
		#douyin-header{
			width: 100%;
		}
		`);},shieldTopNavigator(){o.info("【屏蔽】顶部导航栏"),h.addBlockCSS("#douyin-header"),C.isSearch()&&S(`
			/* 把搜索顶部的工具栏置顶 */
			#search-content-area > div > div:nth-child(1) > div:nth-child(1){
				top: 0;
			}
			`);},shieldBottomQuestionButton(){o.info("屏蔽底部问题按钮"),h.addBlockCSS(["#douyin-sidebar","#douyin-temp-sidebar"]);}},ze={init(){l.execMenu("shieldSearch",()=>{this.shieldSearch();}),l.execMenu("shieldSearchPlaceholder",()=>{this.shieldSearchPlaceholder();}),l.execMenu("shieldSearchGuessYouWantToSearch",()=>{this.shieldSearchGuessYouWantToSearch();}),l.execMenu("shieldSearchTiktokHotspot",()=>{this.shieldSearchTiktokHotspot();});},shieldSearch(){o.info("【屏蔽】搜索框"),h.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div:has(input[data-e2e="searchbar-input"])');},shieldSearchPlaceholder(){o.info("【屏蔽】搜索框的提示"),h.addBlockCSS('#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div div:has( + input[data-e2e="searchbar-input"])'),S(`
		#douyin-header div[data-click="doubleClick"] > div[data-click="doubleClick"] > div input[data-e2e="searchbar-input"]::placeholder{
			color: transparent;
		}
		`);},shieldSearchGuessYouWantToSearch(){o.info("【屏蔽】搜索-猜你想搜"),h.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-guess-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-guess-container"]');},shieldSearchTiktokHotspot(){o.info("【屏蔽】搜索-抖音热点"),h.addBlockCSS('button[data-e2e="searchbar-button"] + div div:has( + div[data-e2e="search-hot-container"])','button[data-e2e="searchbar-button"] + div div[data-e2e="search-hot-container"]');}},Oe={removeEnvCheck(){o.info("移除环境检测");let e=b.setInterval;b.setInterval=function(t,i){let n=t.toString().trim();if(n.includes("debugger")){o.success(["拦截→",[n]]);return}if(n.includes("checkEXp")){o.success(["拦截→",[n]]);return}return e.call(this,t,i)};}},pe={disguiseLogin(){o.info("伪装登录");const e=2e4;let t=parseInt((Math.random()*1e6).toString()),i=Object.defineProperty({},"uid",{value:t,writable:!1});function n(a){var m,p,g,v,M,B,L,G,F,H,Y,q,Q,W,K,j,J,X,Z,ee,te,ie,oe,ne,ae,le,re,de,se,ce;let u=[],r=f.getReactObj(a),s=r==null?void 0:r.reactFiber;return r==null||r.reactProps,(g=(p=(m=s==null?void 0:s.alternate)==null?void 0:m.return)==null?void 0:p.memoizedProps)!=null&&g.userInfo&&u.push((B=(M=(v=s==null?void 0:s.alternate)==null?void 0:v.return)==null?void 0:M.memoizedProps)==null?void 0:B.userInfo),(H=(F=(G=(L=s==null?void 0:s.alternate)==null?void 0:L.return)==null?void 0:G.memoizedProps)==null?void 0:F.userInfo)!=null&&H.userInfo&&u.push((Q=(q=(Y=s==null?void 0:s.alternate)==null?void 0:Y.return)==null?void 0:q.memoizedProps)==null?void 0:Q.userInfo.userInfo),(J=(j=(K=(W=s==null?void 0:s.alternate)==null?void 0:W.return)==null?void 0:K.return)==null?void 0:j.memoizedProps)!=null&&J.userInfo&&u.push((te=(ee=(Z=(X=s==null?void 0:s.alternate)==null?void 0:X.return)==null?void 0:Z.return)==null?void 0:ee.memoizedProps)==null?void 0:te.userInfo),(le=(ae=(ne=(oe=(ie=s==null?void 0:s.alternate)==null?void 0:ie.return)==null?void 0:oe.return)==null?void 0:ne.memoizedProps)==null?void 0:ae.userInfo)!=null&&le.userInfo&&u.push((ce=(se=(de=(re=s==null?void 0:s.alternate)==null?void 0:re.return)==null?void 0:de.return)==null?void 0:se.memoizedProps)==null?void 0:ce.userInfo.userInfo),u}function d(a){n(a).forEach(u=>{Object.defineProperties(u,{info:{value:i,writable:!1},isLogin:{value:!0,writable:!1}});});}if(z.watchVideDataListChange(a=>{d(a);}),f.waitNode("#root div[class*='-os']",e).then(()=>{f.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:f.debounce(()=>{let a=z.getOSElement();a&&d(a);},70)});}).catch(a=>{}),C.isLive())o.info("伪装登录：live"),f.waitNode("#douyin-header div:has(.dy-tip-container)",e).then(()=>{f.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:f.debounce(()=>{d(document.querySelector("#douyin-header"));},70)});});else if(C.isSearch()){let a=function(u){var m,p,g,v,M,B,L;let r=f.getReactObj(u);r==null||r.reactFiber;let s=r==null?void 0:r.reactProps;typeof((v=(g=(p=(m=s==null?void 0:s.children)==null?void 0:m[1])==null?void 0:p.props)==null?void 0:g.userInfo)==null?void 0:v.isLogin)=="boolean"&&(s.children[1].props.userInfo.isLogin=!0),typeof((L=(B=(M=s==null?void 0:s.children)==null?void 0:M[1])==null?void 0:B.props)==null?void 0:L.isClient)=="boolean"&&(s.children[1].props.isClient=!0);};o.info("伪装登录：search"),f.waitNode("#root > div",e).then(u=>{if(!u){o.error("#root > div获取失败");return}f.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback:f.debounce((r,s)=>{a(u);},70)});});}},watchLoginDialogToClose(){o.info("监听登录弹窗并关闭"),h.addBlockCSS('div[id^="login-full-panel-"]'),f.waitNode("body").then(()=>{f.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){var t,i;let e=document.querySelector('body > div[id^="login-full-panel-"] .dy-account-close');e&&((i=(t=f.getReactObj(e))==null?void 0:t.reactProps)==null||i.onClick(new Event("click")));}});});}},Ge={init(){l.execMenu("live-shieldChatRoom",()=>{this.shieldChatRoom();}),l.execMenu("live-shielChatRoomVipSeats",()=>{this.shielChatRoomVipSeats();}),l.execMenu("dy-live-shieldUserLevelIcon",()=>{this.shieldUserLevelIcon();}),l.execMenu("dy-live-shieldUserVIPIcon",()=>{this.shieldUserVIPIcon();}),l.execMenu("dy-live-shieldUserFansIcon",()=>{this.shieldUserFansIcon();}),l.execMenu("dy-live-shieldMessage",()=>{this.shieldMessage();});},shieldChatRoom(){o.info("【屏蔽】评论区"),h.addBlockCSS("#chatroom"),S(`
		div[data-e2e="living-container"],
		div[data-e2e="living-container"] > div{
			margin-bottom: 0px !important;
		}`);},shielChatRoomVipSeats(){o.info("【屏蔽】评论区的贵宾席"),h.addBlockCSS("#chatroom > div > div:has(#audiencePanelScrollId)");},shieldUserLevelIcon(){o.info("【屏蔽】用户等级图标"),h.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="level"])');},shieldUserVIPIcon(){o.info("【屏蔽】VIP图标"),h.addBlockCSS('.webcast-chatroom___item span:has(>img[src*="subscribe"])');},shieldUserFansIcon(){o.info("【屏蔽】粉丝牌"),h.addBlockCSS('.webcast-chatroom___item span:has(>div[style*="fansclub"])');},shieldMessage(){o.info("【屏蔽】信息播报"),h.addBlockCSS(".webcast-chatroom___bottom-message");}},Fe={init(){l.execMenu("live-autoEnterElementFullScreen",()=>{this.autoEnterElementFullScreen();}),l.execMenu("live-shieldGiftColumn",()=>{this.shieldGiftColumn();}),l.execMenu("live-shieldTopToolBarInfo",()=>{this.shieldTopToolBarInfo();}),l.execMenu("live-shieldGiftEffects",()=>{this.shieldGiftEffects();}),l.execMenu("live-shieldDanmuku",()=>{fe.shieldDanmu();}),l.execMenu("live-danmu-shield-rule-enable",()=>{fe.filterDanmu();}),l.execMenu("live-unlockImageQuality",()=>{this.unlockImageQuality();}),l.execMenuOnce("live-waitToRemovePauseDialog",()=>{this.waitToRemovePauseDialog();}),Ge.init();},autoEnterElementFullScreen(){o.info("自动进入网页全屏"),f.waitNode('xg-icon[classname] > div > div:has(path[d="M9.75 8.5a2 2 0 00-2 2v11a2 2 0 002 2h12.5a2 2 0 002-2v-11a2 2 0 00-2-2H9.75zM15 11.25h-3.75a1 1 0 00-1 1V16h2v-2.75H15v-2zm5.75 9.5H17v-2h2.75V16h2v3.75a1 1 0 01-1 1z"])').then(e=>{e.click();});},shieldGiftColumn(){o.info("屏蔽底部的礼物栏"),h.addBlockCSS('div[data-e2e="living-container"] >div> :last-child','div[data-e2e="living-container"] xg-controls > div:has(div[data-e2e="gifts-container"])'),S(`
		/* 去除全屏状态下的礼物栏后，上面的工具栏bottom也去除 */
		div[data-e2e="living-container"] xg-controls xg-inner-controls:has(+div div[data-e2e="gifts-container"]){
			bottom: 0 !important;
		}
		`);},shieldTopToolBarInfo(){o.info("【屏蔽】顶栏信息"),h.addBlockCSS('div[data-e2e="living-container"] > div > pace-island[id^="island_"]');},shieldGiftEffects(){o.info("【屏蔽】礼物特效"),h.addBlockCSS('.basicPlayer[data-e2e="basicPlayer"]  pace-island[id^="island_"]:has(>div>div>div)');},unlockImageQuality(){o.info("解锁画质选择"),y.on(document,"click",'div[data-e2e="quality-selector"] > div',function(e){var i,n;f.preventEvent(e);let t=e.target;try{let d=f.getReactObj(t),a=(i=d==null?void 0:d.reactFiber)==null?void 0:i.key,u=t.closest("div[data-index]"),r=f.getReactObj(u),s=(n=r==null?void 0:r.reactProps)==null?void 0:n.children.ref.current;o.info("当前选择的画质: "+a),o.info(["所有的画质: ",s.getCurrentQualityList()]),s.setCurrentQuality(a);}catch(d){o.error(d),k.error("切换画质失败");}},{capture:!0});},waitToRemovePauseDialog(){o.info("监听【长时间无操作，已暂停播放】弹窗"),y.ready(()=>{f.mutationObserver(document.body,{config:{subtree:!0,childList:!0},callback(){let e=document.querySelector("body > div[elementtiming='element-timing']");e&&(o.success("检测1：出现【长时间无操作，已暂停播放】弹窗，自动关闭"),k.success("检测1：出现【长时间无操作，已暂停播放】弹窗，自动关闭"),e.remove()),document.querySelectorAll('body > div:not([id="root"])').forEach(t=>{t.innerText.includes("长时间无操作")&&t.innerText.includes("暂停播放")&&(o.success("检测2：出现【长时间无操作，已暂停播放】弹窗，自动关闭"),k.success("检测2：出现【长时间无操作，已暂停播放】弹窗，自动关闭"),t.remove());});}});});}},He={init(){l.execMenu("douyin-redirect-url-home-to-root",()=>{this.redirectUrlHomeToRoot();});},redirectUrlHomeToRoot(){window.location.pathname==="/home"&&(o.info("从首页跳转到根目录"),window.location.href=window.location.origin+"/?is_from_mobile_home=1&recommend=1");}},xe={init(){He.init(),l.execMenuOnce("debug",()=>{Oe.removeEnvCheck();}),l.execMenuOnce("watchLoginDialogToClose",()=>{pe.watchLoginDialogToClose();}),l.execMenuOnce("disguiseLogin",()=>{pe.disguiseLogin();}),l.execMenuOnce("dy-initialScale",()=>{this.initialScale();}),l.execMenu("dy-apple-removeMetaAppleItunesApp",()=>{this.removeMetaAppleItunesApp();}),Ue.init(),ze.init(),C.isLive()?(o.info("Router: 直播"),Fe.init()):C.isVideo()?(o.info("Router: 推荐视频"),T.init(),C.isSearch()&&(o.info("Router: 搜索"),Ce.init())):o.error("未知router: "+window.location.hostname);},initialScale(){o.info("设置<meta>的viewport固定缩放倍率为1并移除页面原有的<meta>");let e=y.createElement("meta",{},{name:"viewport",content:"width=device-width,initial-scale=1,user-scalable=no,viewport-fit=cover"});y.remove("meta[name='viewport']"),f.waitNode("head").then(()=>{document.head.appendChild(e);});},removeMetaAppleItunesApp(){f.waitNodeList(['meta[name="apple-itunes-app"]'],1e4).then(e=>{e&&e.forEach(t=>{t.remove();});});}};l.init();xe.init();

})(Qmsg, Utils, DOMUtils);